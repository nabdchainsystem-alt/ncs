generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}


model Request {
  id           Int           @id @default(autoincrement())
  orderNo      String        @unique
  title        String?
  type         String?
  department   String?
  vendor       String?
  priority     String        @default("Medium")
  status       String        @default("NEW")
  quantity     Int?
  requiredDate DateTime?
  warehouse    String?       @default("")
  requester    String?
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt

  items        RequestItem[]

  @@index([orderNo])
  @@index([vendor])
  @@index([department])
  @@index([createdAt])
}

model RequestItem {
  id           Int      @id @default(autoincrement())
  requestId    Int
  name         String?
  qty          Int?
  unit         String?
  code         String?
  machine      String?
  warehouse    String?
  requester    String?
  status       String?       @default("NEW")
  note         String?

  request      Request  @relation(fields: [requestId], references: [id], onDelete: Cascade)
}

model Task {
  id          Int         @id @default(autoincrement())
  title       String
  description String?

  status      String      @default("TODO")
  priority    String?     @default("Medium")
  assignee    String?
  label       String?     // single label for now (can be extended later)
  dueDate     DateTime?

  // Order within a given status column (used for drag & drop)
  order       Int         @default(0)

  commentsCount Int       @default(0)

  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt

  @@index([status, order])
  @@index([dueDate])
}