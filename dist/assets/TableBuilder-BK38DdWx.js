import{c as W,r as m,j as e,X,P as R,T as J,H as K,C as Q}from"./index-DobLoqOc.js";import{F as Y,r as Z,u as ee,S as se}from"./xlsx-LTIZLP-R.js";import{T as te}from"./type-Bs27VvCu.js";import{S as re}from"./square-check-big-B-Y2pHa6.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],ne=W("grid-3x3",ae),ce=({isOpen:$,onClose:b,onAdd:D})=>{const[k,j]=m.useState("New Table"),[i,p]=m.useState([{id:"1",name:"Column 1",type:"text",width:150},{id:"2",name:"Column 2",type:"text",width:150}]),[h,B]=m.useState(!0),[N,M]=m.useState("#f3f4f6"),[u,S]=m.useState([]),g=m.useRef(null);if(!$)return null;const _=async s=>{var x;const r=(x=s.target.files)==null?void 0:x[0];if(!r)return;const y=new FileReader;y.onload=P=>{var T;try{const f=(T=P.target)==null?void 0:T.result,E=Z(f,{type:"binary"}),V=E.SheetNames[0],q=E.Sheets[V],v=ee.sheet_to_json(q,{header:1});if(v.length===0){alert("Excel file is empty!");return}const L=v[0],C=v.slice(1).filter(d=>d&&d.some(c=>c!=null&&c!==""));if(C.length===0){alert("No data rows found in Excel file!");return}const O=r.name.replace(/\.(xlsx|xls)$/i,"");j(O);const z=L.map((d,c)=>{var t;const a=(t=C[0])==null?void 0:t[c];let n="text";return typeof a=="number"?n="number":a instanceof Date||typeof a=="number"&&a>4e4&&a<5e4?n="date":(a===!0||a===!1||a==="true"||a==="false")&&(n="checkbox"),{id:Math.random().toString(36).substr(2,9),name:(d==null?void 0:d.toString())||`Column ${c+1}`,type:n,width:150}});p(z);const I=C.map((d,c)=>{const a=`imported-${Date.now()}-${c}`,n={};return d.forEach((t,U)=>{const o=z[U];if(o)if(o.type==="checkbox")n[o.id]=t===!0||t==="true"||t==="TRUE"||t===1||t==="1";else if(o.type==="number"){const l=Number(t);n[o.id]=isNaN(l)?t:l}else if(o.type==="date")if(typeof t=="number"){const l=se.parse_date_code(t),G=new Date(l.y,l.m-1,l.d);n[o.id]=G.toISOString().split("T")[0]}else{const l=new Date(t);n[o.id]=isNaN(l.getTime())?(t==null?void 0:t.toString())||"":l.toISOString().split("T")[0]}else n[o.id]=t!=null?t.toString():""}),{id:a,data:n}});S(I),alert(`✅ Imported ${I.length} rows from Excel!`)}catch(f){alert(`Failed to import Excel file: ${f instanceof Error?f.message:"Unknown error"}`)}},y.readAsBinaryString(r),g.current&&(g.current.value="")},F=()=>{const s=Math.random().toString(36).substr(2,9);p([...i,{id:s,name:`Column ${i.length+1}`,type:"text",width:150}])},H=s=>{p(i.filter(r=>r.id!==s))},w=(s,r,y)=>{p(i.map(x=>x.id===s?{...x,[r]:y}:x))},A=()=>{const s={title:k,columns:i,showBorder:h,headerColor:N,...u.length>0&&{rows:u}};D(s),b(),j("New Table"),p([{id:"1",name:"Column 1",type:"text",width:150},{id:"2",name:"Column 2",type:"text",width:150}]),S([])};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-[800px] max-h-[90vh] flex flex-col overflow-hidden animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ne,{className:"text-indigo-600",size:20}),e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Custom Table Builder"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{ref:g,type:"file",accept:".xlsx, .xls",onChange:_,className:"hidden"}),e.jsxs("button",{onClick:()=>{var s;return(s=g.current)==null?void 0:s.click()},className:"flex items-center space-x-2 px-3 py-1.5 bg-green-50 hover:bg-green-100 text-green-700 rounded-lg transition-colors border border-green-200 text-sm font-medium",title:"Import from Excel",children:[e.jsx(Y,{size:16}),e.jsx("span",{children:"Import from Excel"})]}),u.length>0&&e.jsxs("span",{className:"text-xs text-green-600 font-medium",children:["✓ ",u.length," rows imported"]})]})]}),e.jsx("button",{onClick:b,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(X,{size:20})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto flex-1 space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Table Title"}),e.jsx("input",{type:"text",value:k,onChange:s=>j(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all",placeholder:"Enter table name..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Header Style"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"color",value:N,onChange:s=>M(s.target.value),className:"h-9 w-16 rounded cursor-pointer border border-gray-300 p-1"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Color"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:s=>B(s.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Show Borders"})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Columns Configuration"}),e.jsxs("button",{onClick:F,className:"text-sm flex items-center space-x-1 text-indigo-600 hover:text-indigo-700 font-medium",children:[e.jsx(R,{size:16}),e.jsx("span",{children:"Add Column"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4 px-4 py-2 bg-gray-100 border-b border-gray-200 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:[e.jsx("div",{className:"col-span-5",children:"Name"}),e.jsx("div",{className:"col-span-3",children:"Type"}),e.jsx("div",{className:"col-span-3",children:"Width (px)"}),e.jsx("div",{className:"col-span-1"})]}),e.jsx("div",{className:"divide-y divide-gray-200",children:i.map(s=>e.jsxs("div",{className:"grid grid-cols-12 gap-4 px-4 py-3 items-center hover:bg-white transition-colors",children:[e.jsx("div",{className:"col-span-5",children:e.jsx("input",{type:"text",value:s.name,onChange:r=>w(s.id,"name",r.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:border-indigo-500 outline-none"})}),e.jsx("div",{className:"col-span-3",children:e.jsxs("select",{value:s.type,onChange:r=>w(s.id,"type",r.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:border-indigo-500 outline-none bg-white",children:[e.jsx("option",{value:"text",children:"Text"}),e.jsx("option",{value:"number",children:"Number"}),e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"checkbox",children:"Checkbox"})]})}),e.jsx("div",{className:"col-span-3",children:e.jsx("input",{type:"number",value:s.width,onChange:r=>w(s.id,"width",parseInt(r.target.value)),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:border-indigo-500 outline-none"})}),e.jsx("div",{className:"col-span-1 flex justify-end",children:e.jsx("button",{onClick:()=>H(s.id),className:"text-gray-400 hover:text-red-500 transition-colors",disabled:i.length<=1,children:e.jsx(J,{size:16})})})]},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Live Preview"}),e.jsxs("div",{className:"border rounded-lg overflow-hidden",style:{borderColor:h?"#e5e7eb":"transparent"},children:[e.jsx("div",{className:"flex",style:{backgroundColor:N},children:i.map(s=>e.jsx("div",{className:`px-4 py-2 text-sm font-semibold text-gray-700 ${h?"border-r border-gray-200 last:border-r-0":""}`,style:{width:s.width},children:e.jsxs("div",{className:"flex items-center space-x-2",children:[s.type==="text"&&e.jsx(te,{size:12,className:"text-gray-400"}),s.type==="number"&&e.jsx(K,{size:12,className:"text-gray-400"}),s.type==="date"&&e.jsx(Q,{size:12,className:"text-gray-400"}),s.type==="checkbox"&&e.jsx(re,{size:12,className:"text-gray-400"}),e.jsx("span",{children:s.name})]})},s.id))}),e.jsx("div",{className:"bg-white",children:e.jsx("div",{className:"flex border-t border-gray-100",children:i.map(s=>e.jsx("div",{className:`px-4 py-3 text-sm text-gray-400 italic ${h?"border-r border-gray-100 last:border-r-0":""}`,style:{width:s.width},children:"Sample Data"},s.id))})})]})]})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-100 bg-gray-50 flex justify-end space-x-3",children:[e.jsx("button",{onClick:b,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:A,className:"px-6 py-2 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded-lg shadow-sm transition-colors flex items-center space-x-2",children:[e.jsx(R,{size:16}),e.jsx("span",{children:"Add Table"})]})]})]})})};export{ce as default};
