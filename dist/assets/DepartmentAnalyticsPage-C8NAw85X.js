import{c as Be,aZ as Ke,a_ as ke,a$ as we,b0 as Je,b1 as Se,b2 as We,r as N,b3 as Te,b4 as Ye,b5 as He,b6 as se,an as Qe,V as B,Q as oe,aF as Ae,R as G,j as e,aA as Re,az as Xe,ax as De,b7 as Ze,aG as qe,as as H,ar as Ue,a8 as et,e as tt,a0 as st,F as nt,_ as ot,b8 as at,W as ve,aw as rt,A as lt}from"./index-D-msRKty.js";import{T as it,K as ct,C as dt}from"./KPICard-yNfjU48H.js";import{C as ut}from"./ChartWidget-BFAIDfL4.js";import{M as ne}from"./minus-PUoJsQYM.js";import"./xlsx-ZJnxW00S.js";import"./arrow-up-down-CZIV7XXl.js";import"./index-DCEMbtTY.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]],xt=Be("columns-2",mt);function pt(...n){const a=!Array.isArray(n[0]),r=a?0:-1,l=n[0+r],o=n[1+r],u=n[2+r],m=n[3+r],k=Ke(o,u,m);return a?k(l):k}function ft(n,a,r){const l=n.get();let o=null,u=l,m;const k=typeof l=="string"?l.replace(/[\d.-]/g,""):void 0,E=()=>{o&&(o.stop(),o=null)},T=()=>{E(),o=new Je({keyframes:[Ce(n.get()),Ce(u)],velocity:n.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...r,onUpdate:m})};if(n.attach((j,_)=>{u=j,m=P=>_(je(P,k)),ke.postRender(T)},E),we(a)){const j=a.on("change",P=>n.set(je(P,k))),_=n.on("destroy",j);return()=>{j(),_()}}return E}function je(n,a){return a?n+a:n}function Ce(n){return typeof n=="number"?n:parseFloat(n)}function re(n){const a=Se(()=>We(n)),{isStatic:r}=N.useContext(Te);if(r){const[,l]=N.useState(n);N.useEffect(()=>a.on("change",l),[])}return a}function Ie(n,a){const r=re(a()),l=()=>r.set(a());return l(),Ye(()=>{const o=()=>ke.preRender(l,!1,!0),u=n.map(m=>m.on("change",o));return()=>{u.forEach(m=>m()),He(l)}}),r}function ht(n){se.current=[],n();const a=Ie(se.current,n);return se.current=void 0,a}function ae(n,a,r,l){if(typeof n=="function")return ht(n);const o=typeof a=="function"?a:pt(a,r,l);return Array.isArray(n)?Ne(n,o):Ne([n],([u])=>o(u))}function Ne(n,a){const r=Se(()=>[]);return Ie(n,()=>{r.length=0;const l=n.length;for(let o=0;o<l;o++)r[o]=n[o].get();return a(r)})}function bt(n,a={}){const{isStatic:r}=N.useContext(Te),l=()=>we(n)?n.get():n;if(r)return ae(l);const o=re(l());return N.useInsertionEffect(()=>ft(o,n,a),[o,JSON.stringify(a)]),o}const gt=({title:n,value:a,trend:r,trendDirection:l,icon:o,color:u})=>e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-100 shadow-sm flex items-start justify-between hover:shadow-md transition-shadow",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-xs font-semibold uppercase tracking-wider mb-1",children:n}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:a}),e.jsxs("div",{className:`flex items-center gap-1 text-xs font-medium ${l==="up"?"text-green-600":"text-red-600"}`,children:[l==="up"?e.jsx(Re,{size:12}):e.jsx(it,{size:12}),r]})]}),e.jsx("div",{className:"p-2 rounded-lg bg-opacity-10",style:{backgroundColor:`${u}20`,color:u},children:e.jsx(o,{size:20})})]}),yt=({title:n="Executive Overview",subtitle:a="Performance Hub",description:r="Welcome to your central command center. This dashboard aggregates real-time data, providing actionable insights into your department's performance and operational efficiency.",stats:l=[],chartData:o,showWiki:u=!1})=>{const m=l.length>0?l:[{title:"Total Records",value:"0",trend:"0%",trendDirection:"up",icon:Qe,color:"#3b82f6"},{title:"Active Widgets",value:"0",trend:"0%",trendDirection:"up",icon:B,color:"#8b5cf6"},{title:"Data Sources",value:"0",trend:"0%",trendDirection:"up",icon:oe,color:"#f59e0b"},{title:"Reports",value:"0",trend:"0%",trendDirection:"up",icon:Ae,color:"#10b981"}],[k,E]=G.useState(!0);return G.useEffect(()=>{const T=setTimeout(()=>E(!1),1500);return()=>clearTimeout(T)},[]),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-5 mb-5",children:e.jsx("div",{className:"flex flex-col gap-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[e.jsxs("div",{className:"lg:col-span-5 flex flex-col justify-center",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"inline-block px-2.5 py-0.5 bg-blue-50 text-blue-600 rounded-full text-[10px] font-bold tracking-wide uppercase mb-2",children:n}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:a}),e.jsxs("div",{className:"text-sm text-gray-500 max-w-3xl leading-relaxed space-y-2 text-justify",children:[e.jsx("p",{children:r}),e.jsx("p",{children:"Monitor key performance indicators and track operational efficiency in real-time. This dashboard provides a comprehensive view of your department's health, enabling data-driven decision-making and strategic planning."})]})]}),e.jsx("div",{className:"flex items-center gap-3 mt-4",children:u&&e.jsxs("a",{href:"/procurement_system_wiki.pdf",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-3 py-1.5 text-xs font-medium text-white bg-black border border-black rounded-md hover:bg-gray-800 transition-colors shadow-sm",children:[e.jsx(oe,{size:14,className:"mr-1.5 text-gray-300"}),"Procurement Wiki"]})}),e.jsxs("p",{className:"text-[10px] text-gray-400 mt-2 ml-1 flex items-center gap-1",children:[e.jsx(B,{size:10}),"Updated: Nov 28, 2025"]})]}),e.jsx("div",{className:"lg:col-span-7",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 h-full",children:m.map((T,j)=>e.jsx(gt,{...T},j))})})]})})})},vt=({reports:n,onSelect:a,isVisible:r})=>{const l=re(1/0);return e.jsx(Xe,{children:r&&e.jsx(De.div,{initial:{x:120,opacity:0},animate:{x:0,opacity:1},exit:{x:120,opacity:0},transition:{type:"spring",stiffness:200,damping:25},className:"fixed right-6 top-1/2 -translate-y-1/2 z-40 flex flex-col gap-3 items-center py-6 px-3 rounded-full bg-white/10 backdrop-blur-2xl border border-white/20 shadow-2xl h-[80vh] justify-center",onMouseMove:o=>l.set(o.pageY),onMouseLeave:()=>l.set(1/0),children:n.map((o,u)=>e.jsx(jt,{mouseY:l,report:o,onClick:()=>a(o)},u))})})},jt=({mouseY:n,report:a,onClick:r})=>{const l=N.useRef(null),o=ae(n,E=>{var j;const T=((j=l.current)==null?void 0:j.getBoundingClientRect())??{y:0,height:0};return E-T.y-T.height/2}),u=ae(o,[-150,0,150],[50,90,50]),m=bt(u,{mass:.1,stiffness:150,damping:12}),k=Ct(a);return e.jsxs(De.div,{ref:l,style:{width:m,height:m},onClick:r,className:"aspect-square rounded-full bg-white/20 border border-white/30 flex items-center justify-center cursor-pointer hover:bg-white/40 transition-colors relative group shadow-lg backdrop-blur-sm",children:[e.jsx(k,{className:"w-1/2 h-1/2 text-white"}),e.jsx("div",{className:"absolute right-full mr-4 px-3 py-1.5 bg-black/70 backdrop-blur-md text-white text-sm font-medium rounded-lg opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none shadow-xl border border-white/10",children:a["Report Title"]})]})},Ct=n=>{const a=n["Chart Type (ECharts)"]||"";return a.includes("Bar")?Ze:a.includes("Pie")?qe:a.includes("Line")?Re:a.includes("Table")?H:a.includes("Heatmap")?B:a.includes("Treemap")?Ue:a.includes("Map")?et:oe},Nt=n=>{const a=n.split("/").filter(m=>m&&m!=="analytics"),r=a.length>1?a[a.length-1]:a[0]||"Department",l=m=>m.split(/[-_]/).map(k=>k.charAt(0).toUpperCase()+k.slice(1)).join(" ").replace(" And "," & "),o=l(r);l(a[0]||"Department");const u=n.includes("/procurement");return{title:"Executive Overview",subtitle:o,description:`Real-time insights and performance metrics for ${o}. Monitor key indicators and track operational efficiency.`,showWiki:u}},zt=({activePage:n,allPageWidgets:a,widgets:r=[],onDeleteWidget:l,onUpdateWidget:o,onInsert:u,placeholderIcon:m,placeholderTitle:k="Department Analytics",placeholderDescription:E='Manage your department data and analytics here. Use the "Insert" menu to add custom tables and charts.',defaultStats:T=[]})=>{var me,xe,pe,fe,he,be;const[j,_]=N.useState(null),[P,Z]=N.useState("select-table"),[Q,le]=N.useState(null),[A,K]=N.useState({}),[kt,Le]=N.useState(!1),[V,q]=N.useState(null),[ze,Me]=N.useState([]),[wt,ie]=N.useState(!1);G.useEffect(()=>{(async()=>{ie(!0);try{let i="supply-chain",b="procurement";if(n){const f=n.split("/").filter(y=>y&&y!=="analytics");f.length>=2&&(i=f[0],b=f[1])}const p=await at.getReports(i,b);Me(p)}catch(i){console.error("Failed to load reports:",i)}finally{ie(!1)}})()},[n]);const R=n.includes("/data"),D=()=>{if(R)return r.filter(i=>i.type==="custom-table");if(n.includes("/analytics")){const s=n.replace("/analytics","/data");return(a[s]||[]).filter(b=>b.type==="custom-table")}return[]},ce=G.useRef(0);G.useEffect(()=>{if(R){const s=D();if(!V&&s.length>0&&q(s[0].id),s.length>ce.current){const i=s[s.length-1];i&&q(i.id)}ce.current=s.length}},[R,r,V]);const Ee=()=>{var y,J;if(R){const t=D().find(h=>h.id===V);if(!t)return[];const I=((y=t.rows)==null?void 0:y.length)||0,v=((J=t.columns)==null?void 0:J.length)||0,x=(t.rows||[]).reduce((h,c)=>h+Object.values(c.data).filter(d=>d===""||d===null||d===void 0).length,0);return[{title:"Total Records",value:I.toLocaleString(),trend:"Live",trendDirection:"up",icon:ve,color:"#3b82f6"},{title:"Columns",value:v.toString(),trend:"Structure",trendDirection:"up",icon:xt,color:"#8b5cf6"},{title:"Empty Cells",value:x.toString(),trend:"Quality",trendDirection:"down",icon:rt,color:"#f59e0b"},{title:"Last Modified",value:"Just now",trend:"Active",trendDirection:"up",icon:lt,color:"#10b981"}]}const s=r.filter(t=>t.type==="custom-table"),i=r.filter(t=>t.type==="chart"),b=r.filter(t=>t.type==="kpi-card"),p=s.reduce((t,I)=>{var v;return t+(((v=I.rows)==null?void 0:v.length)||0)},0),f=r.length>0;return[{title:"Total Records",value:p.toLocaleString(),trend:f?"+12%":"-",trendDirection:"up",icon:ve,color:"#3b82f6"},{title:"Active Tables",value:s.length.toString(),trend:f?"Stable":"-",trendDirection:"up",icon:H,color:"#8b5cf6"},{title:"Visualizations",value:(i.length+b.length).toString(),trend:f?"+2":"-",trendDirection:"up",icon:Ae,color:"#f59e0b"},{title:"Data Points",value:f?(p*5).toLocaleString():"0",trend:f?"+5%":"-",trendDirection:"up",icon:B,color:"#10b981"}]},Ve=()=>{if(R){const p=D().find(y=>y.id===V);if(!p||!p.rows||p.rows.length===0)return{categories:["No Data"],values:[0]};const f=p.columns.find(y=>y.type==="text");if(f){const y={};p.rows.forEach(I=>{const v=I.data[f.id]||"Unknown";y[v]=(y[v]||0)+1});const J=Object.keys(y).slice(0,10),t=Object.values(y).slice(0,10);return{categories:J,values:t}}return{categories:["Row 1","Row 2","Row 3","Row 4","Row 5"],values:[10,20,15,25,18]}}const s=r.filter(p=>p.type==="custom-table");if(s.length===0)return{categories:["No Data"],values:[0]};const i=s.map(p=>p.title||"Untitled").slice(0,6),b=s.map(p=>{var f;return((f=p.rows)==null?void 0:f.length)||0}).slice(0,6);return{categories:i,values:b}},X=Nt(n),Fe=Ee(),$e=Ve(),_e=s=>{u==null||u("report-template",s)};G.useEffect(()=>{r.length>0&&Le(!0)},[r.length]);const de=s=>{_(s),Z("select-table"),le(null),K({})},Oe=s=>{le(s),Z("configure");const i=D().find(b=>b.id===s);if(i){const b=i.columns.find(f=>f.type==="text"),p=i.columns.find(f=>f.type==="number");K({xAxisColumn:(b==null?void 0:b.id)||"",yAxisColumn:(p==null?void 0:p.id)||"",aggregation:"count"})}},Ge=()=>{if(j&&Q){const s=D().find(i=>i.id===Q);o&&o(j,{sourceTableId:Q,title:(s==null?void 0:s.title)||"Connected Widget",config:A,subtext:A.aggregation==="sum"?"Total Value":"Count of records",trend:{value:"+12.5%",direction:"up"}})}_(null)},U=()=>D().find(s=>s.id===Q),ue=()=>r.find(s=>s.id===j);return r.filter(s=>s.type==="chart").length,e.jsxs("div",{className:"w-full h-full overflow-y-auto bg-gray-50/50",children:[e.jsx(vt,{reports:ze,onSelect:_e,isVisible:!1}),R&&r.length>0&&e.jsx("div",{className:"h-12 bg-white/80 backdrop-blur-md border-b border-gray-200/60 flex items-center px-8 gap-2 sticky top-0 z-20 flex-shrink-0 overflow-x-auto no-scrollbar",children:D().length===0?e.jsxs("div",{className:"flex items-center text-sm text-gray-400 italic",children:[e.jsx(H,{size:14,className:"mr-2"}),"Insert a table from the menu to get started..."]}):D().map(s=>e.jsxs("button",{onClick:()=>q(s.id),className:`
                                    px-3 py-1.5 rounded-lg text-sm font-medium transition-all whitespace-nowrap flex items-center gap-2 border
                                    ${V===s.id?"bg-black text-white border-black shadow-sm":"bg-white text-gray-600 hover:bg-gray-50 border-gray-200"}
                                `,children:[e.jsx(H,{size:14}),s.title||"Untitled Table"]},s.id))}),(n.includes("/analytics")||R&&V)&&e.jsx("div",{className:"px-8 pt-6",children:e.jsx(yt,{title:R?((me=D().find(s=>s.id===V))==null?void 0:me.title)||"Table Overview":X.title,subtitle:R?"Data Insights":X.subtitle,description:R?"Overview of records, data quality, and distribution.":X.description,stats:Fe,chartData:$e,showWiki:X.showWiki})}),j&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden border border-gray-200 animate-in zoom-in-95 duration-200 flex flex-col max-h-[80vh]",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 flex items-center justify-between bg-gray-50/50",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:P==="select-table"?"Select Data Source":"Configure Data"}),e.jsx("button",{onClick:()=>_(null),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ne,{size:18,className:"rotate-45"})})]}),e.jsx("div",{className:"p-0 overflow-y-auto flex-1",children:P==="select-table"?e.jsx("div",{className:"p-2",children:D().length===0?e.jsxs("div",{className:"p-8 text-center flex flex-col items-center text-gray-500",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mb-3",children:e.jsx(B,{size:24,className:"text-gray-400"})}),e.jsx("p",{className:"font-medium",children:"No tables found"}),e.jsx("p",{className:"text-sm mt-1",children:"Create a table in the Data section first."})]}):e.jsx("div",{className:"space-y-1",children:D().map(s=>{var i;return e.jsxs("button",{className:"w-full text-left px-4 py-3 hover:bg-blue-50 rounded-lg group transition-colors flex items-center justify-between border border-transparent hover:border-blue-100",onClick:()=>Oe(s.id),children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-100 text-blue-600 flex items-center justify-center mr-3 group-hover:bg-blue-200 transition-colors",children:e.jsx(H,{size:16})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 group-hover:text-blue-700",children:s.title||"Untitled Table"}),e.jsxs("div",{className:"text-xs text-gray-500",children:[((i=s.rows)==null?void 0:i.length)||0," records"]})]})]}),e.jsx("div",{className:"opacity-0 group-hover:opacity-100 text-blue-600 transition-opacity",children:e.jsx(tt,{size:16})})]},s.id)})})}):e.jsxs("div",{className:"p-6 space-y-6",children:[((xe=ue())==null?void 0:xe.type)==="chart"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"X Axis (Category)"}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",value:A.xAxisColumn,onChange:s=>K({...A,xAxisColumn:s.target.value}),children:[e.jsx("option",{value:"",children:"Select Column..."}),(pe=U())==null?void 0:pe.columns.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Y Axis (Value)"}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",value:A.yAxisColumn,onChange:s=>K({...A,yAxisColumn:s.target.value}),children:[e.jsx("option",{value:"",children:"Select Column..."}),(fe=U())==null?void 0:fe.columns.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]})]}),((he=ue())==null?void 0:he.type)==="kpi-card"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Metric"}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",value:A.aggregation,onChange:s=>K({...A,aggregation:s.target.value}),children:[e.jsx("option",{value:"count",children:"Count of Records"}),e.jsx("option",{value:"sum",children:"Sum of Column"}),e.jsx("option",{value:"avg",children:"Average of Column"})]})]}),A.aggregation!=="count"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Column"}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",value:A.yAxisColumn,onChange:s=>K({...A,yAxisColumn:s.target.value}),children:[e.jsx("option",{value:"",children:"Select Column..."}),(be=U())==null?void 0:be.columns.filter(s=>s.type==="number").map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]})]})]})}),e.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-100 text-xs text-gray-500 flex justify-between items-center",children:P==="select-table"?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Select a table to link."}),e.jsx("button",{className:"text-gray-600 hover:text-gray-900 font-medium",onClick:()=>_(null),children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"text-gray-600 hover:text-gray-900 font-medium",onClick:()=>Z("select-table"),children:"Back"}),e.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium",onClick:Ge,children:"Finish"})]})})]})}),e.jsxs("div",{className:"p-8 w-full overflow-x-auto",children:[e.jsx("div",{className:"grid grid-cols-12 gap-4 min-w-[1000px] grid-auto-rows-[minmax(175px,auto)]",children:(()=>{let s=r.filter(t=>t.layoutGroup),i=r.filter(t=>!t.layoutGroup);R&&V&&(i=i.filter(t=>t.id===V),s=[]);const b=[...i].sort((t,I)=>{const v={"kpi-card":1,chart:2,"custom-table":3};return(v[t.type]||99)-(v[I.type]||99)}),p=(t,I,v)=>I<=v?Math.floor(12/I):Math.floor(12/v),f=b.filter(t=>t.type==="kpi-card").length,y=b.filter(t=>t.type==="chart").length;return[...s,...b].map((t,I)=>{var v;if(t.type==="kpi-card"){const h={DollarSign:ot,Users:nt,ShoppingBag:st,Activity:B}[t.icon]||B;let c=t.value;if(t.sourceTableId){const w=n.replace("/analytics","/data"),O=(a[w]||[]).find(S=>S.id===t.sourceTableId);if(O){const S=t.config||{aggregation:"count"};if(S.aggregation==="count")c=(O.rows||[]).length.toString();else if(S.aggregation==="sum"&&S.yAxisColumn)c=(O.rows||[]).reduce(($,M)=>{const g=parseFloat(M.data[S.yAxisColumn])||0;return $+g},0).toLocaleString();else if(S.aggregation==="avg"&&S.yAxisColumn){const z=O.rows||[];z.length>0?c=(z.reduce((M,g)=>{const L=parseFloat(g.data[S.yAxisColumn])||0;return M+L},0)/z.length).toFixed(1):c="0"}else c=(O.rows||[]).length.toString()}}const d=t.layoutGroup&&t.layoutPosition<=4;let C={},F="col-span-3";return d?C={1:{gridColumn:"1 / 4",gridRow:"1"},2:{gridColumn:"4 / 7",gridRow:"1"},3:{gridColumn:"1 / 4",gridRow:"2"},4:{gridColumn:"4 / 7",gridRow:"2"}}[t.layoutPosition]||{}:F=`col-span-${p(0,f,4)}`,e.jsxs("div",{className:`relative group w-full h-full ${d?"":F}`,style:d?C:{},children:[e.jsx("div",{className:"absolute -right-2 -top-2 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:e.jsx("button",{onClick:()=>l&&l(t.id),className:"bg-red-500 text-white p-1 rounded-full shadow-sm hover:bg-red-600",children:e.jsx(ne,{size:12})})}),e.jsx(ct,{title:t.title,value:c,icon:h,trend:t.trend,subtext:t.subtext,isEmpty:!t.value&&!t.sourceTableId,onConnect:()=>de(t.id),onTitleChange:w=>o&&o(t.id,{title:w})})]},t.id)}if(t.type==="chart"){let x=t.data||null;if(t.sourceTableId){const C=n.replace("/analytics","/data"),w=(a[C]||[]).find(W=>W.id===t.sourceTableId);if(w&&w.rows&&w.rows.length>0){const W=t.config||{},O=W.xAxisColumn,S=W.yAxisColumn,z=w.columns||[];let $=O?z.find(g=>g.id===O):null,M=S?z.find(g=>g.id===S):null;if(!$||!M){const g=(v=t.config)==null?void 0:v.smartLogic;g&&g.requirements&&g.requirements.forEach(L=>{var ye;const Y=L.keywords||[],ge=((ye=L.types)==null?void 0:ye[0])||"text",ee=z.find(te=>(te.type===ge||ge==="text"&&te.type!=="number")&&Y.some(Pe=>te.name.toLowerCase().includes(Pe.toLowerCase())));ee&&((L.key==="group_col"||L.key==="date_col")&&($=ee),L.key==="amount_col"&&(M=ee))})}if($||($=z.find(g=>g.type==="text"||g.type==="date")),M||(M=z.find(g=>g.type==="number")),$){const g=w.rows.map(Y=>Y.data[$.id]||"Unknown");let L;M?L=w.rows.map(Y=>parseFloat(Y.data[M.id])||0):L=w.rows.map(()=>1),x={categories:g,values:L}}}}const h=t.layoutGroup&&t.layoutPosition===5;let c={},d="col-span-6";if(h)c={gridColumn:"7 / 13",gridRow:"1 / 3"};else{const C=y===1?12:y===2?6:4;d=`col-span-${C}`,c={gridColumn:`span ${C} / span ${C}`}}return e.jsxs("div",{className:`row-span-2 min-h-[350px] relative group transition-all duration-300 ${h?"":d}`,style:c,children:[e.jsx("div",{className:"absolute -right-2 -top-2 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:e.jsx("button",{onClick:()=>l&&l(t.id),className:"bg-red-500 text-white p-1 rounded-full shadow-sm hover:bg-red-600",children:e.jsx(ne,{size:12})})}),e.jsx(ut,{title:t.title,type:t.chartType||"bar",data:x,isEmpty:!t.sourceTableId&&!t.data,onConnect:()=>de(t.id),onTitleChange:C=>o&&o(t.id,{title:C})})]},t.id)}return t.type==="custom-table"?e.jsx("div",{className:"col-span-12",children:e.jsx(dt,{...t,onDelete:()=>l&&l(t.id),onRenameTable:x=>o&&o(t.id,{title:x}),onRenameColumn:(x,h)=>{const c=t.columns.map(d=>d.id===x?{...d,name:h}:d);o&&o(t.id,{columns:c})},onAddColumn:()=>{const x={id:Math.random().toString(36).substr(2,9),name:"New Column",type:"text",width:150};o&&o(t.id,{columns:[...t.columns,x]})},onUpdateColumnType:(x,h)=>{const c=t.columns.map(d=>d.id===x?{...d,type:h}:d);o&&o(t.id,{columns:c})},onDeleteColumn:x=>{const h=t.columns.filter(c=>c.id!==x);o&&o(t.id,{columns:h})},onUpdateColumnColor:(x,h)=>{const c=t.columns.map(d=>d.id===x?{...d,color:h}:d);o&&o(t.id,{columns:c})},onUpdateRow:(x,h)=>{const c=t.rows||[],d=c.some(F=>F.id===x);let C;d?C=c.map(F=>F.id===x?{...F,data:h}:F):C=[...c,{id:x,data:h}],o&&o(t.id,{rows:C})},onRowsChange:x=>{o&&o(t.id,{rows:x})}})},t.id):null})})()}),r.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[m&&e.jsx("div",{className:"bg-indigo-50 p-6 rounded-full mb-6",children:G.isValidElement(m)?G.cloneElement(m,{className:"text-indigo-600",size:48}):m}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:k}),e.jsx("p",{className:"text-gray-500 max-w-md mb-8",children:E}),T.length>0&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 w-full max-w-4xl",children:T.map((s,i)=>e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"text-gray-500 text-sm font-medium",children:s.label}),e.jsx(s.icon,{className:s.color,size:20})]}),e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:s.value})]},i))})]})]})]})};export{zt as default};
