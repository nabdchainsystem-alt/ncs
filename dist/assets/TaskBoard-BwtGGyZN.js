import{c as Q,r as C,N as ne,K as le,j as e,C as ns,w as is,g as ut,au as os,O as ls,Z as cs,aI as ds,T as He,X as De,aJ as Se,i as ht,Y as mt,u as xs,L as pt,n as me,k as yt,P as ft,a5 as gs,J as bt,E as us,aq as hs,ap as lt,aK as ms,aL as wt,a1 as ps,R as ys,e as fs,a8 as bs,a2 as ws,aM as vs,G as js,aN as Ns}from"./index-BaRn3IWj.js";import{T as he}from"./index-Ca_DMGSD.js";import{b as $s,T as Cs,G as Ss,S as Ds,v as zs,C as ks,c as Is,u as As,a as ct}from"./sortable.esm-CF4rajHW.js";import{C as vt}from"./copy-Js1b8Mpk.js";import{r as Ts}from"./remindersService-CkphtGlV.js";import{g as Ps}from"./goalsService-DtrjEL37.js";import{S as _s}from"./square-check-big-BOoFgSp7.js";import{L as Es}from"./list-B6IbW7Ji.js";import{L as Ls}from"./list-ordered-NTzaGspy.js";import{F as jt}from"./flag-7G_sRA4i.js";import{u as Fs,a as Os,P as Vs,D as Gs,g as Rs,C as Bs}from"./core.esm-DZw859Vw.js";import{S as Nt}from"./star-DjOLFkds.js";import{P as Hs}from"./phone-1J_Lfyvk.js";import{T as Us}from"./tag-C232WDvR.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],qs=Q("archive",Ws);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M20 8h-5",key:"1vsyxs"}],["path",{d:"M15 10V6.5a2.5 2.5 0 0 1 5 0V10",key:"ag13bf"}],["path",{d:"M15 14h5l-5 6h5",key:"ur5jdg"}]],Ys=Q("arrow-down-a-z",Js);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=[["path",{d:"M3 19V5",key:"rwsyhb"}],["path",{d:"m13 6-6 6 6 6",key:"1yhaz7"}],["path",{d:"M7 12h14",key:"uoisry"}]],Ks=Q("arrow-left-to-line",Xs);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=[["path",{d:"M17 12H3",key:"8awo09"}],["path",{d:"m11 18 6-6-6-6",key:"8c2y43"}],["path",{d:"M21 5v14",key:"nzette"}]],Qs=Q("arrow-right-to-line",Zs);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M15 4h5l-5 6h5",key:"8asdl1"}],["path",{d:"M15 20v-3.5a2.5 2.5 0 0 1 5 0V20",key:"r6l5cz"}],["path",{d:"M20 18h-5",key:"18j1r2"}]],er=Q("arrow-up-z-a",Ms);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]],sr=Q("heading-1",tr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rr=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]],ar=Q("heading-2",rr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nr=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]],ir=Q("heading-3",nr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const or=[["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17 10v3a1 1 0 0 0 1 1h3",key:"tj5zdr"}],["path",{d:"M21 10v8",key:"1kdml4"}],["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}]],lr=Q("heading-4",or);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cr=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],$t=Q("maximize-2",cr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dr=[["path",{d:"M14 14a2 2 0 0 0 2-2V8h-2",key:"1r06pg"}],["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}],["path",{d:"M8 14a2 2 0 0 0 2-2V8H8",key:"1jzu5j"}]],xr=Q("message-square-quote",dr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=[["path",{d:"M18 8L22 12L18 16",key:"1r0oui"}],["path",{d:"M2 12H22",key:"1m8cig"}]],dt=Q("move-right",gr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]],hr=Q("pin",ur);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mr=[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]],pr=Q("quote",mr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yr=[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],fr=Q("toggle-left",yr);var A=(r=>(r.New="New",r.Pending="Pending",r.Working="Working on it",r.Stuck="Stuck",r.AlmostFinish="Almost Finish",r.Done="Done",r))(A||{}),Z=(r=>(r.Normal="Normal",r.Low="Low",r.Medium="Medium",r.High="High",r.Urgent="Urgent",r))(Z||{});const Ct={New:"bg-gradient-to-r from-[#A0A5B9] to-[#8D92A6] text-white shadow-sm",Pending:"bg-gradient-to-r from-[#FFD940] to-[#FFCC00] text-white shadow-sm","Working on it":"bg-gradient-to-r from-[#FFBE66] to-[#FFA533] hover:from-[#FFA533] hover:to-[#FF991F] text-white shadow-sm",Stuck:"bg-gradient-to-r from-[#FF7085] to-[#FF526B] hover:from-[#FF526B] hover:to-[#FF3352] text-white shadow-sm","Almost Finish":"bg-gradient-to-r from-[#C48AF0] to-[#B06CE0] text-white shadow-sm",Done:"bg-gradient-to-r from-[#33D995] to-[#00C875] hover:from-[#00C875] hover:to-[#00B067] text-white shadow-sm"},br={New:"bg-gradient-to-r from-slate-700 to-slate-600 text-white shadow-sm border border-white/10",Pending:"bg-gradient-to-r from-yellow-700 to-yellow-600 text-white shadow-sm border border-white/10","Working on it":"bg-gradient-to-r from-orange-700 to-orange-600 text-white shadow-sm border border-white/10",Stuck:"bg-gradient-to-r from-red-700 to-red-600 text-white shadow-sm border border-white/10","Almost Finish":"bg-gradient-to-r from-purple-700 to-purple-600 text-white shadow-sm border border-white/10",Done:"bg-gradient-to-r from-emerald-700 to-emerald-600 text-white shadow-sm border border-white/10"},ze={Normal:"bg-gradient-to-r from-[#D9D9D9] to-[#C4C4C4] text-white shadow-sm",Low:"bg-gradient-to-r from-[#82B4FF] to-[#579BFC] text-white shadow-sm",Medium:"bg-gradient-to-r from-[#FFBE66] to-[#FFA533] text-white shadow-sm",High:"bg-gradient-to-r from-[#7048C4] to-[#552CB0] text-white shadow-sm",Urgent:"bg-gradient-to-r from-[#FF7085] to-[#FF526B] text-white shadow-sm"},wr={Normal:"bg-gradient-to-r from-slate-700 to-slate-600 text-white shadow-sm border border-white/10",Low:"bg-gradient-to-r from-blue-700 to-blue-600 text-white shadow-sm border border-white/10",Medium:"bg-gradient-to-r from-orange-700 to-orange-600 text-white shadow-sm border border-white/10",High:"bg-gradient-to-r from-purple-700 to-purple-600 text-white shadow-sm border border-white/10",Urgent:"bg-gradient-to-r from-red-700 to-red-600 text-white shadow-sm border border-white/10"},Ee=["#3B82F6","#10B981","#F59E0B","#EC4899","#8B5CF6","#0EA5E9","#7C3AED"],xt=[{id:"p1",name:"Max",initials:"MA",color:"bg-gradient-to-br from-blue-400 to-blue-600"},{id:"p2",name:"Hasan",initials:"HA",color:"bg-gradient-to-br from-emerald-400 to-emerald-600"},{id:"p3",name:"Sarah",initials:"SA",color:"bg-gradient-to-br from-purple-400 to-purple-600"},{id:"p4",name:"John",initials:"JO",color:"bg-gradient-to-br from-amber-400 to-amber-600"}],Ce={id:"board-1",name:"Task Board",groups:[{id:"group-1",title:"New Group",color:"#579bfc",columns:[{id:"col_name",title:"Item",type:"name",width:"300px"},{id:"col_person",title:"Owner",type:"person",width:"96px"},{id:"col_status",title:"Status",type:"status",width:"128px"},{id:"col_priority",title:"Priority",type:"priority",width:"128px"},{id:"col_date",title:"Due Date",type:"date",width:"110px"}],tasks:[]}]};he.OBJECT,he.ARRAY,he.OBJECT,he.STRING,he.STRING,he.INTEGER,he.STRING;const vr=async r=>(console.warn("Gemini API key is missing. AI features are disabled."),null),jr=async r=>"AI features are disabled (missing API key).",Nr=r=>{const[x,d]=C.useState(()=>{try{if(typeof window<"u"){const m=localStorage.getItem(r);if(m){const y=JSON.parse(m);if(y.columns&&Array.isArray(y.columns)&&y.groups){const b=y.groups.map(p=>({...p,columns:p.columns||[...y.columns]}));return{...y,groups:b}}if(y.groups&&Array.isArray(y.groups)){const b=y.groups.map(p=>p.columns&&Array.isArray(p.columns)?p:{...p,columns:[{id:"col_name",title:"Item",type:"name",width:"300px"},{id:"col_person",title:"Owner",type:"person",width:"96px"},{id:"col_status",title:"Status",type:"status",width:"128px"},{id:"col_priority",title:"Priority",type:"priority",width:"128px"},{id:"col_date",title:"Due Date",type:"date",width:"110px"}]});return{...y,groups:b}}}}}catch(m){console.warn("Failed to load saved board",m)}return JSON.parse(JSON.stringify(Ce))}),[s,i]=C.useState(""),[$,k]=C.useState(!1),[v,D]=C.useState(null);C.useEffect(()=>{const m=()=>{try{if(typeof window<"u"){const p=localStorage.getItem(r);if(p){const w=JSON.parse(p);if(w.columns&&Array.isArray(w.columns)&&w.groups){const _=w.groups.map(J=>({...J,columns:J.columns||[...w.columns]}));d({...w,groups:_});return}if(w.groups&&Array.isArray(w.groups)){const _=w.groups.map(J=>J.columns&&Array.isArray(J.columns)?J:{...J,columns:[{id:"col_name",title:"Item",type:"name",width:"300px"},{id:"col_person",title:"Owner",type:"person",width:"96px"},{id:"col_status",title:"Status",type:"status",width:"128px"},{id:"col_priority",title:"Priority",type:"priority",width:"128px"},{id:"col_date",title:"Due Date",type:"date",width:"110px"}]});d({...w,groups:_});return}d(w)}else d(JSON.parse(JSON.stringify(Ce)))}}catch(p){console.warn("Failed to load saved board on key change",p),d(JSON.parse(JSON.stringify(Ce)))}};m();const y=p=>{p.key===r&&m()},b=p=>{var w;((w=p.detail)==null?void 0:w.key)===r&&m()};return window.addEventListener("storage",y),window.addEventListener("local-storage-update",b),()=>{window.removeEventListener("storage",y),window.removeEventListener("local-storage-update",b)}},[r]),C.useEffect(()=>{try{localStorage.setItem(r,JSON.stringify(x))}catch(m){console.warn("Failed to save board",m)}},[x,r]);const g=(m,y,b)=>{d(p=>({...p,groups:p.groups.map(w=>w.id!==m?w:{...w,tasks:w.tasks.map(_=>_.id===y?{..._,...b}:_)})}))},u=(m,y,b)=>{g(m,y,{selected:b})},F=(m,y)=>{d(b=>({...b,groups:b.groups.map(p=>m!=="all"&&p.id!==m?p:{...p,tasks:p.tasks.map(w=>({...w,selected:y}))})}))},l=(m,y,b,p)=>{d(w=>({...w,groups:w.groups.map(_=>_.id!==m?_:{..._,tasks:_.tasks.map(J=>J.id!==y?J:{...J,textValues:{...J.textValues,[b]:p}})})}))},S=(m,y,b)=>{const p={id:ne(),name:(y==null?void 0:y.trim())||"New Item",status:A.New,priority:Z.Normal,dueDate:new Date().toISOString().split("T")[0],personId:null,textValues:{},selected:!1,...b};d(w=>({...w,groups:w.groups.map(_=>_.id===m?{..._,tasks:[..._.tasks,p]}:_)}))},P=(m,y)=>{d(b=>({...b,groups:b.groups.map(p=>p.id===m?{...p,tasks:p.tasks.filter(w=>w.id!==y)}:p)}))},h=()=>{const m={id:ne(),title:"New Group",color:Ee[x.groups.length%Ee.length],columns:[{id:"col_name",title:"Item",type:"name",width:"300px"},{id:"col_person",title:"Owner",type:"person",width:"96px"},{id:"col_status",title:"Status",type:"status",width:"128px"},{id:"col_priority",title:"Priority",type:"priority",width:"128px"},{id:"col_date",title:"Due Date",type:"date",width:"110px"}],tasks:[]};d(y=>({...y,groups:[...y.groups,m]}))},V=m=>{d(y=>({...y,groups:y.groups.filter(b=>b.id!==m)}))},E=(m,y)=>{d(b=>({...b,groups:b.groups.map(p=>p.id===m?{...p,title:y}:p)}))},T=m=>{d(y=>({...y,groups:y.groups.map(b=>b.id===m?{...b,isPinned:!b.isPinned}:b)}))},G=(m,y="text",b="New Column",p,w)=>{const J={id:`col_${ne().slice(0,4)}`,title:b,type:y,width:"140px",options:p,currency:w};d(M=>({...M,groups:M.groups.map(ce=>ce.id===m?{...ce,columns:[...ce.columns,J]}:ce)}))},O=(m,y,b)=>{d(p=>({...p,groups:p.groups.map(w=>w.id!==m?w:{...w,columns:w.columns.map(_=>_.id===y?{..._,title:b}:_)})}))},U=(m,y,b)=>{d(p=>({...p,groups:p.groups.map(w=>w.id!==m?w:{...w,columns:w.columns.map(_=>_.id===y?{..._,width:`${b}px`}:_)})}))},X=(m,y)=>{d(b=>({...b,groups:b.groups.map(p=>p.id!==m?p:{...p,columns:p.columns.filter(w=>w.id!==y)})}))},te=(m,y)=>{d(b=>({...b,groups:b.groups.map(p=>{if(p.id!==m)return p;const w=p.columns.findIndex(ce=>ce.id===y);if(w===-1)return p;const _=p.columns[w],J={..._,id:`col_${ne().slice(0,4)}`,title:`${_.title} (Copy)`},M=[...p.columns];return M.splice(w+1,0,J),{...p,columns:M}})}))},o=(m,y,b)=>{d(p=>{const w=p.groups.find(M=>M.id===m);if(!w)return p;const _=[...w.columns],[J]=_.splice(y,1);return _.splice(b,0,J),{...p,groups:p.groups.map(M=>M.id!==m?M:{...M,columns:_})}})};return{board:x,setBoard:d,aiPrompt:s,setAiPrompt:i,isAiLoading:$,aiAnalysis:v,setAiAnalysis:D,updateTask:g,toggleTaskSelection:u,toggleGroupSelection:F,updateTaskTextValue:l,addTask:S,deleteTask:P,addGroup:h,deleteGroup:V,updateGroupTitle:E,toggleGroupPin:T,addColumn:G,updateColumnTitle:O,updateColumnWidth:U,deleteColumn:X,duplicateColumn:te,moveColumn:o,reorderColumn:(m,y,b)=>{o(m,y,b)},handleGeneratePlan:async()=>{if(!s.trim())return;k(!0),D(null);const m=await vr();if(m){const y=new Date,b=m.tasks.map(w=>{const _=new Date(y);return _.setDate(y.getDate()+w.dueDateOffsetDays),{id:ne(),name:w.name,status:A.New,priority:w.priority||Z.Medium,dueDate:_.toISOString().split("T")[0],personId:null,textValues:{}}}),p={id:ne(),title:m.groupName||"AI Generated Plan",color:Ee[Math.floor(Math.random()*Ee.length)],tasks:b,columns:[{id:"col_name",title:"Item",type:"name",width:"300px"},{id:"col_person",title:"Owner",type:"person",width:"96px"},{id:"col_status",title:"Status",type:"status",width:"128px"},{id:"col_priority",title:"Priority",type:"priority",width:"128px"},{id:"col_date",title:"Due Date",type:"date",width:"110px"}]};d(w=>({...w,groups:[p,...w.groups]})),i("")}k(!1)},handleAnalyzeBoard:async()=>{k(!0),x.groups.map(y=>`Group: ${y.title}. Tasks: ${y.tasks.map(b=>`${b.name} (${b.status})`).join(", ")}`).join(`
`);const m=await jr();D(m),k(!1)}}},$r=({date:r,onSelect:x,onClose:d,darkMode:s,className:i=""})=>{const[$,k]=C.useState(new Date),[v,D]=C.useState(r?new Date(r):null),{ref:g}=le({onCancel:d,initialActive:!0});C.useEffect(()=>{if(r){const E=new Date(r);D(E),k(E)}},[r]);const u=(E,T)=>new Date(E,T+1,0).getDate(),F=(E,T)=>new Date(E,T,1).getDay(),l=()=>{const E=$.getFullYear(),T=$.getMonth(),G=u(E,T),O=F(E,T),U=[];for(let X=0;X<O;X++)U.push(e.jsx("div",{className:"w-8 h-8"},`empty-${X}`));for(let X=1;X<=G;X++){const te=new Date(E,T,X),o=v&&te.toDateString()===v.toDateString(),se=new Date().toDateString()===te.toDateString();U.push(e.jsx("button",{onClick:()=>{const re=new Date(E,T,X),j=re.getTimezoneOffset(),m=new Date(re.getTime()-j*60*1e3);x(m.toISOString().split("T")[0]),d()},className:`w-8 h-8 text-xs rounded-full flex items-center justify-center transition-all
                        ${o?"bg-red-500 text-white font-bold shadow-md":s?"text-gray-300 hover:bg-white/10":"text-gray-700 hover:bg-gray-100"}
                        ${se&&!o?"text-red-500 font-bold":""}
                    `,children:X},X))}return U},S=()=>{k(new Date($.getFullYear(),$.getMonth()+1,1))},P=()=>{k(new Date($.getFullYear(),$.getMonth()-1,1))},h=E=>{const T=new Date;T.setDate(T.getDate()+E);const G=T.getTimezoneOffset(),O=new Date(T.getTime()-G*60*1e3);x(O.toISOString().split("T")[0]),d()},V=[{label:"Today",days:0,sub:"Sun"},{label:"Later",days:7,sub:"8:53 pm"},{label:"Tomorrow",days:1,sub:"Mon"},{label:"Next week",days:7,sub:"Mon"},{label:"Next weekend",days:6,sub:"Sat"},{label:"2 weeks",days:14,sub:"14 Dec"},{label:"4 weeks",days:28,sub:"28 Dec"},{label:"8 weeks",days:56,sub:"25 Jan"}];return e.jsxs("div",{ref:g,className:`rounded-xl shadow-2xl border flex overflow-hidden w-[500px] animate-in fade-in zoom-in-95 duration-200 ${s?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"} ${i}`,children:[e.jsxs("div",{className:`w-48 border-r p-2 flex flex-col gap-1 ${s?"bg-[#1a1d24] border-gray-700":"bg-gray-50/50 border-gray-100"}`,children:[e.jsxs("div",{className:`px-3 py-2 mb-2 border-b ${s?"border-gray-700":"border-gray-100"}`,children:[e.jsxs("div",{className:`flex items-center text-xs font-medium mb-1 ${s?"text-gray-500":"text-gray-400"}`,children:[e.jsx(ns,{size:12,className:"mr-2"}),e.jsx("span",{children:"Date"})]}),e.jsx("div",{className:`text-sm font-bold ${s?"text-gray-200":"text-gray-800"}`,children:v?v.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):"Set Date"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:V.map((E,T)=>e.jsxs("button",{onClick:()=>h(E.days),className:`w-full flex items-center justify-between px-3 py-2 rounded-lg transition-colors group text-left ${s?"hover:bg-white/5":"hover:bg-gray-100"}`,children:[e.jsx("span",{className:`text-sm font-medium group-hover:text-gray-900 ${s?"text-gray-300 group-hover:text-white":"text-gray-700"}`,children:E.label}),e.jsx("span",{className:`text-xs group-hover:text-gray-500 ${s?"text-gray-500 group-hover:text-gray-400":"text-gray-400"}`,children:E.sub})]},T))})]}),e.jsxs("div",{className:`flex-1 p-4 ${s?"bg-[#1a1d24]":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm font-bold ${s?"text-gray-200":"text-gray-900"}`,children:$.toLocaleDateString(void 0,{month:"long",year:"numeric"})}),e.jsx("span",{className:`text-xs font-medium cursor-pointer ${s?"text-gray-500 hover:text-gray-300":"text-gray-400 hover:text-gray-600"}`,children:"Today"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:P,className:`p-1 rounded-full transition-colors ${s?"hover:bg-white/10 text-gray-400 hover:text-gray-200":"hover:bg-gray-100 text-gray-400 hover:text-gray-600"}`,children:e.jsx(is,{size:16})}),e.jsx("button",{onClick:S,className:`p-1 rounded-full transition-colors ${s?"hover:bg-white/10 text-gray-400 hover:text-gray-200":"hover:bg-gray-100 text-gray-400 hover:text-gray-600"}`,children:e.jsx(ut,{size:16})})]})]}),e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Su","Mo","Tu","We","Th","Fr","Sa"].map(E=>e.jsx("div",{className:`text-center text-xs font-medium py-1 ${s?"text-gray-500":"text-gray-400"}`,children:E},E))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:l()}),e.jsxs("div",{className:`mt-4 pt-4 border-t flex justify-between items-center ${s?"border-gray-700":"border-gray-100"}`,children:[e.jsx("button",{onClick:()=>{x(""),d()},className:`text-xs font-medium transition-colors ${s?"text-gray-500 hover:text-red-400":"text-gray-400 hover:text-red-500"}`,children:"Clear"}),e.jsx("button",{onClick:d,className:`px-3 py-1 text-xs font-bold rounded-md transition-colors ${s?"bg-white text-black hover:bg-gray-200":"bg-black text-white hover:bg-gray-800"}`,children:"Done"})]})]})]})},Cr=({x:r,y:x,onClose:d,onAction:s,darkMode:i})=>{let v=r,D=x;typeof window<"u"&&(r+256>window.innerWidth&&(v=r-256),x+400>window.innerHeight&&(D=x-400));const g={top:D,left:v},u=l=>{s(l),d()},{ref:F}=le({onCancel:d,initialActive:!0});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-50 bg-transparent",onClick:d,onContextMenu:l=>{l.preventDefault(),d()}}),e.jsx("div",{ref:F,className:`fixed z-50 rounded-lg shadow-xl border w-64 py-2 animate-in fade-in zoom-in-95 duration-100 ${i?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,style:g,onClick:l=>l.stopPropagation(),children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("button",{onClick:()=>u("sort_asc"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(Ys,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Sort ascending"})]}),e.jsxs("button",{onClick:()=>u("sort_desc"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(er,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Sort descending"})]}),e.jsxs("button",{onClick:()=>u("group"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(os,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Group by this field"})]}),e.jsx("div",{className:`h-px my-1 ${i?"bg-gray-700":"bg-gray-100"}`}),e.jsxs("button",{onClick:()=>u("rename"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx($s,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Edit field"})]}),e.jsxs("button",{onClick:()=>u("permissions"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(ls,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Privacy and permissions"})]}),e.jsx("div",{className:`h-px my-1 ${i?"bg-gray-700":"bg-gray-100"}`}),e.jsxs("button",{onClick:()=>u("move_start"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(Ks,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Move to start"})]}),e.jsxs("button",{onClick:()=>u("move_end"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(Qs,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Move to end"})]}),e.jsxs("button",{onClick:()=>u("automate"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(cs,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Automate"})]}),e.jsx("div",{className:`h-px my-1 ${i?"bg-gray-700":"bg-gray-100"}`}),e.jsxs("button",{onClick:()=>u("hide"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(ds,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Hide column"})]}),e.jsxs("button",{onClick:()=>u("duplicate"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(vt,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Duplicate"})]}),e.jsxs("button",{onClick:()=>u("delete"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-red-400":"hover:bg-red-50 text-red-600"}`,children:[e.jsx(He,{size:16,className:"text-red-500"}),e.jsx("span",{children:"Delete field"})]})]})})]})},Sr=({isOpen:r,onClose:x,group:d,darkMode:s})=>{const[i,$]=C.useState(new Set);if(!r)return null;const k=g=>{const u=new Set(i);u.has(g)?u.delete(g):u.add(g),$(u)},v=()=>{const g=d.tasks.filter(u=>i.has(u.id));g.length!==0&&(Ts.addReminder({title:d.title||"Untitled Group",listId:"inbox",priority:"medium",dueDate:void 0,tags:[],completed:!1,subtasks:g.map(u=>({id:ne(),title:u.textValues.col_name||u.name||"Untitled Task",completed:u.status==="Done"}))}),x(),$(new Set))},D=()=>{i.size===d.tasks.length?$(new Set):$(new Set(d.tasks.map(g=>g.id)))};return e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsxs("div",{className:`backdrop-blur-xl rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden animate-in zoom-in-95 duration-300 border ring-1 ring-black/5 flex flex-col max-h-[85vh] ${s?"bg-[#1a1d24]/95 border-gray-700":"bg-white/95 border-white/20"}`,children:[e.jsxs("div",{className:`px-6 py-5 border-b flex items-center justify-between ${s?"border-gray-700 bg-gradient-to-r from-gray-800/50 to-[#1a1d24]":"border-gray-100 bg-gradient-to-r from-gray-50/50 to-white"}`,children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-xl font-bold tracking-tight ${s?"text-gray-100":"text-gray-900"}`,children:"Send to Reminders"}),e.jsxs("p",{className:`text-sm mt-0.5 ${s?"text-gray-400":"text-gray-500"}`,children:["Select tasks from ",e.jsx("span",{className:`font-semibold ${s?"text-gray-300":"text-gray-700"}`,children:d.title})]})]}),e.jsx("button",{onClick:x,className:`p-2 rounded-full transition-all duration-200 active:scale-95 ${s?"hover:bg-white/10 text-gray-400 hover:text-gray-200":"hover:bg-gray-100 text-gray-400 hover:text-gray-600"}`,children:e.jsx(De,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-0",children:d.tasks.length===0?e.jsxs("div",{className:`text-center py-16 flex flex-col items-center gap-3 ${s?"text-gray-500":"text-gray-400"}`,children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${s?"bg-gray-800":"bg-gray-50"}`,children:e.jsx(Se,{size:24,className:`${s?"text-gray-600":"text-gray-300"}`})}),e.jsx("p",{className:"font-medium",children:"No tasks in this group"})]}):e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:`backdrop-blur-md sticky top-0 z-10 shadow-sm ${s?"bg-gray-800/80":"bg-gray-50/80"}`,children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-6 py-3.5 border-b w-[50px] ${s?"border-gray-700/80":"border-gray-200/80"}`,children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("input",{type:"checkbox",checked:i.size===d.tasks.length&&d.tasks.length>0,onChange:D,className:`rounded-md focus:ring-indigo-500/20 transition-all cursor-pointer ${s?"bg-gray-700 border-gray-600 text-indigo-500":"border-gray-300 text-indigo-600"}`})})}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Task Name"}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b text-center w-[120px] ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Priority"}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b w-[140px] ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Due Date"})]})}),e.jsx("tbody",{className:`divide-y ${s?"divide-gray-800":"divide-gray-100"}`,children:d.tasks.map(g=>{const u=i.has(g.id),F=g.textValues.col_name||g.name||"Untitled Task";return e.jsxs("tr",{onClick:()=>k(g.id),className:`cursor-pointer transition-all duration-200 group ${u?s?"bg-indigo-900/20":"bg-indigo-50/60":s?"hover:bg-white/5":"hover:bg-gray-50/80"}`,children:[e.jsx("td",{className:"px-6 py-3.5 w-[50px]",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("input",{type:"checkbox",checked:u,onChange:()=>k(g.id),onClick:l=>l.stopPropagation(),className:`rounded-md focus:ring-indigo-500/20 transition-all cursor-pointer ${s?"bg-gray-700 border-gray-600 text-indigo-500":"border-gray-300 text-indigo-600"}`})})}),e.jsx("td",{className:"px-4 py-3.5",children:e.jsx("span",{className:`text-sm font-medium truncate block max-w-[320px] transition-colors ${u?s?"text-indigo-300":"text-indigo-900":s?"text-gray-300 group-hover:text-white":"text-gray-700 group-hover:text-gray-900"}`,children:F})}),e.jsx("td",{className:"px-4 py-3.5 text-center w-[120px]",children:e.jsx("div",{className:"flex justify-center transform transition-transform group-hover:scale-105",children:e.jsx("span",{className:`text-[11px] px-2.5 py-1 rounded-full text-white font-semibold shadow-sm tracking-wide ${ze[g.priority]||"bg-gray-400"}`,children:g.priority})})}),e.jsx("td",{className:"px-4 py-3.5 w-[140px]",children:e.jsx("span",{className:`text-sm font-mono transition-colors ${g.dueDate?s?"text-gray-400":"text-gray-600":s?"text-gray-600":"text-gray-300"}`,children:g.dueDate||"-"})})]},g.id)})})]})}),e.jsxs("div",{className:`px-6 py-4 border-t backdrop-blur-sm flex justify-end gap-3 ${s?"bg-gray-800/50 border-gray-700":"bg-gray-50/50 border-gray-100"}`,children:[e.jsx("button",{onClick:x,className:`px-5 py-2.5 text-sm font-medium rounded-xl transition-all duration-200 active:scale-95 ${s?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-600 hover:text-gray-900 hover:bg-gray-200/50"}`,children:"Cancel"}),e.jsxs("button",{onClick:v,disabled:i.size===0,className:"px-6 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 active:scale-95 rounded-xl shadow-lg shadow-blue-500/25 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none flex items-center gap-2",children:[e.jsx(Se,{size:16,strokeWidth:2.5}),e.jsx("span",{children:"Send Tasks"}),i.size>0&&e.jsx("span",{className:"bg-white/20 px-1.5 py-0.5 rounded text-xs font-bold ml-1",children:i.size})]})]})]})})},Dr=({isOpen:r,onClose:x,group:d,darkMode:s})=>{const[i,$]=C.useState(new Set);if(!r)return null;const k=g=>{const u=new Set(i);u.has(g)?u.delete(g):u.add(g),$(u)},v=()=>{const g=d.tasks.filter(u=>i.has(u.id));g.length!==0&&(Ps.addObjective({title:d.title||"Untitled Objective",progress:0,status:"on-track",expanded:!0,keyResults:g.map(u=>({id:ne(),title:u.textValues.col_name||u.name||"Untitled Key Result",current:u.status==="Done"?100:0,target:100,unit:"%",confidence:"medium",owner:"Unassigned"}))}),x(),$(new Set))},D=()=>{i.size===d.tasks.length?$(new Set):$(new Set(d.tasks.map(g=>g.id)))};return e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsxs("div",{className:`backdrop-blur-xl rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden animate-in zoom-in-95 duration-300 border ring-1 ring-black/5 flex flex-col max-h-[85vh] ${s?"bg-[#1a1d24]/95 border-gray-700":"bg-white/95 border-white/20"}`,children:[e.jsxs("div",{className:`px-6 py-5 border-b flex items-center justify-between ${s?"border-gray-700 bg-gradient-to-r from-gray-800/50 to-[#1a1d24]":"border-gray-100 bg-gradient-to-r from-gray-50/50 to-white"}`,children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-xl font-bold tracking-tight ${s?"text-gray-100":"text-gray-900"}`,children:"Send to Goals"}),e.jsxs("p",{className:`text-sm mt-0.5 ${s?"text-gray-400":"text-gray-500"}`,children:["Select tasks from ",e.jsx("span",{className:`font-semibold ${s?"text-gray-300":"text-gray-700"}`,children:d.title})]})]}),e.jsx("button",{onClick:x,className:`p-2 rounded-full transition-all duration-200 active:scale-95 ${s?"hover:bg-white/10 text-gray-400 hover:text-gray-200":"hover:bg-gray-100 text-gray-400 hover:text-gray-600"}`,children:e.jsx(De,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-0",children:d.tasks.length===0?e.jsxs("div",{className:`text-center py-16 flex flex-col items-center gap-3 ${s?"text-gray-500":"text-gray-400"}`,children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${s?"bg-gray-800":"bg-gray-50"}`,children:e.jsx(Se,{size:24,className:`${s?"text-gray-600":"text-gray-300"}`})}),e.jsx("p",{className:"font-medium",children:"No tasks in this group"})]}):e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:`backdrop-blur-md sticky top-0 z-10 shadow-sm ${s?"bg-gray-800/80":"bg-gray-50/80"}`,children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-6 py-3.5 border-b w-[50px] ${s?"border-gray-700/80":"border-gray-200/80"}`,children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("input",{type:"checkbox",checked:i.size===d.tasks.length&&d.tasks.length>0,onChange:D,className:`rounded-md focus:ring-indigo-500/20 transition-all cursor-pointer ${s?"bg-gray-700 border-gray-600 text-indigo-500":"border-gray-300 text-indigo-600"}`})})}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Task Name"}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b text-center w-[120px] ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Priority"}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b w-[140px] ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Due Date"})]})}),e.jsx("tbody",{className:`divide-y ${s?"divide-gray-800":"divide-gray-100"}`,children:d.tasks.map(g=>{const u=i.has(g.id),F=g.textValues.col_name||g.name||"Untitled Task";return e.jsxs("tr",{onClick:()=>k(g.id),className:`cursor-pointer transition-all duration-200 group ${u?s?"bg-indigo-900/20":"bg-indigo-50/60":s?"hover:bg-white/5":"hover:bg-gray-50/80"}`,children:[e.jsx("td",{className:"px-6 py-3.5 w-[50px]",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("input",{type:"checkbox",checked:u,onChange:()=>k(g.id),onClick:l=>l.stopPropagation(),className:`rounded-md focus:ring-indigo-500/20 transition-all cursor-pointer ${s?"bg-gray-700 border-gray-600 text-indigo-500":"border-gray-300 text-indigo-600"}`})})}),e.jsx("td",{className:"px-4 py-3.5",children:e.jsx("span",{className:`text-sm font-medium truncate block max-w-[320px] transition-colors ${u?s?"text-indigo-300":"text-indigo-900":s?"text-gray-300 group-hover:text-white":"text-gray-700 group-hover:text-gray-900"}`,children:F})}),e.jsx("td",{className:"px-4 py-3.5 text-center w-[120px]",children:e.jsx("div",{className:"flex justify-center transform transition-transform group-hover:scale-105",children:e.jsx("span",{className:`text-[11px] px-2.5 py-1 rounded-full text-white font-semibold shadow-sm tracking-wide ${ze[g.priority]||"bg-gray-400"}`,children:g.priority})})}),e.jsx("td",{className:"px-4 py-3.5 w-[140px]",children:e.jsx("span",{className:`text-sm font-mono transition-colors ${g.dueDate?s?"text-gray-400":"text-gray-600":s?"text-gray-600":"text-gray-300"}`,children:g.dueDate||"-"})})]},g.id)})})]})}),e.jsxs("div",{className:`px-6 py-4 border-t backdrop-blur-sm flex justify-end gap-3 ${s?"bg-gray-800/50 border-gray-700":"bg-gray-50/50 border-gray-100"}`,children:[e.jsx("button",{onClick:x,className:`px-5 py-2.5 text-sm font-medium rounded-xl transition-all duration-200 active:scale-95 ${s?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-600 hover:text-gray-900 hover:bg-gray-200/50"}`,children:"Cancel"}),e.jsxs("button",{onClick:v,disabled:i.size===0,className:"px-6 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 active:scale-95 rounded-xl shadow-lg shadow-blue-500/25 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none flex items-center gap-2",children:[e.jsx(ht,{size:16,strokeWidth:2.5}),e.jsx("span",{children:"Send to Goals"}),i.size>0&&e.jsx("span",{className:"bg-white/20 px-1.5 py-0.5 rounded text-xs font-bold ml-1",children:i.size})]})]})]})})},zr=({isOpen:r,onClose:x,group:d,darkMode:s})=>{const[i,$]=C.useState(new Set),k=mt.getCurrentUser(),v=k?`taskboard-${k.id}`:"taskboard-default",{showToast:D}=xs(),g=P=>{const h=new Set(i);h.has(P)?h.delete(P):h.add(P),$(h)},u=()=>{const P=d.tasks.filter(h=>i.has(h.id));if(P.length!==0)try{const h=localStorage.getItem(v);let V;h?(V=JSON.parse(h),V.groups||(V={...Ce,...V})):V=Ce;const E={id:ne(),title:d.title||"Imported Group",color:d.color,columns:[...d.columns],tasks:P.map(G=>({...G,id:ne()})),isPinned:!1},T={...V,groups:[E,...V.groups||[]]};localStorage.setItem(v,JSON.stringify(T)),D(`Successfully sent ${P.length} tasks to your Tasks Board`,"success"),x(),$(new Set)}catch(h){console.error("Failed to send tasks:",h),D("Failed to send tasks. Please try again.","error")}},F=()=>{i.size===d.tasks.length?$(new Set):$(new Set(d.tasks.map(P=>P.id)))},{ref:l,setIsActive:S}=le({onConfirm:u,onCancel:x,initialActive:r});return C.useEffect(()=>{S(r)},[r,S]),r?e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsxs("div",{ref:l,className:`backdrop-blur-xl rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden animate-in zoom-in-95 duration-300 border ring-1 ring-black/5 flex flex-col max-h-[85vh] ${s?"bg-[#1a1d24]/95 border-gray-700":"bg-white/95 border-white/20"}`,children:[e.jsxs("div",{className:`px-6 py-5 border-b flex items-center justify-between ${s?"border-gray-700 bg-gradient-to-r from-gray-800/50 to-[#1a1d24]":"border-gray-100 bg-gradient-to-r from-gray-50/50 to-white"}`,children:[e.jsxs("div",{children:[e.jsxs("h2",{className:`text-xl font-bold tracking-tight flex items-center gap-2 ${s?"text-gray-100":"text-gray-900"}`,children:[e.jsx(pt,{className:"text-blue-600",size:24}),"Send to Tasks Board"]}),e.jsxs("p",{className:`text-sm mt-0.5 ${s?"text-gray-400":"text-gray-500"}`,children:["Select tasks from ",e.jsx("span",{className:`font-semibold ${s?"text-gray-300":"text-gray-700"}`,children:d.title})," to copy to your personal Tasks."]})]}),e.jsx("button",{onClick:x,className:`p-2 rounded-full transition-all duration-200 active:scale-95 ${s?"hover:bg-white/10 text-gray-400 hover:text-gray-200":"hover:bg-gray-100 text-gray-400 hover:text-gray-600"}`,children:e.jsx(De,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-0",children:d.tasks.length===0?e.jsxs("div",{className:`text-center py-16 flex flex-col items-center gap-3 ${s?"text-gray-500":"text-gray-400"}`,children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${s?"bg-gray-800":"bg-gray-50"}`,children:e.jsx(Se,{size:24,className:`${s?"text-gray-600":"text-gray-300"}`})}),e.jsx("p",{className:"font-medium",children:"No tasks in this group"})]}):e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:`backdrop-blur-md sticky top-0 z-10 shadow-sm ${s?"bg-gray-800/80":"bg-gray-50/80"}`,children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-6 py-3.5 border-b w-[50px] ${s?"border-gray-700/80":"border-gray-200/80"}`,children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("input",{type:"checkbox",checked:i.size===d.tasks.length&&d.tasks.length>0,onChange:F,className:`rounded-md focus:ring-indigo-500/20 transition-all cursor-pointer ${s?"bg-gray-700 border-gray-600 text-indigo-500":"border-gray-300 text-indigo-600"}`})})}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Task Name"}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b text-center w-[120px] ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Priority"}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b w-[140px] ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Due Date"})]})}),e.jsx("tbody",{className:`divide-y ${s?"divide-gray-800":"divide-gray-100"}`,children:d.tasks.map(P=>{const h=i.has(P.id),V=P.textValues.col_name||P.name||"Untitled Task";return e.jsxs("tr",{onClick:()=>g(P.id),className:`cursor-pointer transition-all duration-200 group ${h?s?"bg-indigo-900/20":"bg-indigo-50/60":s?"hover:bg-white/5":"hover:bg-gray-50/80"}`,children:[e.jsx("td",{className:"px-6 py-3.5 w-[50px]",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("input",{type:"checkbox",checked:h,onChange:()=>g(P.id),onClick:E=>E.stopPropagation(),className:`rounded-md focus:ring-indigo-500/20 transition-all cursor-pointer ${s?"bg-gray-700 border-gray-600 text-indigo-500":"border-gray-300 text-indigo-600"}`})})}),e.jsx("td",{className:"px-4 py-3.5",children:e.jsx("span",{className:`text-sm font-medium truncate block max-w-[320px] transition-colors ${h?s?"text-indigo-300":"text-indigo-900":s?"text-gray-300 group-hover:text-white":"text-gray-700 group-hover:text-gray-900"}`,children:V})}),e.jsx("td",{className:"px-4 py-3.5 text-center w-[120px]",children:e.jsx("div",{className:"flex justify-center transform transition-transform group-hover:scale-105",children:e.jsx("span",{className:`text-[11px] px-2.5 py-1 rounded-full text-white font-semibold shadow-sm tracking-wide ${ze[P.priority]||"bg-gray-400"}`,children:P.priority})})}),e.jsx("td",{className:"px-4 py-3.5 w-[140px]",children:e.jsx("span",{className:`text-sm font-mono transition-colors ${P.dueDate?s?"text-gray-400":"text-gray-600":s?"text-gray-600":"text-gray-300"}`,children:P.dueDate||"-"})})]},P.id)})})]})}),e.jsxs("div",{className:`px-6 py-4 border-t backdrop-blur-sm flex justify-end gap-3 ${s?"bg-gray-800/50 border-gray-700":"bg-gray-50/50 border-gray-100"}`,children:[e.jsx("button",{onClick:x,className:`px-5 py-2.5 text-sm font-medium rounded-xl transition-all duration-200 active:scale-95 ${s?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-600 hover:text-gray-900 hover:bg-gray-200/50"}`,children:"Cancel"}),e.jsxs("button",{onClick:u,disabled:i.size===0,className:"px-6 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 active:scale-95 rounded-xl shadow-lg shadow-blue-500/25 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none flex items-center gap-2",children:[e.jsx(Se,{size:16,strokeWidth:2.5}),e.jsx("span",{children:"Send Tasks"}),i.size>0&&e.jsx("span",{className:"bg-white/20 px-1.5 py-0.5 rounded text-xs font-bold ml-1",children:i.size})]})]})]})}):null},St=({status:r,onChange:x,tabIndex:d,darkMode:s})=>{const[i,$]=C.useState({top:0,left:0,width:0}),{ref:k,isActive:v,setIsActive:D,startAction:g}=le({onCancel:()=>D(!1)}),u=l=>{if(l.stopPropagation(),v){D(!1);return}const S=l.currentTarget.getBoundingClientRect(),P=250,V=window.innerHeight-S.bottom<P;$({top:V?S.top+window.scrollY-P-4:S.bottom+window.scrollY+4,left:S.left+window.scrollX,width:S.width}),g()},F=l=>s?br[l]||"bg-gray-800 text-gray-400":Ct[l]||"bg-gray-100 text-gray-400";return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"relative w-full h-full",children:e.jsxs("div",{onClick:u,onKeyDown:l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),u(l))},tabIndex:d,className:`w-full h-full flex items-center justify-center cursor-pointer transition-all duration-200 text-xs font-medium relative group focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-inset rounded-sm ${F(r)}`,children:[e.jsx("div",{className:"absolute right-0 bottom-0 w-3 h-3 bg-black/10 opacity-0 group-hover:opacity-100 clip-triangle transition-opacity"}),e.jsx("span",{className:"truncate px-1",children:r||e.jsx("span",{className:"opacity-0 group-hover:opacity-100 text-[10px] uppercase",children:"Set Status"})})]})}),v&&me.createPortal(e.jsx("div",{ref:k,className:`fixed z-[10000] shadow-2xl rounded-lg border p-1.5 overflow-hidden animate-in fade-in zoom-in-95 duration-100 flex flex-col gap-1 ${s?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,style:{top:i.top+4,left:i.left-(160-i.width)/2,width:"160px"},onMouseDown:l=>l.stopPropagation(),children:Object.values(A).map(l=>e.jsx("div",{onClick:S=>{S.stopPropagation(),x(l),D(!1)},className:`px-3 py-2.5 text-xs cursor-pointer hover:brightness-95 rounded-sm text-center font-medium transition-all shadow-sm ${F(l)}`,children:l||"Empty"},l))}),document.body)]})},Dt=({priority:r,onChange:x,tabIndex:d,darkMode:s})=>{const[i,$]=C.useState({top:0,left:0,width:0}),{ref:k,isActive:v,setIsActive:D,startAction:g}=le({onCancel:()=>D(!1)}),u=l=>{if(l.stopPropagation(),v){D(!1);return}const S=l.currentTarget.getBoundingClientRect(),P=200,V=window.innerHeight-S.bottom<P;$({top:V?S.top+window.scrollY-P-4:S.bottom+window.scrollY+4,left:S.left+window.scrollX,width:S.width}),g()},F=l=>s?wr[l]||"bg-gray-800 text-gray-400":ze[l]||"bg-gray-100 text-gray-400";return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"relative w-full h-full",children:e.jsxs("div",{onClick:u,onKeyDown:l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),u(l))},tabIndex:d,className:`w-full h-full flex items-center justify-center cursor-pointer transition-all duration-200 text-xs font-medium relative group focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-inset rounded-sm ${F(r)}`,children:[e.jsx("div",{className:"absolute right-0 bottom-0 w-3 h-3 bg-black/10 opacity-0 group-hover:opacity-100 clip-triangle transition-opacity"}),e.jsx("span",{className:"truncate px-1",children:r||e.jsx("span",{className:"opacity-0 group-hover:opacity-100 text-[10px] uppercase",children:"Set"})})]})}),v&&me.createPortal(e.jsx("div",{ref:k,className:`fixed z-[10000] shadow-2xl rounded-lg border p-1.5 animate-in fade-in zoom-in-95 duration-100 flex flex-col gap-1 ${s?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,style:{top:i.top+4,left:i.left-(140-i.width)/2,width:"140px"},onMouseDown:l=>l.stopPropagation(),children:Object.values(Z).map(l=>e.jsx("div",{onClick:S=>{S.stopPropagation(),x(l),D(!1)},className:`px-2 py-2 text-xs cursor-pointer hover:brightness-90 rounded-sm text-center font-medium transition-all shadow-sm ${F(l)}`,children:l||"Empty"},l))}),document.body)]})},zt=({personId:r,onChange:x,tabIndex:d,darkMode:s})=>{const[i,$]=C.useState({top:0,left:0}),k=xt.find(l=>l.id===r),{ref:v,isActive:D,setIsActive:g,startAction:u}=le({onCancel:()=>g(!1)}),F=l=>{if(l.stopPropagation(),D){g(!1);return}const S=l.currentTarget.getBoundingClientRect(),P=250,V=window.innerHeight-S.bottom<P;$({top:V?S.top+window.scrollY-P-5:S.bottom+window.scrollY+5,left:S.left+window.scrollX-90}),u()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"relative w-full h-full flex justify-center items-center group",children:e.jsxs("div",{onClick:F,onKeyDown:l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),F(l))},tabIndex:d,className:"cursor-pointer hover:scale-110 transition-transform duration-200 active:scale-95 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-full",children:[k?e.jsx("div",{className:"w-6 h-6 rounded-full text-white text-[9px] flex items-center justify-center font-bold ring-2 shadow-md "+k.color+(s?" ring-[#1a1d24]":" ring-white"),title:k.name,children:k.initials}):e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center border border-dashed transition-all shadow-sm ${s?"bg-gray-800 text-gray-500 border-gray-700 hover:border-gray-500 hover:bg-gray-700":"bg-gray-100 text-gray-400 hover:bg-gray-200 border-gray-300 hover:border-gray-400"}`,children:e.jsx(yt,{size:12,strokeWidth:2.5})}),!k&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 pointer-events-none",children:e.jsx("div",{className:"w-6 h-6 rounded-full bg-black/5 flex items-center justify-center backdrop-blur-[1px]",children:e.jsx(ft,{size:12,className:"text-black/60",strokeWidth:3})})})]})}),D&&me.createPortal(e.jsxs("div",{ref:v,className:`fixed z-[10000] shadow-2xl rounded-xl border p-2 animate-in fade-in zoom-in-95 duration-100 flex flex-col gap-1 min-w-[180px] ${s?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,style:{top:i.top,left:i.left},onMouseDown:l=>l.stopPropagation(),children:[e.jsx("div",{className:`text-xs font-semibold mb-1 px-2 uppercase tracking-wider py-1 ${s?"text-gray-500":"text-gray-400"}`,children:"Select Person"}),xt.map(l=>e.jsxs("div",{onClick:S=>{S.stopPropagation(),x(l.id),g(!1)},className:`flex items-center gap-3 px-3 py-2 rounded-lg cursor-pointer transition-colors ${s?r===l.id?"bg-blue-500/20":"hover:bg-white/5":r===l.id?"bg-blue-50":"hover:bg-blue-50"}`,children:[e.jsx("div",{className:"w-6 h-6 rounded-full text-white text-[10px] flex items-center justify-center font-bold "+l.color,children:l.initials}),e.jsx("span",{className:`text-sm font-medium ${s?"text-gray-200":"text-gray-700"}`,children:l.name}),r===l.id&&e.jsx("span",{className:"ml-auto text-blue-500",children:""})]},l.id)),e.jsx("div",{className:`border-t my-1 ${s?"border-gray-700":"border-gray-100"}`}),e.jsxs("div",{onClick:l=>{l.stopPropagation(),x(null),g(!1)},className:`px-3 py-2 text-sm rounded-lg cursor-pointer flex items-center gap-2 transition-colors ${s?"hover:bg-red-500/20 text-red-400":"hover:bg-red-50 text-red-500"}`,children:[e.jsx("span",{className:"w-4 h-4 flex items-center justify-center text-xs",children:""}),"Clear Selection"]})]}),document.body)]})},kr=[{id:"text",label:"Normal text",icon:e.jsx(Cs,{size:18,className:"text-gray-500"})},{id:"h1",label:"Heading 1",icon:e.jsx(sr,{size:18,className:"text-gray-500"})},{id:"h2",label:"Heading 2",icon:e.jsx(ar,{size:18,className:"text-gray-500"})},{id:"h3",label:"Heading 3",icon:e.jsx(ir,{size:18,className:"text-gray-500"})},{id:"h4",label:"Heading 4",icon:e.jsx(lr,{size:18,className:"text-gray-500"})},{id:"checklist",label:"Checklist",icon:e.jsx(_s,{size:18,className:"text-gray-500"})},{id:"bulletList",label:"Bulleted list",icon:e.jsx(Es,{size:18,className:"text-gray-500"})},{id:"orderedList",label:"Numbered list",icon:e.jsx(Ls,{size:18,className:"text-gray-500"})},{id:"toggle",label:"Toggle list",icon:e.jsx(fr,{size:18,className:"text-gray-500"})},{id:"banner",label:"Banners",icon:e.jsx(jt,{size:18,className:"text-gray-500"})},{id:"code",label:"Code block",icon:e.jsx(gs,{size:18,className:"text-gray-500"})},{id:"quote",label:"Block quote",icon:e.jsx(pr,{size:18,className:"text-gray-500"})},{id:"pullQuote",label:"Pull quote",icon:e.jsx(xr,{size:18,className:"text-gray-500"})}],Ir=({search:r,onSelect:x,onClose:d,position:s,darkMode:i})=>{const[$,k]=C.useState(0),{ref:v}=le({onCancel:d,initialActive:!0}),D=kr.filter(g=>g.label.toLowerCase().includes(r.toLowerCase()));return C.useEffect(()=>{k(0)},[r]),C.useEffect(()=>{const g=u=>{u.defaultPrevented||(u.key==="ArrowDown"?(u.preventDefault(),k(F=>(F+1)%D.length)):u.key==="ArrowUp"?(u.preventDefault(),k(F=>(F-1+D.length)%D.length)):u.key==="Enter"&&(u.preventDefault(),D[$]&&x(D[$])))};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[D,$,x]),D.length===0?null:e.jsxs("div",{ref:v,className:`fixed z-[9999] rounded-lg shadow-xl border w-72 max-h-80 overflow-y-auto flex flex-col p-1 animate-in fade-in zoom-in-95 duration-100 ${i?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,style:{top:s.top,left:s.left},children:[e.jsx("div",{className:`px-2 py-1.5 text-xs font-semibold uppercase tracking-wider ${i?"text-gray-500":"text-gray-400"}`,children:"Basic blocks"}),D.map((g,u)=>e.jsxs("div",{className:`flex items-center gap-3 px-2 py-1.5 rounded-md cursor-pointer transition-colors ${u===$?i?"bg-white/10":"bg-gray-100":i?"hover:bg-white/5":"hover:bg-gray-50"}`,onClick:()=>x(g),onMouseEnter:()=>k(u),children:[e.jsx("div",{className:`w-10 h-10 rounded border flex items-center justify-center shadow-sm ${i?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:g.icon}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`text-sm font-medium ${i?"text-gray-200":"text-gray-700"}`,children:g.label}),g.description&&e.jsx("span",{className:"text-xs text-gray-400",children:g.description})]})]},g.id))]})},Ar=({value:r,onChange:x,onClose:d,title:s="Edit Text",darkMode:i})=>{const[$,k]=C.useState(r),[v,D]=C.useState(!1),[g,u]=C.useState({top:0,left:0}),[F,l]=C.useState(""),S=C.useRef(null),{ref:P,setIsActive:h}=le({onCancel:d,initialActive:!0});C.useEffect(()=>{h(!v)},[v,h]),C.useEffect(()=>{S.current&&(S.current.focus(),S.current.setSelectionRange(S.current.value.length,S.current.value.length))},[]);const V=G=>{var O;if(v){if(G.key==="ArrowUp"||G.key==="ArrowDown"||G.key==="Enter"){G.key==="Enter"&&G.preventDefault();return}if(G.key==="Escape"){D(!1);return}}if(G.key==="/"&&!v){const U=(O=S.current)==null?void 0:O.getBoundingClientRect();U&&(u({top:U.top+40,left:U.left+20}),D(!0),l(""))}},E=G=>{const O=G.target.value;if(k(O),x(O),v){const U=O.lastIndexOf("/");U===-1?D(!1):l(O.slice(U+1))}},T=G=>{var U;let O="";switch(G.id){case"h1":O="# ";break;case"h2":O="## ";break;case"h3":O="### ";break;case"checklist":O="- [ ] ";break;case"bulletList":O="- ";break;case"orderedList":O="1. ";break;case"quote":O="> ";break;case"code":O="```\n\n```";break;default:O=""}if(O){const X=$.lastIndexOf("/"),te=$.substring(0,X)+O+$.substring(X+1+F.length);k(te),x(te)}D(!1),(U=S.current)==null||U.focus()};return me.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:[e.jsxs("div",{ref:P,className:`rounded-xl shadow-2xl w-[800px] h-[600px] flex flex-col overflow-hidden animate-in zoom-in-95 duration-200 border ${i?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:`flex items-center justify-between px-4 py-3 border-b ${i?"border-gray-700 bg-[#1a1d24]":"border-gray-100 bg-gray-50/50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($t,{size:16,className:`${i?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:`text-sm font-semibold ${i?"text-gray-200":"text-gray-700"}`,children:s})]}),e.jsx("button",{onClick:d,className:`p-1.5 rounded-md transition-colors ${i?"hover:bg-white/5 text-gray-400 hover:text-gray-200":"hover:bg-gray-200 text-gray-400 hover:text-gray-600"}`,children:e.jsx(De,{size:18})})]}),e.jsxs("div",{className:`flex-1 relative ${i?"bg-[#1a1d24]":"bg-white"}`,children:[e.jsx("textarea",{ref:S,value:$,onChange:E,onKeyDown:V,className:`w-full h-full p-6 resize-none focus:outline-none text-base leading-relaxed font-mono ${i?"bg-[#1a1d24] text-gray-200 placeholder-gray-600":"text-gray-800 placeholder-gray-300"}`,placeholder:"Write something... Type '/' for commands"}),e.jsx("div",{className:`absolute bottom-4 right-4 text-xs pointer-events-none ${i?"text-gray-600":"text-gray-400"}`,children:"Markdown supported  Type '/' for commands"})]})]}),v&&e.jsx("div",{className:"fixed inset-0 z-[10000] pointer-events-none",children:e.jsx("div",{className:"pointer-events-auto",children:e.jsx(Ir,{search:F,onSelect:T,onClose:()=>D(!1),position:g,darkMode:i})})})]}),document.body)},Tr=({value:r,onChange:x,tabIndex:d,darkMode:s})=>{const[i,$]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`w-full h-full relative group cursor-pointer transition-colors ${s?"hover:bg-white/5":"hover:bg-gray-50"}`,onClick:()=>$(!0),children:[e.jsx("div",{className:`w-full h-full px-2 py-1.5 text-sm whitespace-nowrap overflow-hidden text-ellipsis focus:outline-none focus:ring-2 focus:ring-blue-500 rounded ${s?"text-gray-300":"text-gray-700"}`,tabIndex:d,children:r||e.jsx("span",{className:`${s?"text-gray-600":"text-gray-400"} italic`,children:"Empty"})}),e.jsx("div",{className:`absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity ${s?"text-gray-500":"text-gray-400"}`,children:e.jsx($t,{size:12})})]}),i&&e.jsx(Ar,{value:r,onChange:x,onClose:()=>$(!1),darkMode:s})]})},Pr=({options:r=[],value:x,onChange:d,onClose:s,tabIndex:i,darkMode:$})=>{const[k,v]=C.useState(""),[D,g]=C.useState(null),u=C.useRef(null),{ref:F,isActive:l,setIsActive:S,startAction:P}=le({onCancel:()=>{S(!1),s==null||s()}}),h=r.find(T=>T.id===x),V=T=>{if(T.stopPropagation(),u.current){const G=u.current.getBoundingClientRect(),O=Math.max(G.width,220),U=G.left+window.scrollX-(O-G.width)/2;g({top:G.bottom+window.scrollY+4,left:U,width:O})}P()},E=r.filter(T=>T.label.toLowerCase().includes(k.toLowerCase()));return e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:u,onClick:V,onKeyDown:T=>{(T.key==="Enter"||T.key===" ")&&(T.preventDefault(),V(T))},tabIndex:i,className:`w-full h-full flex items-center justify-center cursor-pointer transition-colors px-2 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded ${$?"hover:bg-white/5":"hover:bg-gray-50"}`,children:h?e.jsx("div",{className:"px-3 py-1 rounded-sm text-white text-xs font-medium truncate w-full text-center "+h.color,children:h.label}):e.jsx("span",{className:`${$?"text-gray-500":"text-gray-400"}`,children:"-"})}),l&&D&&me.createPortal(e.jsxs("div",{ref:F,className:`dropdown-portal fixed z-[9999] rounded-lg shadow-2xl border animate-in fade-in zoom-in-95 duration-100 ${$?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-100"}`,style:{top:D.top,left:D.left,width:D.width,minWidth:"220px"},onClick:T=>T.stopPropagation(),children:[e.jsx("div",{className:"p-2",children:e.jsx("input",{type:"text",placeholder:"Search or add options...",value:k,onChange:T=>v(T.target.value),className:`w-full px-3 py-2 border-none rounded-md text-sm focus:ring-2 focus:ring-blue-500/20 ${$?"bg-gray-800 text-gray-200 placeholder-gray-500":"bg-gray-50 text-gray-700 placeholder-gray-400"}`,autoFocus:!0})}),e.jsxs("div",{className:"max-h-[240px] overflow-y-auto custom-scrollbar p-2 space-y-1",children:[e.jsx("div",{onClick:()=>{d(""),S(!1)},className:`flex items-center justify-center px-3 py-2 rounded-sm cursor-pointer border border-dashed transition-all ${$?"hover:bg-white/5 border-gray-700 text-gray-500 hover:text-gray-300 hover:border-gray-500":"hover:bg-gray-50 border-gray-200 text-gray-400 hover:text-gray-600 hover:border-gray-300"}`,children:"-"}),E.map(T=>e.jsxs("div",{onClick:()=>{d(T.id),S(!1)},className:"flex items-center justify-center relative gap-2 group cursor-pointer",children:[e.jsx("div",{className:`absolute left-2 opacity-0 group-hover:opacity-100 cursor-grab p-1 rounded ${$?"text-gray-500 hover:bg-white/10":"text-gray-300 hover:bg-gray-100"}`,children:e.jsx(Ss,{size:14})}),e.jsx("div",{className:"w-[90%] px-3 py-2 rounded-sm text-white text-sm font-medium shadow-sm transition-transform active:scale-[0.98] text-center "+T.color,children:T.label})]},T.id)),E.length===0&&e.jsx("div",{className:`px-3 py-4 text-center text-xs ${$?"text-gray-500":"text-gray-400"}`,children:"No options found"})]})]}),document.body)]})},gt=({className:r="w-6 h-6"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:r,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),Be=({className:r="w-6 h-6"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:r,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"})}),_r=({task:r,group:x,selectionColumnWidth:d,actionColumnWidth:s,expandedTaskIds:i,toggleTaskSelection:$,updateTask:k,updateTaskTextValue:v,toggleSubtask:D,setActiveDatePicker:g,handleContextMenu:u,deleteTask:F,handleAddSubtask:l,subtaskInput:S,setSubtaskInput:P,darkMode:h=!1})=>{var te;const{attributes:V,listeners:E,setNodeRef:T,transform:G,transition:O,isDragging:U}=As({id:r.id,data:{type:"TASK",task:r,group:x}}),X={transform:Bs.Transform.toString(G),transition:O,opacity:U?.5:1,gridTemplateColumns:d+" "+x.columns.map(o=>o.width).join(" ")+" "+s};return e.jsxs(ys.Fragment,{children:[e.jsxs("div",{ref:T,style:X,...V,...E,className:`grid gap-px group/row text-sm transition-colors relative ${U?"z-50 shadow-xl ring-2 ring-blue-500/20":""} ${h?"bg-[#1a1d24] hover:bg-white/5":"bg-white hover:bg-gray-50/50"}`,children:[e.jsxs("div",{className:`flex items-center justify-center py-1.5 border-r relative transition-colors sticky left-0 z-10 border-r-2 ${h?"bg-[#1a1d24] border-gray-800 border-r-gray-800 group-hover/row:bg-white/5":"bg-white border-gray-100 border-r-gray-200/50 hover:bg-gray-50"}`,children:[e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1.5",style:{backgroundColor:x.color}}),e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-gray-300",checked:!!r.selected,onChange:o=>$(x.id,r.id,o.target.checked),onClick:o=>o.stopPropagation(),onMouseDown:o=>o.stopPropagation()})]}),x.columns.map(o=>{var re;const se=o.type==="name";return e.jsxs("div",{className:`relative border-r flex items-center ${se?"justify-start pl-2 sticky left-[50px] z-10 border-r-2":"justify-center"} min-h-[32px] transition-colors ${h?"bg-[#1a1d24] border-gray-800 border-r-gray-800 group-hover/row:bg-white/5 text-gray-300":"bg-white border-gray-100 border-r-gray-200/50 group-hover/row:bg-[#f8f9fa]"}`,children:[se&&e.jsx("div",{className:"cursor-grab active:cursor-grabbing text-gray-300 mr-2 opacity-0 group-hover/row:opacity-100 hover:text-gray-500 p-1",children:e.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"9",cy:"12",r:"1"}),e.jsx("circle",{cx:"9",cy:"5",r:"1"}),e.jsx("circle",{cx:"9",cy:"19",r:"1"}),e.jsx("circle",{cx:"15",cy:"12",r:"1"}),e.jsx("circle",{cx:"15",cy:"5",r:"1"}),e.jsx("circle",{cx:"15",cy:"19",r:"1"})]})}),o.type==="name"&&e.jsxs("div",{className:"flex items-center w-full gap-2",children:[e.jsx("button",{onClick:j=>{j.stopPropagation(),D(r.id)},className:"p-0.5 hover:bg-gray-200 rounded text-gray-400 transition-colors",children:i.has(r.id)?e.jsx(fs,{size:14}):e.jsx(ut,{size:14})}),e.jsx("input",{value:r.name,onChange:j=>k(x.id,r.id,{name:j.target.value}),className:`w-full px-2 py-1.5 bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded font-medium truncate ${h?"text-gray-200":"text-gray-700"}`}),e.jsx("div",{className:"text-xs text-gray-400 mr-2",children:(re=r.subtasks)!=null&&re.length?`${r.subtasks.length} subtasks`:""})]}),o.type==="status"?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(St,{status:o.id==="col_status"?r.status:r.textValues[o.id]||A.New,onChange:j=>{o.id==="col_status"?k(x.id,r.id,{status:j}):v(x.id,r.id,o.id,j)},tabIndex:0,darkMode:h})}):o.type==="priority"?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Dt,{priority:o.id==="col_priority"?r.priority:r.textValues[o.id]||Z.Normal,onChange:j=>{o.id==="col_priority"?k(x.id,r.id,{priority:j}):v(x.id,r.id,o.id,j)},tabIndex:0,darkMode:h})}):o.type==="person"?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(zt,{personId:o.id==="col_person"?r.personId:r.textValues[o.id]||null,onChange:j=>{o.id==="col_person"?k(x.id,r.id,{personId:j}):v(x.id,r.id,o.id,j||"")},tabIndex:0,darkMode:h})}):o.type==="date"?e.jsx("div",{className:"w-full h-full relative flex items-center justify-center",children:e.jsx("div",{className:`text-xs font-medium px-2 py-1 rounded transition-colors focus:ring-2 focus:ring-blue-500 focus:outline-none cursor-pointer ${h?"text-gray-300 hover:text-white hover:bg-white/10":"text-gray-500 hover:text-gray-800 hover:bg-gray-100"}`,onClick:j=>{j.stopPropagation();const m=j.currentTarget.getBoundingClientRect(),y=o.id==="col_date",b=y?r.dueDate||"":r.textValues[o.id]||"";g({taskId:r.id,colId:o.id,date:b,rect:m,onSelect:p=>{y?k(x.id,r.id,{dueDate:p}):v(x.id,r.id,o.id,p)}})},tabIndex:0,onKeyDown:j=>{if(j.key==="Enter"||j.key===" "){j.preventDefault();const m=j.currentTarget.getBoundingClientRect(),y=o.id==="col_date",b=y?r.dueDate||"":r.textValues[o.id]||"";g({taskId:r.id,colId:o.id,date:b,rect:m,onSelect:p=>{y?k(x.id,r.id,{dueDate:p}):v(x.id,r.id,o.id,p)}})}},children:(()=>{const m=o.id==="col_date"?r.dueDate:r.textValues[o.id];return m?new Date(m).toLocaleDateString(void 0,{month:"short",day:"numeric"}):e.jsx("span",{className:"text-gray-300",children:"Set Date"})})()})}):null,o.type==="checkbox"&&e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("input",{type:"checkbox",checked:r.textValues[o.id]==="true",onChange:j=>{v(x.id,r.id,o.id,j.target.checked?"true":"false")},className:`w-4 h-4 rounded text-blue-600 focus:ring-blue-500 cursor-pointer ${h?"border-gray-600 bg-transparent":"border-gray-300"}`})}),o.type==="money"&&e.jsx("div",{className:"w-full h-full px-2 py-1.5 text-sm text-gray-700 flex items-center justify-end font-mono",children:r.textValues[o.id]?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:`mr-1 ${h?"text-gray-500":"text-gray-400"}`,children:o.currency||"$"}),e.jsx("input",{type:"text",value:r.textValues[o.id],onChange:j=>{const m=j.target.value.replace(/[^0-9.]/g,"");v(x.id,r.id,o.id,m)},className:"bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-1 w-full text-right",placeholder:"0.00"})]}):e.jsx("input",{type:"text",onChange:j=>{const m=j.target.value.replace(/[^0-9.]/g,"");v(x.id,r.id,o.id,m)},className:`bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-1 w-full text-right ${h?"placeholder-gray-600 text-gray-300":"placeholder-gray-300 text-gray-700"}`,placeholder:o.currency||"$"})}),o.type==="website"&&e.jsxs("div",{className:"w-full h-full px-2 py-1.5 flex items-center gap-2",children:[e.jsx("div",{className:`p-1 rounded ${h?"bg-indigo-500/20 text-indigo-400":"bg-indigo-50 text-indigo-500"}`,children:e.jsx(bs,{size:12})}),e.jsx("input",{type:"text",value:r.textValues[o.id]||"",onChange:j=>v(x.id,r.id,o.id,j.target.value),className:`w-full bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-1 text-sm hover:underline cursor-text truncate ${h?"text-blue-400":"text-blue-600"}`,placeholder:"www.example.com"})]}),o.type==="email"&&e.jsxs("div",{className:"w-full h-full px-2 py-1.5 flex items-center gap-2",children:[e.jsx("div",{className:`p-1 rounded ${h?"bg-red-500/20 text-red-400":"bg-red-50 text-red-500"}`,children:e.jsx(ws,{size:12})}),e.jsx("input",{type:"text",value:r.textValues[o.id]||"",onChange:j=>v(x.id,r.id,o.id,j.target.value),className:`w-full bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-1 text-sm truncate ${h?"text-gray-300":"text-gray-700"}`,placeholder:"email@example.com"})]}),o.type==="phone"&&e.jsxs("div",{className:"w-full h-full px-2 py-1.5 flex items-center gap-2",children:[e.jsx("div",{className:`p-1 rounded ${h?"bg-orange-500/20 text-orange-400":"bg-orange-50 text-orange-500"}`,children:e.jsx(Hs,{size:12})}),e.jsx("input",{type:"text",value:r.textValues[o.id]||"",onChange:j=>v(x.id,r.id,o.id,j.target.value),className:`w-full bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-1 text-sm truncate ${h?"text-gray-300":"text-gray-700"}`,placeholder:"+1 234 567 890"})]}),o.type==="location"&&e.jsxs("div",{className:"w-full h-full px-2 py-1.5 flex items-center gap-2",children:[e.jsx("div",{className:`p-1 rounded ${h?"bg-red-500/20 text-red-400":"bg-red-50 text-red-600"}`,children:e.jsx(vs,{size:12})}),e.jsx("input",{type:"text",value:r.textValues[o.id]||"",onChange:j=>v(x.id,r.id,o.id,j.target.value),className:`w-full bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-1 text-sm truncate ${h?"text-gray-300":"text-gray-700"}`,placeholder:"Add location"})]}),o.type==="rating"&&e.jsx("div",{className:"w-full h-full flex items-center justify-center gap-0.5",children:[1,2,3,4,5].map(j=>e.jsx(Nt,{size:14,className:`cursor-pointer transition-colors ${j<=(Number(r.textValues[o.id])||0)?"text-amber-400 fill-amber-400":h?"text-gray-600":"text-gray-300"}`,onClick:()=>v(x.id,r.id,o.id,j.toString())},j))}),o.type==="progress_manual"&&e.jsxs("div",{className:"w-full h-full px-2 py-1.5 flex items-center gap-2",children:[e.jsxs("div",{className:`flex-1 h-2 rounded-full overflow-hidden relative group/progress cursor-pointer ${h?"bg-gray-700":"bg-gray-100"}`,children:[e.jsx("div",{className:"h-full bg-green-500 transition-all duration-300",style:{width:`${Number(r.textValues[o.id])||0}%`}}),e.jsx("input",{type:"range",min:"0",max:"100",value:Number(r.textValues[o.id])||0,onChange:j=>v(x.id,r.id,o.id,j.target.value),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"})]}),e.jsxs("span",{className:`text-xs w-8 text-right ${h?"text-gray-400":"text-gray-500"}`,children:[Number(r.textValues[o.id])||0,"%"]})]}),o.type==="button"&&e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("button",{className:"px-3 py-1 bg-blue-500 text-white text-xs font-medium rounded hover:bg-blue-600 transition-colors active:scale-95",onClick:()=>alert(`Action triggered for ${r.name}`),children:"Click Me"})}),o.type==="text"&&e.jsx("input",{type:"text",value:r.textValues[o.id]||"",onChange:j=>v(x.id,r.id,o.id,j.target.value),className:`w-full h-full text-center px-2 bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded ${h?"text-gray-300":"text-gray-600"}`,placeholder:"-",tabIndex:0}),o.type==="long_text"&&e.jsx("div",{className:"w-full h-full p-1",children:e.jsx(Tr,{value:r.textValues[o.id]||"",onChange:j=>v(x.id,r.id,o.id,j),tabIndex:0,darkMode:h})}),o.type==="dropdown"&&e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Pr,{options:o.options,value:r.textValues[o.id],onChange:j=>v(x.id,r.id,o.id,j),tabIndex:0,darkMode:h})}),o.type==="number"&&e.jsx("input",{type:"text",value:r.textValues[o.id]||"",onChange:j=>{const m=j.target.value;/^[0-9.,]*$/.test(m)&&v(x.id,r.id,o.id,m)},onBlur:j=>{const m=j.target.value.replace(/,/g,"");if(m&&!isNaN(Number(m))){const y=Number(m).toLocaleString();v(x.id,r.id,o.id,y)}},className:"w-full h-full text-center px-2 bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded text-gray-600 font-mono text-xs",placeholder:"0",tabIndex:0})]},o.id)}),e.jsx("div",{className:`flex items-center justify-center border-l opacity-0 group-hover/row:opacity-100 transition-opacity ${h?"border-gray-800 bg-[#0f1115]":"border-gray-100 bg-white"}`,children:e.jsx("button",{onClick:()=>F(x.id,r.id),className:"text-gray-300 hover:text-red-500 hover:bg-red-50 p-1.5 rounded transition-all",children:e.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})})]}),i.has(r.id)&&e.jsxs("div",{className:"contents",children:[(te=r.subtasks)==null?void 0:te.map(o=>e.jsxs("div",{className:`grid gap-px group/subrow text-sm transition-colors relative ${h?"bg-[#1a1d24]/50 hover:bg-white/5":"bg-gray-50/30 hover:bg-gray-50"}`,style:{gridTemplateColumns:d+" "+x.columns.map(se=>se.width).join(" ")+" "+s},children:[e.jsxs("div",{className:`flex items-center justify-center py-1.5 border-r relative sticky left-0 z-10 border-r-2 ${h?"bg-[#1a1d24]/50 border-gray-800 border-r-gray-800":"bg-gray-50/30 border-gray-100 border-r-gray-200/50"}`,children:[e.jsx("div",{className:"w-4 h-4"})," "]}),x.columns.map(se=>{const re=se.type==="name";return e.jsxs("div",{className:`relative border-r flex items-center ${re?"justify-start pl-8 sticky left-[50px] z-10 border-r-2":"justify-center"} min-h-[32px] transition-colors ${h?"bg-[#1a1d24]/50 border-gray-800 border-r-gray-800 group-hover/subrow:bg-white/5 text-gray-400":"bg-gray-50/30 border-gray-100 border-r-gray-200/50 group-hover/subrow:bg-gray-100"}`,children:[re&&e.jsx(ct,{size:14,className:"text-gray-400 mr-2"}),re?e.jsx("input",{value:o.name,onChange:j=>{var y;const m=(y=r.subtasks)==null?void 0:y.map(b=>b.id===o.id?{...b,name:j.target.value}:b);k(x.id,r.id,{subtasks:m})},className:`w-full px-2 py-1.5 bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded text-sm truncate ${h?"text-gray-300":"text-gray-600"}`}):e.jsx("div",{className:"text-xs text-gray-400 italic",children:"-"})]},`${o.id}-${se.id}`)}),e.jsx("div",{className:`border-l ${h?"bg-[#1a1d24]/50 border-gray-800":"bg-white border-gray-100"}`})]},o.id)),e.jsx("div",{className:`grid gap-px relative z-20 shadow-lg my-2 mx-4 rounded-lg border overflow-hidden animate-in slide-in-from-top-2 duration-200 ${h?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,style:{gridColumn:"1 / -1"},children:e.jsxs("div",{className:`flex items-center p-2 gap-3 ${h?"bg-[#1a1d24]":"bg-white"}`,children:[e.jsx("div",{className:`w-5 h-5 rounded-full border-2 border-dashed animate-spin-slow ${h?"border-gray-600":"border-gray-300"}`}),e.jsx("input",{autoFocus:!0,value:S[r.id]||"",onChange:o=>P({...S,[r.id]:o.target.value}),onKeyDown:o=>{o.key==="Enter"&&l(x.id,r.id)},placeholder:"Task Name or type '/' for commands",className:`flex-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 bg-transparent ${h?"text-gray-200 placeholder-gray-500":"text-gray-700 placeholder-gray-400"}`}),e.jsxs("div",{className:`flex items-center gap-1 border-l pl-3 ${h?"border-gray-700":"border-gray-200"}`,children:[e.jsx("button",{className:`p-1.5 rounded transition-colors ${h?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:e.jsx(wt,{size:16})}),e.jsx("button",{className:`p-1.5 rounded transition-colors ${h?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:e.jsx(js,{size:16})}),e.jsx("div",{className:`w-px h-4 mx-1 ${h?"bg-gray-700":"bg-gray-200"}`}),e.jsx("button",{className:`p-1.5 rounded transition-colors ${h?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:e.jsx(yt,{size:16})}),e.jsx("button",{className:`p-1.5 rounded transition-colors ${h?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:e.jsx(bt,{size:16})}),e.jsx("button",{className:`p-1.5 rounded transition-colors ${h?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:e.jsx(jt,{size:16})}),e.jsx("button",{className:`p-1.5 rounded transition-colors ${h?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:e.jsx(Us,{size:16})}),e.jsx("button",{className:`p-1.5 rounded transition-colors ${h?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:e.jsx(Ns,{size:16})}),e.jsx("div",{className:`w-px h-4 mx-1 ${h?"bg-gray-700":"bg-gray-200"}`}),e.jsx("button",{onClick:()=>D(r.id),className:`px-3 py-1.5 text-sm font-medium rounded border transition-colors ${h?"text-gray-400 hover:bg-white/5 border-gray-700":"text-gray-600 hover:bg-gray-100 border-gray-200"}`,children:"Cancel"}),e.jsxs("button",{onClick:()=>l(x.id,r.id),className:"px-3 py-1.5 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded shadow-sm transition-colors flex items-center gap-1",children:["Save ",e.jsx(ct,{size:12})]})]})]})})]})]})},ea=C.forwardRef(({storageKey:r="taskboard-state",tasks:x,onTaskUpdate:d,darkMode:s=!1,minimal:i=!1,showGroupHeader:$=!1,expandAllSignal:k,collapseAllSignal:v,searchQuery:D="",statusFilter:g="all",sortKey:u="none"},F)=>{const{board:l,setBoard:S,aiPrompt:P,setAiPrompt:h,isAiLoading:V,aiAnalysis:E,setAiAnalysis:T,updateTask:G,toggleTaskSelection:O,toggleGroupSelection:U,updateTaskTextValue:X,addTask:te,deleteTask:o,addGroup:se,deleteGroup:re,updateGroupTitle:j,toggleGroupPin:m,addColumn:y,updateColumnTitle:b,deleteColumn:p,duplicateColumn:w,reorderColumn:_,updateColumnWidth:J,handleGeneratePlan:M,handleAnalyzeBoard:ce}=Nr(r),[Y,fe]=C.useState(null),kt=(t,n)=>{fe({type:"task",id:n,groupId:t})},It=t=>{fe({type:"group",groupId:t})},At=()=>{fe({type:"selected"})},Tt=()=>{if(!Y)return;const{type:t,id:n,groupId:c}=Y;t==="task"&&n&&c?o(c,n):t==="group"&&c?re(c):t==="selected"?ss():t==="column"&&n&&c&&p(c,n),fe(null)};C.useEffect(()=>{x&&x.length>0&&S(t=>{const n=[...t.groups];n.length===0&&n.push({id:"g1",title:"Tasks",color:"#3b82f6",tasks:[],columns:[],isPinned:!1});const c=n[0],f=x.map(N=>{let L=A.New;return N.status==="To do"?L=A.New:N.status==="In Progress"?L=A.Working:N.status==="Review"?L=A.AlmostFinish:N.status==="Complete"&&(L=A.Done),{id:N.id,name:N.title,status:L,priority:N.priority,personId:N.assigneeId||null,dueDate:N.dueDate?new Date(N.dueDate).toISOString():"",textValues:{},selected:!1}});return n[0]={...c,tasks:f},{...t,groups:n}})},[x,S]);const Pt=(t,n,c)=>{if(G(t,n,c),d){const f={};c.name&&(f.title=c.name),c.status&&(c.status===A.New||c.status===A.Pending?f.status="To do":c.status===A.Working||c.status===A.Stuck?f.status="In Progress":c.status===A.AlmostFinish?f.status="Review":c.status===A.Done&&(f.status="Complete")),c.priority&&(f.priority=c.priority),c.personId!==void 0&&(f.assigneeId=c.personId||void 0),c.dueDate&&(f.dueDate=new Date(c.dueDate)),d(n,f)}},[Er,Ue]=C.useState(!1),[Lr,Fr]=C.useState(null),[pe,be]=C.useState(null),[ae,we]=C.useState(null),[We,_t]=C.useState(new Set),[qe,Je]=C.useState({}),[Le,Ye]=C.useState(null),[Xe,Ke]=C.useState(null),[Ze,Qe]=C.useState(null),Me=mt.getCurrentUser(),Et=Me&&r===`taskboard-${Me.id}`,[ve,Fe]=C.useState(null),[R,Oe]=C.useState({}),[Or,Lt]=C.useState(null),Ft=C.useRef(null),Ot=C.useRef(l.groups.length),[de,et]=C.useState(null),[tt,Ve]=C.useState(new Set);C.useEffect(()=>{const t=c=>{if(!de)return;const f=c.clientX-de.startX,N=Math.max(50,de.startWidth+f);J(de.groupId,de.colId,N)},n=()=>{de&&(et(null),document.body.style.cursor="")};return de&&(document.addEventListener("mousemove",t),document.addEventListener("mouseup",n),document.body.style.cursor="col-resize"),()=>{document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",n),document.body.style.cursor=""}},[de,J]),C.useEffect(()=>{Ot.current=l.groups.length},[l.groups.length]);const Vt=t=>{const n=new Set(We);n.has(t)?n.delete(t):n.add(t),_t(n)},Gt=(t,n)=>{var N;const c=(N=qe[n])==null?void 0:N.trim();if(!c)return;const f={id:`subtask-${ne()}`,name:c,status:A.New,priority:Z.Normal,dueDate:"",personId:null,textValues:{},selected:!1};S(L=>({...L,groups:L.groups.map(a=>a.id===t?{...a,tasks:a.tasks.map(I=>I.id===n?{...I,subtasks:[...I.subtasks||[],f]}:I)}:a)})),Je(L=>({...L,[n]:""}))},ee=(t,n)=>{Oe(c=>({...c,[t]:{...c[t],...n}}))},Ge=t=>{const n=R[t]||{},c=n.name||"";c.trim()&&(te(t,c,n),Oe(f=>{const N={...f};return delete N[t],N}))},Rt=t=>{if(Object.entries(R).filter(([,f])=>{var N;return(N=f==null?void 0:f.name)==null?void 0:N.trim()}).length===0)return l;const c={...l,groups:l.groups.map(f=>{var I;const N=R[f.id],L=(I=N==null?void 0:N.name)==null?void 0:I.trim();if(!N||!L)return f;const a={id:ne(),name:L,status:N.status||A.New,priority:N.priority||Z.Normal,dueDate:N.dueDate||new Date().toISOString().split("T")[0],personId:N.personId??null,textValues:N.textValues||{},selected:!1};return{...f,tasks:[...f.tasks,a]}})};return t!=null&&t.skipPersist||S(c),Oe({}),c};C.useImperativeHandle(F,()=>({exportBoardWithDrafts:Rt}),[l,R]);const st=(t,n,c)=>{t.preventDefault(),Fe({x:t.clientX,y:t.clientY,groupId:n,colId:c})},Bt=(t,n,c)=>{if(t==="delete")p(n,c);else if(t==="duplicate")w(n,c);else if(t!=="move_left"){if(t!=="move_right"){if(t==="rename"){const f=prompt("Enter new column name:");f&&b(n,c,f)}}}Fe(null)},Ht=Fs(Os(Vs,{activationConstraint:{distance:5}})),Ut=t=>{const{active:n}=t;Ue(!0)},Wt=t=>{const{active:n,over:c}=t;if(Ue(!1),Lt(null),!c)return;const f=n.id,N=c.id;f!==N&&S(L=>{const a=L.groups.find(H=>H.tasks.some(K=>K.id===f)),I=L.groups.find(H=>H.tasks.some(K=>K.id===N));if(!a||!I)return L;const z=a.tasks.findIndex(H=>H.id===f),W=I.tasks.findIndex(H=>H.id===N);if(a.id===I.id){const H=Is(a.tasks,z,W),K=L.groups.map(oe=>oe.id===a.id?{...oe,tasks:H}:oe);return{...L,groups:K}}else{const H=[...a.tasks],[K]=H.splice(z,1),oe=[...I.tasks];oe.splice(W,0,K);const Pe=L.groups.map(xe=>xe.id===a.id?{...xe,tasks:H}:xe.id===I.id?{...xe,tasks:oe}:xe);return{...L,groups:Pe}}})},qt=(t,n,c,f)=>{if(f===0){t.preventDefault();return}t.dataTransfer.setData("application/json",JSON.stringify({type:"COLUMN",groupId:n,colId:c,index:f})),t.dataTransfer.effectAllowed="move"},Jt=(t,n)=>{t.preventDefault(),n===0?t.dataTransfer.dropEffect="none":t.dataTransfer.dropEffect="move"},Yt=(t,n,c)=>{t.preventDefault();const f=t.dataTransfer.getData("application/json");if(f)try{const{type:N,groupId:L,index:a}=JSON.parse(f);N==="COLUMN"&&L===n&&a!==c&&c!==0&&_(n,a,c)}catch{}},ye={[A.Done]:"#33D995",[A.Working]:"#FFBE66",[A.Stuck]:"#FF7085",[A.Pending]:"#FFD940",[A.AlmostFinish]:"#C48AF0",[A.New]:"#A0A5B9"},Xt=t=>{if(!t)return A.New;const n=t.toLowerCase();return n.includes("done")||n.includes("complete")?A.Done:n.includes("work")||n.includes("progress")||n.includes("doing")?A.Working:n.includes("stuck")||n.includes("block")?A.Stuck:n.includes("pending")||n.includes("todo")||n.includes("to do")||n.includes("backlog")?A.Pending:n.includes("almost")||n.includes("review")?A.AlmostFinish:A.New},Re=(t,n)=>{var N,L;const c=(N=t.columns.find(a=>a.type==="status"))==null?void 0:N.id,f=n.status||(c?(L=n.textValues)==null?void 0:L[c]:void 0);return Xt(f)},Kt=(t,n)=>{const c=(n??t.tasks).flatMap(a=>[a,...a.subtasks||[]]);if(c.length===0)return{counts:{done:0,working:0,stuck:0,pending:0,almostFinish:0,new:0},weighted:0,total:0};const f=c.reduce((a,I)=>{const z=Re(t,I);return a[z===A.Done?"done":z===A.Working?"working":z===A.Stuck?"stuck":z===A.Pending?"pending":z===A.AlmostFinish?"almostFinish":"new"]+=1,a},{done:0,working:0,stuck:0,pending:0,almostFinish:0,new:0}),N=c.length,L=(f.done*1+f.almostFinish*.75+f.working*.5+f.pending*.25+f.new*.1+f.stuck*0)/N*100;return{counts:f,weighted:L,total:N}},ke=D.trim().toLowerCase(),Zt=ke.length>0||g!=="all",Qt=t=>!ke||t.name.toLowerCase().includes(ke)?!0:Object.values(t.textValues||{}).some(n=>(n||"").toLowerCase().includes(ke)),Mt=(t,n)=>{if(g==="all")return!0;const c=Re(n,t);return g==="done"?c===A.Done:g==="new"?c===A.New||c===A.Pending:c!==A.Done},es=t=>{if(u==="none")return t;const n=[...t];if(u==="name")n.sort((c,f)=>c.name.localeCompare(f.name));else if(u==="dueAsc"||u==="dueDesc")n.sort((c,f)=>{const N=c.dueDate?new Date(c.dueDate).getTime():1/0,L=f.dueDate?new Date(f.dueDate).getTime():1/0;return u==="dueAsc"?N-L:L-N});else if(u==="priority"){const c={[Z.Urgent]:1,[Z.High]:2,[Z.Medium]:3,[Z.Normal]:4,[Z.Low]:5};n.sort((f,N)=>(c[f.priority]||99)-(c[N.priority]||99))}return n},Ie="50px",Ae="50px",Te=l.groups.flatMap(t=>t.tasks.filter(n=>n.selected).map(n=>({groupId:t.id,task:n}))).length,ts=()=>{U("all",!1)},ss=()=>{Te!==0&&S(t=>({...t,groups:t.groups.map(n=>({...n,tasks:n.tasks.filter(c=>!c.selected)}))}))},rs=()=>{Te!==0&&S(t=>({...t,groups:t.groups.map(n=>{const c=n.tasks.filter(N=>N.selected);if(c.length===0)return n;const f=c.map(N=>({...N,id:crypto.randomUUID(),name:N.name+" (Copy)",selected:!0}));return{...n,tasks:[...n.tasks,...f]}})}))},as=t=>{Ve(n=>{const c=new Set(n);return c.has(t)?c.delete(t):c.add(t),c})};return C.useEffect(()=>{k!==void 0&&Ve(new Set)},[k]),C.useEffect(()=>{v!==void 0&&Ve(new Set(l.groups.map(t=>t.id)))},[v,l.groups]),e.jsx(Gs,{sensors:Ht,collisionDetection:Rs,onDragStart:Ut,onDragEnd:Wt,children:e.jsxs("div",{className:`flex w-full ${i?"h-full":"h-screen"} overflow-hidden font-sans transition-colors ${s?"bg-[#0f1115] text-gray-200":"bg-white text-gray-800"}`,children:[e.jsxs("main",{className:`flex-1 flex flex-col ${i?"h-full":"h-screen"} overflow-hidden relative transition-colors ${s?"bg-[#0f1115]":"bg-white"}`,children:[!i&&e.jsxs("header",{className:`h-16 flex items-center justify-between px-8 flex-shrink-0 transition-colors ${s?"bg-[#0f1115] border-b border-white/5":"bg-white"}`,children:[e.jsx("div",{children:e.jsx("h1",{className:`text-2xl font-bold tracking-tight ${s?"text-white":"text-gray-800"}`,children:l.name})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:ce,disabled:V,className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-indigo-50 to-purple-50 text-indigo-600 rounded-full hover:shadow-md hover:scale-105 transition-all text-sm font-semibold border border-indigo-100",children:[e.jsx(Be,{className:"w-4 h-4"}),V?"Thinking...":"Analyze Board"]}),e.jsxs("button",{onClick:se,className:"flex items-center gap-2 px-4 py-2 bg-[#1e2126] text-white rounded-md hover:bg-[#2c3036] transition text-sm font-medium shadow-sm",children:[e.jsx(gt,{className:"w-4 h-4"})," New Group"]})]})]}),e.jsxs("div",{ref:Ft,className:`flex-1 overflow-y-auto overflow-x-hidden custom-scroll ${i?"p-0 pb-4":"p-6 pb-96"}`,children:[E&&e.jsxs("div",{className:"mb-8 p-6 bg-white border border-indigo-100 rounded-2xl shadow-xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400"}),e.jsxs("h3",{className:"text-indigo-900 font-bold text-lg mb-3 flex items-center gap-2",children:[e.jsx(Be,{className:"w-5 h-5 text-indigo-500"})," AI Assistant Insights"]}),e.jsx("p",{className:"text-gray-700 whitespace-pre-line text-sm leading-relaxed",children:E}),e.jsx("button",{onClick:()=>T(null),className:"mt-4 text-xs font-semibold text-gray-400 hover:text-gray-600 uppercase tracking-wider",children:"Dismiss"})]}),e.jsx("div",{className:"space-y-8 w-full",children:[...l.groups].sort((t,n)=>(n.isPinned?1:0)-(t.isPinned?1:0)).map(t=>{var L;const n=es(t.tasks.filter(a=>Qt(a)&&Mt(a,t))),c=Kt(t,n),f=t.tasks.length>0&&t.tasks.every(a=>a.selected),N=t.tasks.some(a=>a.selected);return Zt&&n.length===0?null:e.jsxs("div",{id:`group-${t.id}`,className:`relative flex flex-col w-full mb-10 shadow-sm border rounded-xl overflow-hidden transition-colors ${s?"border-gray-800 bg-[#1a1d24]":"border-gray-200/60"}`,children:[e.jsxs("div",{className:`flex items-center px-4 py-3 relative w-full border-b transition-colors ${s?"bg-[#1a1d24] border-gray-800":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 pr-4",children:[e.jsx("div",{className:"cursor-pointer hover:bg-gray-100 p-1.5 rounded transition-colors group/menu relative",onClick:()=>as(t.id),children:e.jsx("svg",{className:`w-4 h-4 text-gray-400 group-hover/menu:text-blue-500 transition-transform ${tt.has(t.id)?"-rotate-90":"rotate-0"}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})}),e.jsx("input",{value:t.title,onChange:a=>j(t.id,a.target.value),className:`text-xl font-bold bg-transparent border border-transparent rounded px-2 py-0.5 focus:outline-none focus:border-blue-500 w-full max-w-md transition-all ${s?"hover:border-gray-700 focus:bg-[#0f1115]":"hover:border-gray-300 focus:bg-white"}`,style:{color:t.color}}),e.jsxs("div",{className:"ml-4 flex items-center gap-2",children:[e.jsx("div",{className:"flex h-1.5 w-28 overflow-hidden rounded-full bg-gray-100",children:["new","pending","working","almostFinish","done","stuck"].map(a=>{const I=c.total===0?0:c.counts[a]/c.total*100;if(I<=0)return null;const z=a==="new"?ye[A.New]:a==="pending"?ye[A.Pending]:a==="working"?ye[A.Working]:a==="almostFinish"?ye[A.AlmostFinish]:a==="done"?ye[A.Done]:ye[A.Stuck];return e.jsx("div",{className:"h-full",style:{width:`${I}%`,backgroundColor:z}},a)})}),e.jsxs("span",{className:"text-xs text-gray-400 font-medium",children:[Math.round(c.weighted),"%"]})]})]}),e.jsx("div",{className:"flex-1"}),!i&&e.jsxs("div",{className:"flex items-center gap-1 px-2",children:[e.jsx("button",{onClick:()=>m(t.id),className:"p-2 transition-colors rounded-md "+(t.isPinned?"text-blue-500 bg-blue-50":"text-gray-300 hover:text-gray-500 hover:bg-gray-100"),title:t.isPinned?"Unpin Group":"Pin Group",children:e.jsx(hr,{className:"w-4 h-4 "+(t.isPinned?"fill-current":"")})}),e.jsx("button",{onClick:a=>{a.stopPropagation(),Ye(t.id)},className:"p-2 transition-colors rounded-md text-gray-300 hover:text-gray-500 hover:bg-gray-100",title:"Send to Reminders",children:e.jsx(bt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:a=>{a.stopPropagation(),Ke(t.id)},className:"p-2 transition-colors rounded-md text-gray-300 hover:text-gray-500 hover:bg-gray-100",title:"Send to Goals",children:e.jsx(ht,{className:"w-4 h-4"})}),!Et&&e.jsx("button",{onClick:a=>{a.stopPropagation(),Qe(t.id)},className:"p-2 transition-colors rounded-md text-gray-300 hover:text-gray-500 hover:bg-gray-100",title:"Send to Tasks Board",children:e.jsx(pt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>It(t.id),className:"text-gray-400 hover:text-red-500 p-2 transition-colors hover:bg-red-50 rounded-md",title:"Delete Group",children:e.jsx(He,{size:14})})]})]}),!tt.has(t.id)&&e.jsxs("div",{className:"overflow-x-auto w-full [&::-webkit-scrollbar]:hidden",children:[e.jsx("div",{className:`sticky top-0 z-[1] min-w-full w-fit transition-colors ${s?"bg-[#1a1d24]":"bg-white"}`,style:{boxShadow:"0 2px 5px -2px rgba(0,0,0,0.05)"},children:e.jsxs("div",{className:`grid gap-px border-y text-xs font-semibold uppercase tracking-wide transition-colors ${s?"bg-gray-800 border-gray-800 text-gray-400":"bg-gray-200 border-gray-200 text-gray-500"}`,style:{gridTemplateColumns:Ie+" "+t.columns.map(a=>a.width).join(" ")+" "+Ae},children:[e.jsx("div",{className:`flex items-center justify-center sticky left-0 z-20 border-r-2 transition-colors ${s?"bg-[#1a1d24]/95 border-r-gray-800":"bg-gray-50/80 border-r-gray-200/50"}`,children:e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-gray-300",checked:f,ref:a=>{a&&(a.indeterminate=N&&!f)},onChange:a=>U(t.id,a.target.checked)})}),t.columns.map((a,I)=>e.jsx("div",{className:`relative group backdrop-blur-sm transition-colors ${a.type==="name"?`sticky left-[50px] z-20 border-r-2 ${s?"border-r-gray-800":"border-r-gray-200/50"}`:"cursor-grab active:cursor-grabbing"} ${s?"bg-[#1a1d24]/95 hover:bg-white/5":"bg-gray-50/80 hover:bg-gray-100"}`,onContextMenu:z=>st(z,t.id,a.id),draggable:a.type!=="name",onDragStart:z=>qt(z,t.id,a.id,I),onDragOver:z=>Jt(z,I),onDrop:z=>Yt(z,t.id,I),children:e.jsxs("div",{className:"flex items-center justify-between h-full",children:[e.jsx("input",{value:a.title,onChange:z=>b(t.id,a.id,z.target.value),className:`w-full h-full bg-transparent px-3 py-2 text-center text-[11px] focus:outline-none border-b-2 border-transparent focus:border-blue-500 ${s?"focus:bg-[#0f1115] focus:text-white text-gray-300":"focus:bg-white focus:text-gray-800"}`,style:{textAlign:a.type==="name"||a.type==="long_text"?"left":"center"}}),e.jsx("div",{className:"absolute right-1 top-1/2 transform -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer p-1 hover:bg-gray-200 rounded",onClick:z=>{z.stopPropagation();const W=z.currentTarget.getBoundingClientRect();we((ae==null?void 0:ae.groupId)===t.id?null:{groupId:t.id,rect:W})},children:e.jsx(us,{size:14,className:"text-gray-400"})}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-400/50 z-30",onMouseDown:z=>{z.stopPropagation(),z.preventDefault();const W=parseInt(a.width.replace("px",""))||140;et({groupId:t.id,colId:a.id,startX:z.clientX,startWidth:W})},onClick:z=>z.stopPropagation()})]})},a.id)),e.jsx("div",{className:`flex items-center justify-center relative group ${s?"bg-[#1a1d24]/95":"bg-gray-50/80"}`,children:e.jsx("div",{className:"cursor-pointer w-6 h-6 rounded flex items-center justify-center transition-all duration-200 "+((ae==null?void 0:ae.groupId)===t.id?"bg-gray-200 text-gray-900":"text-gray-400 hover:text-gray-700 hover:bg-gray-200/50"),onClick:a=>{a.stopPropagation();const I=a.currentTarget.getBoundingClientRect();we((ae==null?void 0:ae.groupId)===t.id?null:{groupId:t.id,rect:I})},title:"Add Column",children:e.jsx(gt,{className:"w-4 h-4"})})})]})}),e.jsx("div",{className:`divide-y relative z-0 min-w-full w-fit ${s?"divide-gray-800":"divide-gray-100"}`,children:e.jsx(Ds,{items:n.map(a=>a.id),strategy:zs,children:n.map(a=>e.jsx(_r,{task:a,group:t,selectionColumnWidth:Ie,actionColumnWidth:Ae,expandedTaskIds:We,toggleTaskSelection:O,updateTask:Pt,deleteTask:()=>kt(t.id,a.id),updateTaskTextValue:X,toggleSubtask:Vt,setActiveDatePicker:be,handleContextMenu:st,handleAddSubtask:Gt,subtaskInput:qe,setSubtaskInput:Je,darkMode:s},a.id))})}),e.jsxs("div",{className:`grid gap-px border-t group/add-row transition-colors min-w-full w-fit ${s?"bg-[#1a1d24] border-gray-800 hover:bg-white/5":"bg-white border-gray-200 hover:bg-gray-50"}`,style:{gridTemplateColumns:Ie+" "+t.columns.map(a=>a.width).join(" ")+" "+Ae},children:[e.jsxs("div",{className:`flex items-center justify-center border-r sticky left-0 z-10 border-r-2 transition-colors relative ${s?"bg-[#1a1d24] border-gray-800 border-r-gray-800 group-hover/add-row:bg-white/5":"bg-white border-gray-100 border-r-gray-200/50 group-hover/add-row:bg-gray-50"}`,children:[e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1.5",style:{backgroundColor:t.color}}),e.jsx("div",{className:"w-4 h-4 rounded border border-gray-200 flex items-center justify-center text-gray-300",children:e.jsx(ft,{size:10})})]}),e.jsx("div",{className:`flex items-center pl-2 py-2 border-r sticky left-[50px] z-10 border-r-2 transition-colors ${s?"bg-[#1a1d24] border-gray-800 border-r-gray-800 group-hover/add-row:bg-white/5":"bg-white border-gray-100 border-r-gray-200/50 group-hover/add-row:bg-gray-50"}`,children:e.jsx("input",{type:"text",placeholder:"+ Add task",value:((L=R[t.id])==null?void 0:L.name)||"",onChange:a=>ee(t.id,{name:a.target.value}),className:`w-full bg-transparent text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 ${s?"placeholder-gray-600 text-gray-200":"placeholder-gray-400 text-gray-700"}`,onKeyDown:a=>{a.key==="Enter"&&Ge(t.id)}})}),t.columns.slice(1).map(a=>{var I,z,W,H,K,oe,Pe,xe,rt,at,nt,it,ot;return e.jsx("div",{className:`border-r min-h-[32px] flex items-center justify-center ${s?"bg-[#1a1d24] border-gray-800":"bg-white border-gray-100"}`,children:a.type==="status"?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(St,{status:a.id==="col_status"?((I=R[t.id])==null?void 0:I.status)||A.New:((W=(z=R[t.id])==null?void 0:z.textValues)==null?void 0:W[a.id])||A.New,onChange:B=>{var q;a.id==="col_status"?ee(t.id,{status:B}):ee(t.id,{textValues:{...(q=R[t.id])==null?void 0:q.textValues,[a.id]:B}})},tabIndex:0,darkMode:s})}):a.type==="priority"?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Dt,{priority:a.id==="col_priority"?((H=R[t.id])==null?void 0:H.priority)||Z.Normal:((oe=(K=R[t.id])==null?void 0:K.textValues)==null?void 0:oe[a.id])||Z.Normal,onChange:B=>{var q;a.id==="col_priority"?ee(t.id,{priority:B}):ee(t.id,{textValues:{...(q=R[t.id])==null?void 0:q.textValues,[a.id]:B}})},tabIndex:0,darkMode:s})}):a.type==="person"?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(zt,{personId:a.id==="col_person"?((Pe=R[t.id])==null?void 0:Pe.personId)||null:((rt=(xe=R[t.id])==null?void 0:xe.textValues)==null?void 0:rt[a.id])||null,onChange:B=>{var q;a.id==="col_person"?ee(t.id,{personId:B}):ee(t.id,{textValues:{...(q=R[t.id])==null?void 0:q.textValues,[a.id]:B||""}})},tabIndex:0,darkMode:s})}):a.type==="date"?e.jsx("div",{className:"w-full h-full relative flex items-center justify-center",children:e.jsx("div",{className:`text-xs cursor-pointer font-medium px-2 py-1 rounded transition-colors focus:ring-2 focus:ring-blue-500 focus:outline-none ${s?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-500 hover:text-gray-800 hover:bg-gray-100"}`,onClick:B=>{var ue,je,_e;B.stopPropagation();const q=B.currentTarget.getBoundingClientRect(),ie=a.id==="col_date",ge=ie?((ue=R[t.id])==null?void 0:ue.dueDate)||"":((_e=(je=R[t.id])==null?void 0:je.textValues)==null?void 0:_e[a.id])||"";be({taskId:"draft-"+t.id,colId:a.id,date:ge,rect:q,onSelect:Ne=>{var $e;ie?ee(t.id,{dueDate:Ne}):ee(t.id,{textValues:{...($e=R[t.id])==null?void 0:$e.textValues,[a.id]:Ne}})}})},tabIndex:0,onKeyDown:B=>{var q,ie,ge;if(B.key==="Enter"||B.key===" "){B.preventDefault();const ue=B.currentTarget.getBoundingClientRect(),je=a.id==="col_date",_e=je?((q=R[t.id])==null?void 0:q.dueDate)||"":((ge=(ie=R[t.id])==null?void 0:ie.textValues)==null?void 0:ge[a.id])||"";be({taskId:"draft-"+t.id,colId:a.id,date:_e,rect:ue,onSelect:Ne=>{var $e;je?ee(t.id,{dueDate:Ne}):ee(t.id,{textValues:{...($e=R[t.id])==null?void 0:$e.textValues,[a.id]:Ne}})}})}},children:(()=>{var ie,ge,ue;const q=a.id==="col_date"?(ie=R[t.id])==null?void 0:ie.dueDate:(ue=(ge=R[t.id])==null?void 0:ge.textValues)==null?void 0:ue[a.id];return q?new Date(q).toLocaleDateString(void 0,{month:"short",day:"numeric"}):e.jsx("span",{className:"text-gray-300",children:"Set Date"})})()})}):a.type==="text"?e.jsx("input",{type:"text",value:((nt=(at=R[t.id])==null?void 0:at.textValues)==null?void 0:nt[a.id])||"",onChange:B=>{var q;return ee(t.id,{textValues:{...(q=R[t.id])==null?void 0:q.textValues,[a.id]:B.target.value}})},className:"w-full h-full text-center px-2 bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded text-gray-600",placeholder:"-",tabIndex:0,onKeyDown:B=>B.key==="Enter"&&Ge(t.id)}):a.type==="number"?e.jsx("input",{type:"text",value:((ot=(it=R[t.id])==null?void 0:it.textValues)==null?void 0:ot[a.id])||"",onChange:B=>{var ie;const q=B.target.value;/^[0-9.,]*$/.test(q)&&ee(t.id,{textValues:{...(ie=R[t.id])==null?void 0:ie.textValues,[a.id]:q}})},className:"w-full h-full text-center px-2 bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded text-gray-600 font-mono text-xs",placeholder:"0",tabIndex:0,onKeyDown:B=>B.key==="Enter"&&Ge(t.id)}):e.jsx("div",{className:"w-full h-full"})},a.id)}),e.jsx("div",{className:`transition-colors ${s?"bg-[#1a1d24] group-hover/add-row:bg-white/5":"bg-white group-hover/add-row:bg-gray-50"}`})]}),e.jsxs("div",{className:`grid gap-px border-t rounded-b-xl min-w-full w-fit ${s?"bg-[#1a1d24] border-gray-800":"bg-white border-gray-200"}`,style:{gridTemplateColumns:Ie+" "+t.columns.map(a=>a.width).join(" ")+" "+Ae},children:[e.jsx("div",{className:`flex items-center justify-center border-r sticky left-0 z-10 border-r-2 ${s?"bg-[#1a1d24] border-gray-800 border-r-gray-800":"bg-white border-gray-100 border-r-gray-200/50"}`}),e.jsx("div",{className:`flex items-center justify-center sticky left-[50px] z-10 border-t ${s?"bg-[#1a1d24] border-gray-800":"bg-white border-gray-200"}`,children:e.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider"})}),t.columns.slice(1).map(a=>e.jsxs("div",{className:`border-r min-h-[32px] flex items-center justify-center px-2 ${s?"bg-[#1a1d24] border-gray-800":"bg-white border-gray-100"}`,children:[a.type==="status"&&e.jsx("div",{className:"w-full h-4 flex rounded-sm overflow-hidden",children:Object.values(A).map(I=>{const z=n.filter(H=>Re(t,H)===I).length;if(z===0)return null;const W=z/Math.max(n.length,1)*100;return e.jsx("div",{style:{width:W+"%"},title:I+": "+z,className:Ct[I]+" h-full hover:opacity-80 transition-opacity"},I)})}),a.type==="priority"&&e.jsx("div",{className:"w-full h-4 flex rounded-sm overflow-hidden",children:Object.values(Z).map(I=>{const z=t.tasks.filter(H=>(a.id==="col_priority"?H.priority:H.textValues[a.id])===I).length;if(z===0)return null;const W=z/t.tasks.length*100;return e.jsx("div",{style:{width:W+"%"},title:I+": "+z,className:ze[I]+" h-full hover:opacity-80 transition-opacity"},I)})}),a.type==="person"&&(()=>{const I=t.tasks.filter(z=>{const W=a.id==="col_owner"?z.personId:z.textValues[a.id];return W&&W.length>0}).length;return I===0?null:e.jsxs("div",{className:"flex flex-col items-center justify-center leading-none",children:[e.jsx("span",{className:"text-sm text-gray-500 font-medium",children:I}),e.jsx("span",{className:"text-[10px] text-gray-400",children:"owners"})]})})(),a.type==="money"&&(()=>{const I=t.tasks.reduce((z,W)=>{var K;const H=(K=W.textValues[a.id])==null?void 0:K.replace(/,/g,"");return z+(Number(H)||0)},0);return e.jsxs("div",{className:"flex flex-col items-center justify-center leading-none",children:[e.jsxs("span",{className:"text-xs text-gray-700 font-bold font-mono",children:[a.currency||"$"," ",I.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("span",{className:"text-[10px] text-gray-400",children:"sum"})]})})(),a.type==="checkbox"&&(()=>{const I=t.tasks.filter(z=>z.textValues[a.id]==="true").length;return I===0?null:e.jsxs("div",{className:"flex flex-col items-center justify-center leading-none",children:[e.jsx("span",{className:"text-xs text-gray-700 font-bold font-mono",children:I}),e.jsx("span",{className:"text-[10px] text-gray-400",children:"checked"})]})})(),a.type==="number"&&(()=>{const I=t.tasks.reduce((z,W)=>{var K;const H=(K=W.textValues[a.id])==null?void 0:K.replace(/,/g,"");return z+(Number(H)||0)},0);return e.jsxs("div",{className:"flex flex-col items-center justify-center leading-none",children:[e.jsx("span",{className:"text-xs text-gray-700 font-bold font-mono",children:I.toLocaleString()}),e.jsx("span",{className:"text-[10px] text-gray-400",children:"sum"})]})})(),(a.type==="text"||a.type==="long_text"||a.type==="date"||a.type==="dropdown"||a.type==="name")&&(()=>{const I=t.tasks.filter(z=>{if(a.type==="name")return!0;const W=z.textValues[a.id];return W&&W.trim().length>0}).length;return I===0?null:e.jsxs("div",{className:"flex flex-col items-center justify-center leading-none",children:[e.jsx("span",{className:"text-xs text-gray-700 font-bold font-mono",children:I}),e.jsx("span",{className:"text-[10px] text-gray-400",children:"count"})]})})()]},a.id)),e.jsx("div",{className:`${s?"bg-[#1a1d24]":"bg-white"}`})]})]})]},t.id)})})]}),e.jsx(hs,{children:Te>0&&e.jsx(lt.div,{className:"fixed bottom-16 md:bottom-20 left-0 right-0 px-4 z-50 pointer-events-none",initial:{opacity:0,y:16,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:16,scale:.98},transition:{duration:.18,ease:"easeOut"},children:e.jsx(lt.div,{className:`mx-auto max-w-5xl shadow-2xl border rounded-2xl px-6 py-3 flex items-center gap-6 pointer-events-auto justify-center ${s?"bg-[#1a1d24] border-gray-800":"bg-white border-gray-200"}`,initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:8},transition:{duration:.18,ease:"easeOut",delay:.02},children:e.jsx("div",{className:"flex items-center gap-5 text-sm text-gray-600 flex-wrap md:flex-nowrap justify-center w-full",children:e.jsxs("div",{className:"flex items-center gap-5 flex-wrap md:flex-nowrap justify-center",children:[e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",onClick:rs,children:[e.jsx(vt,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Duplicate"})]}),e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",children:[e.jsx(ms,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Export"})]}),e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",children:[e.jsx(qs,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Archive"})]}),e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",onClick:At,children:[e.jsx(He,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Delete"})]}),e.jsxs("button",{className:"flex items-center gap-2 text-gray-400 cursor-not-allowed whitespace-nowrap",disabled:!0,children:[e.jsx(dt,{size:18,className:"text-gray-400"})," ",e.jsx("span",{children:"Convert"})]}),e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",children:[e.jsx(dt,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Move to"})]}),e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",children:[e.jsx(Nt,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Sidekick"})]}),e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",children:[e.jsx(wt,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Apps"})]}),e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",onClick:ts,children:[e.jsx(De,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Clear"})]})]})})})})}),!i&&e.jsx("div",{className:"absolute bottom-6 left-1/2 transform -translate-x-1/2 w-full max-w-2xl px-4",children:e.jsxs("div",{className:`backdrop-blur-md rounded-full shadow-2xl border p-2 flex items-center gap-3 pl-5 transition-all focus-within:ring-4 ring-indigo-500/10 ${s?"bg-[#1a1d24]/90 border-white/10":"bg-white/90 border-white/50"}`,children:[e.jsx(Be,{className:"text-indigo-500 w-5 h-5 animate-pulse"}),e.jsx("input",{type:"text",value:P,onChange:t=>h(t.target.value),onKeyDown:t=>t.key==="Enter"&&M(),placeholder:"Ask AI to build a plan (e.g. 'Plan a product launch for next month')",className:"flex-1 bg-transparent focus:outline-none text-sm text-gray-800 py-2 placeholder-gray-500"}),e.jsx("button",{onClick:M,disabled:V||!P,className:"bg-indigo-600 text-white rounded-full px-6 py-2.5 text-sm font-medium hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-all hover:shadow-lg flex items-center gap-2",children:V?e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsx("span",{children:"Generate"})})]})})]}),ve&&e.jsx(Cr,{x:ve.x,y:ve.y,onClose:()=>Fe(null),onAction:t=>Bt(t,ve.groupId,ve.colId)}),pe&&me.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-[9998] bg-transparent",onClick:t=>{t.stopPropagation(),be(null)}}),e.jsx("div",{className:"fixed z-[10005]",style:{top:pe.rect.bottom+8,left:pe.rect.left+pe.rect.width/2,transform:"translateX(-50%)"},onClick:t=>t.stopPropagation(),children:e.jsx($r,{date:pe.date,onSelect:t=>{pe.onSelect(t)},onClose:()=>be(null)})})]}),document.body),ae&&me.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-[9998] bg-transparent",onClick:t=>{t.stopPropagation(),we(null)}}),e.jsx("div",{className:"fixed top-[100px] bottom-0 right-0 z-[10005]",onClick:t=>t.stopPropagation(),children:e.jsx(ks,{onClose:()=>we(null),onSelect:(t,n,c,f)=>{ae&&y(ae.groupId,t,n,c,f),we(null)},darkMode:s})})]}),document.body),Le&&e.jsx(Sr,{isOpen:!!Le,onClose:()=>Ye(null),group:l.groups.find(t=>t.id===Le)}),Xe&&e.jsx(Dr,{isOpen:!0,onClose:()=>Ke(null),group:l.groups.find(t=>t.id===Xe)}),Ze&&e.jsx(zr,{isOpen:!0,onClose:()=>Qe(null),group:l.groups.find(t=>t.id===Ze)}),e.jsx(ps,{isOpen:!!Y,onClose:()=>fe(null),onConfirm:Tt,title:(Y==null?void 0:Y.type)==="task"?"Delete Task":(Y==null?void 0:Y.type)==="group"?"Delete Group":(Y==null?void 0:Y.type)==="column"?"Delete Column":"Delete Selected Tasks",message:(Y==null?void 0:Y.type)==="task"?"Are you sure you want to delete this task? This action cannot be undone.":(Y==null?void 0:Y.type)==="group"?"Are you sure you want to delete this group and all its tasks? This action cannot be undone.":(Y==null?void 0:Y.type)==="column"?"Are you sure you want to delete this column? This action cannot be undone.":`Are you sure you want to delete ${Te} tasks? This action cannot be undone.`,confirmText:"Delete",variant:"danger"})]})})});export{qs as A,$r as D,Ce as I,hr as P,A as S,ea as T,Ct as a,Z as b,Nr as u};
