import{c as Z,r as C,N as ee,K as xe,j as e,W as ls,O as cs,Z as ds,aK as xs,T as Ue,X as De,Q as Se,i as yt,$ as ft,u as us,L as bt,n as me,k as wt,P as vt,a9 as gs,J as jt,E as hs,au as ms,at as xt,aL as ps,aM as Nt,a3 as ys,R as fs,e as bs,g as ws,ac as vs,a4 as js,aN as Ns,G as Cs,aO as $s}from"./index-B2SFjcJL.js";import{T as he}from"./index-Ca_DMGSD.js";import{P as Ss,b as Ds,C as ks,a as ut}from"./ColumnMenu-BvyMittW.js";import{r as zs,D as Is}from"./remindersService-zGzTsx_y.js";import{C as Ct}from"./copy-D5twc85r.js";import{S as As}from"./square-check-big-DPGxLAw4.js";import{L as Ps}from"./list-Ds4obQst.js";import{L as Ts}from"./list-ordered-C_5XeJ7S.js";import{F as $t}from"./flag-DpjAhyDO.js";import{G as _s}from"./smile-CQSSvyfc.js";import{u as Es,a as gt,T as Ls,M as Os,D as Rs,g as Fs,b as Vs,C as Gs}from"./core.esm-QUJsqprI.js";import{S as Bs,v as Hs,a as Us,u as Ws,T as qs}from"./sortable.esm-bFtSoKBW.js";import{S as St}from"./star-tf2Ijocp.js";import{P as Js}from"./phone-BybaaGlv.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Ys=Z("archive",Xs);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M20 8h-5",key:"1vsyxs"}],["path",{d:"M15 10V6.5a2.5 2.5 0 0 1 5 0V10",key:"ag13bf"}],["path",{d:"M15 14h5l-5 6h5",key:"ur5jdg"}]],Zs=Z("arrow-down-a-z",Ks);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=[["path",{d:"M3 19V5",key:"rwsyhb"}],["path",{d:"m13 6-6 6 6 6",key:"1yhaz7"}],["path",{d:"M7 12h14",key:"uoisry"}]],Ms=Z("arrow-left-to-line",Qs);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=[["path",{d:"M17 12H3",key:"8awo09"}],["path",{d:"m11 18 6-6-6-6",key:"8c2y43"}],["path",{d:"M21 5v14",key:"nzette"}]],tr=Z("arrow-right-to-line",er);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sr=[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M15 4h5l-5 6h5",key:"8asdl1"}],["path",{d:"M15 20v-3.5a2.5 2.5 0 0 1 5 0V20",key:"r6l5cz"}],["path",{d:"M20 18h-5",key:"18j1r2"}]],rr=Z("arrow-up-z-a",sr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nr=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]],ar=Z("heading-1",nr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]],or=Z("heading-2",ir);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]],cr=Z("heading-3",lr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dr=[["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17 10v3a1 1 0 0 0 1 1h3",key:"tj5zdr"}],["path",{d:"M21 10v8",key:"1kdml4"}],["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}]],xr=Z("heading-4",dr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],Dt=Z("maximize-2",ur);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=[["path",{d:"M14 14a2 2 0 0 0 2-2V8h-2",key:"1r06pg"}],["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}],["path",{d:"M8 14a2 2 0 0 0 2-2V8H8",key:"1jzu5j"}]],hr=Z("message-square-quote",gr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mr=[["path",{d:"M18 8L22 12L18 16",key:"1r0oui"}],["path",{d:"M2 12H22",key:"1m8cig"}]],ht=Z("move-right",mr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]],yr=Z("pin",pr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fr=[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]],br=Z("quote",fr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],vr=Z("toggle-left",wr);var z=(r=>(r.New="New",r.Pending="Pending",r.Working="Working on it",r.Stuck="Stuck",r.AlmostFinish="Almost Finish",r.Done="Done",r))(z||{}),K=(r=>(r.Normal="Normal",r.Low="Low",r.Medium="Medium",r.High="High",r.Urgent="Urgent",r))(K||{});const kt={New:"bg-gradient-to-r from-[#A0A5B9] to-[#8D92A6] text-white shadow-sm",Pending:"bg-gradient-to-r from-[#FFD940] to-[#FFCC00] text-white shadow-sm","Working on it":"bg-gradient-to-r from-[#FFBE66] to-[#FFA533] hover:from-[#FFA533] hover:to-[#FF991F] text-white shadow-sm",Stuck:"bg-gradient-to-r from-[#FF7085] to-[#FF526B] hover:from-[#FF526B] hover:to-[#FF3352] text-white shadow-sm","Almost Finish":"bg-gradient-to-r from-[#C48AF0] to-[#B06CE0] text-white shadow-sm",Done:"bg-gradient-to-r from-[#33D995] to-[#00C875] hover:from-[#00C875] hover:to-[#00B067] text-white shadow-sm"},jr={New:"bg-gradient-to-r from-slate-700 to-slate-600 text-white shadow-sm border border-white/10",Pending:"bg-gradient-to-r from-yellow-700 to-yellow-600 text-white shadow-sm border border-white/10","Working on it":"bg-gradient-to-r from-orange-700 to-orange-600 text-white shadow-sm border border-white/10",Stuck:"bg-gradient-to-r from-red-700 to-red-600 text-white shadow-sm border border-white/10","Almost Finish":"bg-gradient-to-r from-purple-700 to-purple-600 text-white shadow-sm border border-white/10",Done:"bg-gradient-to-r from-emerald-700 to-emerald-600 text-white shadow-sm border border-white/10"},ke={Normal:"bg-gradient-to-r from-[#D9D9D9] to-[#C4C4C4] text-white shadow-sm",Low:"bg-gradient-to-r from-[#82B4FF] to-[#579BFC] text-white shadow-sm",Medium:"bg-gradient-to-r from-[#FFBE66] to-[#FFA533] text-white shadow-sm",High:"bg-gradient-to-r from-[#7048C4] to-[#552CB0] text-white shadow-sm",Urgent:"bg-gradient-to-r from-[#FF7085] to-[#FF526B] text-white shadow-sm"},Nr={Normal:"bg-gradient-to-r from-slate-700 to-slate-600 text-white shadow-sm border border-white/10",Low:"bg-gradient-to-r from-blue-700 to-blue-600 text-white shadow-sm border border-white/10",Medium:"bg-gradient-to-r from-orange-700 to-orange-600 text-white shadow-sm border border-white/10",High:"bg-gradient-to-r from-purple-700 to-purple-600 text-white shadow-sm border border-white/10",Urgent:"bg-gradient-to-r from-red-700 to-red-600 text-white shadow-sm border border-white/10"},Le=["#3B82F6","#10B981","#F59E0B","#EC4899","#8B5CF6","#0EA5E9","#7C3AED"],mt=[{id:"p1",name:"Max",initials:"MA",color:"bg-gradient-to-br from-blue-400 to-blue-600"},{id:"p2",name:"Hasan",initials:"HA",color:"bg-gradient-to-br from-emerald-400 to-emerald-600"},{id:"p3",name:"Sarah",initials:"SA",color:"bg-gradient-to-br from-purple-400 to-purple-600"},{id:"p4",name:"John",initials:"JO",color:"bg-gradient-to-br from-amber-400 to-amber-600"}],$e={id:"board-1",name:"Task Board",groups:[{id:"group-1",title:"New Group",color:"#579bfc",columns:[{id:"col_name",title:"Item",type:"name",width:"300px"},{id:"col_person",title:"Owner",type:"person",width:"96px"},{id:"col_status",title:"Status",type:"status",width:"128px"},{id:"col_priority",title:"Priority",type:"priority",width:"128px"},{id:"col_date",title:"Due Date",type:"date",width:"110px"}],tasks:[]}]};he.OBJECT,he.ARRAY,he.OBJECT,he.STRING,he.STRING,he.INTEGER,he.STRING;const Cr=async r=>(console.warn("Gemini API key is missing. AI features are disabled."),null),$r=async r=>"AI features are disabled (missing API key).",Sr=r=>{const[c,x]=C.useState(()=>{try{if(typeof window<"u"){const m=localStorage.getItem(r);if(m){const y=JSON.parse(m);if(y.columns&&Array.isArray(y.columns)&&y.groups){const b=y.groups.map(p=>({...p,columns:p.columns||[...y.columns]}));return{...y,groups:b}}if(y.groups&&Array.isArray(y.groups)){const b=y.groups.map(p=>p.columns&&Array.isArray(p.columns)?p:{...p,columns:[{id:"col_name",title:"Item",type:"name",width:"300px"},{id:"col_person",title:"Owner",type:"person",width:"96px"},{id:"col_status",title:"Status",type:"status",width:"128px"},{id:"col_priority",title:"Priority",type:"priority",width:"128px"},{id:"col_date",title:"Due Date",type:"date",width:"110px"}]});return{...y,groups:b}}}}}catch(m){console.warn("Failed to load saved board",m)}return JSON.parse(JSON.stringify($e))}),[s,i]=C.useState(""),[I,A]=C.useState(!1),[v,k]=C.useState(null);C.useEffect(()=>{const m=()=>{try{if(typeof window<"u"){const p=localStorage.getItem(r);if(p){const w=JSON.parse(p);if(w.columns&&Array.isArray(w.columns)&&w.groups){const T=w.groups.map(W=>({...W,columns:W.columns||[...w.columns]}));x({...w,groups:T});return}if(w.groups&&Array.isArray(w.groups)){const T=w.groups.map(W=>W.columns&&Array.isArray(W.columns)?W:{...W,columns:[{id:"col_name",title:"Item",type:"name",width:"300px"},{id:"col_person",title:"Owner",type:"person",width:"96px"},{id:"col_status",title:"Status",type:"status",width:"128px"},{id:"col_priority",title:"Priority",type:"priority",width:"128px"},{id:"col_date",title:"Due Date",type:"date",width:"110px"}]});x({...w,groups:T});return}x(w)}else x(JSON.parse(JSON.stringify($e)))}}catch(p){console.warn("Failed to load saved board on key change",p),x(JSON.parse(JSON.stringify($e)))}};m();const y=p=>{p.key===r&&m()},b=p=>{var w;((w=p.detail)==null?void 0:w.key)===r&&m()};return window.addEventListener("storage",y),window.addEventListener("local-storage-update",b),()=>{window.removeEventListener("storage",y),window.removeEventListener("local-storage-update",b)}},[r]),C.useEffect(()=>{try{localStorage.setItem(r,JSON.stringify(c))}catch(m){console.warn("Failed to save board",m)}},[c,r]);const u=(m,y,b)=>{x(p=>({...p,groups:p.groups.map(w=>w.id!==m?w:{...w,tasks:w.tasks.map(T=>T.id===y?{...T,...b}:T)})}))},g=(m,y,b)=>{u(m,y,{selected:b})},E=(m,y)=>{x(b=>({...b,groups:b.groups.map(p=>m!=="all"&&p.id!==m?p:{...p,tasks:p.tasks.map(w=>({...w,selected:y}))})}))},o=(m,y,b,p)=>{x(w=>({...w,groups:w.groups.map(T=>T.id!==m?T:{...T,tasks:T.tasks.map(W=>W.id!==y?W:{...W,textValues:{...W.textValues,[b]:p}})})}))},$=(m,y,b)=>{const p={id:ee(),name:(y==null?void 0:y.trim())||"New Item",status:z.New,priority:K.Normal,dueDate:new Date().toISOString().split("T")[0],personId:null,textValues:{},selected:!1,...b};x(w=>({...w,groups:w.groups.map(T=>T.id===m?{...T,tasks:[...T.tasks,p]}:T)}))},P=(m,y)=>{x(b=>({...b,groups:b.groups.map(p=>p.id===m?{...p,tasks:p.tasks.filter(w=>w.id!==y)}:p)}))},h=()=>{const m={id:ee(),title:"New Group",color:Le[c.groups.length%Le.length],columns:[{id:"col_name",title:"Item",type:"name",width:"300px"},{id:"col_person",title:"Owner",type:"person",width:"96px"},{id:"col_status",title:"Status",type:"status",width:"128px"},{id:"col_priority",title:"Priority",type:"priority",width:"128px"},{id:"col_date",title:"Due Date",type:"date",width:"110px"}],tasks:[]};x(y=>({...y,groups:[...y.groups,m]}))},L=m=>{x(y=>({...y,groups:y.groups.filter(b=>b.id!==m)}))},Y=(m,y)=>{x(b=>({...b,groups:b.groups.map(p=>p.id===m?{...p,title:y}:p)}))},O=m=>{x(y=>({...y,groups:y.groups.map(b=>b.id===m?{...b,isPinned:!b.isPinned}:b)}))},G=(m,y="text",b="New Column",p,w)=>{const W={id:`col_${ee().slice(0,4)}`,title:b,type:y,width:"140px",options:p,currency:w};x(Q=>({...Q,groups:Q.groups.map(le=>le.id===m?{...le,columns:[...le.columns,W]}:le)}))},R=(m,y,b)=>{x(p=>({...p,groups:p.groups.map(w=>w.id!==m?w:{...w,columns:w.columns.map(T=>T.id===y?{...T,title:b}:T)})}))},J=(m,y,b)=>{x(p=>({...p,groups:p.groups.map(w=>w.id!==m?w:{...w,columns:w.columns.map(T=>T.id===y?{...T,width:`${b}px`}:T)})}))},oe=(m,y)=>{x(b=>({...b,groups:b.groups.map(p=>p.id!==m?p:{...p,columns:p.columns.filter(w=>w.id!==y)})}))},ne=(m,y)=>{x(b=>({...b,groups:b.groups.map(p=>{if(p.id!==m)return p;const w=p.columns.findIndex(le=>le.id===y);if(w===-1)return p;const T=p.columns[w],W={...T,id:`col_${ee().slice(0,4)}`,title:`${T.title} (Copy)`},Q=[...p.columns];return Q.splice(w+1,0,W),{...p,columns:Q}})}))},l=(m,y,b)=>{x(p=>{const w=p.groups.find(Q=>Q.id===m);if(!w)return p;const T=[...w.columns],[W]=T.splice(y,1);return T.splice(b,0,W),{...p,groups:p.groups.map(Q=>Q.id!==m?Q:{...Q,columns:T})}})};return{board:c,setBoard:x,aiPrompt:s,setAiPrompt:i,isAiLoading:I,aiAnalysis:v,setAiAnalysis:k,updateTask:u,toggleTaskSelection:g,toggleGroupSelection:E,updateTaskTextValue:o,addTask:$,deleteTask:P,addGroup:h,deleteGroup:L,updateGroupTitle:Y,toggleGroupPin:O,addColumn:G,updateColumnTitle:R,updateColumnWidth:J,deleteColumn:oe,duplicateColumn:ne,moveColumn:l,reorderColumn:(m,y,b)=>{l(m,y,b)},handleGeneratePlan:async()=>{if(!s.trim())return;A(!0),k(null);const m=await Cr();if(m){const y=new Date,b=m.tasks.map(w=>{const T=new Date(y);return T.setDate(y.getDate()+w.dueDateOffsetDays),{id:ee(),name:w.name,status:z.New,priority:w.priority||K.Medium,dueDate:T.toISOString().split("T")[0],personId:null,textValues:{}}}),p={id:ee(),title:m.groupName||"AI Generated Plan",color:Le[Math.floor(Math.random()*Le.length)],tasks:b,columns:[{id:"col_name",title:"Item",type:"name",width:"300px"},{id:"col_person",title:"Owner",type:"person",width:"96px"},{id:"col_status",title:"Status",type:"status",width:"128px"},{id:"col_priority",title:"Priority",type:"priority",width:"128px"},{id:"col_date",title:"Due Date",type:"date",width:"110px"}]};x(w=>({...w,groups:[p,...w.groups]})),i("")}A(!1)},handleAnalyzeBoard:async()=>{A(!0),c.groups.map(y=>`Group: ${y.title}. Tasks: ${y.tasks.map(b=>`${b.name} (${b.status})`).join(", ")}`).join(`
`);const m=await $r();k(m),A(!1)}}},Dr=({x:r,y:c,onClose:x,onAction:s,darkMode:i})=>{let v=r,k=c;typeof window<"u"&&(r+256>window.innerWidth&&(v=r-256),c+400>window.innerHeight&&(k=c-400));const u={top:k,left:v},g=o=>{s(o),x()},{ref:E}=xe({onCancel:x,initialActive:!0});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-50 bg-transparent",onClick:x,onContextMenu:o=>{o.preventDefault(),x()}}),e.jsx("div",{ref:E,className:`fixed z-50 rounded-lg shadow-xl border w-64 py-2 animate-in fade-in zoom-in-95 duration-100 ${i?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,style:u,onClick:o=>o.stopPropagation(),children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("button",{onClick:()=>g("sort_asc"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(Zs,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Sort ascending"})]}),e.jsxs("button",{onClick:()=>g("sort_desc"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(rr,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Sort descending"})]}),e.jsxs("button",{onClick:()=>g("group"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(ls,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Group by this field"})]}),e.jsx("div",{className:`h-px my-1 ${i?"bg-gray-700":"bg-gray-100"}`}),e.jsxs("button",{onClick:()=>g("rename"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(Ss,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Edit field"})]}),e.jsxs("button",{onClick:()=>g("permissions"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(cs,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Privacy and permissions"})]}),e.jsx("div",{className:`h-px my-1 ${i?"bg-gray-700":"bg-gray-100"}`}),e.jsxs("button",{onClick:()=>g("move_start"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(Ms,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Move to start"})]}),e.jsxs("button",{onClick:()=>g("move_end"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(tr,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Move to end"})]}),e.jsxs("button",{onClick:()=>g("automate"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(ds,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Automate"})]}),e.jsx("div",{className:`h-px my-1 ${i?"bg-gray-700":"bg-gray-100"}`}),e.jsxs("button",{onClick:()=>g("hide"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(xs,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Hide column"})]}),e.jsxs("button",{onClick:()=>g("duplicate"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(Ct,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Duplicate"})]}),e.jsxs("button",{onClick:()=>g("delete"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-red-400":"hover:bg-red-50 text-red-600"}`,children:[e.jsx(Ue,{size:16,className:"text-red-500"}),e.jsx("span",{children:"Delete field"})]})]})})]})},kr=({isOpen:r,onClose:c,group:x,darkMode:s})=>{const[i,I]=C.useState(new Set);if(!r)return null;const A=u=>{const g=new Set(i);g.has(u)?g.delete(u):g.add(u),I(g)},v=()=>{const u=x.tasks.filter(g=>i.has(g.id));u.length!==0&&(zs.addReminder({title:x.title||"Untitled Group",listId:"inbox",priority:"medium",dueDate:void 0,tags:[],completed:!1,subtasks:u.map(g=>({id:ee(),title:g.textValues.col_name||g.name||"Untitled Task",completed:g.status==="Done"}))}),c(),I(new Set))},k=()=>{i.size===x.tasks.length?I(new Set):I(new Set(x.tasks.map(u=>u.id)))};return e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsxs("div",{className:`backdrop-blur-xl rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden animate-in zoom-in-95 duration-300 border ring-1 ring-black/5 flex flex-col max-h-[85vh] ${s?"bg-[#1a1d24]/95 border-gray-700":"bg-white/95 border-white/20"}`,children:[e.jsxs("div",{className:`px-6 py-5 border-b flex items-center justify-between ${s?"border-gray-700 bg-gradient-to-r from-gray-800/50 to-[#1a1d24]":"border-gray-100 bg-gradient-to-r from-gray-50/50 to-white"}`,children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-xl font-bold tracking-tight ${s?"text-gray-100":"text-gray-900"}`,children:"Send to Reminders"}),e.jsxs("p",{className:`text-sm mt-0.5 ${s?"text-gray-400":"text-gray-500"}`,children:["Select tasks from ",e.jsx("span",{className:`font-semibold ${s?"text-gray-300":"text-gray-700"}`,children:x.title})]})]}),e.jsx("button",{onClick:c,className:`p-2 rounded-full transition-all duration-200 active:scale-95 ${s?"hover:bg-white/10 text-gray-400 hover:text-gray-200":"hover:bg-gray-100 text-gray-400 hover:text-gray-600"}`,children:e.jsx(De,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-0",children:x.tasks.length===0?e.jsxs("div",{className:`text-center py-16 flex flex-col items-center gap-3 ${s?"text-gray-500":"text-gray-400"}`,children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${s?"bg-gray-800":"bg-gray-50"}`,children:e.jsx(Se,{size:24,className:`${s?"text-gray-600":"text-gray-300"}`})}),e.jsx("p",{className:"font-medium",children:"No tasks in this group"})]}):e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:`backdrop-blur-md sticky top-0 z-10 shadow-sm ${s?"bg-gray-800/80":"bg-gray-50/80"}`,children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-6 py-3.5 border-b w-[50px] ${s?"border-gray-700/80":"border-gray-200/80"}`,children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("input",{type:"checkbox",checked:i.size===x.tasks.length&&x.tasks.length>0,onChange:k,className:`rounded-md focus:ring-indigo-500/20 transition-all cursor-pointer ${s?"bg-gray-700 border-gray-600 text-indigo-500":"border-gray-300 text-indigo-600"}`})})}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Task Name"}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b text-center w-[120px] ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Priority"}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b w-[140px] ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Due Date"})]})}),e.jsx("tbody",{className:`divide-y ${s?"divide-gray-800":"divide-gray-100"}`,children:x.tasks.map(u=>{const g=i.has(u.id),E=u.textValues.col_name||u.name||"Untitled Task";return e.jsxs("tr",{onClick:()=>A(u.id),className:`cursor-pointer transition-all duration-200 group ${g?s?"bg-indigo-900/20":"bg-indigo-50/60":s?"hover:bg-white/5":"hover:bg-gray-50/80"}`,children:[e.jsx("td",{className:"px-6 py-3.5 w-[50px]",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("input",{type:"checkbox",checked:g,onChange:()=>A(u.id),onClick:o=>o.stopPropagation(),className:`rounded-md focus:ring-indigo-500/20 transition-all cursor-pointer ${s?"bg-gray-700 border-gray-600 text-indigo-500":"border-gray-300 text-indigo-600"}`})})}),e.jsx("td",{className:"px-4 py-3.5",children:e.jsx("span",{className:`text-sm font-medium truncate block max-w-[320px] transition-colors ${g?s?"text-indigo-300":"text-indigo-900":s?"text-gray-300 group-hover:text-white":"text-gray-700 group-hover:text-gray-900"}`,children:E})}),e.jsx("td",{className:"px-4 py-3.5 text-center w-[120px]",children:e.jsx("div",{className:"flex justify-center transform transition-transform group-hover:scale-105",children:e.jsx("span",{className:`text-[11px] px-2.5 py-1 rounded-full text-white font-semibold shadow-sm tracking-wide ${ke[u.priority]||"bg-gray-400"}`,children:u.priority})})}),e.jsx("td",{className:"px-4 py-3.5 w-[140px]",children:e.jsx("span",{className:`text-sm font-mono transition-colors ${u.dueDate?s?"text-gray-400":"text-gray-600":s?"text-gray-600":"text-gray-300"}`,children:u.dueDate||"-"})})]},u.id)})})]})}),e.jsxs("div",{className:`px-6 py-4 border-t backdrop-blur-sm flex justify-end gap-3 ${s?"bg-gray-800/50 border-gray-700":"bg-gray-50/50 border-gray-100"}`,children:[e.jsx("button",{onClick:c,className:`px-5 py-2.5 text-sm font-medium rounded-xl transition-all duration-200 active:scale-95 ${s?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-600 hover:text-gray-900 hover:bg-gray-200/50"}`,children:"Cancel"}),e.jsxs("button",{onClick:v,disabled:i.size===0,className:"px-6 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 active:scale-95 rounded-xl shadow-lg shadow-blue-500/25 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none flex items-center gap-2",children:[e.jsx(Se,{size:16,strokeWidth:2.5}),e.jsx("span",{children:"Send Tasks"}),i.size>0&&e.jsx("span",{className:"bg-white/20 px-1.5 py-0.5 rounded text-xs font-bold ml-1",children:i.size})]})]})]})})},zr=[{id:"1",title:"Scale Revenue to $10M ARR",progress:65,status:"on-track",expanded:!0,keyResults:[{id:"kr1",title:"Close 5 Enterprise Deals",current:3,target:5,unit:"deals",confidence:"high",owner:"Sales"},{id:"kr2",title:"Reduce Churn to < 2%",current:2.4,target:2,unit:"%",confidence:"medium",owner:"Success"},{id:"kr3",title:"Launch Self-Serve Plan",current:80,target:100,unit:"%",confidence:"high",owner:"Product"}]},{id:"2",title:"Become the #1 Rated App in Category",progress:42,status:"at-risk",expanded:!0,keyResults:[{id:"kr4",title:"Achieve NPS of 70+",current:58,target:70,unit:"score",confidence:"low",owner:"Product"},{id:"kr5",title:"Reduce App Load Time to 500ms",current:800,target:500,unit:"ms",confidence:"medium",owner:"Eng"}]},{id:"3",title:"Build a World-Class Team",progress:88,status:"on-track",expanded:!1,keyResults:[{id:"kr6",title:"Hire 5 Senior Engineers",current:4,target:5,unit:"hires",confidence:"high",owner:"HR"},{id:"kr7",title:"Launch Internal Training Academy",current:100,target:100,unit:"%",confidence:"high",owner:"HR"}]}];class Ir{constructor(){this.objectives=zr,this.listeners=[]}getObjectives(){return this.objectives}addObjective(c){const x={...c,id:ee()};return this.objectives=[x,...this.objectives],this.notify(),x}updateObjective(c,x){this.objectives=this.objectives.map(s=>s.id===c?{...s,...x}:s),this.notify()}deleteObjective(c){this.objectives=this.objectives.filter(x=>x.id!==c),this.notify()}subscribe(c){return this.listeners.push(c),()=>{this.listeners=this.listeners.filter(x=>x!==c)}}notify(){this.listeners.forEach(c=>c())}}const Ar=new Ir,Pr=({isOpen:r,onClose:c,group:x,darkMode:s})=>{const[i,I]=C.useState(new Set);if(!r)return null;const A=u=>{const g=new Set(i);g.has(u)?g.delete(u):g.add(u),I(g)},v=()=>{const u=x.tasks.filter(g=>i.has(g.id));u.length!==0&&(Ar.addObjective({title:x.title||"Untitled Objective",progress:0,status:"on-track",expanded:!0,keyResults:u.map(g=>({id:ee(),title:g.textValues.col_name||g.name||"Untitled Key Result",current:g.status==="Done"?100:0,target:100,unit:"%",confidence:"medium",owner:"Unassigned"}))}),c(),I(new Set))},k=()=>{i.size===x.tasks.length?I(new Set):I(new Set(x.tasks.map(u=>u.id)))};return e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsxs("div",{className:`backdrop-blur-xl rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden animate-in zoom-in-95 duration-300 border ring-1 ring-black/5 flex flex-col max-h-[85vh] ${s?"bg-[#1a1d24]/95 border-gray-700":"bg-white/95 border-white/20"}`,children:[e.jsxs("div",{className:`px-6 py-5 border-b flex items-center justify-between ${s?"border-gray-700 bg-gradient-to-r from-gray-800/50 to-[#1a1d24]":"border-gray-100 bg-gradient-to-r from-gray-50/50 to-white"}`,children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-xl font-bold tracking-tight ${s?"text-gray-100":"text-gray-900"}`,children:"Send to Goals"}),e.jsxs("p",{className:`text-sm mt-0.5 ${s?"text-gray-400":"text-gray-500"}`,children:["Select tasks from ",e.jsx("span",{className:`font-semibold ${s?"text-gray-300":"text-gray-700"}`,children:x.title})]})]}),e.jsx("button",{onClick:c,className:`p-2 rounded-full transition-all duration-200 active:scale-95 ${s?"hover:bg-white/10 text-gray-400 hover:text-gray-200":"hover:bg-gray-100 text-gray-400 hover:text-gray-600"}`,children:e.jsx(De,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-0",children:x.tasks.length===0?e.jsxs("div",{className:`text-center py-16 flex flex-col items-center gap-3 ${s?"text-gray-500":"text-gray-400"}`,children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${s?"bg-gray-800":"bg-gray-50"}`,children:e.jsx(Se,{size:24,className:`${s?"text-gray-600":"text-gray-300"}`})}),e.jsx("p",{className:"font-medium",children:"No tasks in this group"})]}):e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:`backdrop-blur-md sticky top-0 z-10 shadow-sm ${s?"bg-gray-800/80":"bg-gray-50/80"}`,children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-6 py-3.5 border-b w-[50px] ${s?"border-gray-700/80":"border-gray-200/80"}`,children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("input",{type:"checkbox",checked:i.size===x.tasks.length&&x.tasks.length>0,onChange:k,className:`rounded-md focus:ring-indigo-500/20 transition-all cursor-pointer ${s?"bg-gray-700 border-gray-600 text-indigo-500":"border-gray-300 text-indigo-600"}`})})}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Task Name"}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b text-center w-[120px] ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Priority"}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b w-[140px] ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Due Date"})]})}),e.jsx("tbody",{className:`divide-y ${s?"divide-gray-800":"divide-gray-100"}`,children:x.tasks.map(u=>{const g=i.has(u.id),E=u.textValues.col_name||u.name||"Untitled Task";return e.jsxs("tr",{onClick:()=>A(u.id),className:`cursor-pointer transition-all duration-200 group ${g?s?"bg-indigo-900/20":"bg-indigo-50/60":s?"hover:bg-white/5":"hover:bg-gray-50/80"}`,children:[e.jsx("td",{className:"px-6 py-3.5 w-[50px]",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("input",{type:"checkbox",checked:g,onChange:()=>A(u.id),onClick:o=>o.stopPropagation(),className:`rounded-md focus:ring-indigo-500/20 transition-all cursor-pointer ${s?"bg-gray-700 border-gray-600 text-indigo-500":"border-gray-300 text-indigo-600"}`})})}),e.jsx("td",{className:"px-4 py-3.5",children:e.jsx("span",{className:`text-sm font-medium truncate block max-w-[320px] transition-colors ${g?s?"text-indigo-300":"text-indigo-900":s?"text-gray-300 group-hover:text-white":"text-gray-700 group-hover:text-gray-900"}`,children:E})}),e.jsx("td",{className:"px-4 py-3.5 text-center w-[120px]",children:e.jsx("div",{className:"flex justify-center transform transition-transform group-hover:scale-105",children:e.jsx("span",{className:`text-[11px] px-2.5 py-1 rounded-full text-white font-semibold shadow-sm tracking-wide ${ke[u.priority]||"bg-gray-400"}`,children:u.priority})})}),e.jsx("td",{className:"px-4 py-3.5 w-[140px]",children:e.jsx("span",{className:`text-sm font-mono transition-colors ${u.dueDate?s?"text-gray-400":"text-gray-600":s?"text-gray-600":"text-gray-300"}`,children:u.dueDate||"-"})})]},u.id)})})]})}),e.jsxs("div",{className:`px-6 py-4 border-t backdrop-blur-sm flex justify-end gap-3 ${s?"bg-gray-800/50 border-gray-700":"bg-gray-50/50 border-gray-100"}`,children:[e.jsx("button",{onClick:c,className:`px-5 py-2.5 text-sm font-medium rounded-xl transition-all duration-200 active:scale-95 ${s?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-600 hover:text-gray-900 hover:bg-gray-200/50"}`,children:"Cancel"}),e.jsxs("button",{onClick:v,disabled:i.size===0,className:"px-6 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 active:scale-95 rounded-xl shadow-lg shadow-blue-500/25 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none flex items-center gap-2",children:[e.jsx(yt,{size:16,strokeWidth:2.5}),e.jsx("span",{children:"Send to Goals"}),i.size>0&&e.jsx("span",{className:"bg-white/20 px-1.5 py-0.5 rounded text-xs font-bold ml-1",children:i.size})]})]})]})})},Tr=({isOpen:r,onClose:c,group:x,darkMode:s})=>{const[i,I]=C.useState(new Set),A=ft.getCurrentUser(),v=A?`taskboard-${A.id}`:"taskboard-default",{showToast:k}=us(),u=P=>{const h=new Set(i);h.has(P)?h.delete(P):h.add(P),I(h)},g=()=>{const P=x.tasks.filter(h=>i.has(h.id));if(P.length!==0)try{const h=localStorage.getItem(v);let L;h?(L=JSON.parse(h),L.groups||(L={...$e,...L})):L=$e;const Y={id:ee(),title:x.title||"Imported Group",color:x.color,columns:[...x.columns],tasks:P.map(G=>({...G,id:ee()})),isPinned:!1},O={...L,groups:[Y,...L.groups||[]]};localStorage.setItem(v,JSON.stringify(O)),k(`Successfully sent ${P.length} tasks to your Tasks Board`,"success"),c(),I(new Set)}catch(h){console.error("Failed to send tasks:",h),k("Failed to send tasks. Please try again.","error")}},E=()=>{i.size===x.tasks.length?I(new Set):I(new Set(x.tasks.map(P=>P.id)))},{ref:o,setIsActive:$}=xe({onConfirm:g,onCancel:c,initialActive:r});return C.useEffect(()=>{$(r)},[r,$]),r?e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsxs("div",{ref:o,className:`backdrop-blur-xl rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden animate-in zoom-in-95 duration-300 border ring-1 ring-black/5 flex flex-col max-h-[85vh] ${s?"bg-[#1a1d24]/95 border-gray-700":"bg-white/95 border-white/20"}`,children:[e.jsxs("div",{className:`px-6 py-5 border-b flex items-center justify-between ${s?"border-gray-700 bg-gradient-to-r from-gray-800/50 to-[#1a1d24]":"border-gray-100 bg-gradient-to-r from-gray-50/50 to-white"}`,children:[e.jsxs("div",{children:[e.jsxs("h2",{className:`text-xl font-bold tracking-tight flex items-center gap-2 ${s?"text-gray-100":"text-gray-900"}`,children:[e.jsx(bt,{className:"text-blue-600",size:24}),"Send to Tasks Board"]}),e.jsxs("p",{className:`text-sm mt-0.5 ${s?"text-gray-400":"text-gray-500"}`,children:["Select tasks from ",e.jsx("span",{className:`font-semibold ${s?"text-gray-300":"text-gray-700"}`,children:x.title})," to copy to your personal Tasks."]})]}),e.jsx("button",{onClick:c,className:`p-2 rounded-full transition-all duration-200 active:scale-95 ${s?"hover:bg-white/10 text-gray-400 hover:text-gray-200":"hover:bg-gray-100 text-gray-400 hover:text-gray-600"}`,children:e.jsx(De,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-0",children:x.tasks.length===0?e.jsxs("div",{className:`text-center py-16 flex flex-col items-center gap-3 ${s?"text-gray-500":"text-gray-400"}`,children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${s?"bg-gray-800":"bg-gray-50"}`,children:e.jsx(Se,{size:24,className:`${s?"text-gray-600":"text-gray-300"}`})}),e.jsx("p",{className:"font-medium",children:"No tasks in this group"})]}):e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:`backdrop-blur-md sticky top-0 z-10 shadow-sm ${s?"bg-gray-800/80":"bg-gray-50/80"}`,children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-6 py-3.5 border-b w-[50px] ${s?"border-gray-700/80":"border-gray-200/80"}`,children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("input",{type:"checkbox",checked:i.size===x.tasks.length&&x.tasks.length>0,onChange:E,className:`rounded-md focus:ring-indigo-500/20 transition-all cursor-pointer ${s?"bg-gray-700 border-gray-600 text-indigo-500":"border-gray-300 text-indigo-600"}`})})}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Task Name"}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b text-center w-[120px] ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Priority"}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b w-[140px] ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Due Date"})]})}),e.jsx("tbody",{className:`divide-y ${s?"divide-gray-800":"divide-gray-100"}`,children:x.tasks.map(P=>{const h=i.has(P.id),L=P.textValues.col_name||P.name||"Untitled Task";return e.jsxs("tr",{onClick:()=>u(P.id),className:`cursor-pointer transition-all duration-200 group ${h?s?"bg-indigo-900/20":"bg-indigo-50/60":s?"hover:bg-white/5":"hover:bg-gray-50/80"}`,children:[e.jsx("td",{className:"px-6 py-3.5 w-[50px]",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("input",{type:"checkbox",checked:h,onChange:()=>u(P.id),onClick:Y=>Y.stopPropagation(),className:`rounded-md focus:ring-indigo-500/20 transition-all cursor-pointer ${s?"bg-gray-700 border-gray-600 text-indigo-500":"border-gray-300 text-indigo-600"}`})})}),e.jsx("td",{className:"px-4 py-3.5",children:e.jsx("span",{className:`text-sm font-medium truncate block max-w-[320px] transition-colors ${h?s?"text-indigo-300":"text-indigo-900":s?"text-gray-300 group-hover:text-white":"text-gray-700 group-hover:text-gray-900"}`,children:L})}),e.jsx("td",{className:"px-4 py-3.5 text-center w-[120px]",children:e.jsx("div",{className:"flex justify-center transform transition-transform group-hover:scale-105",children:e.jsx("span",{className:`text-[11px] px-2.5 py-1 rounded-full text-white font-semibold shadow-sm tracking-wide ${ke[P.priority]||"bg-gray-400"}`,children:P.priority})})}),e.jsx("td",{className:"px-4 py-3.5 w-[140px]",children:e.jsx("span",{className:`text-sm font-mono transition-colors ${P.dueDate?s?"text-gray-400":"text-gray-600":s?"text-gray-600":"text-gray-300"}`,children:P.dueDate||"-"})})]},P.id)})})]})}),e.jsxs("div",{className:`px-6 py-4 border-t backdrop-blur-sm flex justify-end gap-3 ${s?"bg-gray-800/50 border-gray-700":"bg-gray-50/50 border-gray-100"}`,children:[e.jsx("button",{onClick:c,className:`px-5 py-2.5 text-sm font-medium rounded-xl transition-all duration-200 active:scale-95 ${s?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-600 hover:text-gray-900 hover:bg-gray-200/50"}`,children:"Cancel"}),e.jsxs("button",{onClick:g,disabled:i.size===0,className:"px-6 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 active:scale-95 rounded-xl shadow-lg shadow-blue-500/25 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none flex items-center gap-2",children:[e.jsx(Se,{size:16,strokeWidth:2.5}),e.jsx("span",{children:"Send Tasks"}),i.size>0&&e.jsx("span",{className:"bg-white/20 px-1.5 py-0.5 rounded text-xs font-bold ml-1",children:i.size})]})]})]})}):null},zt=({status:r,onChange:c,tabIndex:x,darkMode:s})=>{const[i,I]=C.useState({top:0,left:0,width:0}),{ref:A,isActive:v,setIsActive:k,startAction:u}=xe({onCancel:()=>k(!1)}),g=o=>{if(o.stopPropagation(),v){k(!1);return}const $=o.currentTarget.getBoundingClientRect(),P=250,L=window.innerHeight-$.bottom<P;I({top:L?$.top+window.scrollY-P-4:$.bottom+window.scrollY+4,left:$.left+window.scrollX,width:$.width}),u()},E=o=>s?jr[o]||"bg-gray-800 text-gray-400":kt[o]||"bg-gray-100 text-gray-400";return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"relative w-full h-full",children:e.jsxs("div",{onClick:g,onKeyDown:o=>{(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),g(o))},tabIndex:x,className:`w-full h-full flex items-center justify-center cursor-pointer transition-all duration-200 text-xs font-medium relative group focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-inset rounded-sm ${E(r)}`,children:[e.jsx("div",{className:"absolute right-0 bottom-0 w-3 h-3 bg-black/10 opacity-0 group-hover:opacity-100 clip-triangle transition-opacity"}),e.jsx("span",{className:"truncate px-1",children:r||e.jsx("span",{className:"opacity-0 group-hover:opacity-100 text-[10px] uppercase",children:"Set Status"})})]})}),v&&me.createPortal(e.jsx("div",{ref:A,className:`fixed z-[10000] shadow-2xl rounded-lg border p-1.5 overflow-hidden animate-in fade-in zoom-in-95 duration-100 flex flex-col gap-1 ${s?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,style:{top:i.top+4,left:i.left-(160-i.width)/2,width:"160px"},onMouseDown:o=>o.stopPropagation(),children:Object.values(z).map(o=>e.jsx("div",{onClick:$=>{$.stopPropagation(),c(o),k(!1)},className:`px-3 py-2.5 text-xs cursor-pointer hover:brightness-95 rounded-sm text-center font-medium transition-all shadow-sm ${E(o)}`,children:o||"Empty"},o))}),document.body)]})},It=({priority:r,onChange:c,tabIndex:x,darkMode:s})=>{const[i,I]=C.useState({top:0,left:0,width:0}),{ref:A,isActive:v,setIsActive:k,startAction:u}=xe({onCancel:()=>k(!1)}),g=o=>{if(o.stopPropagation(),v){k(!1);return}const $=o.currentTarget.getBoundingClientRect(),P=200,L=window.innerHeight-$.bottom<P;I({top:L?$.top+window.scrollY-P-4:$.bottom+window.scrollY+4,left:$.left+window.scrollX,width:$.width}),u()},E=o=>s?Nr[o]||"bg-gray-800 text-gray-400":ke[o]||"bg-gray-100 text-gray-400";return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"relative w-full h-full",children:e.jsxs("div",{onClick:g,onKeyDown:o=>{(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),g(o))},tabIndex:x,className:`w-full h-full flex items-center justify-center cursor-pointer transition-all duration-200 text-xs font-medium relative group focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-inset rounded-sm ${E(r)}`,children:[e.jsx("div",{className:"absolute right-0 bottom-0 w-3 h-3 bg-black/10 opacity-0 group-hover:opacity-100 clip-triangle transition-opacity"}),e.jsx("span",{className:"truncate px-1",children:r||e.jsx("span",{className:"opacity-0 group-hover:opacity-100 text-[10px] uppercase",children:"Set"})})]})}),v&&me.createPortal(e.jsx("div",{ref:A,className:`fixed z-[10000] shadow-2xl rounded-lg border p-1.5 animate-in fade-in zoom-in-95 duration-100 flex flex-col gap-1 ${s?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,style:{top:i.top+4,left:i.left-(140-i.width)/2,width:"140px"},onMouseDown:o=>o.stopPropagation(),children:Object.values(K).map(o=>e.jsx("div",{onClick:$=>{$.stopPropagation(),c(o),k(!1)},className:`px-2 py-2 text-xs cursor-pointer hover:brightness-90 rounded-sm text-center font-medium transition-all shadow-sm ${E(o)}`,children:o||"Empty"},o))}),document.body)]})},At=({personId:r,onChange:c,tabIndex:x,darkMode:s})=>{const[i,I]=C.useState({top:0,left:0}),A=mt.find(o=>o.id===r),{ref:v,isActive:k,setIsActive:u,startAction:g}=xe({onCancel:()=>u(!1)}),E=o=>{if(o.stopPropagation(),k){u(!1);return}const $=o.currentTarget.getBoundingClientRect(),P=250,L=window.innerHeight-$.bottom<P;I({top:L?$.top+window.scrollY-P-5:$.bottom+window.scrollY+5,left:$.left+window.scrollX-90}),g()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"relative w-full h-full flex justify-center items-center group",children:e.jsxs("div",{onClick:E,onKeyDown:o=>{(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),E(o))},tabIndex:x,className:"cursor-pointer hover:scale-110 transition-transform duration-200 active:scale-95 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-full",children:[A?e.jsx("div",{className:"w-6 h-6 rounded-full text-white text-[9px] flex items-center justify-center font-bold ring-2 shadow-md "+A.color+(s?" ring-[#1a1d24]":" ring-white"),title:A.name,children:A.initials}):e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center border border-dashed transition-all shadow-sm ${s?"bg-gray-800 text-gray-500 border-gray-700 hover:border-gray-500 hover:bg-gray-700":"bg-gray-100 text-gray-400 hover:bg-gray-200 border-gray-300 hover:border-gray-400"}`,children:e.jsx(wt,{size:12,strokeWidth:2.5})}),!A&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 pointer-events-none",children:e.jsx("div",{className:"w-6 h-6 rounded-full bg-black/5 flex items-center justify-center backdrop-blur-[1px]",children:e.jsx(vt,{size:12,className:"text-black/60",strokeWidth:3})})})]})}),k&&me.createPortal(e.jsxs("div",{ref:v,className:`fixed z-[10000] shadow-2xl rounded-xl border p-2 animate-in fade-in zoom-in-95 duration-100 flex flex-col gap-1 min-w-[180px] ${s?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,style:{top:i.top,left:i.left},onMouseDown:o=>o.stopPropagation(),children:[e.jsx("div",{className:`text-xs font-semibold mb-1 px-2 uppercase tracking-wider py-1 ${s?"text-gray-500":"text-gray-400"}`,children:"Select Person"}),mt.map(o=>e.jsxs("div",{onClick:$=>{$.stopPropagation(),c(o.id),u(!1)},className:`flex items-center gap-3 px-3 py-2 rounded-lg cursor-pointer transition-colors ${s?r===o.id?"bg-blue-500/20":"hover:bg-white/5":r===o.id?"bg-blue-50":"hover:bg-blue-50"}`,children:[e.jsx("div",{className:"w-6 h-6 rounded-full text-white text-[10px] flex items-center justify-center font-bold "+o.color,children:o.initials}),e.jsx("span",{className:`text-sm font-medium ${s?"text-gray-200":"text-gray-700"}`,children:o.name}),r===o.id&&e.jsx("span",{className:"ml-auto text-blue-500",children:"✓"})]},o.id)),e.jsx("div",{className:`border-t my-1 ${s?"border-gray-700":"border-gray-100"}`}),e.jsxs("div",{onClick:o=>{o.stopPropagation(),c(null),u(!1)},className:`px-3 py-2 text-sm rounded-lg cursor-pointer flex items-center gap-2 transition-colors ${s?"hover:bg-red-500/20 text-red-400":"hover:bg-red-50 text-red-500"}`,children:[e.jsx("span",{className:"w-4 h-4 flex items-center justify-center text-xs",children:"✕"}),"Clear Selection"]})]}),document.body)]})},_r=[{id:"text",label:"Normal text",icon:e.jsx(Ds,{size:18,className:"text-gray-500"})},{id:"h1",label:"Heading 1",icon:e.jsx(ar,{size:18,className:"text-gray-500"})},{id:"h2",label:"Heading 2",icon:e.jsx(or,{size:18,className:"text-gray-500"})},{id:"h3",label:"Heading 3",icon:e.jsx(cr,{size:18,className:"text-gray-500"})},{id:"h4",label:"Heading 4",icon:e.jsx(xr,{size:18,className:"text-gray-500"})},{id:"checklist",label:"Checklist",icon:e.jsx(As,{size:18,className:"text-gray-500"})},{id:"bulletList",label:"Bulleted list",icon:e.jsx(Ps,{size:18,className:"text-gray-500"})},{id:"orderedList",label:"Numbered list",icon:e.jsx(Ts,{size:18,className:"text-gray-500"})},{id:"toggle",label:"Toggle list",icon:e.jsx(vr,{size:18,className:"text-gray-500"})},{id:"banner",label:"Banners",icon:e.jsx($t,{size:18,className:"text-gray-500"})},{id:"code",label:"Code block",icon:e.jsx(gs,{size:18,className:"text-gray-500"})},{id:"quote",label:"Block quote",icon:e.jsx(br,{size:18,className:"text-gray-500"})},{id:"pullQuote",label:"Pull quote",icon:e.jsx(hr,{size:18,className:"text-gray-500"})}],Er=({search:r,onSelect:c,onClose:x,position:s,darkMode:i})=>{const[I,A]=C.useState(0),{ref:v}=xe({onCancel:x,initialActive:!0}),k=_r.filter(u=>u.label.toLowerCase().includes(r.toLowerCase()));return C.useEffect(()=>{A(0)},[r]),C.useEffect(()=>{const u=g=>{g.defaultPrevented||(g.key==="ArrowDown"?(g.preventDefault(),A(E=>(E+1)%k.length)):g.key==="ArrowUp"?(g.preventDefault(),A(E=>(E-1+k.length)%k.length)):g.key==="Enter"&&(g.preventDefault(),k[I]&&c(k[I])))};return document.addEventListener("keydown",u),()=>document.removeEventListener("keydown",u)},[k,I,c]),k.length===0?null:e.jsxs("div",{ref:v,className:`fixed z-[9999] rounded-lg shadow-xl border w-72 max-h-80 overflow-y-auto flex flex-col p-1 animate-in fade-in zoom-in-95 duration-100 ${i?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,style:{top:s.top,left:s.left},children:[e.jsx("div",{className:`px-2 py-1.5 text-xs font-semibold uppercase tracking-wider ${i?"text-gray-500":"text-gray-400"}`,children:"Basic blocks"}),k.map((u,g)=>e.jsxs("div",{className:`flex items-center gap-3 px-2 py-1.5 rounded-md cursor-pointer transition-colors ${g===I?i?"bg-white/10":"bg-gray-100":i?"hover:bg-white/5":"hover:bg-gray-50"}`,onClick:()=>c(u),onMouseEnter:()=>A(g),children:[e.jsx("div",{className:`w-10 h-10 rounded border flex items-center justify-center shadow-sm ${i?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:u.icon}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`text-sm font-medium ${i?"text-gray-200":"text-gray-700"}`,children:u.label}),u.description&&e.jsx("span",{className:"text-xs text-gray-400",children:u.description})]})]},u.id))]})},Lr=({value:r,onChange:c,onClose:x,title:s="Edit Text",darkMode:i})=>{const[I,A]=C.useState(r),[v,k]=C.useState(!1),[u,g]=C.useState({top:0,left:0}),[E,o]=C.useState(""),$=C.useRef(null),{ref:P,setIsActive:h}=xe({onCancel:x,initialActive:!0});C.useEffect(()=>{h(!v)},[v,h]),C.useEffect(()=>{$.current&&($.current.focus(),$.current.setSelectionRange($.current.value.length,$.current.value.length))},[]);const L=G=>{var R;if(v){if(G.key==="ArrowUp"||G.key==="ArrowDown"||G.key==="Enter"){G.key==="Enter"&&G.preventDefault();return}if(G.key==="Escape"){k(!1);return}}if(G.key==="/"&&!v){const J=(R=$.current)==null?void 0:R.getBoundingClientRect();J&&(g({top:J.top+40,left:J.left+20}),k(!0),o(""))}},Y=G=>{const R=G.target.value;if(A(R),c(R),v){const J=R.lastIndexOf("/");J===-1?k(!1):o(R.slice(J+1))}},O=G=>{var J;let R="";switch(G.id){case"h1":R="# ";break;case"h2":R="## ";break;case"h3":R="### ";break;case"checklist":R="- [ ] ";break;case"bulletList":R="- ";break;case"orderedList":R="1. ";break;case"quote":R="> ";break;case"code":R="```\n\n```";break;default:R=""}if(R){const oe=I.lastIndexOf("/"),ne=I.substring(0,oe)+R+I.substring(oe+1+E.length);A(ne),c(ne)}k(!1),(J=$.current)==null||J.focus()};return me.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:[e.jsxs("div",{ref:P,className:`rounded-xl shadow-2xl w-[800px] h-[600px] flex flex-col overflow-hidden animate-in zoom-in-95 duration-200 border ${i?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:`flex items-center justify-between px-4 py-3 border-b ${i?"border-gray-700 bg-[#1a1d24]":"border-gray-100 bg-gray-50/50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Dt,{size:16,className:`${i?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:`text-sm font-semibold ${i?"text-gray-200":"text-gray-700"}`,children:s})]}),e.jsx("button",{onClick:x,className:`p-1.5 rounded-md transition-colors ${i?"hover:bg-white/5 text-gray-400 hover:text-gray-200":"hover:bg-gray-200 text-gray-400 hover:text-gray-600"}`,children:e.jsx(De,{size:18})})]}),e.jsxs("div",{className:`flex-1 relative ${i?"bg-[#1a1d24]":"bg-white"}`,children:[e.jsx("textarea",{ref:$,value:I,onChange:Y,onKeyDown:L,className:`w-full h-full p-6 resize-none focus:outline-none text-base leading-relaxed font-mono ${i?"bg-[#1a1d24] text-gray-200 placeholder-gray-600":"text-gray-800 placeholder-gray-300"}`,placeholder:"Write something... Type '/' for commands"}),e.jsx("div",{className:`absolute bottom-4 right-4 text-xs pointer-events-none ${i?"text-gray-600":"text-gray-400"}`,children:"Markdown supported • Type '/' for commands"})]})]}),v&&e.jsx("div",{className:"fixed inset-0 z-[10000] pointer-events-none",children:e.jsx("div",{className:"pointer-events-auto",children:e.jsx(Er,{search:E,onSelect:O,onClose:()=>k(!1),position:u,darkMode:i})})})]}),document.body)},Or=({value:r,onChange:c,tabIndex:x,darkMode:s})=>{const[i,I]=C.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`w-full h-full relative group cursor-pointer transition-colors ${s?"hover:bg-white/5":"hover:bg-gray-50"}`,onClick:()=>I(!0),children:[e.jsx("div",{className:`w-full h-full px-2 py-1.5 text-sm whitespace-nowrap overflow-hidden text-ellipsis focus:outline-none focus:ring-2 focus:ring-blue-500 rounded ${s?"text-gray-300":"text-gray-700"}`,tabIndex:x,children:r||e.jsx("span",{className:`${s?"text-gray-600":"text-gray-400"} italic`,children:"Empty"})}),e.jsx("div",{className:`absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity ${s?"text-gray-500":"text-gray-400"}`,children:e.jsx(Dt,{size:12})})]}),i&&e.jsx(Lr,{value:r,onChange:c,onClose:()=>I(!1),darkMode:s})]})},Rr=({options:r=[],value:c,onChange:x,onClose:s,tabIndex:i,darkMode:I})=>{const[A,v]=C.useState(""),[k,u]=C.useState(null),g=C.useRef(null),{ref:E,isActive:o,setIsActive:$,startAction:P}=xe({onCancel:()=>{$(!1),s==null||s()}}),h=r.find(O=>O.id===c),L=O=>{if(O.stopPropagation(),g.current){const G=g.current.getBoundingClientRect(),R=Math.max(G.width,220),J=G.left+window.scrollX-(R-G.width)/2;u({top:G.bottom+window.scrollY+4,left:J,width:R})}P()},Y=r.filter(O=>O.label.toLowerCase().includes(A.toLowerCase()));return e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:g,onClick:L,onKeyDown:O=>{(O.key==="Enter"||O.key===" ")&&(O.preventDefault(),L(O))},tabIndex:i,className:`w-full h-full flex items-center justify-center cursor-pointer transition-colors px-2 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded ${I?"hover:bg-white/5":"hover:bg-gray-50"}`,children:h?e.jsx("div",{className:"px-3 py-1 rounded-sm text-white text-xs font-medium truncate w-full text-center "+h.color,children:h.label}):e.jsx("span",{className:`${I?"text-gray-500":"text-gray-400"}`,children:"-"})}),o&&k&&me.createPortal(e.jsxs("div",{ref:E,className:`dropdown-portal fixed z-[9999] rounded-lg shadow-2xl border animate-in fade-in zoom-in-95 duration-100 ${I?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-100"}`,style:{top:k.top,left:k.left,width:k.width,minWidth:"220px"},onClick:O=>O.stopPropagation(),children:[e.jsx("div",{className:"p-2",children:e.jsx("input",{type:"text",placeholder:"Search or add options...",value:A,onChange:O=>v(O.target.value),className:`w-full px-3 py-2 border-none rounded-md text-sm focus:ring-2 focus:ring-blue-500/20 ${I?"bg-gray-800 text-gray-200 placeholder-gray-500":"bg-gray-50 text-gray-700 placeholder-gray-400"}`,autoFocus:!0})}),e.jsxs("div",{className:"max-h-[240px] overflow-y-auto custom-scrollbar p-2 space-y-1",children:[e.jsx("div",{onClick:()=>{x(""),$(!1)},className:`flex items-center justify-center px-3 py-2 rounded-sm cursor-pointer border border-dashed transition-all ${I?"hover:bg-white/5 border-gray-700 text-gray-500 hover:text-gray-300 hover:border-gray-500":"hover:bg-gray-50 border-gray-200 text-gray-400 hover:text-gray-600 hover:border-gray-300"}`,children:"-"}),Y.map(O=>e.jsxs("div",{onClick:()=>{x(O.id),$(!1)},className:"flex items-center justify-center relative gap-2 group cursor-pointer",children:[e.jsx("div",{className:`absolute left-2 opacity-0 group-hover:opacity-100 cursor-grab p-1 rounded ${I?"text-gray-500 hover:bg-white/10":"text-gray-300 hover:bg-gray-100"}`,children:e.jsx(_s,{size:14})}),e.jsx("div",{className:"w-[90%] px-3 py-2 rounded-sm text-white text-sm font-medium shadow-sm transition-transform active:scale-[0.98] text-center "+O.color,children:O.label})]},O.id)),Y.length===0&&e.jsx("div",{className:`px-3 py-4 text-center text-xs ${I?"text-gray-500":"text-gray-400"}`,children:"No options found"})]})]}),document.body)]})},pt=({className:r="w-6 h-6"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:r,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),He=({className:r="w-6 h-6"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:r,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"})}),Fr=({task:r,group:c,selectionColumnWidth:x,actionColumnWidth:s,expandedTaskIds:i,toggleTaskSelection:I,updateTask:A,updateTaskTextValue:v,toggleSubtask:k,setActiveDatePicker:u,handleContextMenu:g,deleteTask:E,handleAddSubtask:o,subtaskInput:$,setSubtaskInput:P,darkMode:h=!1})=>{var ne;const{attributes:L,listeners:Y,setNodeRef:O,transform:G,transition:R,isDragging:J}=Ws({id:r.id,data:{type:"TASK",task:r,group:c}}),oe={transform:Gs.Translate.toString(G),transition:R,opacity:J?.3:1,zIndex:J?999:"auto",gridTemplateColumns:x+" "+c.columns.map(l=>l.width).join(" ")+" "+s};return e.jsxs(fs.Fragment,{children:[e.jsxs("div",{ref:O,style:oe,className:`grid gap-px group/row text-sm transition-colors relative ${J?"z-50 shadow-xl ring-2 ring-blue-500/20":""} ${h?"bg-[#1a1d24] hover:bg-white/5":"bg-white hover:bg-gray-50/50"}`,children:[e.jsxs("div",{className:`flex items-center justify-center py-1.5 border-r relative transition-colors sticky left-0 z-10 border-r-2 ${h?"bg-[#1a1d24] border-gray-800 border-r-gray-800 group-hover/row:bg-white/5":"bg-white border-gray-100 border-r-gray-200/50 hover:bg-gray-50"}`,children:[e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1.5",style:{backgroundColor:c.color}}),e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-gray-300",checked:!!r.selected,onChange:l=>I(c.id,r.id,l.target.checked),onClick:l=>l.stopPropagation(),onMouseDown:l=>l.stopPropagation()})]}),c.columns.map(l=>{var ae;const re=l.type==="name";return e.jsxs("div",{className:`relative border-r flex items-center ${re?"justify-start pl-2 sticky left-[50px] z-10 border-r-2":"justify-center"} min-h-[32px] transition-colors ${h?"bg-[#1a1d24] border-gray-800 border-r-gray-800 group-hover/row:bg-white/5 text-gray-300":"bg-white border-gray-100 border-r-gray-200/50 group-hover/row:bg-[#f8f9fa]"}`,children:[re&&e.jsx("div",{className:"cursor-grab active:cursor-grabbing text-gray-400 mr-2 hover:text-gray-600 p-2 hover:bg-gray-100 rounded",...Y,...L,style:{touchAction:"none"},children:e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"9",cy:"12",r:"1"}),e.jsx("circle",{cx:"9",cy:"5",r:"1"}),e.jsx("circle",{cx:"9",cy:"19",r:"1"}),e.jsx("circle",{cx:"15",cy:"12",r:"1"}),e.jsx("circle",{cx:"15",cy:"5",r:"1"}),e.jsx("circle",{cx:"15",cy:"19",r:"1"})]})}),l.type==="name"&&e.jsxs("div",{className:"flex items-center w-full gap-2",children:[e.jsx("button",{onClick:j=>{j.stopPropagation(),k(r.id)},className:"p-0.5 hover:bg-gray-200 rounded text-gray-400 transition-colors",children:i.has(r.id)?e.jsx(bs,{size:14}):e.jsx(ws,{size:14})}),e.jsx("input",{value:r.name,onChange:j=>A(c.id,r.id,{name:j.target.value}),className:`w-full px-2 py-1.5 bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded font-medium truncate ${h?"text-gray-200":"text-gray-700"}`}),e.jsx("div",{className:"text-xs text-gray-400 mr-2",children:(ae=r.subtasks)!=null&&ae.length?`${r.subtasks.length} subtasks`:""})]}),l.type==="status"?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(zt,{status:l.id==="col_status"?r.status:r.textValues[l.id]||z.New,onChange:j=>{l.id==="col_status"?A(c.id,r.id,{status:j}):v(c.id,r.id,l.id,j)},tabIndex:0,darkMode:h})}):l.type==="priority"?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(It,{priority:l.id==="col_priority"?r.priority:r.textValues[l.id]||K.Normal,onChange:j=>{l.id==="col_priority"?A(c.id,r.id,{priority:j}):v(c.id,r.id,l.id,j)},tabIndex:0,darkMode:h})}):l.type==="person"?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(At,{personId:l.id==="col_person"?r.personId:r.textValues[l.id]||null,onChange:j=>{l.id==="col_person"?A(c.id,r.id,{personId:j}):v(c.id,r.id,l.id,j||"")},tabIndex:0,darkMode:h})}):l.type==="date"?e.jsx("div",{className:"w-full h-full relative flex items-center justify-center",children:e.jsx("div",{className:`text-xs font-medium px-2 py-1 rounded transition-colors focus:ring-2 focus:ring-blue-500 focus:outline-none cursor-pointer ${h?"text-gray-300 hover:text-white hover:bg-white/10":"text-gray-500 hover:text-gray-800 hover:bg-gray-100"}`,onClick:j=>{j.stopPropagation();const m=j.currentTarget.getBoundingClientRect(),y=l.id==="col_date",b=y?r.dueDate||"":r.textValues[l.id]||"";u({taskId:r.id,colId:l.id,date:b,rect:m,onSelect:p=>{y?A(c.id,r.id,{dueDate:p}):v(c.id,r.id,l.id,p)}})},tabIndex:0,onKeyDown:j=>{if(j.key==="Enter"||j.key===" "){j.preventDefault();const m=j.currentTarget.getBoundingClientRect(),y=l.id==="col_date",b=y?r.dueDate||"":r.textValues[l.id]||"";u({taskId:r.id,colId:l.id,date:b,rect:m,onSelect:p=>{y?A(c.id,r.id,{dueDate:p}):v(c.id,r.id,l.id,p)}})}},children:(()=>{const m=l.id==="col_date"?r.dueDate:r.textValues[l.id];return m?new Date(m).toLocaleDateString(void 0,{month:"short",day:"numeric"}):e.jsx("span",{className:"text-gray-300",children:"Set Date"})})()})}):null,l.type==="checkbox"&&e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("input",{type:"checkbox",checked:r.textValues[l.id]==="true",onChange:j=>{v(c.id,r.id,l.id,j.target.checked?"true":"false")},className:`w-4 h-4 rounded text-blue-600 focus:ring-blue-500 cursor-pointer ${h?"border-gray-600 bg-transparent":"border-gray-300"}`})}),l.type==="money"&&e.jsx("div",{className:"w-full h-full px-2 py-1.5 text-sm text-gray-700 flex items-center justify-end font-mono",children:r.textValues[l.id]?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:`mr-1 ${h?"text-gray-500":"text-gray-400"}`,children:l.currency||"$"}),e.jsx("input",{type:"text",value:r.textValues[l.id],onChange:j=>{const m=j.target.value.replace(/[^0-9.]/g,"");v(c.id,r.id,l.id,m)},className:"bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-1 w-full text-right",placeholder:"0.00"})]}):e.jsx("input",{type:"text",onChange:j=>{const m=j.target.value.replace(/[^0-9.]/g,"");v(c.id,r.id,l.id,m)},className:`bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-1 w-full text-right ${h?"placeholder-gray-600 text-gray-300":"placeholder-gray-300 text-gray-700"}`,placeholder:l.currency||"$"})}),l.type==="website"&&e.jsxs("div",{className:"w-full h-full px-2 py-1.5 flex items-center gap-2",children:[e.jsx("div",{className:`p-1 rounded ${h?"bg-indigo-500/20 text-indigo-400":"bg-indigo-50 text-indigo-500"}`,children:e.jsx(vs,{size:12})}),e.jsx("input",{type:"text",value:r.textValues[l.id]||"",onChange:j=>v(c.id,r.id,l.id,j.target.value),className:`w-full bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-1 text-sm hover:underline cursor-text truncate ${h?"text-blue-400":"text-blue-600"}`,placeholder:"www.example.com"})]}),l.type==="email"&&e.jsxs("div",{className:"w-full h-full px-2 py-1.5 flex items-center gap-2",children:[e.jsx("div",{className:`p-1 rounded ${h?"bg-red-500/20 text-red-400":"bg-red-50 text-red-500"}`,children:e.jsx(js,{size:12})}),e.jsx("input",{type:"text",value:r.textValues[l.id]||"",onChange:j=>v(c.id,r.id,l.id,j.target.value),className:`w-full bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-1 text-sm truncate ${h?"text-gray-300":"text-gray-700"}`,placeholder:"email@example.com"})]}),l.type==="phone"&&e.jsxs("div",{className:"w-full h-full px-2 py-1.5 flex items-center gap-2",children:[e.jsx("div",{className:`p-1 rounded ${h?"bg-orange-500/20 text-orange-400":"bg-orange-50 text-orange-500"}`,children:e.jsx(Js,{size:12})}),e.jsx("input",{type:"text",value:r.textValues[l.id]||"",onChange:j=>v(c.id,r.id,l.id,j.target.value),className:`w-full bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-1 text-sm truncate ${h?"text-gray-300":"text-gray-700"}`,placeholder:"+1 234 567 890"})]}),l.type==="location"&&e.jsxs("div",{className:"w-full h-full px-2 py-1.5 flex items-center gap-2",children:[e.jsx("div",{className:`p-1 rounded ${h?"bg-red-500/20 text-red-400":"bg-red-50 text-red-600"}`,children:e.jsx(Ns,{size:12})}),e.jsx("input",{type:"text",value:r.textValues[l.id]||"",onChange:j=>v(c.id,r.id,l.id,j.target.value),className:`w-full bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-1 text-sm truncate ${h?"text-gray-300":"text-gray-700"}`,placeholder:"Add location"})]}),l.type==="rating"&&e.jsx("div",{className:"w-full h-full flex items-center justify-center gap-0.5",children:[1,2,3,4,5].map(j=>e.jsx(St,{size:14,className:`cursor-pointer transition-colors ${j<=(Number(r.textValues[l.id])||0)?"text-amber-400 fill-amber-400":h?"text-gray-600":"text-gray-300"}`,onClick:()=>v(c.id,r.id,l.id,j.toString())},j))}),l.type==="progress_manual"&&e.jsxs("div",{className:"w-full h-full px-2 py-1.5 flex items-center gap-2",children:[e.jsxs("div",{className:`flex-1 h-2 rounded-full overflow-hidden relative group/progress cursor-pointer ${h?"bg-gray-700":"bg-gray-100"}`,children:[e.jsx("div",{className:"h-full bg-green-500 transition-all duration-300",style:{width:`${Number(r.textValues[l.id])||0}%`}}),e.jsx("input",{type:"range",min:"0",max:"100",value:Number(r.textValues[l.id])||0,onChange:j=>v(c.id,r.id,l.id,j.target.value),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"})]}),e.jsxs("span",{className:`text-xs w-8 text-right ${h?"text-gray-400":"text-gray-500"}`,children:[Number(r.textValues[l.id])||0,"%"]})]}),l.type==="button"&&e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("button",{className:"px-3 py-1 bg-blue-500 text-white text-xs font-medium rounded hover:bg-blue-600 transition-colors active:scale-95",onClick:()=>alert(`Action triggered for ${r.name}`),children:"Click Me"})}),l.type==="text"&&e.jsx("input",{type:"text",value:r.textValues[l.id]||"",onChange:j=>v(c.id,r.id,l.id,j.target.value),className:`w-full h-full text-center px-2 bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded ${h?"text-gray-300":"text-gray-600"}`,placeholder:"-",tabIndex:0}),l.type==="long_text"&&e.jsx("div",{className:"w-full h-full p-1",children:e.jsx(Or,{value:r.textValues[l.id]||"",onChange:j=>v(c.id,r.id,l.id,j),tabIndex:0,darkMode:h})}),l.type==="dropdown"&&e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Rr,{options:l.options,value:r.textValues[l.id],onChange:j=>v(c.id,r.id,l.id,j),tabIndex:0,darkMode:h})}),l.type==="number"&&e.jsx("input",{type:"text",value:r.textValues[l.id]||"",onChange:j=>{const m=j.target.value;/^[0-9.,]*$/.test(m)&&v(c.id,r.id,l.id,m)},onBlur:j=>{const m=j.target.value.replace(/,/g,"");if(m&&!isNaN(Number(m))){const y=Number(m).toLocaleString();v(c.id,r.id,l.id,y)}},className:"w-full h-full text-center px-2 bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded text-gray-600 font-mono text-xs",placeholder:"0",tabIndex:0})]},l.id)}),e.jsx("div",{className:`flex items-center justify-center border-l opacity-0 group-hover/row:opacity-100 transition-opacity ${h?"border-gray-800 bg-[#0f1115]":"border-gray-100 bg-white"}`,children:e.jsx("button",{onClick:()=>E(c.id,r.id),className:"text-gray-300 hover:text-red-500 hover:bg-red-50 p-1.5 rounded transition-all",children:e.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})})]}),i.has(r.id)&&e.jsxs("div",{className:"contents",children:[(ne=r.subtasks)==null?void 0:ne.map(l=>e.jsxs("div",{className:`grid gap-px group/subrow text-sm transition-colors relative ${h?"bg-[#1a1d24]/50 hover:bg-white/5":"bg-gray-50/30 hover:bg-gray-50"}`,style:{gridTemplateColumns:x+" "+c.columns.map(re=>re.width).join(" ")+" "+s},children:[e.jsxs("div",{className:`flex items-center justify-center py-1.5 border-r relative sticky left-0 z-10 border-r-2 ${h?"bg-[#1a1d24]/50 border-gray-800 border-r-gray-800":"bg-gray-50/30 border-gray-100 border-r-gray-200/50"}`,children:[e.jsx("div",{className:"w-4 h-4"})," "]}),c.columns.map(re=>{const ae=re.type==="name";return e.jsxs("div",{className:`relative border-r flex items-center ${ae?"justify-start pl-8 sticky left-[50px] z-10 border-r-2":"justify-center"} min-h-[32px] transition-colors ${h?"bg-[#1a1d24]/50 border-gray-800 border-r-gray-800 group-hover/subrow:bg-white/5 text-gray-400":"bg-gray-50/30 border-gray-100 border-r-gray-200/50 group-hover/subrow:bg-gray-100"}`,children:[ae&&e.jsx(ut,{size:14,className:"text-gray-400 mr-2"}),ae?e.jsx("input",{value:l.name,onChange:j=>{var y;const m=(y=r.subtasks)==null?void 0:y.map(b=>b.id===l.id?{...b,name:j.target.value}:b);A(c.id,r.id,{subtasks:m})},className:`w-full px-2 py-1.5 bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded text-sm truncate ${h?"text-gray-300":"text-gray-600"}`}):e.jsx("div",{className:"text-xs text-gray-400 italic",children:"-"})]},`${l.id}-${re.id}`)}),e.jsx("div",{className:`border-l ${h?"bg-[#1a1d24]/50 border-gray-800":"bg-white border-gray-100"}`})]},l.id)),e.jsx("div",{className:`grid gap-px relative z-20 shadow-lg my-2 mx-4 rounded-lg border overflow-hidden animate-in slide-in-from-top-2 duration-200 ${h?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,style:{gridColumn:"1 / -1"},children:e.jsxs("div",{className:`flex items-center p-2 gap-3 ${h?"bg-[#1a1d24]":"bg-white"}`,children:[e.jsx("div",{className:`w-5 h-5 rounded-full border-2 border-dashed animate-spin-slow ${h?"border-gray-600":"border-gray-300"}`}),e.jsx("input",{autoFocus:!0,value:$[r.id]||"",onChange:l=>P({...$,[r.id]:l.target.value}),onKeyDown:l=>{l.key==="Enter"&&o(c.id,r.id)},placeholder:"Task Name or type '/' for commands",className:`flex-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 bg-transparent ${h?"text-gray-200 placeholder-gray-500":"text-gray-700 placeholder-gray-400"}`}),e.jsxs("div",{className:`flex items-center gap-1 border-l pl-3 ${h?"border-gray-700":"border-gray-200"}`,children:[e.jsx("button",{className:`p-1.5 rounded transition-colors ${h?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:e.jsx(Nt,{size:16})}),e.jsx("button",{className:`p-1.5 rounded transition-colors ${h?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:e.jsx(Cs,{size:16})}),e.jsx("div",{className:`w-px h-4 mx-1 ${h?"bg-gray-700":"bg-gray-200"}`}),e.jsx("button",{className:`p-1.5 rounded transition-colors ${h?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:e.jsx(wt,{size:16})}),e.jsx("button",{className:`p-1.5 rounded transition-colors ${h?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:e.jsx(jt,{size:16})}),e.jsx("button",{className:`p-1.5 rounded transition-colors ${h?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:e.jsx($t,{size:16})}),e.jsx("button",{className:`p-1.5 rounded transition-colors ${h?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:e.jsx(qs,{size:16})}),e.jsx("button",{className:`p-1.5 rounded transition-colors ${h?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:e.jsx($s,{size:16})}),e.jsx("div",{className:`w-px h-4 mx-1 ${h?"bg-gray-700":"bg-gray-200"}`}),e.jsx("button",{onClick:()=>k(r.id),className:`px-3 py-1.5 text-sm font-medium rounded border transition-colors ${h?"text-gray-400 hover:bg-white/5 border-gray-700":"text-gray-600 hover:bg-gray-100 border-gray-200"}`,children:"Cancel"}),e.jsxs("button",{onClick:()=>o(c.id,r.id),className:"px-3 py-1.5 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded shadow-sm transition-colors flex items-center gap-1",children:["Save ",e.jsx(ut,{size:12})]})]})]})})]})]})},on=C.forwardRef(({storageKey:r="taskboard-state",tasks:c,onTaskUpdate:x,darkMode:s=!1,minimal:i=!1,showGroupHeader:I=!1,expandAllSignal:A,collapseAllSignal:v,searchQuery:k="",statusFilter:u="all",sortKey:g="none"},E)=>{var at;const{board:o,setBoard:$,aiPrompt:P,setAiPrompt:h,isAiLoading:L,aiAnalysis:Y,setAiAnalysis:O,updateTask:G,toggleTaskSelection:R,toggleGroupSelection:J,updateTaskTextValue:oe,addTask:ne,deleteTask:l,addGroup:re,deleteGroup:ae,updateGroupTitle:j,toggleGroupPin:m,addColumn:y,updateColumnTitle:b,deleteColumn:p,duplicateColumn:w,reorderColumn:T,updateColumnWidth:W,handleGeneratePlan:Q,handleAnalyzeBoard:le}=Sr(r),[q,fe]=C.useState(null),Pt=(t,a)=>{fe({type:"task",id:a,groupId:t})},Tt=t=>{fe({type:"group",groupId:t})},_t=()=>{fe({type:"selected"})},Et=()=>{if(!q)return;const{type:t,id:a,groupId:d}=q;t==="task"&&a&&d?l(d,a):t==="group"&&d?ae(d):t==="selected"?as():t==="column"&&a&&d&&p(d,a),fe(null)};C.useEffect(()=>{c&&c.length>0&&$(t=>{const a=[...t.groups];a.length===0&&a.push({id:"g1",title:"Tasks",color:"#3b82f6",tasks:[],columns:[],isPinned:!1});const d=a[0],f=c.map(N=>{let _=z.New;return N.status==="To do"?_=z.New:N.status==="In Progress"?_=z.Working:N.status==="Review"?_=z.AlmostFinish:N.status==="Complete"&&(_=z.Done),{id:N.id,name:N.title,status:_,priority:N.priority,personId:N.assigneeId||null,dueDate:N.dueDate?new Date(N.dueDate).toISOString():"",textValues:{},selected:!1}});return a[0]={...d,tasks:f},{...t,groups:a}})},[c,$]);const Lt=(t,a,d)=>{if(G(t,a,d),x){const f={};d.name&&(f.title=d.name),d.status&&(d.status===z.New||d.status===z.Pending?f.status="To do":d.status===z.Working||d.status===z.Stuck?f.status="In Progress":d.status===z.AlmostFinish?f.status="Review":d.status===z.Done&&(f.status="Complete")),d.priority&&(f.priority=d.priority),d.personId!==void 0&&(f.assigneeId=d.personId||void 0),d.dueDate&&(f.dueDate=new Date(d.dueDate)),x(a,f)}},[Vr,ze]=C.useState(!1),[Gr,Br]=C.useState(null),[pe,be]=C.useState(null),[te,we]=C.useState(null),[We,Ot]=C.useState(new Set),[qe,Je]=C.useState({}),[Oe,Xe]=C.useState(null),[Ye,Ke]=C.useState(null),[Ze,Qe]=C.useState(null),Me=ft.getCurrentUser(),Rt=Me&&r===`taskboard-${Me.id}`,[ve,Re]=C.useState(null),[F,Fe]=C.useState({}),[Hr,Ur]=C.useState(null),[et,Ft]=C.useState(null),Vt=C.useRef(null),Gt=C.useRef(o.groups.length),[ce,tt]=C.useState(null),[st,Ve]=C.useState(new Set);C.useEffect(()=>{const t=d=>{if(!ce)return;const f=d.clientX-ce.startX,N=Math.max(50,ce.startWidth+f);W(ce.groupId,ce.colId,N)},a=()=>{ce&&(tt(null),document.body.style.cursor="")};return ce&&(document.addEventListener("mousemove",t),document.addEventListener("mouseup",a),document.body.style.cursor="col-resize"),()=>{document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",a),document.body.style.cursor=""}},[ce,W]),C.useEffect(()=>{Gt.current=o.groups.length},[o.groups.length]);const Bt=t=>{const a=new Set(We);a.has(t)?a.delete(t):a.add(t),Ot(a)},Ht=(t,a)=>{var N;const d=(N=qe[a])==null?void 0:N.trim();if(!d)return;const f={id:`subtask-${ee()}`,name:d,status:z.New,priority:K.Normal,dueDate:"",personId:null,textValues:{},selected:!1};$(_=>({..._,groups:_.groups.map(n=>n.id===t?{...n,tasks:n.tasks.map(D=>D.id===a?{...D,subtasks:[...D.subtasks||[],f]}:D)}:n)})),Je(_=>({..._,[a]:""}))},M=(t,a)=>{Fe(d=>({...d,[t]:{...d[t],...a}}))},Ge=t=>{const a=F[t]||{},d=a.name||"";d.trim()&&(ne(t,d,a),Fe(f=>{const N={...f};return delete N[t],N}))},Ut=t=>{if(Object.entries(F).filter(([,f])=>{var N;return(N=f==null?void 0:f.name)==null?void 0:N.trim()}).length===0)return o;const d={...o,groups:o.groups.map(f=>{var D;const N=F[f.id],_=(D=N==null?void 0:N.name)==null?void 0:D.trim();if(!N||!_)return f;const n={id:ee(),name:_,status:N.status||z.New,priority:N.priority||K.Normal,dueDate:N.dueDate||new Date().toISOString().split("T")[0],personId:N.personId??null,textValues:N.textValues||{},selected:!1};return{...f,tasks:[...f.tasks,n]}})};return t!=null&&t.skipPersist||$(d),Fe({}),d};C.useImperativeHandle(E,()=>({exportBoardWithDrafts:Ut}),[o,F]);const rt=(t,a,d)=>{t.preventDefault(),Re({x:t.clientX,y:t.clientY,groupId:a,colId:d})},Wt=(t,a,d)=>{if(t==="delete")p(a,d);else if(t==="duplicate")w(a,d);else if(t!=="move_left"){if(t!=="move_right"){if(t==="rename"){const f=prompt("Enter new column name:");f&&b(a,d,f)}}}Re(null)},qt=Es(gt(Os,{activationConstraint:{distance:5}}),gt(Ls,{activationConstraint:{delay:250,tolerance:5}})),Jt=t=>{const{active:a}=t;ze(!0),Ft(a.id)},Xt=t=>{const{active:a,over:d}=t;if(!d){ze(!1);return}const f=a.id,N=d.id;if(f===N){ze(!1);return}$(_=>{const n=_.groups.find(B=>B.tasks.some(X=>X.id===f)),D=_.groups.find(B=>B.tasks.some(X=>X.id===N));if(!n||!D)return _;const S=n.tasks.findIndex(B=>B.id===f),H=D.tasks.findIndex(B=>B.id===N);if(n.id===D.id){const B=Us(n.tasks,S,H),X=_.groups.map(ie=>ie.id===n.id?{...ie,tasks:B}:ie);return{..._,groups:X}}else{const B=[...n.tasks],[X]=B.splice(S,1),ie=[...D.tasks];ie.splice(H,0,X);const _e=_.groups.map(de=>de.id===n.id?{...de,tasks:B}:de.id===D.id?{...de,tasks:ie}:de);return{..._,groups:_e}}}),ze(!1)},Yt=(t,a,d,f)=>{if(f===0){t.preventDefault();return}t.dataTransfer.setData("application/json",JSON.stringify({type:"COLUMN",groupId:a,colId:d,index:f})),t.dataTransfer.effectAllowed="move"},Kt=(t,a)=>{t.preventDefault(),a===0?t.dataTransfer.dropEffect="none":t.dataTransfer.dropEffect="move"},Zt=(t,a,d)=>{t.preventDefault();const f=t.dataTransfer.getData("application/json");if(f)try{const{type:N,groupId:_,index:n}=JSON.parse(f);N==="COLUMN"&&_===a&&n!==d&&d!==0&&T(a,n,d)}catch{}},ye={[z.Done]:"#33D995",[z.Working]:"#FFBE66",[z.Stuck]:"#FF7085",[z.Pending]:"#FFD940",[z.AlmostFinish]:"#C48AF0",[z.New]:"#A0A5B9"},Qt=t=>{if(!t)return z.New;const a=t.toLowerCase();return a.includes("done")||a.includes("complete")?z.Done:a.includes("work")||a.includes("progress")||a.includes("doing")?z.Working:a.includes("stuck")||a.includes("block")?z.Stuck:a.includes("pending")||a.includes("todo")||a.includes("to do")||a.includes("backlog")?z.Pending:a.includes("almost")||a.includes("review")?z.AlmostFinish:z.New},Be=(t,a)=>{var N,_;const d=(N=t.columns.find(n=>n.type==="status"))==null?void 0:N.id,f=a.status||(d?(_=a.textValues)==null?void 0:_[d]:void 0);return Qt(f)},Mt=(t,a)=>{const d=(a??t.tasks).flatMap(n=>[n,...n.subtasks||[]]);if(d.length===0)return{counts:{done:0,working:0,stuck:0,pending:0,almostFinish:0,new:0},weighted:0,total:0};const f=d.reduce((n,D)=>{const S=Be(t,D);return n[S===z.Done?"done":S===z.Working?"working":S===z.Stuck?"stuck":S===z.Pending?"pending":S===z.AlmostFinish?"almostFinish":"new"]+=1,n},{done:0,working:0,stuck:0,pending:0,almostFinish:0,new:0}),N=d.length,_=(f.done*1+f.almostFinish*.75+f.working*.5+f.pending*.25+f.new*.1+f.stuck*0)/N*100;return{counts:f,weighted:_,total:N}},Ie=k.trim().toLowerCase(),es=Ie.length>0||u!=="all",ts=t=>!Ie||t.name.toLowerCase().includes(Ie)?!0:Object.values(t.textValues||{}).some(a=>(a||"").toLowerCase().includes(Ie)),ss=(t,a)=>{if(u==="all")return!0;const d=Be(a,t);return u==="done"?d===z.Done:u==="new"?d===z.New||d===z.Pending:d!==z.Done},rs=t=>{if(g==="none")return t;const a=[...t];if(g==="name")a.sort((d,f)=>d.name.localeCompare(f.name));else if(g==="dueAsc"||g==="dueDesc")a.sort((d,f)=>{const N=d.dueDate?new Date(d.dueDate).getTime():1/0,_=f.dueDate?new Date(f.dueDate).getTime():1/0;return g==="dueAsc"?N-_:_-N});else if(g==="priority"){const d={[K.Urgent]:1,[K.High]:2,[K.Medium]:3,[K.Normal]:4,[K.Low]:5};a.sort((f,N)=>(d[f.priority]||99)-(d[N.priority]||99))}return a},Ae="50px",Pe="50px",Te=o.groups.flatMap(t=>t.tasks.filter(a=>a.selected).map(a=>({groupId:t.id,task:a}))).length,ns=()=>{J("all",!1)},as=()=>{Te!==0&&$(t=>({...t,groups:t.groups.map(a=>({...a,tasks:a.tasks.filter(d=>!d.selected)}))}))},is=()=>{Te!==0&&$(t=>({...t,groups:t.groups.map(a=>{const d=a.tasks.filter(N=>N.selected);if(d.length===0)return a;const f=d.map(N=>({...N,id:crypto.randomUUID(),name:N.name+" (Copy)",selected:!0}));return{...a,tasks:[...a.tasks,...f]}})}))},os=t=>{Ve(a=>{const d=new Set(a);return d.has(t)?d.delete(t):d.add(t),d})};C.useEffect(()=>{A!==void 0&&Ve(new Set)},[A]);const nt=C.useRef(v);return C.useEffect(()=>{v!==void 0&&v!==nt.current&&(Ve(new Set(o.groups.map(t=>t.id))),nt.current=v)},[v,o.groups]),e.jsxs(Rs,{sensors:qt,collisionDetection:Fs,onDragStart:Jt,onDragEnd:Xt,children:[e.jsxs("div",{className:`flex w-full ${i?"h-full":"h-screen"} overflow-hidden font-sans transition-colors ${s?"bg-[#0f1115] text-gray-200":"bg-white text-gray-800"}`,children:[e.jsxs("main",{className:`flex-1 flex flex-col ${i?"h-full":"h-screen"} overflow-hidden relative transition-colors ${s?"bg-[#0f1115]":"bg-white"}`,children:[!i&&e.jsxs("header",{className:`h-16 flex items-center justify-between px-8 flex-shrink-0 transition-colors ${s?"bg-[#0f1115] border-b border-white/5":"bg-white"}`,children:[e.jsx("div",{children:e.jsx("h1",{className:`text-2xl font-bold tracking-tight ${s?"text-white":"text-gray-800"}`,children:o.name})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:le,disabled:L,className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-indigo-50 to-purple-50 text-indigo-600 rounded-full hover:shadow-md hover:scale-105 transition-all text-sm font-semibold border border-indigo-100",children:[e.jsx(He,{className:"w-4 h-4"}),L?"Thinking...":"Analyze Board"]}),e.jsxs("button",{onClick:re,className:"flex items-center gap-2 px-4 py-2 bg-[#1e2126] text-white rounded-md hover:bg-[#2c3036] transition text-sm font-medium shadow-sm",children:[e.jsx(pt,{className:"w-4 h-4"})," New Group"]})]})]}),e.jsxs("div",{ref:Vt,className:`flex-1 overflow-y-auto overflow-x-hidden custom-scroll ${i?"p-0 pb-4":"p-6 pb-96"}`,children:[Y&&e.jsxs("div",{className:"mb-8 p-6 bg-white border border-indigo-100 rounded-2xl shadow-xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400"}),e.jsxs("h3",{className:"text-indigo-900 font-bold text-lg mb-3 flex items-center gap-2",children:[e.jsx(He,{className:"w-5 h-5 text-indigo-500"})," AI Assistant Insights"]}),e.jsx("p",{className:"text-gray-700 whitespace-pre-line text-sm leading-relaxed",children:Y}),e.jsx("button",{onClick:()=>O(null),className:"mt-4 text-xs font-semibold text-gray-400 hover:text-gray-600 uppercase tracking-wider",children:"Dismiss"})]}),e.jsx("div",{className:"space-y-8 w-full",children:[...o.groups].sort((t,a)=>(a.isPinned?1:0)-(t.isPinned?1:0)).map(t=>{var _;const a=rs(t.tasks.filter(n=>ts(n)&&ss(n,t))),d=Mt(t,a),f=t.tasks.length>0&&t.tasks.every(n=>n.selected),N=t.tasks.some(n=>n.selected);return es&&a.length===0?null:e.jsxs("div",{id:`group-${t.id}`,className:`relative flex flex-col w-full mb-10 shadow-sm border rounded-xl overflow-hidden transition-colors ${s?"border-gray-800 bg-[#1a1d24]":"border-gray-200/60"}`,children:[e.jsxs("div",{className:`flex items-center px-4 py-3 relative w-full border-b transition-colors ${s?"bg-[#1a1d24] border-gray-800":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 pr-4",children:[e.jsx("div",{className:"cursor-pointer hover:bg-gray-100 p-1.5 rounded transition-colors group/menu relative",onClick:()=>os(t.id),children:e.jsx("svg",{className:`w-4 h-4 text-gray-400 group-hover/menu:text-blue-500 transition-transform ${st.has(t.id)?"-rotate-90":"rotate-0"}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})}),e.jsx("input",{value:t.title,onChange:n=>j(t.id,n.target.value),className:`text-xl font-bold bg-transparent border border-transparent rounded px-2 py-0.5 focus:outline-none focus:border-blue-500 w-full max-w-md transition-all ${s?"hover:border-gray-700 focus:bg-[#0f1115]":"hover:border-gray-300 focus:bg-white"}`,style:{color:t.color}}),e.jsxs("div",{className:"ml-4 flex items-center gap-2",children:[e.jsx("div",{className:"flex h-1.5 w-28 overflow-hidden rounded-full bg-gray-100",children:["new","pending","working","almostFinish","done","stuck"].map(n=>{const D=d.total===0?0:d.counts[n]/d.total*100;if(D<=0)return null;const S=n==="new"?ye[z.New]:n==="pending"?ye[z.Pending]:n==="working"?ye[z.Working]:n==="almostFinish"?ye[z.AlmostFinish]:n==="done"?ye[z.Done]:ye[z.Stuck];return e.jsx("div",{className:"h-full",style:{width:`${D}%`,backgroundColor:S}},n)})}),e.jsxs("span",{className:"text-xs text-gray-400 font-medium",children:[Math.round(d.weighted),"%"]})]})]}),e.jsx("div",{className:"flex-1"}),!i&&e.jsxs("div",{className:"flex items-center gap-1 px-2",children:[e.jsx("button",{onClick:()=>m(t.id),className:"p-2 transition-colors rounded-md "+(t.isPinned?"text-blue-500 bg-blue-50":"text-gray-300 hover:text-gray-500 hover:bg-gray-100"),title:t.isPinned?"Unpin Group":"Pin Group",children:e.jsx(yr,{className:"w-4 h-4 "+(t.isPinned?"fill-current":"")})}),e.jsx("button",{onClick:n=>{n.stopPropagation(),Xe(t.id)},className:"p-2 transition-colors rounded-md text-gray-300 hover:text-gray-500 hover:bg-gray-100",title:"Send to Reminders",children:e.jsx(jt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:n=>{n.stopPropagation(),Ke(t.id)},className:"p-2 transition-colors rounded-md text-gray-300 hover:text-gray-500 hover:bg-gray-100",title:"Send to Goals",children:e.jsx(yt,{className:"w-4 h-4"})}),!Rt&&e.jsx("button",{onClick:n=>{n.stopPropagation(),Qe(t.id)},className:"p-2 transition-colors rounded-md text-gray-300 hover:text-gray-500 hover:bg-gray-100",title:"Send to Tasks Board",children:e.jsx(bt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Tt(t.id),className:"text-gray-400 hover:text-red-500 p-2 transition-colors hover:bg-red-50 rounded-md",title:"Delete Group",children:e.jsx(Ue,{size:14})})]})]}),!st.has(t.id)&&e.jsxs("div",{className:"overflow-x-auto w-full [&::-webkit-scrollbar]:hidden",children:[e.jsx("div",{className:`sticky top-0 z-[1] min-w-full w-fit transition-colors ${s?"bg-[#1a1d24]":"bg-white"}`,style:{boxShadow:"0 2px 5px -2px rgba(0,0,0,0.05)"},children:e.jsxs("div",{className:`grid gap-px border-y text-xs font-semibold uppercase tracking-wide transition-colors ${s?"bg-gray-800 border-gray-800 text-gray-400":"bg-gray-200 border-gray-200 text-gray-500"}`,style:{gridTemplateColumns:Ae+" "+t.columns.map(n=>n.width).join(" ")+" "+Pe},children:[e.jsx("div",{className:`flex items-center justify-center sticky left-0 z-20 border-r-2 transition-colors ${s?"bg-[#1a1d24]/95 border-r-gray-800":"bg-gray-50/80 border-r-gray-200/50"}`,children:e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-gray-300",checked:f,ref:n=>{n&&(n.indeterminate=N&&!f)},onChange:n=>J(t.id,n.target.checked)})}),t.columns.map((n,D)=>e.jsx("div",{className:`relative group backdrop-blur-sm transition-colors ${n.type==="name"?`sticky left-[50px] z-20 border-r-2 ${s?"border-r-gray-800":"border-r-gray-200/50"}`:"cursor-grab active:cursor-grabbing"} ${s?"bg-[#1a1d24]/95 hover:bg-white/5":"bg-gray-50/80 hover:bg-gray-100"}`,onContextMenu:S=>rt(S,t.id,n.id),draggable:n.type!=="name",onDragStart:S=>Yt(S,t.id,n.id,D),onDragOver:S=>Kt(S,D),onDrop:S=>Zt(S,t.id,D),children:e.jsxs("div",{className:"flex items-center justify-between h-full",children:[e.jsx("input",{value:n.title,onChange:S=>b(t.id,n.id,S.target.value),className:`w-full h-full bg-transparent px-3 py-2 text-center text-[11px] focus:outline-none border-b-2 border-transparent focus:border-blue-500 ${s?"focus:bg-[#0f1115] focus:text-white text-gray-300":"focus:bg-white focus:text-gray-800"}`,style:{textAlign:n.type==="name"||n.type==="long_text"?"left":"center"}}),e.jsx("div",{className:"absolute right-1 top-1/2 transform -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer p-1 hover:bg-gray-200 rounded",onClick:S=>{S.stopPropagation();const H=S.currentTarget.getBoundingClientRect();we((te==null?void 0:te.groupId)===t.id?null:{groupId:t.id,rect:H})},children:e.jsx(hs,{size:14,className:"text-gray-400"})}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-400/50 z-30",onMouseDown:S=>{S.stopPropagation(),S.preventDefault();const H=parseInt(n.width.replace("px",""))||140;tt({groupId:t.id,colId:n.id,startX:S.clientX,startWidth:H})},onClick:S=>S.stopPropagation()})]})},n.id)),e.jsx("div",{className:`flex items-center justify-center relative group ${s?"bg-[#1a1d24]/95":"bg-gray-50/80"}`,children:e.jsx("div",{className:"cursor-pointer w-6 h-6 rounded flex items-center justify-center transition-all duration-200 "+((te==null?void 0:te.groupId)===t.id?"bg-gray-200 text-gray-900":"text-gray-400 hover:text-gray-700 hover:bg-gray-200/50"),onClick:n=>{n.stopPropagation();const D=n.currentTarget.getBoundingClientRect();we((te==null?void 0:te.groupId)===t.id?null:{groupId:t.id,rect:D})},title:"Add Column",children:e.jsx(pt,{className:"w-4 h-4"})})})]})}),e.jsx("div",{className:`divide-y relative z-0 min-w-full w-fit ${s?"divide-gray-800":"divide-gray-100"}`,children:e.jsx(Bs,{items:a.map(n=>n.id),strategy:Hs,children:a.map(n=>e.jsx(Fr,{task:n,group:t,selectionColumnWidth:Ae,actionColumnWidth:Pe,expandedTaskIds:We,toggleTaskSelection:R,updateTask:Lt,deleteTask:()=>Pt(t.id,n.id),updateTaskTextValue:oe,toggleSubtask:Bt,setActiveDatePicker:be,handleContextMenu:rt,handleAddSubtask:Ht,subtaskInput:qe,setSubtaskInput:Je,darkMode:s},n.id))})}),e.jsxs("div",{className:`grid gap-px border-t group/add-row transition-colors min-w-full w-fit ${s?"bg-[#1a1d24] border-gray-800 hover:bg-white/5":"bg-white border-gray-200 hover:bg-gray-50"}`,style:{gridTemplateColumns:Ae+" "+t.columns.map(n=>n.width).join(" ")+" "+Pe},children:[e.jsxs("div",{className:`flex items-center justify-center border-r sticky left-0 z-10 border-r-2 transition-colors relative ${s?"bg-[#1a1d24] border-gray-800 border-r-gray-800 group-hover/add-row:bg-white/5":"bg-white border-gray-100 border-r-gray-200/50 group-hover/add-row:bg-gray-50"}`,children:[e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1.5",style:{backgroundColor:t.color}}),e.jsx("div",{className:"w-4 h-4 rounded border border-gray-200 flex items-center justify-center text-gray-300",children:e.jsx(vt,{size:10})})]}),e.jsx("div",{className:`flex items-center pl-2 py-2 border-r sticky left-[50px] z-10 border-r-2 transition-colors ${s?"bg-[#1a1d24] border-gray-800 border-r-gray-800 group-hover/add-row:bg-white/5":"bg-white border-gray-100 border-r-gray-200/50 group-hover/add-row:bg-gray-50"}`,children:e.jsx("input",{type:"text",placeholder:"+ Add task",value:((_=F[t.id])==null?void 0:_.name)||"",onChange:n=>M(t.id,{name:n.target.value}),className:`w-full bg-transparent text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 ${s?"placeholder-gray-600 text-gray-200":"placeholder-gray-400 text-gray-700"}`,onKeyDown:n=>{n.key==="Enter"&&Ge(t.id)}})}),t.columns.slice(1).map(n=>{var D,S,H,B,X,ie,_e,de,it,ot,lt,ct,dt;return e.jsx("div",{className:`border-r min-h-[32px] flex items-center justify-center ${s?"bg-[#1a1d24] border-gray-800":"bg-white border-gray-100"}`,children:n.type==="status"?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(zt,{status:n.id==="col_status"?((D=F[t.id])==null?void 0:D.status)||z.New:((H=(S=F[t.id])==null?void 0:S.textValues)==null?void 0:H[n.id])||z.New,onChange:V=>{var U;n.id==="col_status"?M(t.id,{status:V}):M(t.id,{textValues:{...(U=F[t.id])==null?void 0:U.textValues,[n.id]:V}})},tabIndex:0,darkMode:s})}):n.type==="priority"?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(It,{priority:n.id==="col_priority"?((B=F[t.id])==null?void 0:B.priority)||K.Normal:((ie=(X=F[t.id])==null?void 0:X.textValues)==null?void 0:ie[n.id])||K.Normal,onChange:V=>{var U;n.id==="col_priority"?M(t.id,{priority:V}):M(t.id,{textValues:{...(U=F[t.id])==null?void 0:U.textValues,[n.id]:V}})},tabIndex:0,darkMode:s})}):n.type==="person"?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(At,{personId:n.id==="col_person"?((_e=F[t.id])==null?void 0:_e.personId)||null:((it=(de=F[t.id])==null?void 0:de.textValues)==null?void 0:it[n.id])||null,onChange:V=>{var U;n.id==="col_person"?M(t.id,{personId:V}):M(t.id,{textValues:{...(U=F[t.id])==null?void 0:U.textValues,[n.id]:V||""}})},tabIndex:0,darkMode:s})}):n.type==="date"?e.jsx("div",{className:"w-full h-full relative flex items-center justify-center",children:e.jsx("div",{className:`text-xs cursor-pointer font-medium px-2 py-1 rounded transition-colors focus:ring-2 focus:ring-blue-500 focus:outline-none ${s?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-500 hover:text-gray-800 hover:bg-gray-100"}`,onClick:V=>{var ge,je,Ee;V.stopPropagation();const U=V.currentTarget.getBoundingClientRect(),se=n.id==="col_date",ue=se?((ge=F[t.id])==null?void 0:ge.dueDate)||"":((Ee=(je=F[t.id])==null?void 0:je.textValues)==null?void 0:Ee[n.id])||"";be({taskId:"draft-"+t.id,colId:n.id,date:ue,rect:U,onSelect:Ne=>{var Ce;se?M(t.id,{dueDate:Ne}):M(t.id,{textValues:{...(Ce=F[t.id])==null?void 0:Ce.textValues,[n.id]:Ne}})}})},tabIndex:0,onKeyDown:V=>{var U,se,ue;if(V.key==="Enter"||V.key===" "){V.preventDefault();const ge=V.currentTarget.getBoundingClientRect(),je=n.id==="col_date",Ee=je?((U=F[t.id])==null?void 0:U.dueDate)||"":((ue=(se=F[t.id])==null?void 0:se.textValues)==null?void 0:ue[n.id])||"";be({taskId:"draft-"+t.id,colId:n.id,date:Ee,rect:ge,onSelect:Ne=>{var Ce;je?M(t.id,{dueDate:Ne}):M(t.id,{textValues:{...(Ce=F[t.id])==null?void 0:Ce.textValues,[n.id]:Ne}})}})}},children:(()=>{var se,ue,ge;const U=n.id==="col_date"?(se=F[t.id])==null?void 0:se.dueDate:(ge=(ue=F[t.id])==null?void 0:ue.textValues)==null?void 0:ge[n.id];return U?new Date(U).toLocaleDateString(void 0,{month:"short",day:"numeric"}):e.jsx("span",{className:"text-gray-300",children:"Set Date"})})()})}):n.type==="text"?e.jsx("input",{type:"text",value:((lt=(ot=F[t.id])==null?void 0:ot.textValues)==null?void 0:lt[n.id])||"",onChange:V=>{var U;return M(t.id,{textValues:{...(U=F[t.id])==null?void 0:U.textValues,[n.id]:V.target.value}})},className:"w-full h-full text-center px-2 bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded text-gray-600",placeholder:"-",tabIndex:0,onKeyDown:V=>V.key==="Enter"&&Ge(t.id)}):n.type==="number"?e.jsx("input",{type:"text",value:((dt=(ct=F[t.id])==null?void 0:ct.textValues)==null?void 0:dt[n.id])||"",onChange:V=>{var se;const U=V.target.value;/^[0-9.,]*$/.test(U)&&M(t.id,{textValues:{...(se=F[t.id])==null?void 0:se.textValues,[n.id]:U}})},className:"w-full h-full text-center px-2 bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded text-gray-600 font-mono text-xs",placeholder:"0",tabIndex:0,onKeyDown:V=>V.key==="Enter"&&Ge(t.id)}):e.jsx("div",{className:"w-full h-full"})},n.id)}),e.jsx("div",{className:`transition-colors ${s?"bg-[#1a1d24] group-hover/add-row:bg-white/5":"bg-white group-hover/add-row:bg-gray-50"}`})]}),e.jsxs("div",{className:`grid gap-px border-t rounded-b-xl min-w-full w-fit ${s?"bg-[#1a1d24] border-gray-800":"bg-white border-gray-200"}`,style:{gridTemplateColumns:Ae+" "+t.columns.map(n=>n.width).join(" ")+" "+Pe},children:[e.jsx("div",{className:`flex items-center justify-center border-r sticky left-0 z-10 border-r-2 ${s?"bg-[#1a1d24] border-gray-800 border-r-gray-800":"bg-white border-gray-100 border-r-gray-200/50"}`}),e.jsx("div",{className:`flex items-center justify-center sticky left-[50px] z-10 border-t ${s?"bg-[#1a1d24] border-gray-800":"bg-white border-gray-200"}`,children:e.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider"})}),t.columns.slice(1).map(n=>e.jsxs("div",{className:`border-r min-h-[32px] flex items-center justify-center px-2 ${s?"bg-[#1a1d24] border-gray-800":"bg-white border-gray-100"}`,children:[n.type==="status"&&e.jsx("div",{className:"w-full h-4 flex rounded-sm overflow-hidden",children:Object.values(z).map(D=>{const S=a.filter(B=>Be(t,B)===D).length;if(S===0)return null;const H=S/Math.max(a.length,1)*100;return e.jsx("div",{style:{width:H+"%"},title:D+": "+S,className:kt[D]+" h-full hover:opacity-80 transition-opacity"},D)})}),n.type==="priority"&&e.jsx("div",{className:"w-full h-4 flex rounded-sm overflow-hidden",children:Object.values(K).map(D=>{const S=t.tasks.filter(B=>(n.id==="col_priority"?B.priority:B.textValues[n.id])===D).length;if(S===0)return null;const H=S/t.tasks.length*100;return e.jsx("div",{style:{width:H+"%"},title:D+": "+S,className:ke[D]+" h-full hover:opacity-80 transition-opacity"},D)})}),n.type==="person"&&(()=>{const D=t.tasks.filter(S=>{const H=n.id==="col_owner"?S.personId:S.textValues[n.id];return H&&H.length>0}).length;return D===0?null:e.jsxs("div",{className:"flex flex-col items-center justify-center leading-none",children:[e.jsx("span",{className:"text-sm text-gray-500 font-medium",children:D}),e.jsx("span",{className:"text-[10px] text-gray-400",children:"owners"})]})})(),n.type==="money"&&(()=>{const D=t.tasks.reduce((S,H)=>{var X;const B=(X=H.textValues[n.id])==null?void 0:X.replace(/,/g,"");return S+(Number(B)||0)},0);return e.jsxs("div",{className:"flex flex-col items-center justify-center leading-none",children:[e.jsxs("span",{className:"text-xs text-gray-700 font-bold font-mono",children:[n.currency||"$"," ",D.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("span",{className:"text-[10px] text-gray-400",children:"sum"})]})})(),n.type==="checkbox"&&(()=>{const D=t.tasks.filter(S=>S.textValues[n.id]==="true").length;return D===0?null:e.jsxs("div",{className:"flex flex-col items-center justify-center leading-none",children:[e.jsx("span",{className:"text-xs text-gray-700 font-bold font-mono",children:D}),e.jsx("span",{className:"text-[10px] text-gray-400",children:"checked"})]})})(),n.type==="number"&&(()=>{const D=t.tasks.reduce((S,H)=>{var X;const B=(X=H.textValues[n.id])==null?void 0:X.replace(/,/g,"");return S+(Number(B)||0)},0);return e.jsxs("div",{className:"flex flex-col items-center justify-center leading-none",children:[e.jsx("span",{className:"text-xs text-gray-700 font-bold font-mono",children:D.toLocaleString()}),e.jsx("span",{className:"text-[10px] text-gray-400",children:"sum"})]})})(),(n.type==="text"||n.type==="long_text"||n.type==="date"||n.type==="dropdown"||n.type==="name")&&(()=>{const D=t.tasks.filter(S=>{if(n.type==="name")return!0;const H=S.textValues[n.id];return H&&H.trim().length>0}).length;return D===0?null:e.jsxs("div",{className:"flex flex-col items-center justify-center leading-none",children:[e.jsx("span",{className:"text-xs text-gray-700 font-bold font-mono",children:D}),e.jsx("span",{className:"text-[10px] text-gray-400",children:"count"})]})})()]},n.id)),e.jsx("div",{className:`${s?"bg-[#1a1d24]":"bg-white"}`})]})]})]},t.id)})})]}),e.jsx(ms,{children:Te>0&&e.jsx(xt.div,{className:"fixed bottom-16 md:bottom-20 left-0 right-0 px-4 z-50 pointer-events-none",initial:{opacity:0,y:16,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:16,scale:.98},transition:{duration:.18,ease:"easeOut"},children:e.jsx(xt.div,{className:`mx-auto max-w-5xl shadow-2xl border rounded-2xl px-6 py-3 flex items-center gap-6 pointer-events-auto justify-center ${s?"bg-[#1a1d24] border-gray-800":"bg-white border-gray-200"}`,initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:8},transition:{duration:.18,ease:"easeOut",delay:.02},children:e.jsx("div",{className:"flex items-center gap-5 text-sm text-gray-600 flex-wrap md:flex-nowrap justify-center w-full",children:e.jsxs("div",{className:"flex items-center gap-5 flex-wrap md:flex-nowrap justify-center",children:[e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",onClick:is,children:[e.jsx(Ct,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Duplicate"})]}),e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",children:[e.jsx(ps,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Export"})]}),e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",children:[e.jsx(Ys,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Archive"})]}),e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",onClick:_t,children:[e.jsx(Ue,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Delete"})]}),e.jsxs("button",{className:"flex items-center gap-2 text-gray-400 cursor-not-allowed whitespace-nowrap",disabled:!0,children:[e.jsx(ht,{size:18,className:"text-gray-400"})," ",e.jsx("span",{children:"Convert"})]}),e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",children:[e.jsx(ht,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Move to"})]}),e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",children:[e.jsx(St,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Sidekick"})]}),e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",children:[e.jsx(Nt,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Apps"})]}),e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",onClick:ns,children:[e.jsx(De,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Clear"})]})]})})})})}),!i&&e.jsx("div",{className:"absolute bottom-6 left-1/2 transform -translate-x-1/2 w-full max-w-2xl px-4",children:e.jsxs("div",{className:`backdrop-blur-md rounded-full shadow-2xl border p-2 flex items-center gap-3 pl-5 transition-all focus-within:ring-4 ring-indigo-500/10 ${s?"bg-[#1a1d24]/90 border-white/10":"bg-white/90 border-white/50"}`,children:[e.jsx(He,{className:"text-indigo-500 w-5 h-5 animate-pulse"}),e.jsx("input",{type:"text",value:P,onChange:t=>h(t.target.value),onKeyDown:t=>t.key==="Enter"&&Q(),placeholder:"Ask AI to build a plan (e.g. 'Plan a product launch for next month')",className:"flex-1 bg-transparent focus:outline-none text-sm text-gray-800 py-2 placeholder-gray-500"}),e.jsx("button",{onClick:Q,disabled:L||!P,className:"bg-indigo-600 text-white rounded-full px-6 py-2.5 text-sm font-medium hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-all hover:shadow-lg flex items-center gap-2",children:L?e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsx("span",{children:"Generate"})})]})})]}),ve&&e.jsx(Dr,{x:ve.x,y:ve.y,onClose:()=>Re(null),onAction:t=>Wt(t,ve.groupId,ve.colId)}),pe&&me.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-[9998] bg-transparent",onClick:t=>{t.stopPropagation(),be(null)}}),e.jsx("div",{className:"fixed z-[10005]",style:{top:pe.rect.bottom+8,left:pe.rect.left+pe.rect.width/2,transform:"translateX(-50%)"},onClick:t=>t.stopPropagation(),children:e.jsx(Is,{date:pe.date,onSelect:t=>{pe.onSelect(t)},onClose:()=>be(null)})})]}),document.body),te&&me.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-[9998] bg-transparent",onClick:t=>{t.stopPropagation(),we(null)}}),e.jsx("div",{className:"fixed top-[100px] bottom-0 right-0 z-[10005]",onClick:t=>t.stopPropagation(),children:e.jsx(ks,{onClose:()=>we(null),onSelect:(t,a,d,f)=>{te&&y(te.groupId,t,a,d,f),we(null)},darkMode:s})})]}),document.body),Oe&&e.jsx(kr,{isOpen:!!Oe,onClose:()=>Xe(null),group:o.groups.find(t=>t.id===Oe)}),Ye&&e.jsx(Pr,{isOpen:!0,onClose:()=>Ke(null),group:o.groups.find(t=>t.id===Ye)}),Ze&&e.jsx(Tr,{isOpen:!0,onClose:()=>Qe(null),group:o.groups.find(t=>t.id===Ze)}),e.jsx(ys,{isOpen:!!q,onClose:()=>fe(null),onConfirm:Et,title:(q==null?void 0:q.type)==="task"?"Delete Task":(q==null?void 0:q.type)==="group"?"Delete Group":(q==null?void 0:q.type)==="column"?"Delete Column":"Delete Selected Tasks",message:(q==null?void 0:q.type)==="task"?"Are you sure you want to delete this task? This action cannot be undone.":(q==null?void 0:q.type)==="group"?"Are you sure you want to delete this group and all its tasks? This action cannot be undone.":(q==null?void 0:q.type)==="column"?"Are you sure you want to delete this column? This action cannot be undone.":`Are you sure you want to delete ${Te} tasks? This action cannot be undone.`,confirmText:"Delete",variant:"danger"})]}),e.jsx(Vs,{children:et?e.jsxs("div",{className:`flex items-center p-3 rounded-lg shadow-2xl border cursor-grabbing ${s?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:"mr-3 text-gray-400",children:e.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"9",cy:"12",r:"1"}),e.jsx("circle",{cx:"9",cy:"5",r:"1"}),e.jsx("circle",{cx:"9",cy:"19",r:"1"}),e.jsx("circle",{cx:"15",cy:"12",r:"1"}),e.jsx("circle",{cx:"15",cy:"5",r:"1"}),e.jsx("circle",{cx:"15",cy:"19",r:"1"})]})}),e.jsx("span",{className:`text-sm font-medium ${s?"text-gray-200":"text-gray-700"}`,children:((at=o.groups.flatMap(t=>t.tasks).find(t=>t.id===et))==null?void 0:at.name)||"Task"})]}):e.jsx("div",{className:"p-2 bg-red-500 text-white rounded",children:"Warning: Dragging Unknown Task"})})]})});export{Ys as A,$e as I,yr as P,z as S,on as T,kt as a,K as b,Sr as u};
