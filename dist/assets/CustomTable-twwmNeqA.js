import{r as o,j as e,at as Q,$ as he,T as A,be as ge,P as pe,z as fe,k as be}from"./index-DYCMOhyY.js";import{F as ye,r as je,u as ve,S as Ne}from"./xlsx-CLCeUIlT.js";import{P as we,C as Ce}from"./TaskBoardIcons-jR9B2fMY.js";import{A as ke}from"./arrow-up-down-CfV2NEUS.js";import{S as Se}from"./star-lcAsu_-e.js";const ze=[{name:"Default",value:"transparent"},{name:"Red",value:"#fee2e2"},{name:"Green",value:"#dcfce7"},{name:"Blue",value:"#dbeafe"},{name:"Yellow",value:"#fef9c3"},{name:"Purple",value:"#f3e8ff"},{name:"Orange",value:"#ffedd5"}],Pe=10,Ue=({id:Me,title:X,columns:k,showBorder:Ee,headerColor:$e,onDelete:L,onRenameTable:V,onRenameColumn:O,onAddColumn:U,onUpdateColumnType:Re,onDeleteColumn:B,onUpdateColumnColor:Te,onUpdateRow:W,onRowsChange:x,rows:P})=>{const[v,N]=o.useState(P||[{id:"1",data:{}},{id:"2",data:{}},{id:"2",data:{}},{id:"3",data:{}}]),[d,w]=o.useState(1),[p,Z]=o.useState(Pe),[M,Fe]=o.useState([]),[F,G]=o.useState(!1),[De,Ie]=o.useState(!1),[D,ee]=o.useState([]),E=o.useRef(null),[c,te]=o.useState(null),[S,$]=o.useState(null),se=t=>{ee(s=>s.includes(t)?s.filter(r=>r!==t):[...s,t])},re=t=>{let s="asc";c&&c.key===t&&c.direction==="asc"&&(s="desc"),te({key:t,direction:s})},ae=async t=>{var a;const s=(a=t.target.files)==null?void 0:a[0];if(!s)return;const r=new FileReader;r.onload=l=>{var h;try{const b=(h=l.target)==null?void 0:h.result,n=je(b,{type:"binary"}),de=n.SheetNames[0],ce=n.Sheets[de],_=ve.sheet_to_json(ce,{header:1});if(_.length===0){alert("Excel file is empty!");return}const ue=_[0],q=_.slice(1).filter(C=>C&&C.some(y=>y!=null&&y!==""));if(q.length===0){alert("No data rows found in Excel file!");return}const Y={};ue.forEach((C,y)=>{const R=k.find(g=>g.name.toLowerCase()===C.toString().toLowerCase());R&&(Y[y]=R.id)});const J=q.map((C,y)=>{const R=`imported-${Date.now()}-${y}`,g={};return C.forEach((i,xe)=>{const j=Y[xe];if(!j)return;const T=k.find(u=>u.id===j);if(T)if(T.type==="checkbox")g[j]=i===!0||i==="true"||i==="TRUE"||i===1||i==="1";else if(T.type==="number"){const u=Number(i);g[j]=isNaN(u)?i:u}else if(T.type==="date")if(typeof i=="number"){const u=Ne.parse_date_code(i),me=new Date(u.y,u.m-1,u.d);g[j]=me.toISOString().split("T")[0]}else{const u=new Date(i);g[j]=isNaN(u.getTime())?(i==null?void 0:i.toString())||"":u.toISOString().split("T")[0]}else g[j]=i!=null?i.toString():""}),{id:R,data:g}}),K=[...v,...J];N(K),x&&x(K),alert(`✅ Imported ${J.length} rows!`)}catch(b){alert(`Failed to import Excel file: ${b instanceof Error?b.message:"Unknown error"}`)}},r.readAsBinaryString(s),E.current&&(E.current.value="")},I=k.filter(t=>!D.includes(t.id)),z=v.filter(t=>M.length===0?!0:M.every(s=>{const r=String(t.data[s.columnId]||"").toLowerCase(),a=s.value.toLowerCase();switch(s.operator){case"contains":return r.includes(a);case"equals":return r===a;case"starts_with":return r.startsWith(a);case"ends_with":return r.endsWith(a);default:return!0}})).sort((t,s)=>{if(!c)return 0;const r=t.data[c.key],a=s.data[c.key];if(r===a)return 0;const l=c.direction==="asc"?1:-1;return!isNaN(Number(r))&&!isNaN(Number(a))?(Number(r)-Number(a))*l:String(r).localeCompare(String(a))*l}),m=Math.ceil(z.length/p),H=z.slice((d-1)*p,d*p);o.useEffect(()=>{d>m&&m>0?w(m):d===0&&m>0&&w(1)},[z.length,m,d]),o.useEffect(()=>{P&&N(P)},[P]);const ne=t=>{Z(Number(t.target.value)),w(1)},ie=()=>{const t={};k.forEach(a=>{a.type==="date"&&(t[a.id]=new Date().toISOString().split("T")[0])});const s={id:Math.random().toString(36).substr(2,9),data:t},r=[...v,s];if(N(r),x&&x(r),M.length===0){const a=Math.ceil(r.length/p);w(a)}},f=(t,s,r)=>{const a=v.map(l=>{if(l.id===t){const h={...l.data,[s]:r};return W&&W(t,h),{...l,data:h}}return l});N(a),x&&x(a)},le=t=>{const s=v.filter(r=>r.id!==t);N(s),x&&x(s)},oe=(t,s)=>{const r=v.map(a=>a.id===t?{...a,color:s}:a);N(r),x&&x(r)};return e.jsxs("div",{className:"mb-8 bg-white rounded-xl animate-in fade-in duration-500 flex flex-col",children:[e.jsxs("div",{className:"px-0 py-6 flex justify-between items-center bg-white shrink-0",children:[e.jsx("input",{type:"text",value:X,onChange:t=>V&&V(t.target.value),className:"text-xl font-semibold text-gray-900 bg-transparent border-none focus:ring-0 p-0 w-full mr-4 placeholder-gray-300",placeholder:"Table Name"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:E,type:"file",accept:".xlsx, .xls",onChange:ae,className:"hidden"}),e.jsxs("button",{onClick:()=>{var t;return(t=E.current)==null?void 0:t.click()},className:"flex items-center space-x-2 px-4 py-2 bg-green-50 hover:bg-green-100 text-green-700 rounded-lg text-sm font-medium transition-colors",title:"Import from Excel",children:[e.jsx("span",{children:"Import"}),e.jsx(ye,{size:14})]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>G(!F),className:`flex items-center space-x-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${F?"bg-gray-200 text-gray-900":"bg-gray-100 hover:bg-gray-200 text-gray-700"}`,children:[e.jsx("span",{children:"Filter"}),e.jsx(Q,{size:14,className:"text-gray-500"})]}),F&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>G(!1)}),e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-64 bg-white rounded-xl shadow-xl border border-gray-100 z-50 p-2 animate-in fade-in zoom-in-95 duration-100 ring-1 ring-black/5",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3 px-3 mt-2",children:"Show/Hide Columns"}),e.jsx("div",{className:"space-y-0.5 max-h-60 overflow-y-auto custom-scrollbar",children:k.map(t=>e.jsxs("button",{onClick:()=>se(t.id),className:"flex items-center w-full px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-lg transition-colors group",children:[e.jsx("div",{className:`w-4 h-4 mr-3 rounded border flex items-center justify-center transition-colors ${D.includes(t.id)?"border-gray-300 group-hover:border-gray-400":"bg-blue-600 border-blue-600"}`,children:!D.includes(t.id)&&e.jsx(he,{size:10,className:"text-white"})}),e.jsx("span",{className:"truncate font-medium",children:t.name||"Untitled"})]},t.id))})]})]})]}),L&&e.jsx("button",{onClick:L,className:"p-2 bg-red-50 hover:bg-red-100 text-red-500 hover:text-red-600 rounded-lg transition-colors",title:"Delete Table",children:e.jsx(A,{size:20})})]})]}),e.jsx("div",{className:"overflow-x-auto flex-1 scrollbar-hide border-t border-gray-100",children:e.jsxs("table",{className:"min-w-full border-collapse",style:{tableLayout:"auto"},children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50/50 border-b border-gray-100",children:[I.map(t=>e.jsx("th",{className:"px-6 py-4 text-left relative group/header first:pl-4 cursor-pointer hover:bg-gray-100 transition-colors",style:{minWidth:t.width},onClick:()=>re(t.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"relative w-full flex items-center space-x-2",children:[e.jsx("span",{className:"invisible whitespace-pre text-xs font-medium text-gray-500 block min-w-[80px]",children:t.name||"Column"}),e.jsx("input",{type:"text",value:t.name,onChange:s=>O&&O(t.id,s.target.value),onClick:s=>s.stopPropagation(),className:"absolute inset-0 w-full h-full bg-transparent border-none focus:ring-0 p-0 text-xs font-medium text-gray-500 hover:text-gray-700 transition-colors cursor-text"}),(c==null?void 0:c.key)===t.id&&e.jsx(ke,{size:12,className:`text-gray-400 ${c.direction==="asc"?"rotate-0":"rotate-180"} transition-transform`})]}),e.jsx("button",{onClick:s=>{s.stopPropagation(),B&&B(t.id)},className:"text-gray-300 hover:text-red-500 transition-colors p-1 opacity-0 group-hover/header:opacity-100 ml-2 shrink-0",title:"Delete Column",children:e.jsx(A,{size:12})})]})},t.id)),e.jsx("th",{className:"px-2 py-2 w-10",children:e.jsx("div",{className:"flex items-center justify-center relative group bg-gray-50/80",children:e.jsx("div",{className:"cursor-pointer w-6 h-6 rounded flex items-center justify-center transition-all duration-200 "+(S?"bg-gray-200 text-gray-900":"text-gray-400 hover:text-gray-700 hover:bg-gray-200/50"),onClick:t=>{t.stopPropagation();const s=t.currentTarget.getBoundingClientRect();$(S?null:{id:"table-add",rect:s})},title:"Add Column",children:e.jsx(we,{className:"w-4 h-4"})})})})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-50",children:H.length>0?H.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors group",style:{backgroundColor:t.color||"transparent"},children:[I.map(s=>{var r,a,l,h,b;return e.jsx("td",{className:"p-0 align-middle first:pl-4",style:{backgroundColor:s.color||"transparent"},children:s.type==="checkbox"?e.jsx("div",{className:"w-full h-full flex items-center justify-center py-4",children:e.jsx("input",{type:"checkbox",checked:t.data[s.id]||!1,onChange:n=>f(t.id,s.id,n.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 cursor-pointer"})}):s.type==="status"||s.type==="dropdown"?e.jsx("div",{className:"w-full h-full px-4 py-3",children:e.jsxs("select",{value:t.data[s.id]||"",onChange:n=>f(t.id,s.id,n.target.value),className:"w-full h-8 text-xs rounded border-0 bg-transparent focus:ring-0 cursor-pointer font-medium",style:{backgroundColor:((a=(r=s.options)==null?void 0:r.find(n=>n.label===t.data[s.id]))==null?void 0:a.color)||"transparent",color:(h=(l=s.options)==null?void 0:l.find(n=>n.label===t.data[s.id]))!=null&&h.color?"#1f2937":"inherit"},children:[e.jsx("option",{value:"",children:"Select..."}),(b=s.options)==null?void 0:b.map(n=>e.jsx("option",{value:n.label,children:n.label},n.id))]})}):s.type==="long_text"?e.jsx("div",{className:"relative w-full h-full",children:e.jsx("textarea",{value:t.data[s.id]||"",onChange:n=>f(t.id,s.id,n.target.value),className:"absolute inset-0 w-full h-full px-4 py-2 bg-transparent border-none focus:ring-2 focus:ring-inset focus:ring-blue-500/20 text-sm text-gray-600 placeholder-gray-300 resize-none leading-relaxed",placeholder:"..."})}):s.type==="money"?e.jsxs("div",{className:"relative w-full h-full flex items-center px-4",children:[e.jsx("span",{className:"text-gray-400 text-sm mr-1",children:s.currency==="EUR"?"€":s.currency==="GBP"?"£":"$"}),e.jsx("input",{type:"number",value:t.data[s.id]||"",onChange:n=>f(t.id,s.id,n.target.value),className:"w-full h-full bg-transparent border-none focus:ring-0 p-0 text-sm text-gray-600 placeholder-gray-300",placeholder:"0.00"})]}):s.type==="rating"?e.jsx("div",{className:"w-full h-full flex items-center px-4 space-x-1",children:[1,2,3,4,5].map(n=>e.jsx("button",{onClick:()=>f(t.id,s.id,n),className:"focus:outline-none transition-transform hover:scale-110",children:e.jsx(Se,{size:16,className:`${(t.data[s.id]||0)>=n?"text-amber-400 fill-amber-400":"text-gray-300"}`})},n))}):s.type==="progress_manual"?e.jsxs("div",{className:"w-full h-full flex items-center px-4 space-x-2 group/progress",children:[e.jsxs("div",{className:"flex-1 h-2 bg-gray-100 rounded-full overflow-hidden relative cursor-pointer",children:[e.jsx("div",{className:"absolute top-0 left-0 h-full bg-green-500 transition-all",style:{width:`${Math.min(100,Math.max(0,Number(t.data[s.id]||0)))}%`}}),e.jsx("input",{type:"range",min:"0",max:"100",value:t.data[s.id]||0,onChange:n=>f(t.id,s.id,n.target.value),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"})]}),e.jsxs("span",{className:"text-xs text-gray-500 w-8 text-right",children:[t.data[s.id]||0,"%"]})]}):e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("span",{className:"invisible whitespace-pre px-6 py-4 block min-w-[80px] text-sm text-gray-600",children:t.data[s.id]||"..."}),e.jsx("input",{type:s.type==="number"?"number":s.type==="date"?"date":s.type==="email"?"email":s.type==="phone"?"tel":"text",value:t.data[s.id]||"",onChange:n=>f(t.id,s.id,n.target.value),className:`absolute inset-0 w-full h-full px-6 py-4 bg-transparent border-none focus:ring-2 focus:ring-inset focus:ring-blue-500/20 text-sm text-gray-600 placeholder-gray-300 ${s.type==="website"?"text-blue-600 underline":""}`,placeholder:"..."})]})},s.id)}),e.jsx("td",{className:"w-16 p-0 align-middle",children:e.jsxs("div",{className:"flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity space-x-1 px-2",children:[e.jsxs("div",{className:"relative group/color",children:[e.jsx("button",{className:"text-gray-300 hover:text-blue-600 p-1.5 rounded-lg hover:bg-blue-50 transition-colors",children:e.jsx(ge,{size:14})}),e.jsx("div",{className:"absolute bottom-full right-0 mb-1 bg-white rounded-xl shadow-xl border border-gray-100 p-3 hidden group-hover/color:grid grid-cols-4 gap-2 w-40 z-50 ring-1 ring-black/5",children:ze.map(s=>e.jsx("button",{onClick:()=>oe(t.id,s.value),className:`w-6 h-6 rounded-full border border-gray-200 hover:scale-110 transition-transform ${t.color===s.value?"ring-2 ring-blue-500 ring-offset-1":""}`,style:{backgroundColor:s.value},title:s.name},s.value))})]}),e.jsx("button",{onClick:()=>le(t.id),className:"text-gray-300 hover:text-red-500 p-1.5 rounded-lg hover:bg-red-50 transition-colors",title:"Delete Row",children:e.jsx(A,{size:14})})]})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:I.length+1,className:"px-6 py-12 text-center text-gray-400 text-sm",children:e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-50 rounded-full flex items-center justify-center",children:e.jsx(Q,{size:20,className:"text-gray-300"})}),e.jsx("span",{children:M.length>0?"No results match your filters":"No data available"})]})})})})]})}),e.jsxs("div",{className:"px-0 py-4 border-t border-gray-100 bg-white flex items-center justify-between shrink-0",children:[e.jsxs("button",{onClick:ie,className:"flex items-center space-x-2 px-3 py-1.5 text-sm font-medium text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 group",title:"Add Row",children:[e.jsx("div",{className:"w-5 h-5 rounded-md border border-gray-300 flex items-center justify-center group-hover:border-blue-300 transition-colors",children:e.jsx(pe,{size:12})}),e.jsx("span",{children:"Add Row"})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Rows per page:"}),e.jsxs("select",{value:p,onChange:ne,className:"text-xs border-none bg-gray-50 rounded px-2 py-1 focus:ring-0 cursor-pointer text-gray-700 font-medium",children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"})]})]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[(d-1)*p+1,"-",Math.min(d*p,z.length)," of ",z.length]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>w(t=>Math.max(1,t-1)),disabled:d===1,className:`p-1.5 rounded-lg transition-colors ${d===1?"text-gray-300 cursor-not-allowed":"text-gray-500 hover:text-blue-600 hover:bg-blue-50"}`,children:e.jsx(fe,{size:16})}),e.jsx("button",{onClick:()=>w(t=>Math.min(m,t+1)),disabled:d===m,className:`p-1.5 rounded-lg transition-colors ${d===m?"text-gray-300 cursor-not-allowed":"text-gray-500 hover:text-blue-600 hover:bg-blue-50"}`,children:e.jsx(be,{size:16})})]})]})]}),S&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>$(null)}),e.jsx("div",{className:"fixed z-50 animate-in fade-in zoom-in-95 duration-200",style:{top:S.rect.top-45,left:Math.min(window.innerWidth-350,S.rect.left-300),height:"auto",maxHeight:"600px"},children:e.jsx(Ce,{onClose:()=>$(null),onSelect:(t,s,r,a)=>{U&&U(t,{name:s,options:r,currency:a}),$(null)}})})]})]})};export{Ue as C};
