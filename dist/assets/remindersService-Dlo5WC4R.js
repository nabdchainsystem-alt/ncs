import{a9 as d,a7 as s,Z as a}from"./index-sqQsKImc.js";const m={getReminders:async t=>{const e=s();let i=d.from("reminders").select("*").eq("company_id",e);t&&(i=i.eq("list_id",t));const{data:r,error:o}=await i;return o?(console.error("Error fetching reminders:",o),[]):(r||[]).map(n=>({id:n.id,title:n.title,notes:n.notes,dueDate:n.due_date,secondaryDueDate:n.secondary_due_date,time:n.time,priority:n.priority,listId:n.list_id,tags:n.tags||[],completed:n.completed,subtasks:n.subtasks||[],company_id:n.company_id}))},addReminder:async t=>{const e=s(),i={title:t.title,notes:t.notes,due_date:t.dueDate,secondary_due_date:t.secondaryDueDate,time:t.time,priority:t.priority,list_id:t.listId,tags:t.tags,completed:t.completed,subtasks:t.subtasks,company_id:e},{data:r,error:o}=await d.from("reminders").insert(i).select().single();if(o)throw console.error("Error adding reminder:",o),o;return window.dispatchEvent(new Event("reminders-updated")),{...t,id:r.id}},updateReminder:async(t,e)=>{const i={};e.title!==void 0&&(i.title=e.title),e.notes!==void 0&&(i.notes=e.notes),e.dueDate!==void 0&&(i.due_date=e.dueDate),e.secondaryDueDate!==void 0&&(i.secondary_due_date=e.secondaryDueDate),e.time!==void 0&&(i.time=e.time),e.priority!==void 0&&(i.priority=e.priority),e.listId!==void 0&&(i.list_id=e.listId),e.tags!==void 0&&(i.tags=e.tags),e.completed!==void 0&&(i.completed=e.completed),e.subtasks!==void 0&&(i.subtasks=e.subtasks);const{error:r}=await d.from("reminders").update(i).eq("id",t);if(r){console.error("Error updating reminder:",r);return}window.dispatchEvent(new Event("reminders-updated"))},deleteReminder:async t=>{const{error:e}=await d.from("reminders").delete().eq("id",t);e&&console.error("Error deleting reminder:",e),window.dispatchEvent(new Event("reminders-updated"))},deleteRemindersByListId:async t=>{const{error:e}=await d.from("reminders").delete().eq("list_id",t);e&&console.error("Error deleting reminders by list:",e),window.dispatchEvent(new Event("reminders-updated"))},getLists:async()=>{const t=s(),{data:e,error:i}=await d.from("reminder_lists").select("*").eq("company_id",t);return i?(console.error("Error fetching lists:",i),[]):(e||[]).map(r=>({id:r.id,name:r.name,type:r.type,icon:r.icon,count:r.count,color:r.color,company_id:r.company_id}))},addList:async t=>{const e=s(),i=a(),r={id:i,name:t.name,type:t.type,icon:t.icon,count:0,color:t.color,company_id:e},{error:o}=await d.from("reminder_lists").insert(r);if(o)throw console.error("Error adding list:",o),o;return window.dispatchEvent(new Event("reminders-lists-updated")),{...t,id:i,count:0}},deleteList:async t=>{const{error:e}=await d.from("reminder_lists").delete().eq("id",t);e&&console.error("Error deleting list:",e),window.dispatchEvent(new Event("reminders-lists-updated"))},subscribe:t=>{const e=()=>t();return window.addEventListener("reminders-updated",e),window.addEventListener("reminders-lists-updated",e),()=>{window.removeEventListener("reminders-updated",e),window.removeEventListener("reminders-lists-updated",e)}}};export{m as r};
