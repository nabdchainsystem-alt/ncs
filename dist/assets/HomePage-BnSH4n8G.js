import{c as Y,r as f,K,N as q,j as e,O as Z,k as R,e as X,h as T,X as ee,Q as te,T as J,R as E,C as O,V as G,J as W,W as F,Y as se,Z as B,_ as oe,P as ae,u as ne,D as re,$ as le}from"./index-B2SFjcJL.js";import{C as ie,d as ce}from"./discussionService-BI3B1NdW.js";import{I as P,T as de,A as Q}from"./TaskBoard-ejLQd_g0.js";import{D as xe}from"./remindersService-zGzTsx_y.js";import{T as me}from"./ColumnMenu-BvyMittW.js";import{S as V}from"./square-check-big-DPGxLAw4.js";import{S as ue}from"./square-C8keCSEB.js";import"./constants-DIz9rW5w.js";import"./index-Ca_DMGSD.js";import"./copy-D5twc85r.js";import"./list-Ds4obQst.js";import"./list-ordered-C_5XeJ7S.js";import"./flag-DpjAhyDO.js";import"./smile-CQSSvyfc.js";import"./core.esm-QUJsqprI.js";import"./sortable.esm-bFtSoKBW.js";import"./star-tf2Ijocp.js";import"./phone-BybaaGlv.js";import"./circle-plus-C2KKyCpO.js";import"./type-DCtxMeSp.js";import"./paperclip-C8HP2wh7.js";import"./minus-BtcSKIt1.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}]],pe=Y("list-checks",he);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],fe=Y("thumbs-down",ge),A="taskboard-quick-draft",be=({isOpen:i,onClose:b,onSend:w,rooms:N=[],darkMode:c=!1})=>{const[a,r]=f.useState(!1),[l,h]=f.useState({type:"main",name:"My Tasks"}),[n,x]=f.useState(!1),k=f.useRef(null),D=()=>{b()},{ref:p,setIsActive:v}=K({onCancel:D,initialActive:i});if(f.useEffect(()=>{v(i)},[i,v]),f.useEffect(()=>{if(i){if(r(!0),h({type:"main",name:"My Tasks"}),x(!1),!localStorage.getItem(A)){const g={...P,id:"draft-board",name:"Draft Task",groups:[{...P.groups[0],id:q(),title:"New Group",tasks:[]}]};localStorage.setItem(A,JSON.stringify(g))}}else{const g=setTimeout(()=>r(!1),300);return()=>clearTimeout(g)}},[i]),!a&&!i)return null;const j=()=>{var g;try{const C=(g=k.current)==null?void 0:g.exportBoardWithDrafts();if(!C){const I=localStorage.getItem(A);if(!I)return;w(JSON.parse(I),{type:l.type,roomId:l.roomId}),localStorage.removeItem(A);return}localStorage.setItem(A,JSON.stringify(C)),w(C,{type:l.type,roomId:l.roomId}),localStorage.removeItem(A)}catch(C){console.error("Failed to read draft board",C)}};return e.jsx("div",{className:`fixed inset-0 z-[9999] flex items-center justify-center transition-all duration-300 ${i?"bg-black/60 backdrop-blur-md opacity-100":"bg-transparent backdrop-blur-none opacity-0 pointer-events-none"}`,children:e.jsx("div",{ref:p,className:`w-full max-w-[95vw] h-auto max-h-[85vh] transform transition-all duration-300 ${i?"scale-100 translate-y-0 opacity-100":"scale-95 translate-y-4 opacity-0"}`,children:e.jsxs("div",{className:`relative w-full max-h-full flex flex-col rounded-3xl shadow-2xl overflow-hidden backdrop-blur-xl border ${c?"bg-gray-900/95 border-gray-700":"bg-white/95 border-white/40"}`,children:[e.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden relative min-h-[300px]",children:a&&e.jsx("div",{className:"min-w-full h-full",children:e.jsx(de,{ref:k,storageKey:A,darkMode:c,minimal:!0,showGroupHeader:!0})})}),e.jsxs("div",{className:`px-6 py-4 flex items-center justify-between border-t border-gray-100/10 shrink-0 ${c?"bg-black/20":"bg-white/40"}`,children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>x(!n),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${c?"text-gray-300 hover:bg-white/5":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx("span",{className:"opacity-60",children:"Save As:"}),e.jsxs("span",{className:`font-bold flex items-center gap-2 ${c?"text-white":"text-gray-900"}`,children:[l.type==="room"&&e.jsx(Z,{size:12,className:"text-indigo-400"}),l.type==="main"&&e.jsx(R,{size:12,className:"text-blue-400"}),l.name]}),e.jsx(X,{size:14,className:`opacity-50 transition-transform ${n?"rotate-180":""}`})]}),n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>x(!1)}),e.jsxs("div",{className:`absolute bottom-full left-0 mb-2 w-64 rounded-xl shadow-xl border overflow-hidden p-1 z-20 animate-in slide-in-from-bottom-2 fade-in duration-200 ${c?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("button",{onClick:()=>{h({type:"main",name:"My Tasks"}),x(!1)},className:`w-full flex items-center justify-between px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ${c?"hover:bg-white/5 text-gray-200":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-1.5 rounded-md ${c?"bg-blue-500/20 text-blue-400":"bg-blue-50 text-blue-600"}`,children:e.jsx(R,{size:14})}),e.jsx("span",{children:"My Tasks"})]}),l.type==="main"&&e.jsx(T,{size:16,className:"text-blue-500"})]}),e.jsx("div",{className:`my-1 mx-2 border-t ${c?"border-gray-700":"border-gray-100"}`}),e.jsx("div",{className:`px-3 py-1 text-xs font-semibold uppercase tracking-wider mb-1 ${c?"text-gray-500":"text-gray-400"}`,children:"Private Rooms"}),e.jsx("div",{className:"max-h-48 overflow-y-auto custom-scrollbar space-y-0.5",children:N.length===0?e.jsx("div",{className:`px-3 py-2 text-xs italic ${c?"text-gray-500":"text-gray-400"}`,children:"No rooms found"}):N.map(g=>e.jsxs("button",{onClick:()=>{h({type:"room",roomId:g.id,name:g.name}),x(!1)},className:`w-full flex items-center justify-between px-3 py-2 rounded-lg text-sm font-medium transition-colors ${c?"hover:bg-white/5 text-gray-200":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-md flex items-center justify-center text-[10px] font-bold text-white shadow-sm",style:{backgroundColor:g.color||"#3b82f6"},children:g.name.charAt(0).toUpperCase()}),e.jsx("span",{className:"truncate max-w-[140px]",children:g.name})]}),l.roomId===g.id&&e.jsx(T,{size:16,className:"text-indigo-500"})]},g.id))})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:D,className:`px-5 py-2.5 rounded-xl font-semibold text-sm transition-all ${c?"text-gray-400 hover:bg-white/10 hover:text-white":"text-gray-600 hover:bg-black/5 hover:text-gray-900"}`,children:"Cancel"}),e.jsx("button",{onClick:j,className:"px-6 py-2.5 rounded-xl font-semibold text-sm text-white shadow-lg active:scale-95 transition-all bg-[#2a2e35] hover:bg-[#32363e] border border-gray-700",children:e.jsx("span",{children:"Send Task"})})]})]})]})})})},je=({items:i,projects:b,onCapture:w,onSelect:N,onDelete:c})=>{const[a,r]=f.useState(""),[l,h]=f.useState(null),n=s=>{s.preventDefault(),a.trim()&&(w(a),r(""))},x=(s,o)=>{s.stopPropagation(),h(o)},k=(s,o)=>{s.stopPropagation(),c(o),h(null)},D=s=>{s.stopPropagation(),h(null)},p=i.filter(s=>s.status==="inbox").sort((s,o)=>o.createdAt-s.createdAt),v=s=>{const o=new Date;return s.getDate()===o.getDate()&&s.getMonth()===o.getMonth()&&s.getFullYear()===o.getFullYear()},j=s=>{const o=new Date;return o.setDate(o.getDate()-1),s.getDate()===o.getDate()&&s.getMonth()===o.getMonth()&&s.getFullYear()===o.getFullYear()},g=p.filter(s=>v(new Date(s.createdAt))),C=p.filter(s=>j(new Date(s.createdAt))),I=p.filter(s=>!v(new Date(s.createdAt))&&!j(new Date(s.createdAt))),t=({title:s,items:o,subtitle:d,highlight:y=!1})=>e.jsxs("div",{className:`flex flex-col h-full relative ${y?"bg-white/40 shadow-sm ring-1 ring-stone-900/5":"bg-transparent"} rounded-[2rem] p-1 transition-all duration-300`,children:[e.jsxs("div",{className:"flex-none flex items-center justify-between px-5 pt-4 pb-2 border-b border-stone-100/50 mb-1 mx-2",children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:`text-xs font-bold uppercase tracking-widest ${y?"text-stone-900":"text-stone-400"}`,children:s}),d&&e.jsx("span",{className:"text-[10px] text-stone-300 italic font-medium",children:d})]}),e.jsx("span",{className:`text-[10px] font-extrabold h-5 min-w-[1.25rem] flex items-center justify-center px-1.5 rounded-full ${y?"bg-stone-900 text-white":"bg-stone-100 text-stone-400"}`,children:o.length})]}),e.jsxs("div",{className:"flex-1 relative w-full min-h-0 rounded-b-[2rem] overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 overflow-y-auto scrollbar-hide px-3 pb-8 pt-1",children:o.length>0?e.jsx("div",{className:"space-y-1",children:o.map(u=>{const S=l===u.id;return e.jsx("div",{onClick:()=>!S&&N(u.id),className:`group relative py-3 px-3 border border-transparent transition-all cursor-pointer rounded-xl flex flex-col gap-1 overflow-hidden 
                                            ${S?"bg-red-50 border-red-100":"hover:border-stone-100/50 hover:bg-white/60 hover:shadow-sm"}
                                        `,children:S?e.jsxs("div",{className:"flex items-center justify-between w-full h-full animate-fade-in-right",children:[e.jsx("span",{className:"text-xs font-bold text-red-600 uppercase tracking-widest pl-1",children:"Delete item?"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:m=>D(m),className:"p-1 rounded-full bg-stone-200 text-stone-500 hover:bg-stone-300 transition-colors",children:e.jsx(ee,{size:14,strokeWidth:3})}),e.jsx("button",{onClick:m=>k(m,u.id),className:"p-1 rounded-full bg-red-500 text-white hover:bg-red-600 transition-colors shadow-sm",children:e.jsx(te,{size:14,strokeWidth:3})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("span",{className:`text-base font-serif italic line-clamp-2 leading-snug ${y?"text-stone-700":"text-stone-500"} group-hover:text-stone-900 transition-colors`,children:u.text}),e.jsx("button",{onClick:m=>x(m,u.id),className:"opacity-0 group-hover:opacity-100 transition-all p-1.5 text-stone-300 hover:text-red-500 hover:bg-red-50 rounded-lg -mr-1 -mt-1",title:"Delete",children:e.jsx(J,{size:14})})]}),e.jsx("span",{className:"text-[9px] font-sans font-bold text-stone-200 group-hover:text-stone-300 uppercase tracking-wider transition-opacity",children:new Date(u.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},u.id)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full opacity-30 select-none pb-8",children:[e.jsx("span",{className:"text-3xl font-serif italic text-stone-300 mb-2",children:"~"}),e.jsx("p",{className:"text-[9px] font-sans tracking-widest uppercase font-bold text-stone-300",children:"Empty"})]})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-10 bg-gradient-to-t from-stone-50/100 to-transparent pointer-events-none"})]})]});return e.jsxs("div",{className:"h-full flex flex-col font-serif p-6 max-w-[90rem] mx-auto w-full",children:[e.jsxs("div",{className:"flex-none mb-8 text-center relative z-10",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold font-serif text-stone-900 uppercase tracking-widest mb-6 select-none",children:"Capture"}),e.jsxs("form",{onSubmit:n,className:"relative w-full max-w-2xl mx-auto group",children:[e.jsx("input",{type:"text",value:a,onChange:s=>r(s.target.value),placeholder:"Write it down...",className:"w-full bg-transparent border-b border-stone-200 focus:border-stone-900 px-6 py-4 text-4xl font-serif italic text-stone-800 placeholder:text-stone-200 focus:placeholder:text-stone-300 focus:outline-none transition-all text-center",autoFocus:!0}),e.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 opacity-0 group-focus-within:opacity-100 transition-opacity duration-500",children:e.jsx("span",{className:"text-[9px] font-bold bg-stone-100 text-stone-400 px-2 py-1 rounded-md uppercase tracking-wider",children:"Enter"})})]})]}),e.jsxs("div",{className:"flex-1 w-full grid grid-cols-1 md:grid-cols-3 gap-6 min-h-0 border-t border-stone-100/30 pt-4",children:[e.jsx(t,{title:"Yesterday",items:C,subtitle:"Review"}),e.jsx(t,{title:"Today",items:g,subtitle:"Inbox",highlight:!0}),e.jsx(t,{title:"Pending",items:I,subtitle:"Backlog"})]})]})},ve=({item:i,onProcess:b,onCreateProject:w,onNavigate:N,projects:c})=>{const[a,r]=f.useState("initial"),[l,h]=f.useState(""),[n,x]=f.useState(""),[k,D]=f.useState(!1);if(E.useEffect(()=>{r("initial"),h(""),x(""),D(!1)},[i==null?void 0:i.id]),!i)return e.jsxs("div",{className:"h-full w-full flex flex-col items-center justify-center text-stone-300 animate-fade-in-up",children:[e.jsx(T,{size:96,strokeWidth:.5,className:"mb-8 opacity-20 text-stone-900"}),e.jsx("h3",{className:"text-4xl font-serif text-stone-400 italic mb-4",children:"Inbox Zero"}),e.jsx("p",{className:"text-stone-400 font-sans tracking-widest uppercase text-xs font-bold",children:"You are clear."})]});const p=j=>{b(i.id,j)},v=(j,g,C)=>e.jsxs("div",{className:"w-full max-w-2xl mx-auto animate-fade-in-up",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("span",{className:"text-xs font-bold text-stone-400 uppercase tracking-widest mb-3 block font-sans",children:"Step 2: Clarify"}),e.jsxs("div",{className:"bg-white p-8 rounded-3xl shadow-xl border border-stone-100 relative",children:[e.jsxs("div",{className:"text-3xl font-serif text-stone-800 italic leading-snug mb-4",children:['"',i.text,'"']}),e.jsxs("div",{className:"flex justify-center gap-4 text-xs font-bold uppercase tracking-wider text-stone-300",children:[e.jsxs("span",{children:["Created ",new Date(i.createdAt).toLocaleDateString()]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:["ID #",i.id]})]})]})]}),e.jsxs("div",{className:"bg-stone-50/50 backdrop-blur-sm rounded-3xl p-8 border border-stone-100 shadow-inner",children:[e.jsx("h4",{className:"text-xl font-serif text-stone-600 mb-8 text-center italic",children:j}),g]}),C&&e.jsxs("button",{onClick:C,className:"mx-auto mt-6 flex items-center gap-2 text-stone-400 hover:text-stone-600 text-xs font-bold uppercase tracking-wider transition-colors",children:[e.jsx(G,{className:"rotate-180",size:14})," Back"]})]});return a==="initial"?v("Is this actionable?",e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("button",{onClick:()=>r("not_actionable"),className:"group bg-white p-8 rounded-2xl border border-stone-200 shadow-sm hover:border-stone-400 hover:shadow-lg transition-all text-center",children:[e.jsx(fe,{size:32,className:"mx-auto mb-4 text-stone-300 group-hover:text-stone-500 transition-colors"}),e.jsx("span",{className:"block text-lg font-bold text-stone-700 mb-2",children:"No"}),e.jsx("span",{className:"text-xs text-stone-400 font-sans",children:"Trash, Reference, or Someday"})]}),e.jsxs("button",{onClick:()=>r("actionable_type"),className:"group bg-stone-900 p-8 rounded-2xl shadow-xl hover:bg-black hover:-translate-y-1 transition-all text-center",children:[e.jsx(me,{size:32,className:"mx-auto mb-4 text-stone-400 group-hover:text-amber-400 transition-colors"}),e.jsx("span",{className:"block text-lg font-bold text-white mb-2",children:"Yes"}),e.jsx("span",{className:"text-xs text-stone-400 font-sans",children:"Do, Delegate, Defer, or Project"})]})]})):a==="not_actionable"?v("Organize non-actionables",e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("button",{onClick:()=>p({status:"trash"}),className:"bg-white hover:bg-red-50 p-6 rounded-2xl border border-stone-200 hover:border-red-200 transition-all flex flex-col items-center gap-3 group",children:[e.jsx(J,{size:24,className:"text-stone-400 group-hover:text-red-500"}),e.jsx("span",{className:"font-bold text-stone-600 group-hover:text-red-700",children:"Trash"})]}),e.jsxs("button",{onClick:()=>p({status:"reference"}),className:"bg-white hover:bg-blue-50 p-6 rounded-2xl border border-stone-200 hover:border-blue-200 transition-all flex flex-col items-center gap-3 group",children:[e.jsx(Q,{size:24,className:"text-stone-400 group-hover:text-blue-500"}),e.jsx("span",{className:"font-bold text-stone-600 group-hover:text-blue-700",children:"Reference"})]}),e.jsxs("button",{onClick:()=>p({status:"someday"}),className:"bg-white hover:bg-amber-50 p-6 rounded-2xl border border-stone-200 hover:border-amber-200 transition-all flex flex-col items-center gap-3 group",children:[e.jsx(W,{size:24,className:"text-stone-400 group-hover:text-amber-500"}),e.jsx("span",{className:"font-bold text-stone-600 group-hover:text-amber-700",children:"Someday"})]})]}),()=>r("initial")):a==="actionable_type"?v("What is the next step?",e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-2",children:e.jsxs("button",{onClick:()=>r("project_details"),className:"w-full bg-indigo-50 hover:bg-indigo-100 p-4 rounded-xl border border-indigo-100 hover:border-indigo-200 transition-all flex items-center justify-between group px-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(F,{size:20,className:"text-indigo-400 group-hover:text-indigo-600"}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"block font-bold text-indigo-900",children:"It's a Project"}),e.jsx("span",{className:"text-xs text-indigo-400",children:"Requires multiple steps"})]})]}),e.jsx(G,{size:16,className:"text-indigo-300"})]})}),e.jsxs("button",{onClick:()=>p({status:"done"}),className:"bg-white hover:bg-emerald-50 p-4 rounded-xl border border-stone-200 hover:border-emerald-200 transition-all flex flex-col items-center gap-2 group",children:[e.jsx(T,{size:24,className:"text-stone-400 group-hover:text-emerald-500"}),e.jsx("span",{className:"font-bold text-sm text-stone-600 group-hover:text-emerald-700",children:"Do it (< 2m)"})]}),e.jsxs("button",{onClick:()=>r("delegate_details"),className:"bg-white hover:bg-purple-50 p-4 rounded-xl border border-stone-200 hover:border-purple-200 transition-all flex flex-col items-center gap-2 group",children:[e.jsx(R,{size:24,className:"text-stone-400 group-hover:text-purple-500"}),e.jsx("span",{className:"font-bold text-sm text-stone-600 group-hover:text-purple-700",children:"Delegate"})]}),e.jsxs("button",{onClick:()=>p({status:"actionable"}),className:"bg-white hover:bg-stone-50 p-4 rounded-xl border border-stone-200 hover:border-stone-300 transition-all flex flex-col items-center gap-2 group",children:[e.jsx(T,{size:24,className:"text-stone-400 group-hover:text-stone-600"}),e.jsx("span",{className:"font-bold text-sm text-stone-600 group-hover:text-stone-800",children:"Next Action"})]}),e.jsxs("button",{onClick:()=>r("defer_details"),className:"bg-white hover:bg-orange-50 p-4 rounded-xl border border-stone-200 hover:border-orange-200 transition-all flex flex-col items-center gap-2 group",children:[e.jsx(O,{size:24,className:"text-stone-400 group-hover:text-orange-500"}),e.jsx("span",{className:"font-bold text-sm text-stone-600 group-hover:text-orange-700",children:"Defer (Calendar)"})]})]}),()=>r("initial")):a==="delegate_details"?v("Who are you waiting for?",e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Enter name (e.g., Alice)...",value:l,onChange:j=>h(j.target.value),className:"w-full p-4 bg-white rounded-xl border border-stone-200 focus:outline-none focus:ring-2 focus:ring-stone-900/10 focus:border-stone-400 font-serif italic text-lg",autoFocus:!0}),e.jsx("button",{disabled:!l.trim(),onClick:()=>p({status:"waiting",delegatedTo:l}),className:"w-full py-4 bg-stone-900 text-white rounded-xl font-bold tracking-wide hover:bg-black disabled:opacity-50 transition-all",children:"Confirm Waiting For"})]}),()=>r("actionable_type")):a==="defer_details"?v("When do you need to see this?",e.jsxs("div",{className:"space-y-4 relative",children:[e.jsxs("button",{onClick:()=>D(!0),className:"w-full p-4 bg-white rounded-xl border border-stone-200 focus:outline-none focus:ring-2 focus:ring-stone-900/10 focus:border-stone-400 font-serif italic text-lg text-left text-stone-700 flex justify-between items-center",children:[n?new Date(n).toLocaleDateString(void 0,{weekday:"long",month:"long",day:"numeric"}):"Select Value...",e.jsx(O,{size:20,className:"text-stone-400"})]}),k&&e.jsx("div",{className:"absolute top-full left-0 mt-2 z-50 shadow-2xl rounded-2xl overflow-hidden",children:e.jsx(xe,{date:n,onSelect:j=>{x(j),D(!1)},onClose:()=>D(!1)})}),e.jsx("button",{disabled:!n,onClick:()=>p({status:"actionable",dueDate:new Date(n).getTime()}),className:"w-full py-4 bg-stone-900 text-white rounded-xl font-bold tracking-wide hover:bg-black disabled:opacity-50 transition-all",children:"Add to Calendar"})]}),()=>r("actionable_type")):a==="project_details"?v("Define the Outcome (Project Name)",e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"e.g. Vacation in Hawaii...",value:l,onChange:j=>h(j.target.value),className:"w-full p-4 bg-white rounded-xl border border-stone-200 focus:outline-none focus:ring-2 focus:ring-stone-900/10 focus:border-stone-400 font-serif italic text-lg",autoFocus:!0}),e.jsx("button",{disabled:!l.trim(),onClick:()=>{w(l,[i.text]),b(i.id,{status:"trash"})},className:"w-full py-4 bg-stone-900 text-white rounded-xl font-bold tracking-wide hover:bg-black disabled:opacity-50 transition-all",children:"Create Project"})]}),()=>r("actionable_type")):null},we=({projects:i,items:b,onUpdateItem:w})=>{const N=b.filter(n=>n.status==="actionable"&&!n.dueDate),c=b.filter(n=>(n.status==="actionable"||n.status==="waiting")&&n.dueDate).sort((n,x)=>(n.dueDate||0)-(x.dueDate||0)),a=b.filter(n=>n.status==="waiting"),r=b.filter(n=>n.status==="someday"),l=({title:n,icon:x,count:k,children:D,color:p="stone"})=>{const v={stone:"border-stone-100/50",emerald:"border-emerald-100/50",indigo:"border-indigo-100/50",amber:"border-amber-100/50",blue:"border-blue-100/50"},j={stone:"bg-white/40",emerald:"bg-emerald-50/30",indigo:"bg-indigo-50/30",amber:"bg-amber-50/30",blue:"bg-blue-50/30"};return e.jsxs("div",{className:`flex flex-col ${j[p]} rounded-3xl border ${v[p]} backdrop-blur-sm h-full overflow-hidden transition-all hover:shadow-lg`,children:[e.jsxs("div",{className:"p-6 pb-2 flex-none flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-xl ${p==="stone"?"bg-white":"bg-white/60"} shadow-sm`,children:e.jsx(x,{size:18,className:`text-${p}-600`})}),e.jsx("h3",{className:"font-serif font-bold text-lg text-stone-800 italic",children:n})]}),e.jsx("span",{className:"bg-white/50 px-2 py-1 rounded-lg text-xs font-bold text-stone-500",children:k})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 scrollbar-hide",children:D})]})},h=({item:n,type:x="task"})=>e.jsx("div",{className:"group bg-white/60 hover:bg-white p-4 rounded-xl border border-stone-100 hover:border-stone-300 transition-all cursor-pointer shadow-sm hover:shadow-md",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-serif text-stone-800 text-sm leading-snug font-medium mb-1 line-clamp-2",children:x==="project"?n.name:n.text}),x==="waiting"&&n.delegatedTo&&e.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] font-bold uppercase tracking-wider text-amber-600 bg-amber-50 px-2 py-1 rounded-md w-fit",children:[e.jsx(R,{size:10})," Waiting: ",n.delegatedTo]}),n.dueDate&&e.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] font-bold uppercase tracking-wider text-indigo-600 bg-indigo-50 px-2 py-1 rounded-md w-fit",children:[e.jsx(O,{size:10})," ",new Date(n.dueDate).toLocaleDateString(void 0,{month:"short",day:"numeric"})]})]}),x==="project"?e.jsx("div",{className:"h-2 w-2 rounded-full bg-indigo-400 mt-1.5"}):e.jsx("div",{className:`h-4 w-4 rounded-full border-2 mt-0.5 transition-colors ${x==="task"?"border-emerald-200 group-hover:border-emerald-500":x==="waiting"?"border-amber-200 group-hover:border-amber-500":"border-stone-200"}`})]})});return e.jsx("div",{className:"h-full flex flex-col font-serif p-0",children:e.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 p-4",children:[e.jsxs(l,{title:"Projects",icon:F,count:i.filter(n=>n.status==="active").length,color:"indigo",children:[i.filter(n=>n.status==="active").map(n=>e.jsx(h,{item:n,type:"project"},n.id)),e.jsx("button",{className:"w-full py-3 border-2 border-dashed border-indigo-200/50 rounded-xl text-indigo-400 text-xs font-bold uppercase tracking-wider hover:bg-indigo-50 hover:border-indigo-300 transition-colors",children:"+ New Project"})]}),e.jsxs(l,{title:"Next Actions",icon:T,count:N.length,color:"emerald",children:[N.map(n=>e.jsx(h,{item:n,type:"task"},n.id)),e.jsx("button",{className:"w-full py-3 border-2 border-dashed border-emerald-200/50 rounded-xl text-emerald-400 text-xs font-bold uppercase tracking-wider hover:bg-emerald-50 hover:border-emerald-300 transition-colors",children:"+ Next Action"})]}),e.jsxs(l,{title:"Waiting For",icon:W,count:a.length,color:"amber",children:[a.map(n=>e.jsx(h,{item:n,type:"waiting"},n.id)),e.jsx("button",{className:"w-full py-3 border-2 border-dashed border-amber-200/50 rounded-xl text-amber-400 text-xs font-bold uppercase tracking-wider hover:bg-amber-50 hover:border-amber-300 transition-colors",children:"+ Log Waiting"})]}),e.jsxs(l,{title:"Scheduled",icon:O,count:c.length,color:"stone",children:[c.map(n=>e.jsx(h,{item:n,type:"task"},n.id)),e.jsxs("div",{className:"my-4 pt-4 border-t border-stone-200/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 px-1",children:[e.jsx("span",{className:"text-xs font-bold text-stone-400 uppercase tracking-wider",children:"Someday / Maybe"}),e.jsx(Q,{size:14,className:"text-stone-300"})]}),r.map(n=>e.jsxs("div",{className:"group p-3 rounded-lg hover:bg-stone-100 transition-colors cursor-pointer flex items-center gap-2 text-stone-600 hover:text-stone-900",children:[e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-stone-300"}),e.jsx("span",{className:"text-sm font-serif truncate",children:n.text})]},n.id))]})]})]})})},Ne=({items:i})=>{const[b,w]=f.useState([{id:1,text:"Collect Loose Papers and Materials",checked:!1},{id:2,text:'Get "In" to Zero',checked:!1},{id:3,text:"Empty Your Head",checked:!1},{id:4,text:'Review "Next Actions" Lists',checked:!1},{id:5,text:'Review "Waiting For" List',checked:!1},{id:6,text:'Review "Projects" (and Larger Outcomes)',checked:!1},{id:7,text:'Review "Someday/Maybe" List',checked:!1}]),N=a=>{w(b.map(r=>r.id===a?{...r,checked:!r.checked}:r))},c=Math.round(b.filter(a=>a.checked).length/b.length*100);return e.jsxs("div",{className:"h-full flex flex-col font-serif",children:[e.jsxs("div",{className:"flex-none text-center mb-8",children:[e.jsx("span",{className:"text-xs font-bold text-stone-400 uppercase tracking-widest mb-2 block font-sans",children:"Step 4"}),e.jsx("h3",{className:"text-4xl font-serif text-stone-900 mb-2 tracking-tight italic",children:"Reflect"}),e.jsx("p",{className:"text-sm text-stone-500 font-sans max-w-xl mx-auto",children:"Weekly Review: Clear the decks."})]}),e.jsxs("div",{className:"flex-1 relative w-full h-full min-h-0",children:[e.jsx("div",{className:"absolute inset-0 overflow-y-auto scrollbar-hide px-4 pb-12",children:e.jsxs("div",{className:"max-w-xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 px-2 sticky top-0 bg-stone-50/95 backdrop-blur-sm py-2 z-10 border-b border-stone-200/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{size:18,className:"text-stone-400"}),e.jsx("h4",{className:"font-bold text-xs uppercase tracking-wider text-stone-500 font-sans",children:"Weekly Review Checklist"})]}),e.jsxs("span",{className:"text-xs font-bold font-sans text-stone-400 bg-stone-100 px-2 py-1 rounded-full",children:[c,"% Complete"]})]}),e.jsx("div",{className:"space-y-2",children:b.map(a=>e.jsxs("div",{onClick:()=>N(a.id),className:`flex items-start p-4 cursor-pointer group transition-all rounded-xl border ${a.checked?"bg-stone-50 border-stone-100":"bg-white border-stone-200 hover:border-stone-400 shadow-sm hover:shadow-md"}`,children:[e.jsx("div",{className:`mr-4 pt-1 transition-colors ${a.checked?"text-stone-300":"text-stone-800"}`,children:a.checked?e.jsx(V,{size:22,strokeWidth:1.5}):e.jsx(ue,{size:22,strokeWidth:1.5})}),e.jsx("div",{children:e.jsx("span",{className:`text-lg transition-all font-serif italic ${a.checked?"text-stone-400 line-through decoration-stone-300":"text-stone-800"}`,children:a.text})})]},a.id))}),c===100&&e.jsx("div",{className:"mt-8 text-center animate-fade-in-up",children:e.jsxs("button",{onClick:()=>w(b.map(a=>({...a,checked:!1}))),className:"inline-flex items-center gap-2 px-6 py-3 bg-stone-900 text-white rounded-xl shadow-lg hover:bg-black transition-colors",children:[e.jsx(se,{size:16}),e.jsx("span",{className:"font-bold text-sm",children:"Start New Week"})]})}),e.jsx("p",{className:"mt-12 text-sm text-stone-300 italic text-center pb-4",children:'"Your mind is for having ideas, not holding them."'})]})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-16 bg-gradient-to-t from-stone-50/100 to-transparent pointer-events-none"})]})]})},ye=({actions:i,projects:b})=>{const[w,N]=f.useState("all"),c=Array.from(new Set(i.map(r=>r.contextId||"uncategorized"))),a=w==="all"?i:i.filter(r=>(r.contextId||"uncategorized")===w);return e.jsxs("div",{className:"h-full flex flex-col font-serif",children:[e.jsxs("div",{className:"flex-none text-center mb-6",children:[e.jsx("span",{className:"text-xs font-bold text-stone-400 uppercase tracking-widest mb-2 block font-sans",children:"Step 5"}),e.jsx("h3",{className:"text-4xl font-serif text-stone-900 mb-2 tracking-tight italic",children:"Engage"}),e.jsx("p",{className:"text-sm text-stone-500 font-sans max-w-xl mx-auto",children:"Trust your system and execute with confidence."})]}),e.jsx("div",{className:"flex-none mb-6 px-4",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>N("all"),className:`px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider transition-all font-sans border ${w==="all"?"bg-stone-800 text-white border-stone-800":"bg-white text-stone-400 border-stone-200 hover:border-stone-400 hover:text-stone-600"}`,children:"All"}),c.map(r=>e.jsx("button",{onClick:()=>N(r),className:`px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider transition-all font-sans border ${w===r?"bg-stone-800 text-white border-stone-800":"bg-white text-stone-400 border-stone-200 hover:border-stone-400 hover:text-stone-600"}`,children:r},r))]})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 pb-4",children:e.jsx("div",{className:"max-w-2xl mx-auto space-y-3",children:a.length===0?e.jsxs("div",{className:"text-center py-12 text-stone-300",children:[e.jsx("span",{className:"block text-4xl mb-4",children:"â˜•ï¸"}),e.jsx("p",{className:"italic font-serif text-lg",children:"Nothing to do here."}),e.jsx("p",{className:"text-sm font-sans",children:"Check other contexts or enjoy your break."})]}):a.map(r=>e.jsx("div",{className:"group bg-white p-4 rounded-xl border border-stone-200 hover:border-stone-400 shadow-sm hover:shadow-md transition-all cursor-pointer",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("button",{className:"pt-1 text-stone-300 hover:text-green-600 transition-colors",children:e.jsx(T,{size:24,strokeWidth:1.5})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-serif italic text-stone-800 mb-1 group-hover:text-black transition-colors",children:r.text}),e.jsxs("div",{className:"flex items-center gap-3 text-[10px] font-sans font-bold text-stone-400 uppercase tracking-widest",children:[r.project&&e.jsxs("span",{className:"text-stone-500",children:["ðŸ“‚ ",r.project]}),r.contextId&&e.jsx("span",{className:"bg-stone-100 px-1.5 py-0.5 rounded text-stone-500",children:r.contextId}),r.time&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(W,{size:10})," ",r.time]}),r.energy&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(B,{size:10})," ",r.energy]})]})]})]}),r.dueDate&&e.jsxs("span",{className:"text-xs font-serif italic text-red-500 bg-red-50 px-2 py-1 rounded-md",children:["Due ",new Date(r.dueDate).toLocaleDateString(void 0,{month:"short",day:"numeric"})]})]})},r.id))})})]})},U="gtd-system-items",M="gtd-system-projects",ke=({userName:i="User",onOpenQuickTask:b,onOpenDiscussion:w})=>{const[N,c]=f.useState("capture"),[a,r]=f.useState(()=>{try{const t=localStorage.getItem(U);if(t)return JSON.parse(t)}catch(t){console.error("Failed to load GTD items",t)}return[{id:1,text:"Call insurance company",status:"inbox",createdAt:Date.now()},{id:2,text:"Brainstorm marketing ideas",status:"inbox",createdAt:Date.now()-1e3},{id:3,text:"Buy printer ink",status:"actionable",contextId:"errands",energy:"Low",time:"30m",createdAt:Date.now()-2e3},{id:4,text:"Review Q3 Financials",status:"waiting",delegatedTo:"Alice",createdAt:Date.now()-5e3},{id:5,text:"Learn Spanish",status:"someday",createdAt:Date.now()-1e4}]}),[l,h]=f.useState(()=>{try{const t=localStorage.getItem(M);if(t)return JSON.parse(t)}catch(t){console.error("Failed to load GTD projects",t)}return[{id:101,name:"Q4 Marketing Strategy",status:"active",items:[]},{id:102,name:"Office Renovation",status:"planning",items:[]}]});E.useEffect(()=>{localStorage.setItem(U,JSON.stringify(a))},[a]),E.useEffect(()=>{localStorage.setItem(M,JSON.stringify(l))},[l]);const[n,x]=f.useState(null),k=a.filter(t=>t.status==="inbox").sort((t,s)=>s.createdAt-t.createdAt),D=a.filter(t=>t.status==="actionable");a.filter(t=>t.status==="waiting"),a.filter(t=>t.status==="someday"),a.filter(t=>t.status==="reference");const p=t=>{const s=t.toLowerCase();let o="inbox",d=t,y=!1;if(s.startsWith("@task ")?(o="actionable",d=t.slice(6)):s.startsWith("@project ")?(y=!0,d=t.slice(9)):s.startsWith("@waiting ")?(o="waiting",d=t.slice(9)):s.startsWith("@someday ")?(o="someday",d=t.slice(9)):s.startsWith("@read ")&&(o="reference",d=t.slice(6)),y){const u={id:Date.now(),name:d,status:"active",items:[]};h([u,...l])}else{const u={id:Date.now(),text:d,status:o,createdAt:Date.now()};r([u,...a])}},v=(t,s)=>{r(a.map(o=>o.id===t?{...o,...s}:o)),t===n&&(a.filter(o=>o.status==="inbox"&&o.id!==t),k.findIndex(o=>o.id===t)+1,x(null))},j=(t,s=[])=>{const o={id:Date.now(),name:t,status:"active",items:[]},d=s.map((y,u)=>({id:Date.now()+u+1,text:y,status:"actionable",projectId:o.id,createdAt:Date.now()}));h([...l,o]),r([...a,...d])},g=t=>{r(a.filter(s=>s.id!==t))},C=()=>{switch(N){case"capture":return e.jsx(je,{items:a,projects:l,onCapture:p,onSelect:t=>{x(t),c("clarify")},onDelete:g});case"clarify":return e.jsx(ve,{item:a.find(t=>t.id===n)||k[0],onProcess:v,onCreateProject:j,onNavigate:t=>c(t),projects:l,hasMore:k.length>0});case"organize":return e.jsx(we,{projects:l,items:a,onUpdateItem:v});case"review":return e.jsx(Ne,{items:a});case"engage":return e.jsx(ye,{actions:D,projects:l});default:return null}},I=[{id:"capture",label:"Capture",icon:oe,color:"text-blue-600",count:k.length},{id:"clarify",label:"Clarify",icon:T,color:"text-amber-600",count:n?1:0},{id:"organize",label:"Organize",icon:F,color:"text-indigo-600",count:0},{id:"review",label:"Reflect",icon:V,color:"text-emerald-600",count:0},{id:"engage",label:"Engage",icon:B,color:"text-orange-600",count:0}];return e.jsxs("div",{className:"h-full w-full bg-stone-50 rounded-[2.5rem] p-6 shadow-inner ring-1 ring-stone-900/5 flex flex-col font-serif relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 opacity-[0.03] pointer-events-none bg-[url('https://www.transparenttextures.com/patterns/notebook.png')]"}),e.jsxs("div",{className:"flex-none pt-10 pb-6 z-10 relative bg-white/60 border-b border-stone-200/50 backdrop-blur-xl px-8",children:[e.jsxs("div",{className:"flex items-end justify-between max-w-7xl mx-auto mb-8",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-4xl md:text-5xl font-serif italic text-stone-900 tracking-tight leading-none mb-2",children:[(()=>{const t=new Date().getHours();return t<12?"Good morning":t<17?"Good afternoon":"Good evening"})(),", ",i.split(" ")[0]]}),e.jsx("p",{className:"text-xs font-bold font-sans text-stone-400 uppercase tracking-widest pl-1",children:new Date().toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})})]}),e.jsxs("div",{className:"flex items-center gap-6 pb-1",children:[e.jsx("button",{onClick:w,className:"text-xs font-bold text-stone-400 hover:text-stone-900 transition-colors uppercase tracking-wider font-sans group flex items-center gap-2",children:e.jsx("span",{children:"Discussion"})}),e.jsx("div",{className:"w-px h-3 bg-stone-200"}),e.jsx("button",{className:"text-xs font-bold text-stone-400 hover:text-stone-900 transition-colors uppercase tracking-wider font-sans",children:"New Goal"}),e.jsx("div",{className:"w-px h-3 bg-stone-200"}),e.jsx("button",{className:"text-xs font-bold text-stone-400 hover:text-stone-900 transition-colors uppercase tracking-wider font-sans",children:"Reminder"}),e.jsxs("button",{onClick:b,className:"ml-4 bg-stone-900 text-white px-5 py-2 rounded-xl shadow-lg hover:bg-black hover:-translate-y-0.5 transition-all text-xs font-bold tracking-widest uppercase flex items-center gap-2",children:[e.jsx(ae,{size:14,strokeWidth:3}),e.jsx("span",{children:"Task"})]})]})]}),e.jsx("div",{className:"text-center mb-10 mt-32",children:e.jsx("h1",{className:"text-3xl font-serif italic text-stone-900 tracking-tight",children:"The Getting Things Done System"})}),e.jsx("div",{className:"flex justify-center relative z-20",children:e.jsx("div",{className:"flex items-center bg-stone-100/50 p-1 rounded-2xl border border-stone-200/50 backdrop-blur-sm",children:I.map(t=>{const s=N===t.id,o=t.icon;return e.jsxs("button",{onClick:()=>c(t.id),className:`
                                            relative px-8 py-2.5 rounded-xl flex items-center gap-2.5 transition-all duration-300
                                            ${s?"bg-white text-stone-900 shadow-sm ring-1 ring-stone-900/5":"text-stone-400 hover:text-stone-600 hover:bg-stone-200/50"}
                                        `,children:[e.jsx(o,{size:16,strokeWidth:s?2.5:2,className:s?t.color:"text-stone-400"}),e.jsx("span",{className:"text-[11px] font-bold tracking-widest uppercase opacity-100",children:t.label}),t.count>0&&e.jsx("span",{className:`flex h-4 min-w-[1rem] px-1 items-center justify-center rounded-full text-[9px] font-extrabold ${s?"bg-stone-900 text-white":"bg-stone-200 text-stone-500"}`,children:t.count})]},t.id)})})})]}),e.jsx("div",{className:"flex-1 flex overflow-hidden bg-white/30 relative",children:e.jsx("div",{className:"flex-1 overflow-hidden w-full relative z-10",children:C()})})]})},De="available_rooms",Ve=({cards:i=[],onUpdateCard:b=a=>{},onRemoveCard:w=a=>{},onOpenCustomize:N=()=>{},userName:c="User"})=>{var t;const{showToast:a}=ne(),{setActivePage:r}=re(),[l,h]=f.useState(!1),[n,x]=f.useState(!1),[k,D]=f.useState([]);E.useEffect(()=>{(()=>{try{const o=localStorage.getItem(De);o&&D(JSON.parse(o))}catch(o){console.error("Failed to load rooms for QuickTask",o)}})()},[]);const p=((t=P.groups[0])==null?void 0:t.columns)||[],v=s=>{console.log("Debug: Handle Send",s);try{const o=le.getCurrentUser(),d=o?`taskboard-${o.id}`:"taskboard-default";console.log("Debug: Sending tasks to",d);const y=localStorage.getItem(d);let u=y?JSON.parse(y):{id:"main",name:"My Tasks",groups:[],columns:[],users:[],version:1};console.log("Debug: Main board before merge",u),(s.groups||[]).map(m=>({...m,id:m.id||crypto.randomUUID(),title:m.title||"Quick Tasks",color:m.color||"#579bfc",columns:Array.isArray(m.columns)&&m.columns.length?m.columns:p,tasks:Array.isArray(m.tasks)?m.tasks:[]})).forEach(m=>{if(m.tasks.length>0){const $=m.title||"Quick Tasks",_=u.groups.findIndex(z=>z.title===$);if(_>=0){const z=u.groups[_],H=m.tasks.map(L=>({...L,id:L.id||crypto.randomUUID()}));z.tasks=[...z.tasks,...H],u.groups[_]=z}else{const z={...m,id:crypto.randomUUID(),title:$,tasks:[...m.tasks]};u.groups=[z,...u.groups]}}}),localStorage.setItem(d,JSON.stringify(u)),console.log("Debug: Saved to localStorage",d,u),a("Tasks sent to My Tasks successfully","success"),r("tasks"),window.dispatchEvent(new CustomEvent("local-storage-update",{detail:{key:d}})),window.dispatchEvent(new Event("storage"))}catch(o){console.error("Failed to merge to main tasks",o),a("Failed to send tasks","error")}},j=(s,o)=>{try{const d=`room_board_${o.id}`,y=localStorage.getItem(d);let u=y?JSON.parse(y):{id:o.id,name:o.name,groups:[],columns:[],users:[],version:1};s.groups.forEach(S=>{if(S.tasks.length>0){let m=u.groups.find($=>$.title===S.title);m||(m={...S,id:crypto.randomUUID(),tasks:[]},u.groups.push(m)),m.tasks=[...m.tasks,...S.tasks]}}),localStorage.setItem(d,JSON.stringify(u)),a(`Tasks sent to ${o.name}`,"success"),window.dispatchEvent(new CustomEvent("local-storage-update",{detail:{key:d}})),window.dispatchEvent(new Event("storage"))}catch(d){console.error("Failed to send to room",d),a("Failed to send to room","error")}},g=(s,o)=>{if(x(!1),o.type==="main")v(s);else if(o.type==="room"&&o.roomId){const d=k.find(y=>y.id===o.roomId);d?j(s,d):a("Room not found","error")}},C=()=>{h(!0)},I=async(s,o)=>{try{const d=await ce.createChannel(s,o);a("Discussion created successfully!","success"),localStorage.setItem("autoOpenChannelId",d.id),h(!1),r("discussion")}catch(d){console.error("Failed to create discussion:",d),a("Failed to create discussion","error")}};return e.jsxs("div",{className:"flex-1 bg-brand-surface flex flex-col h-full overflow-hidden relative",children:[e.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide w-full h-full bg-white relative",children:e.jsx("div",{className:"w-full mx-auto p-4 pb-24 flex flex-col h-full min-h-[800px]",children:e.jsx("div",{className:"flex-1 w-full animate-fade-in-up",children:e.jsx(ke,{userName:c,onOpenQuickTask:()=>x(!0),onOpenDiscussion:C})})})}),e.jsx(be,{isOpen:n,onClose:()=>x(!1),onSend:g,rooms:k,darkMode:!1}),e.jsx(ie,{isOpen:l,onClose:()=>h(!1),onCreate:I})]})};export{Ve as default};
