import{c as ye,r as c,j as e,aH as se,Q as je,T as W,P as re,ba as Ne,w as ve,g as we,V as G,au as ke}from"./index-BFP11Qd5.js";import{F as Ce,r as Se,u as ze,S as Ee}from"./xlsx-C7ql35B0.js";import{A as Pe}from"./arrow-up-down-DxLladfH.js";import{M as Te}from"./minus-Hbm8BIDe.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],De=ye("trending-down",Me),Ie=[{name:"Default",value:"transparent"},{name:"Red",value:"#fee2e2"},{name:"Green",value:"#dcfce7"},{name:"Blue",value:"#dbeafe"},{name:"Yellow",value:"#fef9c3"},{name:"Purple",value:"#f3e8ff"},{name:"Orange",value:"#ffedd5"}],Re=10,Ue=({id:b,title:L,columns:x,showBorder:m,headerColor:V,onDelete:E,onRenameTable:P,onRenameColumn:T,onAddColumn:A,onUpdateColumnType:M,onDeleteColumn:D,onUpdateColumnColor:O,onUpdateRow:w,onRowsChange:l,rows:y})=>{const[h,g]=c.useState(y||[{id:"1",data:{}},{id:"2",data:{}},{id:"2",data:{}},{id:"3",data:{}}]),[i,k]=c.useState(1),[j,ae]=c.useState(Re),[I,$e]=c.useState([]),[U,q]=c.useState(!1),[Fe,_e]=c.useState(!1),[B,ne]=c.useState([]),R=c.useRef(null),[o,ie]=c.useState(null),le=t=>{ne(s=>s.includes(t)?s.filter(r=>r!==t):[...s,t])},oe=t=>{let s="asc";o&&o.key===t&&o.direction==="asc"&&(s="desc"),ie({key:t,direction:s})},de=async t=>{var a;const s=(a=t.target.files)==null?void 0:a[0];if(!s)return;const r=new FileReader;r.onload=u=>{var z;try{const $=(z=u.target)==null?void 0:z.result,J=Se($,{type:"binary"}),he=J.SheetNames[0],ge=J.Sheets[he],K=ze.sheet_to_json(ge,{header:1});if(K.length===0){alert("Excel file is empty!");return}const pe=K[0],X=K.slice(1).filter(C=>C&&C.some(N=>N!=null&&N!==""));if(X.length===0){alert("No data rows found in Excel file!");return}const Z={};pe.forEach((C,N)=>{const F=x.find(f=>f.name.toLowerCase()===C.toString().toLowerCase());F&&(Z[N]=F.id)});const ee=X.map((C,N)=>{const F=`imported-${Date.now()}-${N}`,f={};return C.forEach((n,fe)=>{const v=Z[fe];if(!v)return;const _=x.find(d=>d.id===v);if(_)if(_.type==="checkbox")f[v]=n===!0||n==="true"||n==="TRUE"||n===1||n==="1";else if(_.type==="number"){const d=Number(n);f[v]=isNaN(d)?n:d}else if(_.type==="date")if(typeof n=="number"){const d=Ee.parse_date_code(n),be=new Date(d.y,d.m-1,d.d);f[v]=be.toISOString().split("T")[0]}else{const d=new Date(n);f[v]=isNaN(d.getTime())?(n==null?void 0:n.toString())||"":d.toISOString().split("T")[0]}else f[v]=n!=null?n.toString():""}),{id:F,data:f}}),te=[...h,...ee];g(te),l&&l(te),alert(`âœ… Imported ${ee.length} rows!`)}catch($){alert(`Failed to import Excel file: ${$ instanceof Error?$.message:"Unknown error"}`)}},r.readAsBinaryString(s),R.current&&(R.current.value="")},H=x.filter(t=>!B.includes(t.id)),S=h.filter(t=>I.length===0?!0:I.every(s=>{const r=String(t.data[s.columnId]||"").toLowerCase(),a=s.value.toLowerCase();switch(s.operator){case"contains":return r.includes(a);case"equals":return r===a;case"starts_with":return r.startsWith(a);case"ends_with":return r.endsWith(a);default:return!0}})).sort((t,s)=>{if(!o)return 0;const r=t.data[o.key],a=s.data[o.key];if(r===a)return 0;const u=o.direction==="asc"?1:-1;return!isNaN(Number(r))&&!isNaN(Number(a))?(Number(r)-Number(a))*u:String(r).localeCompare(String(a))*u}),p=Math.ceil(S.length/j),Q=S.slice((i-1)*j,i*j);c.useEffect(()=>{i>p&&p>0?k(p):i===0&&p>0&&k(1)},[S.length,p,i]),c.useEffect(()=>{y&&g(y)},[y]);const ce=t=>{ae(Number(t.target.value)),k(1)},ue=()=>{const t={};x.forEach(a=>{a.type==="date"&&(t[a.id]=new Date().toISOString().split("T")[0])});const s={id:Math.random().toString(36).substr(2,9),data:t},r=[...h,s];if(g(r),l&&l(r),I.length===0){const a=Math.ceil(r.length/j);k(a)}},Y=(t,s,r)=>{const a=h.map(u=>{if(u.id===t){const z={...u.data,[s]:r};return w&&w(t,z),{...u,data:z}}return u});g(a),l&&l(a)},xe=t=>{const s=h.filter(r=>r.id!==t);g(s),l&&l(s)},me=(t,s)=>{const r=h.map(a=>a.id===t?{...a,color:s}:a);g(r),l&&l(r)};return e.jsxs("div",{className:"mb-8 bg-white rounded-xl animate-in fade-in duration-500 flex flex-col",children:[e.jsxs("div",{className:"px-0 py-6 flex justify-between items-center bg-white shrink-0",children:[e.jsx("input",{type:"text",value:L,onChange:t=>P&&P(t.target.value),className:"text-xl font-semibold text-gray-900 bg-transparent border-none focus:ring-0 p-0 w-full mr-4 placeholder-gray-300",placeholder:"Table Name"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:R,type:"file",accept:".xlsx, .xls",onChange:de,className:"hidden"}),e.jsxs("button",{onClick:()=>{var t;return(t=R.current)==null?void 0:t.click()},className:"flex items-center space-x-2 px-4 py-2 bg-green-50 hover:bg-green-100 text-green-700 rounded-lg text-sm font-medium transition-colors",title:"Import from Excel",children:[e.jsx("span",{children:"Import"}),e.jsx(Ce,{size:14})]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>q(!U),className:`flex items-center space-x-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${U?"bg-gray-200 text-gray-900":"bg-gray-100 hover:bg-gray-200 text-gray-700"}`,children:[e.jsx("span",{children:"Filter"}),e.jsx(se,{size:14,className:"text-gray-500"})]}),U&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>q(!1)}),e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-64 bg-white rounded-xl shadow-xl border border-gray-100 z-50 p-2 animate-in fade-in zoom-in-95 duration-100 ring-1 ring-black/5",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3 px-3 mt-2",children:"Show/Hide Columns"}),e.jsx("div",{className:"space-y-0.5 max-h-60 overflow-y-auto custom-scrollbar",children:x.map(t=>e.jsxs("button",{onClick:()=>le(t.id),className:"flex items-center w-full px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-lg transition-colors group",children:[e.jsx("div",{className:`w-4 h-4 mr-3 rounded border flex items-center justify-center transition-colors ${B.includes(t.id)?"border-gray-300 group-hover:border-gray-400":"bg-blue-600 border-blue-600"}`,children:!B.includes(t.id)&&e.jsx(je,{size:10,className:"text-white"})}),e.jsx("span",{className:"truncate font-medium",children:t.name||"Untitled"})]},t.id))})]})]})]}),E&&e.jsx("button",{onClick:E,className:"p-2 bg-red-50 hover:bg-red-100 text-red-500 hover:text-red-600 rounded-lg transition-colors",title:"Delete Table",children:e.jsx(W,{size:20})})]})]}),e.jsx("div",{className:"overflow-x-auto flex-1 scrollbar-hide border-t border-gray-100",children:e.jsxs("table",{className:"min-w-full border-collapse",style:{tableLayout:"auto"},children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50/50 border-b border-gray-100",children:[H.map(t=>e.jsx("th",{className:"px-6 py-4 text-left relative group/header first:pl-4 cursor-pointer hover:bg-gray-100 transition-colors",style:{minWidth:t.width},onClick:()=>oe(t.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"relative w-full flex items-center space-x-2",children:[e.jsx("span",{className:"invisible whitespace-pre text-xs font-medium text-gray-500 block min-w-[80px]",children:t.name||"Column"}),e.jsx("input",{type:"text",value:t.name,onChange:s=>T&&T(t.id,s.target.value),onClick:s=>s.stopPropagation(),className:"absolute inset-0 w-full h-full bg-transparent border-none focus:ring-0 p-0 text-xs font-medium text-gray-500 hover:text-gray-700 transition-colors cursor-text"}),(o==null?void 0:o.key)===t.id&&e.jsx(Pe,{size:12,className:`text-gray-400 ${o.direction==="asc"?"rotate-0":"rotate-180"} transition-transform`})]}),e.jsx("button",{onClick:s=>{s.stopPropagation(),D&&D(t.id)},className:"text-gray-300 hover:text-red-500 transition-colors p-1 opacity-0 group-hover/header:opacity-100 ml-2 shrink-0",title:"Delete Column",children:e.jsx(W,{size:12})})]})},t.id)),e.jsx("th",{className:"px-2 py-2 w-10",children:e.jsx("button",{onClick:A,className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Add Column",children:e.jsx(re,{size:16})})})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-50",children:Q.length>0?Q.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors group",style:{backgroundColor:t.color||"transparent"},children:[H.map(s=>e.jsx("td",{className:"p-0 align-middle first:pl-4",style:{backgroundColor:s.color||"transparent"},children:s.type==="checkbox"?e.jsx("div",{className:"w-full h-full flex items-center justify-center py-4",children:e.jsx("input",{type:"checkbox",checked:t.data[s.id]||!1,onChange:r=>Y(t.id,s.id,r.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 cursor-pointer"})}):e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("span",{className:"invisible whitespace-pre px-6 py-4 block min-w-[80px] text-sm text-gray-600",children:t.data[s.id]||"..."}),e.jsx("input",{type:s.type==="number"?"number":s.type==="date"?"date":"text",value:t.data[s.id]||"",onChange:r=>Y(t.id,s.id,r.target.value),className:"absolute inset-0 w-full h-full px-6 py-4 bg-transparent border-none focus:ring-2 focus:ring-inset focus:ring-blue-500/20 text-sm text-gray-600 placeholder-gray-300",placeholder:"..."})]})},s.id)),e.jsx("td",{className:"w-16 p-0 align-middle",children:e.jsxs("div",{className:"flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity space-x-1 px-2",children:[e.jsxs("div",{className:"relative group/color",children:[e.jsx("button",{className:"text-gray-300 hover:text-blue-600 p-1.5 rounded-lg hover:bg-blue-50 transition-colors",children:e.jsx(Ne,{size:14})}),e.jsx("div",{className:"absolute bottom-full right-0 mb-1 bg-white rounded-xl shadow-xl border border-gray-100 p-3 hidden group-hover/color:grid grid-cols-4 gap-2 w-40 z-50 ring-1 ring-black/5",children:Ie.map(s=>e.jsx("button",{onClick:()=>me(t.id,s.value),className:`w-6 h-6 rounded-full border border-gray-200 hover:scale-110 transition-transform ${t.color===s.value?"ring-2 ring-blue-500 ring-offset-1":""}`,style:{backgroundColor:s.value},title:s.name},s.value))})]}),e.jsx("button",{onClick:()=>xe(t.id),className:"text-gray-300 hover:text-red-500 p-1.5 rounded-lg hover:bg-red-50 transition-colors",title:"Delete Row",children:e.jsx(W,{size:14})})]})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:H.length+1,className:"px-6 py-12 text-center text-gray-400 text-sm",children:e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-50 rounded-full flex items-center justify-center",children:e.jsx(se,{size:20,className:"text-gray-300"})}),e.jsx("span",{children:I.length>0?"No results match your filters":"No data available"})]})})})})]})}),e.jsxs("div",{className:"px-0 py-4 border-t border-gray-100 bg-white flex items-center justify-between shrink-0",children:[e.jsxs("button",{onClick:ue,className:"flex items-center space-x-2 px-3 py-1.5 text-sm font-medium text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 group",title:"Add Row",children:[e.jsx("div",{className:"w-5 h-5 rounded-md border border-gray-300 flex items-center justify-center group-hover:border-blue-300 transition-colors",children:e.jsx(re,{size:12})}),e.jsx("span",{children:"Add Row"})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Rows per page:"}),e.jsxs("select",{value:j,onChange:ce,className:"text-xs border-none bg-gray-50 rounded px-2 py-1 focus:ring-0 cursor-pointer text-gray-700 font-medium",children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"})]})]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[(i-1)*j+1,"-",Math.min(i*j,S.length)," of ",S.length]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>k(t=>Math.max(1,t-1)),disabled:i===1,className:`p-1.5 rounded-lg transition-colors ${i===1?"text-gray-300 cursor-not-allowed":"text-gray-500 hover:text-blue-600 hover:bg-blue-50"}`,children:e.jsx(ve,{size:16})}),e.jsx("button",{onClick:()=>k(t=>Math.min(p,t+1)),disabled:i===p,className:`p-1.5 rounded-lg transition-colors ${i===p?"text-gray-300 cursor-not-allowed":"text-gray-500 hover:text-blue-600 hover:bg-blue-50"}`,children:e.jsx(we,{size:16})})]})]})]})]})},Be=({title:b,value:L,icon:x,trend:m,subtext:V,iconColorClass:E="text-blue-600",iconBgClass:P="bg-blue-50",isEmpty:T,onConnect:A,onTitleChange:M})=>{const[D,O]=G.useState(!1),[w,l]=G.useState(b);G.useEffect(()=>{l(b)},[b]);const y=()=>{O(!1),w.trim()!==b&&M?M(w.trim()):l(b)};if(T)return e.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-dashed border-gray-300 shadow-sm flex flex-col items-center justify-center h-full min-h-[140px] hover:bg-gray-50 transition-colors cursor-pointer group",onClick:A,children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center mb-3 group-hover:bg-blue-100 transition-colors",children:e.jsx(x,{size:20,className:"text-gray-400 group-hover:text-blue-500"})}),e.jsx("span",{className:"text-sm font-medium text-gray-500 group-hover:text-blue-600",children:"Connect Data"})]});const h=()=>{if(!m)return"text-gray-500 bg-gray-50";switch(m.direction){case"up":return"text-green-600 bg-green-50";case"down":return"text-red-600 bg-red-50";default:return"text-gray-600 bg-gray-50"}},g=()=>{if(!m)return null;switch(m.direction){case"up":return e.jsx(ke,{size:12,className:"mr-1"});case"down":return e.jsx(De,{size:12,className:"mr-1"});default:return e.jsx(Te,{size:12,className:"mr-1"})}};return e.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-gray-100 shadow-sm flex items-center justify-between hover:shadow-md transition-shadow h-full",children:[e.jsxs("div",{children:[D?e.jsx("input",{type:"text",value:w,onChange:i=>l(i.target.value),onBlur:y,onKeyDown:i=>i.key==="Enter"&&y(),className:"text-xs font-medium text-gray-900 uppercase tracking-wide border-b border-blue-500 outline-none w-full bg-transparent",autoFocus:!0}):e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide cursor-text hover:text-blue-600 transition-colors",onClick:()=>{M&&O(!0)},children:b}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mt-1",children:L}),m&&e.jsxs("div",{className:`flex items-center mt-2 text-xs font-medium px-2 py-0.5 rounded-full w-fit ${h()}`,children:[g(),m.label||m.value]}),V&&e.jsx("div",{className:"flex items-center mt-2 text-xs font-medium text-gray-500",children:V})]}),e.jsx("div",{className:`p-3 rounded-xl ${P} ${E}`,children:e.jsx(x,{size:24})})]})};export{Ue as C,Be as K,De as T};
