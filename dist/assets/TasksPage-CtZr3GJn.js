import{c as U,r as u,Y as X,P as ee,Z as se,j as e,a0 as te,aG as re,aH as ae}from"./index-BaRn3IWj.js";import{u as ne,T as oe,S as i,b as h}from"./TaskBoard-BwtGGyZN.js";import{u as le,a as ie,D as de,c as ce,P as ue,e as me,C as xe}from"./core.esm-DZw859Vw.js";import{S as ge,v as be,u as pe}from"./sortable.esm-CF4rajHW.js";import{L as he}from"./list-B6IbW7Ji.js";import{S as fe}from"./square-kanban-teHmKL1h.js";import{A as ye}from"./arrow-up-down-Dz7OrkaD.js";import"./index-Ca_DMGSD.js";import"./copy-Js1b8Mpk.js";import"./remindersService-CkphtGlV.js";import"./goalsService-DtrjEL37.js";import"./square-check-big-BOoFgSp7.js";import"./list-ordered-NTzaGspy.js";import"./flag-7G_sRA4i.js";import"./star-DjOLFkds.js";import"./phone-1J_Lfyvk.js";import"./tag-C232WDvR.js";import"./smile-D8ED8Fch.js";import"./type-RMmUzjJx.js";import"./paperclip-Bq1xUkZq.js";import"./minus-BlqgYl96.js";import"./arrow-up-right-BV-z3Hwt.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=[["path",{d:"m7 20 5-5 5 5",key:"13a0gw"}],["path",{d:"m7 4 5 5 5-5",key:"1kwcof"}]],ke=U("chevrons-down-up",we);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],je=U("chevrons-up-down",ve),qe=()=>{const[r,m]=u.useState("table"),[b,x]=u.useState(""),[g,N]=u.useState("all"),[d,f]=u.useState("none"),[y,S]=u.useState(!1),[T,C]=u.useState(!1),[R,D]=u.useState(0),[V,_]=u.useState(0),z=X.getCurrentUser(),L=z?`taskboard-${z.id}`:"taskboard-default",B=u.useMemo(()=>[{label:"Expand all",icon:ke,onClick:()=>D(s=>s+1)},{label:"Collapse all",icon:je,onClick:()=>_(s=>s+1)},{label:"Quick add",icon:ee,onClick:()=>D(s=>s+1)},{label:"AI assist",icon:se,onClick:()=>D(s=>s+1)}],[]),{board:F,setBoard:H}=ne(L),w=b.trim().toLowerCase(),P=w.length>0||g!=="all",Q=s=>{if(!s)return i.New;const t=s.toLowerCase();return t.includes("done")||t.includes("complete")?i.Done:t.includes("work")||t.includes("progress")||t.includes("doing")?i.Working:t.includes("stuck")||t.includes("block")?i.Stuck:t.includes("pending")||t.includes("todo")||t.includes("to do")||t.includes("backlog")?i.Pending:t.includes("almost")||t.includes("review")?i.AlmostFinish:i.New},M=s=>!w||(s.name||"").toLowerCase().includes(w)?!0:Object.values(s.textValues||{}).some(t=>(t||"").toLowerCase().includes(w)),G=(s,t)=>{var c,o,p;if(g==="all")return!0;const a=(o=(c=t.columns)==null?void 0:c.find(k=>k.type==="status"))==null?void 0:o.id,n=Q(s.status||(a?(p=s.textValues)==null?void 0:p[a]:void 0));return g==="done"?n===i.Done:g==="new"?n===i.New||n===i.Pending:n!==i.Done},$=s=>{if(d==="none")return s;const t=[...s];if(d==="name")t.sort((a,n)=>(a.name||"").localeCompare(n.name||""));else if(d==="dueAsc"||d==="dueDesc")t.sort((a,n)=>{const c=a.dueDate?new Date(a.dueDate).getTime():1/0,o=n.dueDate?new Date(n.dueDate).getTime():1/0;return d==="dueAsc"?c-o:o-c});else if(d==="priority"){const a={[h.Urgent]:1,[h.High]:2,[h.Medium]:3,[h.Normal]:4,[h.Low]:5};t.sort((n,c)=>(a[n.priority]||99)-(a[c.priority]||99))}return t},Z=u.useMemo(()=>(F.groups||[]).map(s=>{const t=$((s.tasks||[]).filter(a=>M(a)&&G(a,s)));return{...s,tasks:t}}).filter(s=>!P||s.tasks.length>0),[F.groups,P,$,M,G]),O=le(ie(ue,{activationConstraint:{distance:5}})),q=s=>{const{active:t,over:a}=s;if(!a||!t.data.current)return;const{taskId:n,fromGroupId:c}=t.data.current,o=a.data.current,p=(o==null?void 0:o.groupId)||c,k=o==null?void 0:o.taskId;!n||!p||H(v=>{const I=v.groups.map(l=>({...l,tasks:[...l.tasks]})),A=I.find(l=>l.id===c),j=I.find(l=>l.id===p);if(!A||!j)return v;const K=A.tasks.findIndex(l=>l.id===n);if(K===-1)return v;const[Y]=A.tasks.splice(K,1);let E=j.tasks.length;if(k){const l=j.tasks.findIndex(J=>J.id===k);l>=0&&(E=l)}return j.tasks.splice(E,0,Y),{...v,groups:I}})},W=Z;return e.jsxs("div",{className:"flex flex-col h-full w-full bg-white overflow-hidden",children:[e.jsxs("div",{className:"h-16 border-b border-gray-200 flex items-center justify-between px-6 flex-shrink-0 bg-white z-10",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Tasks"}),e.jsx("div",{className:"h-6 w-px bg-gray-200 mx-2"}),e.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-lg space-x-1",children:[e.jsx("button",{onClick:()=>m("table"),className:`p-1.5 rounded-md transition-all ${r==="table"?"bg-white shadow-sm text-blue-600":"text-gray-500 hover:text-gray-700"}`,title:"Table view",children:e.jsx(he,{size:18})}),e.jsx("button",{onClick:()=>m("kanban"),className:`p-1.5 rounded-md transition-all ${r==="kanban"?"bg-white shadow-sm text-blue-600":"text-gray-500 hover:text-gray-700"}`,title:"Kanban view",children:e.jsx(fe,{size:18})})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(te,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search tasks...",value:b,onChange:s=>x(s.target.value),className:"pl-9 pr-4 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 w-64 transition-all"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>{S(!y),C(!1)},className:"flex items-center px-3 py-2 text-sm font-medium text-gray-600 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(re,{size:16,className:"mr-2"}),"Filter"]}),y&&e.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-lg z-20",children:[{key:"all",label:"All"},{key:"active",label:"Active (not done)"},{key:"done",label:"Done only"},{key:"new",label:"New / Pending"}].map(s=>e.jsx("button",{onClick:()=>{N(s.key),S(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${g===s.key?"text-blue-600 font-semibold":"text-gray-600"}`,children:s.label},s.key))})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>{C(!T),S(!1)},className:"flex items-center px-3 py-2 text-sm font-medium text-gray-600 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(ye,{size:16,className:"mr-2"}),"Sort"]}),T&&e.jsx("div",{className:"absolute right-0 mt-2 w-52 bg-white border border-gray-200 rounded-lg shadow-lg z-20",children:[{key:"none",label:"Default order"},{key:"name",label:"Name A â†’ Z"},{key:"dueAsc",label:"Due date (soonest)"},{key:"dueDesc",label:"Due date (latest)"},{key:"priority",label:"Priority (high first)"}].map(s=>e.jsx("button",{onClick:()=>{f(s.key),C(!1)},className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${d===s.key?"text-blue-600 font-semibold":"text-gray-600"}`,children:s.label},s.key))})]}),e.jsx("div",{className:"h-6 w-px bg-gray-200 mx-1"}),e.jsx("div",{className:"flex items-center space-x-2",children:B.map(s=>e.jsxs("button",{onClick:s.onClick,className:"flex items-center px-3 py-2 text-sm font-medium text-gray-600 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",title:s.label,children:[e.jsx(s.icon,{size:16,className:"mr-2"}),s.label]},s.label))}),e.jsx("div",{className:"h-6 w-px bg-gray-200 mx-1"}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ae,{size:20})})]})]}),e.jsxs("div",{className:"flex-1 overflow-hidden relative",children:[r==="table"&&e.jsx(oe,{storageKey:L,expandAllSignal:R,collapseAllSignal:V,searchQuery:b,statusFilter:g,sortKey:d}),r==="kanban"&&e.jsx("div",{className:"h-full w-full overflow-x-auto px-4 py-6 bg-gray-50",children:e.jsx(de,{sensors:O,collisionDetection:ce,onDragEnd:q,children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-4 auto-rows-min",children:W.map(s=>e.jsx(Ne,{group:s},s.id))})})})]})]})},Ne=({group:r})=>{const{setNodeRef:m,isOver:b}=Ce(r.id);return e.jsxs("div",{ref:m,className:`w-full min-w-[260px] bg-white rounded-2xl shadow-sm border border-gray-200 flex flex-col transition-all ${b?"ring-2 ring-blue-100":""}`,children:[e.jsx("div",{className:"p-3 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-sm text-gray-800 truncate",children:r.title}),e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-gray-100 text-gray-500",children:r.tasks.length})]})}),e.jsx(ge,{items:r.tasks.map(x=>x.id),strategy:be,children:e.jsxs("div",{className:"flex-1 max-h-[420px] overflow-y-auto p-3 space-y-3",children:[r.tasks.length===0&&e.jsx("div",{className:"text-xs text-gray-400 text-center py-4 border border-dashed border-gray-200 rounded-lg",children:"No tasks"}),r.tasks.map(x=>e.jsx(Se,{task:x,groupId:r.id},x.id))]})})]})},Se=({task:r,groupId:m})=>{const{attributes:b,listeners:x,setNodeRef:g,transform:N,transition:d,isDragging:f}=pe({id:r.id,data:{taskId:r.id,fromGroupId:m,groupId:m}}),y={transform:xe.Transform.toString(N),transition:d,boxShadow:f?"0 10px 25px rgba(0,0,0,0.12)":void 0};return e.jsxs("div",{ref:g,style:y,...b,...x,className:`bg-white border border-gray-200 rounded-xl p-3 shadow-sm hover:shadow-md transition-all cursor-grab active:cursor-grabbing ${f?"opacity-80 ring-2 ring-blue-100":""}`,children:[e.jsx("p",{className:"text-sm font-medium text-gray-800 mb-2",children:r.name}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-gray-50 text-gray-600 border border-gray-100",children:r.status||"New"}),e.jsx("span",{className:"text-[10px] text-gray-400",children:r.dueDate?new Date(r.dueDate).toLocaleDateString():""})]})]})},Ce=r=>me({id:r,data:{groupId:r}});export{qe as default};
