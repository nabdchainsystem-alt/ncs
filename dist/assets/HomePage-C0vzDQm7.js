const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-sqQsKImc.js","assets/index-CgMTJ2g5.css"])))=>i.map(i=>d[i]);
import{c as te,r as x,R as De,j as e,V as Se,W as xe,X as ue,H as Ie,_ as ke,Y as Le,Z as Me,$ as $e,n as be,h as Ee,l as W,a0 as pe,a1 as Oe,T as he,Q as q,L as K,a2 as oe,C as je,B as Z,a3 as Re,P as we,a4 as me,a5 as Ue,a6 as ne,m as ge,O as Ge,S as _e,a7 as ie,a8 as ee,a9 as se,u as Te,aa as Fe,K as We,ab as He,ac as ae,ad as Be,I as Ve}from"./index-sqQsKImc.js";import{d as ce}from"./discussionService-BW2ODrb-.js";import{I as ve,T as Ye}from"./TaskBoard-DC-l2SVj.js";import{g as X}from"./goalsService-XSbMoi0L.js";import{r as de}from"./remindersService-Dlo5WC4R.js";import{D as ye}from"./DatePicker-pXxBGZdI.js";import{T as Je}from"./DropdownCell-CSE_WS_c.js";import{A as Qe}from"./pin-DjGnB7tA.js";import{C as qe}from"./calendar-plus-YXip1osB.js";import{C as Ke}from"./cloud-DHhc2oZp.js";import{E as Ze}from"./index-CG6KNRPH.js";import{A as Xe}from"./phone-7-BcSGjI.js";import"./index-Ca_DMGSD.js";import"./copy-BQSRc9CV.js";import"./sortable.esm-BXA-dmXh.js";import"./core.esm-TRimKU_7.js";import"./list-Dm11EKlK.js";import"./list-ordered-5Rzf6Kqc.js";import"./flag-DM0neTDo.js";import"./star-hYvHy8aM.js";import"./corner-down-right-Dl5DQQhO.js";import"./tag-Dqtpp501.js";import"./smile-CQ81lmMB.js";import"./type-L4PgBd7E.js";import"./paperclip-BPOrNbhc.js";import"./minus-CDGUDZnw.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],tt=te("arrow-down-right",et);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]],at=te("cloud-lightning",st);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]],nt=te("cloud-rain",ot);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M8 19h.01",key:"puxtts"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M12 21h.01",key:"h35vbk"}],["path",{d:"M16 15h.01",key:"rnfrdf"}],["path",{d:"M16 19h.01",key:"1vcnzz"}]],lt=te("cloud-snow",rt);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=[["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}],["path",{d:"M15.947 12.65a4 4 0 0 0-5.925-4.128",key:"dpwdj0"}],["path",{d:"M13 22H7a5 5 0 1 1 4.9-6H13a3 3 0 0 1 0 6Z",key:"s09mg5"}]],Ce=te("cloud-sun",it);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],dt=te("thumbs-down",ct),xt=({isOpen:n,onClose:g,onCreate:w})=>{const[m,o]=x.useState(""),[p,s]=x.useState([]),j=r=>{r.preventDefault(),m.trim()&&(w(m,p),o(""),s([]),g())},N=r=>{s(u=>u.includes(r)?u.filter(h=>h!==r):[...u,r])},[d,i]=x.useState([]);return De.useEffect(()=>{(async()=>{var T;const u=await ke(()=>import("./index-sqQsKImc.js").then(l=>l.br),__vite__mapDeps([0,1])).then(l=>l.authService.getUsers()),S=(T=await ke(()=>import("./index-sqQsKImc.js").then(l=>l.br),__vite__mapDeps([0,1])).then(l=>l.authService.getCurrentUser()))==null?void 0:T.id;i(u.filter(l=>l.id!==S))})()},[]),e.jsx(Se,{children:n&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx(xe.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:g}),e.jsxs(xe.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:"Start New Discussion"}),e.jsx("button",{onClick:g,className:"p-1 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(ue,{size:20,className:"text-gray-500"})})]}),e.jsxs("form",{onSubmit:j,className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Discussion Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ie,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:m,onChange:r=>o(r.target.value),placeholder:"e.g. Project Alpha",className:"w-full pl-9 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all",autoFocus:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Add Participants"}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto border border-gray-100 rounded-lg p-2",children:d.map(r=>e.jsxs("div",{onClick:()=>N(r.id),className:`flex items-center p-2 rounded-md cursor-pointer transition-colors ${p.includes(r.id)?"bg-blue-50 border-blue-100":"hover:bg-gray-50"}`,children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-xs font-bold mr-3 overflow-hidden",style:{backgroundColor:r.color||"#3b82f6"},children:r.avatarUrl?e.jsx("img",{src:r.avatarUrl,alt:r.name,className:"w-full h-full object-cover"}):(r.name||"?").charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:r.name}),e.jsx("p",{className:"text-xs text-gray-500",children:r.email})]}),p.includes(r.id)&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"})]},r.id))})]}),e.jsxs("div",{className:"flex justify-end pt-2",children:[e.jsx("button",{type:"button",onClick:g,className:"px-4 py-2 text-sm font-medium text-gray-600 hover:text-gray-800 mr-2",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:!m.trim(),className:"px-4 py-2 bg-[#1e2126] hover:bg-[#2c3036] text-white text-sm font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Create Discussion"})]})]})]})]})})},Q="taskboard-quick-draft",mt=({isOpen:n,onClose:g,onSend:w,rooms:m=[],darkMode:o=!1})=>{const[p,s]=x.useState(!1),[j,N]=x.useState({type:"main",name:"My Tasks"}),[d,i]=x.useState(!1),r=x.useRef(null),u=()=>{g()},{ref:h,setIsActive:S}=Le({onCancel:u,initialActive:n});if(x.useEffect(()=>{S(n)},[n,S]),x.useEffect(()=>{if(n){if(s(!0),N({type:"main",name:"My Tasks"}),i(!1),!localStorage.getItem(Q)){const l={...ve,id:"draft-board",name:"Draft Task",groups:[{...ve.groups[0],id:Me(),title:"New Group",tasks:[]}]};localStorage.setItem(Q,JSON.stringify(l))}}else{const l=setTimeout(()=>s(!1),300);return()=>clearTimeout(l)}},[n]),!p&&!n)return null;const T=()=>{var l;try{const _=(l=r.current)==null?void 0:l.exportBoardWithDrafts();if(!_){const c=localStorage.getItem(Q);if(!c)return;w(JSON.parse(c),{type:j.type,roomId:j.roomId}),localStorage.removeItem(Q);return}localStorage.setItem(Q,JSON.stringify(_)),w(_,{type:j.type,roomId:j.roomId}),localStorage.removeItem(Q)}catch(_){console.error("Failed to read draft board",_)}};return e.jsx(Se,{children:n&&e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",children:[e.jsx(xe.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:`absolute inset-0 ${n?"bg-black/60 backdrop-blur-md":""}`,onClick:u}),e.jsx(xe.div,{ref:h,initial:{scale:.95,opacity:0,y:10},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:10},transition:{duration:.2,ease:"easeOut"},className:"w-full max-w-[95vw] h-auto max-h-[85vh] relative z-10",children:e.jsxs("div",{className:`relative w-full max-h-full flex flex-col rounded-3xl shadow-2xl overflow-hidden backdrop-blur-xl border ${o?"bg-gray-900/95 border-gray-700":"bg-white/95 border-white/40"}`,children:[e.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden relative min-h-[300px]",children:p&&e.jsx("div",{className:"min-w-full h-full",children:e.jsx(Ye,{ref:r,storageKey:Q,darkMode:o,minimal:!0,showGroupHeader:!0})})}),e.jsxs("div",{className:`px-6 py-4 flex items-center justify-between border-t border-gray-100/10 shrink-0 ${o?"bg-black/20":"bg-white/40"}`,children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>i(!d),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${o?"text-gray-300 hover:bg-white/5":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx("span",{className:"opacity-60",children:"Save As:"}),e.jsxs("span",{className:`font-bold flex items-center gap-2 ${o?"text-white":"text-gray-900"}`,children:[j.type==="room"&&e.jsx($e,{size:12,className:"text-indigo-400"}),j.type==="main"&&e.jsx(be,{size:12,className:"text-blue-400"}),j.name]}),e.jsx(Ee,{size:14,className:`opacity-50 transition-transform ${d?"rotate-180":""}`})]}),d&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>i(!1)}),e.jsxs("div",{className:`absolute bottom-full left-0 mb-2 w-64 rounded-xl shadow-xl border overflow-hidden p-1 z-20 animate-in slide-in-from-bottom-2 fade-in duration-200 ${o?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("button",{onClick:()=>{N({type:"main",name:"My Tasks"}),i(!1)},className:`w-full flex items-center justify-between px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ${o?"hover:bg-white/5 text-gray-200":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-1.5 rounded-md ${o?"bg-blue-500/20 text-blue-400":"bg-blue-50 text-blue-600"}`,children:e.jsx(be,{size:14})}),e.jsx("span",{children:"My Tasks"})]}),j.type==="main"&&e.jsx(W,{size:16,className:"text-blue-500"})]}),e.jsx("div",{className:`my-1 mx-2 border-t ${o?"border-gray-700":"border-gray-100"}`}),e.jsx("div",{className:`px-3 py-1 text-xs font-semibold uppercase tracking-wider mb-1 ${o?"text-gray-500":"text-gray-400"}`,children:"Private Rooms"}),e.jsx("div",{className:"max-h-48 overflow-y-auto custom-scrollbar space-y-0.5",children:m.length===0?e.jsx("div",{className:`px-3 py-2 text-xs italic ${o?"text-gray-500":"text-gray-400"}`,children:"No rooms found"}):m.map(l=>e.jsxs("button",{onClick:()=>{N({type:"room",roomId:l.id,name:l.name}),i(!1)},className:`w-full flex items-center justify-between px-3 py-2 rounded-lg text-sm font-medium transition-colors ${o?"hover:bg-white/5 text-gray-200":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-md flex items-center justify-center text-[10px] font-bold text-white shadow-sm",style:{backgroundColor:l.color||"#3b82f6"},children:l.name.charAt(0).toUpperCase()}),e.jsx("span",{className:"truncate max-w-[140px]",children:l.name})]}),j.roomId===l.id&&e.jsx(W,{size:16,className:"text-indigo-500"})]},l.id))})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:u,className:`px-5 py-2.5 rounded-xl font-semibold text-sm transition-all ${o?"text-gray-400 hover:bg-white/10 hover:text-white":"text-gray-600 hover:bg-black/5 hover:text-gray-900"}`,children:"Cancel"}),e.jsx("button",{onClick:T,className:"px-6 py-2.5 rounded-xl font-semibold text-sm text-white shadow-lg active:scale-95 transition-all bg-[#2a2e35] hover:bg-[#32363e] border border-gray-700",children:e.jsx("span",{children:"Send Task"})})]})]})]})})]})})},ut=({items:n,projects:g,onCapture:w,onSelect:m,onDelete:o})=>{const{t:p}=pe(),[s,j]=x.useState(""),[N,d]=x.useState(null),i=v=>{v.preventDefault(),s.trim()&&(w(s),j(""))},r=(v,k)=>{v.stopPropagation(),d(k)},u=(v,k)=>{v.stopPropagation(),o(k),d(null)},h=v=>{v.stopPropagation(),d(null)},S=n.filter(v=>v.status==="inbox").sort((v,k)=>k.createdAt-v.createdAt),T=v=>{const k=new Date;return v.getDate()===k.getDate()&&v.getMonth()===k.getMonth()&&v.getFullYear()===k.getFullYear()},l=v=>{const k=new Date;return k.setDate(k.getDate()-1),v.getDate()===k.getDate()&&v.getMonth()===k.getMonth()&&v.getFullYear()===k.getFullYear()},_=S.filter(v=>T(new Date(v.createdAt))),c=S.filter(v=>l(new Date(v.createdAt))),C=S.filter(v=>!T(new Date(v.createdAt))&&!l(new Date(v.createdAt))),P=({title:v,items:k,subtitle:R,highlight:M=!1})=>e.jsxs("div",{className:`flex flex-col h-full relative ${M?"bg-white/40 shadow-sm ring-1 ring-stone-900/5":"bg-transparent"} rounded-[2rem] p-1 transition-all duration-300`,children:[e.jsxs("div",{className:"flex-none flex items-center justify-between px-5 pt-4 pb-2 border-b border-stone-100/50 mb-1 mx-2",children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:`text-xs font-bold uppercase tracking-widest ${M?"text-stone-900":"text-stone-400"}`,children:v}),R&&e.jsx("span",{className:"text-[10px] text-stone-300 italic font-medium",children:R})]}),e.jsx("span",{className:`text-[10px] font-extrabold h-5 min-w-[1.25rem] flex items-center justify-center px-1.5 rounded-full ${M?"bg-stone-900 text-white":"bg-stone-100 text-stone-400"}`,children:k.length})]}),e.jsxs("div",{className:"flex-1 relative w-full min-h-0 rounded-b-[2rem] overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 overflow-y-auto scrollbar-hide px-3 pb-8 pt-1",children:k.length>0?e.jsx("div",{className:"space-y-1",children:k.map(D=>{const L=N===D.id;return e.jsx("div",{onClick:()=>!L&&m(D.id),className:`group relative py-3 px-3 border border-transparent transition-all cursor-pointer rounded-xl flex flex-col gap-1 overflow-hidden 
                                            ${L?"bg-red-50 border-red-100":"hover:border-stone-100/50 hover:bg-white/60 hover:shadow-sm"}
                                        `,children:L?e.jsxs("div",{className:"flex items-center justify-between w-full h-full animate-fade-in-right",children:[e.jsx("span",{className:"text-xs font-bold text-red-600 uppercase tracking-widest pl-1",children:p("gtd.capture.delete_confirm")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:z=>h(z),className:"p-1 rounded-full bg-stone-200 text-stone-500 hover:bg-stone-300 transition-colors",children:e.jsx(ue,{size:14,strokeWidth:3})}),e.jsx("button",{onClick:z=>u(z,D.id),className:"p-1 rounded-full bg-red-500 text-white hover:bg-red-600 transition-colors shadow-sm",children:e.jsx(Oe,{size:14,strokeWidth:3})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("span",{className:`text-base font-serif italic line-clamp-2 leading-snug ${M?"text-stone-700":"text-stone-500"} group-hover:text-stone-900 transition-colors`,children:D.text}),e.jsx("button",{onClick:z=>r(z,D.id),className:"opacity-0 group-hover:opacity-100 transition-all p-1.5 text-stone-300 hover:text-red-500 hover:bg-red-50 rounded-lg -mr-1 -mt-1",title:"Delete",children:e.jsx(he,{size:14})})]}),e.jsx("span",{className:"text-[9px] font-sans font-bold text-stone-200 group-hover:text-stone-300 uppercase tracking-wider transition-opacity",children:new Date(D.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},D.id)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full opacity-30 select-none pb-8",children:[e.jsx("span",{className:"text-3xl font-serif italic text-stone-300 mb-2",children:"~"}),e.jsx("p",{className:"text-[9px] font-sans tracking-widest uppercase font-bold text-stone-300",children:p("gtd.capture.empty")})]})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-10 bg-gradient-to-t from-stone-50/100 to-transparent pointer-events-none"})]})]});return e.jsxs("div",{className:"h-full min-h-[600px] flex flex-col font-serif p-6 max-w-[90rem] mx-auto w-full",children:[e.jsxs("div",{className:"flex-none mb-8 text-center relative z-10",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold font-serif text-stone-900 uppercase tracking-widest mb-6 select-none",children:p("gtd.capture")}),e.jsxs("form",{onSubmit:i,className:"relative w-full max-w-2xl mx-auto group",children:[e.jsx("input",{type:"text",value:s,onChange:v=>j(v.target.value),placeholder:p("gtd.capture.placeholder"),className:"w-full bg-transparent border-b border-stone-200 focus:border-stone-900 px-6 py-4 text-4xl font-serif italic text-stone-800 placeholder:text-stone-200 focus:placeholder:text-stone-300 focus:outline-none transition-all text-center",autoFocus:!0}),e.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 opacity-0 group-focus-within:opacity-100 transition-opacity duration-500",children:e.jsx("span",{className:"text-[9px] font-bold bg-stone-100 text-stone-400 px-2 py-1 rounded-md uppercase tracking-wider",children:p("gtd.capture.enter")})})]})]}),e.jsxs("div",{className:"flex-1 w-full grid grid-cols-1 md:grid-cols-3 gap-6 min-h-0 border-t border-stone-100/30 pt-4",children:[e.jsx(P,{title:p("gtd.capture.yesterday"),items:c,subtitle:p("gtd.capture.review")}),e.jsx(P,{title:p("gtd.capture.today"),items:_,subtitle:p("gtd.capture.inbox"),highlight:!0}),e.jsx(P,{title:p("gtd.capture.pending"),items:C,subtitle:p("gtd.capture.backlog")})]})]})},pt=({item:n,onProcess:g,onCreateProject:w,onNavigate:m,onExportToBoard:o,projects:p,onNext:s,onPrev:j,canNext:N,canPrev:d})=>{const{t:i}=pe(),[r,u]=x.useState("initial"),[h,S]=x.useState(""),[T,l]=x.useState(""),[_,c]=x.useState(!1);x.useEffect(()=>{u("initial"),S(""),l(""),c(!1)},[n==null?void 0:n.id]),x.useEffect(()=>{const k=R=>{R.target instanceof HTMLInputElement||R.target instanceof HTMLTextAreaElement||(R.key==="ArrowRight"&&N?s==null||s():R.key==="ArrowLeft"&&d&&(j==null||j()))};return window.addEventListener("keydown",k),()=>window.removeEventListener("keydown",k)},[N,d,s,j]);const C=k=>{g(n.id,k)},P=(k,R,M)=>e.jsxs("div",{className:"w-full max-w-2xl mx-auto animate-fade-in-up",children:[e.jsx("div",{className:"text-center mb-10",children:e.jsxs("div",{className:"bg-white p-8 rounded-3xl shadow-xl border border-stone-100 relative",children:[e.jsxs("div",{className:"text-3xl font-serif text-stone-800 italic leading-snug mb-4",children:['"',n.text,'"']}),e.jsxs("div",{className:"flex justify-center gap-4 text-xs font-bold uppercase tracking-wider text-stone-300",children:[e.jsxs("span",{children:["Created ",new Date(n.createdAt).toLocaleDateString()]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["ID #",n.id]})]}),d&&e.jsx("button",{onClick:j,className:"absolute left-[-3rem] top-1/2 -translate-y-1/2 p-2 text-stone-300 hover:text-stone-600 transition-colors",title:"Previous Item",children:e.jsx(oe,{size:24,className:"rotate-180"})}),N&&e.jsx("button",{onClick:s,className:"absolute right-[-3rem] top-1/2 -translate-y-1/2 p-2 text-stone-300 hover:text-stone-600 transition-colors",title:"Next Item",children:e.jsx(oe,{size:24})})]})}),e.jsxs("div",{className:"bg-stone-50/50 backdrop-blur-sm rounded-3xl p-8 border border-stone-100 shadow-inner",children:[e.jsx("h4",{className:"text-xl font-serif text-stone-600 mb-8 text-center italic",children:k}),R]}),M&&e.jsxs("button",{onClick:M,className:"mx-auto mt-6 flex items-center gap-2 text-stone-400 hover:text-stone-600 text-xs font-bold uppercase tracking-wider transition-colors",children:[e.jsx(oe,{className:"rotate-180",size:14})," Back"]})]});let v=null;return n?r==="initial"?v=P(i("gtd.clarify.is_actionable"),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("button",{onClick:()=>u("not_actionable"),className:"group bg-white p-8 rounded-2xl border border-stone-200 shadow-sm hover:border-stone-400 hover:shadow-lg transition-all text-center",children:[e.jsx(dt,{size:32,className:"mx-auto mb-4 text-stone-300 group-hover:text-stone-500 transition-colors"}),e.jsx("span",{className:"block text-lg font-bold text-stone-700 mb-2",children:i("gtd.clarify.no")}),e.jsx("span",{className:"text-xs text-stone-400 font-sans",children:i("gtd.clarify.no_desc")})]}),e.jsxs("button",{onClick:()=>u("actionable_type"),className:"group bg-stone-900 p-8 rounded-2xl shadow-xl hover:bg-black hover:-translate-y-1 transition-all text-center",children:[e.jsx(Je,{size:32,className:"mx-auto mb-4 text-stone-400 group-hover:text-amber-400 transition-colors"}),e.jsx("span",{className:"block text-lg font-bold text-white mb-2",children:i("gtd.clarify.yes")}),e.jsx("span",{className:"text-xs text-stone-400 font-sans",children:i("gtd.clarify.yes_desc")})]})]})):r==="not_actionable"?v=P(i("gtd.clarify.organize_non_actionable"),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("button",{onClick:()=>{C({status:"trash"}),m("organize")},className:"bg-white hover:bg-red-50 p-6 rounded-2xl border border-stone-200 hover:border-red-200 transition-all flex flex-col items-center gap-3 group",children:[e.jsx(he,{size:24,className:"text-stone-400 group-hover:text-red-500"}),e.jsx("span",{className:"font-bold text-stone-600 group-hover:text-red-700",children:i("gtd.clarify.trash")})]}),e.jsxs("button",{onClick:()=>{C({status:"reference"}),m("organize")},className:"bg-white hover:bg-blue-50 p-6 rounded-2xl border border-stone-200 hover:border-blue-200 transition-all flex flex-col items-center gap-3 group",children:[e.jsx(Qe,{size:24,className:"text-stone-400 group-hover:text-blue-500"}),e.jsx("span",{className:"font-bold text-stone-600 group-hover:text-blue-700",children:i("gtd.list.reference")}),e.jsx("span",{className:"text-[10px] text-stone-400 font-sans mt-1",children:i("gtd.clarify.file_away")})]}),e.jsxs("button",{onClick:()=>{C({status:"someday"}),m("organize")},className:"bg-white hover:bg-amber-50 p-6 rounded-2xl border border-stone-200 hover:border-amber-200 transition-all flex flex-col items-center gap-3 group",children:[e.jsx(q,{size:24,className:"text-stone-400 group-hover:text-amber-500"}),e.jsx("span",{className:"font-bold text-stone-600 group-hover:text-amber-700",children:i("gtd.list.someday")})]})]}),()=>u("initial")):r==="actionable_type"?v=P(i("gtd.clarify.next_step"),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-2",children:e.jsxs("button",{onClick:()=>u("project_details"),className:"w-full bg-indigo-50 hover:bg-indigo-100 p-4 rounded-xl border border-indigo-100 hover:border-indigo-200 transition-all flex items-center justify-between group px-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(K,{size:20,className:"text-indigo-400 group-hover:text-indigo-600"}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"block font-bold text-indigo-900",children:i("gtd.clarify.is_project")}),e.jsx("span",{className:"text-xs text-indigo-400",children:i("gtd.clarify.project_desc")})]})]}),e.jsx(oe,{size:16,className:"text-indigo-300"})]})}),e.jsxs("button",{onClick:()=>{C({status:"done"}),m("review")},className:"bg-white hover:bg-emerald-50 p-4 rounded-xl border border-stone-200 hover:border-emerald-200 transition-all flex flex-col items-center gap-2 group",children:[e.jsx(W,{size:24,className:"text-stone-400 group-hover:text-emerald-500"}),e.jsx("span",{className:"font-bold text-sm text-stone-600 group-hover:text-emerald-700",children:i("gtd.clarify.do_it")}),e.jsx("span",{className:"text-[10px] text-stone-400 font-sans",children:i("gtd.clarify.mark_done")})]}),e.jsxs("button",{onClick:()=>u("delegate_details"),className:"bg-white hover:bg-purple-50 p-4 rounded-xl border border-stone-200 hover:border-purple-200 transition-all flex flex-col items-center gap-2 group",children:[e.jsx(be,{size:24,className:"text-stone-400 group-hover:text-purple-500"}),e.jsx("span",{className:"font-bold text-sm text-stone-600 group-hover:text-purple-700",children:i("gtd.clarify.delegate")})]}),e.jsxs("button",{onClick:()=>{C({status:"actionable"}),m("organize")},className:"bg-white hover:bg-stone-50 p-4 rounded-xl border border-stone-200 hover:border-stone-300 transition-all flex flex-col items-center gap-2 group",children:[e.jsx(W,{size:24,className:"text-stone-400 group-hover:text-stone-600"}),e.jsx("span",{className:"font-bold text-sm text-stone-600 group-hover:text-stone-800",children:i("gtd.list.next_actions")})]}),e.jsxs("button",{onClick:()=>u("defer_details"),className:"bg-white hover:bg-orange-50 p-4 rounded-xl border border-stone-200 hover:border-orange-200 transition-all flex flex-col items-center gap-2 group",children:[e.jsx(je,{size:24,className:"text-stone-400 group-hover:text-orange-500"}),e.jsx("span",{className:"font-bold text-sm text-stone-600 group-hover:text-orange-700",children:i("gtd.clarify.defer")})]})]}),()=>u("initial")):r==="delegate_details"?v=P(i("gtd.clarify.who_waiting"),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:i("gtd.clarify.enter_name"),value:h,onChange:k=>S(k.target.value),className:"w-full p-4 bg-white rounded-xl border border-stone-200 focus:outline-none focus:ring-2 focus:ring-stone-900/10 focus:border-stone-400 font-serif italic text-lg",autoFocus:!0}),e.jsx("button",{disabled:!h.trim(),onClick:()=>{C({status:"waiting",delegatedTo:h}),m("organize")},className:"w-full py-4 bg-stone-900 text-white rounded-xl font-bold tracking-wide hover:bg-black disabled:opacity-50 transition-all",children:i("gtd.clarify.confirm_waiting")})]}),()=>u("actionable_type")):r==="defer_details"?v=P(i("gtd.clarify.when_need"),e.jsxs("div",{className:"space-y-4 relative",children:[e.jsxs("button",{onClick:()=>c(!0),className:"w-full p-4 bg-white rounded-xl border border-stone-200 focus:outline-none focus:ring-2 focus:ring-stone-900/10 focus:border-stone-400 font-serif italic text-lg text-left text-stone-700 flex justify-between items-center",children:[T?new Date(T).toLocaleDateString(void 0,{weekday:"long",month:"long",day:"numeric"}):i("gtd.clarify.select_value"),e.jsx(je,{size:20,className:"text-stone-400"})]}),_&&e.jsx("div",{className:"absolute bottom-full mb-2 left-0 z-50 shadow-2xl rounded-2xl overflow-hidden",children:e.jsx(ye,{date:T,onSelect:k=>{l(k),c(!1)},onClose:()=>c(!1)})}),e.jsx("button",{disabled:!T,onClick:()=>{C({status:"actionable",dueDate:new Date(T).getTime()}),m("organize")},className:"w-full py-4 bg-stone-900 text-white rounded-xl font-bold tracking-wide hover:bg-black disabled:opacity-50 transition-all",children:i("gtd.clarify.add_calendar")})]}),()=>u("actionable_type")):r==="project_details"&&(v=P(i("gtd.clarify.define_outcome"),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"e.g. Vacation in Hawaii...",value:h,onChange:k=>S(k.target.value),className:"w-full p-4 bg-white rounded-xl border border-stone-200 focus:outline-none focus:ring-2 focus:ring-stone-900/10 focus:border-stone-400 font-serif italic text-lg",autoFocus:!0}),e.jsx("button",{disabled:!h.trim(),onClick:()=>{w(h,[n.text]),g(n.id,{status:"trash"}),m("organize")},className:"w-full py-4 bg-stone-900 text-white rounded-xl font-bold tracking-wide hover:bg-black disabled:opacity-50 transition-all",children:i("gtd.clarify.create_project")})]}),()=>u("actionable_type"))):v=e.jsxs("div",{className:"h-full w-full flex flex-col items-center justify-center text-stone-300 animate-fade-in-up",children:[e.jsx(W,{size:96,strokeWidth:.5,className:"mb-8 opacity-20 text-stone-900"}),e.jsx("h3",{className:"text-4xl font-serif text-stone-400 italic mb-4",children:i("gtd.clarify.inbox_zero")}),e.jsx("p",{className:"text-stone-400 font-sans tracking-widest uppercase text-xs font-bold",children:i("gtd.clarify.you_are_clear")})]}),e.jsxs("div",{className:"h-full min-h-[600px] flex flex-col font-serif p-6 max-w-[90rem] mx-auto w-full",children:[e.jsx("div",{className:"text-center mb-8",children:e.jsx("h1",{className:"text-4xl md:text-5xl font-bold font-serif text-stone-900 uppercase tracking-widest mb-2 select-none",children:i("gtd.clarify")})}),e.jsx("div",{className:"flex-1 w-full min-h-0 relative",children:v})]})},ht=({projects:n,items:g,onUpdateItem:w,onAddProject:m,onAddItem:o,onDelete:p})=>{const{t:s}=pe(),j=g.filter(t=>t.status==="actionable"&&!t.dueDate),N=g.filter(t=>(t.status==="actionable"||t.status==="waiting")&&t.dueDate).sort((t,$)=>(t.dueDate||0)-($.dueDate||0)),d=g.filter(t=>t.status==="waiting"),i=g.filter(t=>t.status==="someday"),r=g.filter(t=>t.status==="reference");g.filter(t=>t.status==="done").sort((t,$)=>$.createdAt-t.createdAt);const[u,h]=x.useState(null),[S,T]=x.useState(""),[l,_]=x.useState(""),[c,C]=x.useState(""),[P,v]=x.useState(null),[k,R]=x.useState(""),[M,D]=x.useState(""),L=()=>{if(!S.trim())return;const t={dueDate:c?new Date(c).getTime():void 0,energy:P||void 0,contextId:k||void 0,description:M||void 0};u==="project"?m(S):u==="action"?o({text:S,status:"actionable",...t}):u==="waiting"?o({text:S,status:"waiting",delegatedTo:l||"Someone",...t}):u==="someday"?o({text:S,status:"someday",...t}):u==="reference"&&o({text:S,status:"reference",...t}),z()},z=()=>{h(null),T(""),_(""),C(""),v(null),R(""),D("")},U=new Date().setHours(0,0,0,0),G=t=>t>=U,A=({title:t,description:$,icon:O,count:B,children:Y,onAdd:V,addLabel:J,newCount:re,color:le="text-stone-400"})=>e.jsxs("div",{className:"group",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(O,{size:20,className:`${le} opacity-80`}),e.jsx("h3",{className:"text-xl font-serif font-bold text-stone-800",children:t}),V&&e.jsx("button",{onClick:V,className:"ml-2 p-1 text-stone-300 hover:text-stone-900 hover:bg-stone-100 rounded-lg transition-colors",title:J,children:e.jsx(we,{size:16})}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold uppercase tracking-widest text-stone-400 bg-stone-50 px-2 py-1 rounded-full border border-stone-100",children:[e.jsxs("span",{children:[s("gtd.label.total"),": ",B]}),re>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-stone-300",children:"|"}),e.jsxs("span",{className:le,children:[s("gtd.label.new"),": ",re]})]})]})]})}),e.jsx("div",{className:"space-y-1 pl-2 md:pl-8 border-l border-stone-100 group-hover:border-stone-200 transition-colors max-h-[300px] overflow-y-auto pr-2 scrollbar-hide",children:Y})]}),F=({item:t,type:$="task"})=>e.jsxs("div",{className:"group py-3 px-2 flex items-start justify-between gap-4 border-b border-stone-100/50 hover:border-stone-100 hover:bg-stone-50/50 rounded-lg transition-all cursor-pointer relative",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`font-serif text-sm leading-snug ${$==="simple"?"text-stone-500":"text-stone-800 font-medium"}`,children:$==="project"?t.name:t.text}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-1.5 opacity-0 group-hover:opacity-100 transition-opacity",children:[$==="waiting"&&t.delegatedTo&&e.jsxs("span",{className:"text-[10px] uppercase font-bold text-amber-500",children:["Waiting: ",t.delegatedTo]}),t.dueDate&&e.jsx("span",{className:"text-[10px] uppercase font-bold text-stone-400",children:new Date(t.dueDate).toLocaleDateString(void 0,{month:"short",day:"numeric"})}),t.progress!==void 0&&e.jsxs("span",{className:"text-[10px] uppercase font-bold text-indigo-500",children:[t.progress,"% Done"]})]})]}),e.jsxs("div",{className:"flex items-start gap-3 min-w-fit",children:[e.jsx("button",{onClick:O=>{O.stopPropagation(),confirm("Are you sure you want to delete this item?")&&p(t.id)},className:"opacity-0 group-hover:opacity-100 p-1 text-stone-300 hover:text-red-500 transition-all",title:"Delete",children:e.jsx(he,{size:14})}),e.jsxs("div",{className:"mt-1",children:[$==="project"&&e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-stone-900"}),$==="task"&&e.jsx("div",{className:"h-3 w-3 rounded-full border border-stone-300 group-hover:border-emerald-500 transition-colors"}),$==="waiting"&&e.jsx(q,{size:14,className:"text-stone-300 group-hover:text-amber-500"})]})]})]});return e.jsxs("div",{className:"h-full min-h-[600px] flex flex-col font-serif p-6 max-w-[90rem] mx-auto w-full",children:[e.jsx("div",{className:"flex flex-col items-center justify-center mb-8 pb-6 border-b border-stone-100",children:e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold font-serif text-stone-900 uppercase tracking-widest select-none",children:s("gtd.organize")}),e.jsx("p",{className:"text-stone-400 text-xs font-bold uppercase tracking-widest mt-2",children:s("gtd.organize.subtitle")})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide px-2",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-8 pb-12",children:[e.jsx(A,{title:s("gtd.list.projects"),description:s("gtd.list.desc.projects"),icon:K,count:n.filter(t=>t.status==="active").length,newCount:n.filter(t=>t.status==="active"&&G(t.id)).length,color:"text-indigo-500",onAdd:()=>h("project"),addLabel:s("gtd.modal.start_project"),children:n.filter(t=>t.status==="active").map(t=>{const $=t.items.length,O=t.items.filter(Y=>{var V;return((V=g.find(J=>J.id===Y))==null?void 0:V.status)==="done"}).length,B=$>0?Math.round(O/$*100):0;return e.jsx(F,{item:{...t,progress:B},type:"project"},t.id)})}),e.jsx(A,{title:s("gtd.list.next_actions"),description:s("gtd.list.desc.next_actions"),icon:W,count:j.length,newCount:j.filter(t=>G(t.createdAt)).length,color:"text-emerald-500",onAdd:()=>h("action"),addLabel:s("gtd.modal.add_action"),children:j.map(t=>e.jsx(F,{item:t,type:"task"},t.id))}),e.jsx(A,{title:s("gtd.list.waiting_for"),description:s("gtd.list.desc.waiting"),icon:Z,count:d.length,newCount:d.filter(t=>G(t.createdAt)).length,color:"text-amber-500",onAdd:()=>h("waiting"),addLabel:s("gtd.modal.log_waiting"),children:d.map(t=>e.jsx(F,{item:t,type:"waiting"},t.id))}),e.jsxs(A,{title:s("gtd.list.scheduled"),description:s("gtd.list.desc.scheduled"),icon:je,count:N.length,newCount:N.filter(t=>G(t.createdAt)).length,color:"text-blue-500",children:[N.map(t=>e.jsx("div",{className:"py-3 px-2 border-b border-transparent hover:bg-stone-50 rounded-lg group",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-10 text-center leading-none",children:[e.jsx("span",{className:"block text-[10px] font-bold text-stone-400 uppercase",children:t.dueDate?new Date(t.dueDate).toLocaleDateString(void 0,{month:"short"}):""}),e.jsx("span",{className:"block text-xl font-serif font-bold text-stone-900",children:t.dueDate?new Date(t.dueDate).getDate():""})]}),e.jsx("span",{className:"text-sm font-serif font-medium text-stone-800",children:t.text})]})},t.id)),N.length===0&&e.jsx("span",{className:"text-stone-300 text-xs italic p-2",children:s("gtd.label.nothing_scheduled")})]}),e.jsx(A,{title:s("gtd.list.someday"),description:s("gtd.list.desc.someday"),icon:q,count:i.length,newCount:i.filter(t=>G(t.createdAt)).length,color:"text-stone-400",onAdd:()=>h("someday"),addLabel:s("gtd.modal.add_idea"),children:i.map(t=>e.jsx(F,{item:t,type:"simple"},t.id))}),e.jsx(A,{title:s("gtd.list.reference"),description:s("gtd.list.desc.reference"),icon:Re,count:r.length,newCount:r.filter(t=>G(t.createdAt)).length,color:"text-stone-500",onAdd:()=>h("reference"),addLabel:s("gtd.modal.add_reference"),children:r.map(t=>e.jsx(F,{item:t,type:"simple"},t.id))})]})}),u&&e.jsxs("div",{className:"absolute inset-0 z-50 flex items-center justify-center p-4 bg-stone-900/10 backdrop-blur-sm animate-fade-in",children:[e.jsx("div",{className:"absolute inset-0",onClick:z}),e.jsxs("div",{className:"bg-white rounded-3xl p-8 pb-12 w-full max-w-lg shadow-2xl ring-1 ring-black/5 animate-scale-in relative z-10 overflow-y-auto max-h-[85vh]",children:[e.jsx("h3",{className:"text-2xl font-serif font-bold text-stone-900 mb-6 italic",children:s(u==="project"?"gtd.modal.start_project":u==="action"?"gtd.modal.add_action":u==="someday"?"gtd.list.someday":u==="reference"?"gtd.modal.add_reference":"gtd.modal.log_waiting")}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-stone-400 uppercase tracking-widest mb-2",children:s(u==="project"?"gtd.modal.project_name":"gtd.modal.description")}),e.jsx("input",{autoFocus:!0,type:"text",className:"w-full text-lg font-serif border-b-2 border-stone-100 focus:border-stone-900 outline-none py-2 bg-transparent transition-colors placeholder:text-stone-300 text-stone-800",placeholder:u==="project"?"e.g., Q4 Marketing Strategy":"e.g., Call John about updates",value:S,onChange:t=>T(t.target.value)})]}),u==="waiting"&&e.jsxs("div",{className:"animate-fade-in-up",children:[e.jsx("label",{className:"block text-xs font-bold text-stone-400 uppercase tracking-widest mb-2",children:s("gtd.modal.who_waiting")}),e.jsx("input",{type:"text",className:"w-full text-base font-serif border-b-2 border-stone-100 focus:border-stone-900 outline-none py-2 bg-transparent transition-colors placeholder:text-stone-300 text-stone-800",placeholder:"e.g., Alice, Client, Approval Board",value:l,onChange:t=>_(t.target.value)})]}),e.jsxs("div",{className:"pt-4 border-t border-stone-100 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold text-stone-400 uppercase tracking-widest mb-1",children:s("gtd.modal.due_date")}),e.jsx("input",{type:"date",className:"w-full text-sm font-sans border-b border-stone-100 focus:border-stone-900 outline-none py-1 bg-transparent text-stone-600",value:c,onChange:t=>C(t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold text-stone-400 uppercase tracking-widest mb-1",children:s("gtd.modal.context")}),e.jsx("input",{type:"text",placeholder:"@office, @home",className:"w-full text-sm font-sans border-b border-stone-100 focus:border-stone-900 outline-none py-1 bg-transparent text-stone-600 placeholder:text-stone-300",value:k,onChange:t=>R(t.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold text-stone-400 uppercase tracking-widest mb-2",children:s("gtd.modal.energy")}),e.jsx("div",{className:"flex items-center gap-2",children:["High","Medium","Low"].map(t=>e.jsx("button",{onClick:()=>v(t),className:`px-3 py-1.5 rounded-lg text-xs font-bold uppercase tracking-wider border transition-all ${P===t?"bg-stone-900 text-white border-stone-900":"bg-white text-stone-400 border-stone-200 hover:border-stone-400"}`,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold text-stone-400 uppercase tracking-widest mb-1",children:s("gtd.modal.notes")}),e.jsx("textarea",{className:"w-full text-sm font-serif border border-stone-200 rounded-xl p-3 focus:border-stone-900 outline-none bg-stone-50/50 min-h-[80px] text-stone-700 resize-none",placeholder:"Add any additional details...",value:M,onChange:t=>D(t.target.value)})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-stone-100",children:[e.jsx("button",{onClick:z,className:"px-6 py-3 rounded-xl text-stone-500 font-bold text-xs uppercase tracking-wider hover:bg-stone-50 transition-colors",children:s("gtd.modal.cancel")}),e.jsx("button",{onClick:L,disabled:!S.trim(),className:"px-8 py-3 bg-stone-900 text-white rounded-xl font-bold text-xs uppercase tracking-wider hover:bg-black transition-all shadow-lg hover:shadow-xl disabled:opacity-50 disabled:shadow-none",children:s(u==="project"?"gtd.clarify.create_project":"gtd.modal.add_item")})]})]})]})]})]})},gt=({items:n,projects:g,onUpdate:w,onDelete:m})=>{const[o,p]=x.useState("daily"),[s,j]=x.useState(null),d=(c=>{const C=new Date;if(C.setHours(0,0,0,0),c==="weekly"){const P=C.getDay()||7;P!==1&&C.setHours(-24*(P-1))}else c==="monthly"&&C.setDate(1);return C.getTime()})(o),i=n.filter(c=>c.status==="inbox"),r=n.filter(c=>c.status==="actionable"),u=n.filter(c=>c.status==="waiting"),h=n.filter(c=>c.status==="someday"),S=g.filter(c=>c.status!=="completed"),T=n.filter(c=>c.status==="done").sort((c,C)=>(C.completedAt||0)-(c.completedAt||0)),l=c=>c.filter(C=>(C.createdAt||C.id)>=d).length,_=[{id:"inbox",title:"Inbox",icon:me,items:i,color:"text-blue-500",statLabel:"New",statCount:l(i)},{id:"actions",title:"Next Actions",icon:W,items:r,color:"text-emerald-500",statLabel:"New",statCount:l(r)},{id:"waiting",title:"Waiting For",icon:Z,items:u,color:"text-amber-500",statLabel:"New",statCount:l(u)},{id:"projects",title:"Active Projects",icon:Ue,items:S.map(c=>({id:c.id,text:c.name,...c})),color:"text-indigo-500",statLabel:"New",statCount:l(S)},{id:"someday",title:"Someday / Maybe",icon:q,items:h,color:"text-stone-400",statLabel:"New",statCount:l(h)},{id:"done",title:"Completed",icon:me,items:T,color:"text-blue-500",statLabel:"Total",statCount:T.length}];return e.jsxs("div",{className:"h-full min-h-[600px] flex flex-col font-serif p-6 max-w-[90rem] mx-auto w-full",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center mb-8 pb-6 border-b border-stone-100",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold font-serif text-stone-900 uppercase tracking-widest select-none",children:"Reflect"}),e.jsx("p",{className:"text-stone-400 text-xs font-bold uppercase tracking-widest mt-2",children:o==="daily"?"Today's Progress":o==="weekly"?"Weekly Reset":"Monthly Overview"})]}),e.jsx("div",{className:"flex bg-stone-100 p-1 rounded-xl",children:["daily","weekly","monthly"].map(c=>e.jsx("button",{onClick:()=>p(c),className:`px-6 py-2 rounded-lg text-xs font-bold uppercase tracking-wider transition-all ${o===c?"bg-white text-stone-900 shadow-sm":"text-stone-400 hover:text-stone-600"}`,children:c},c))})]}),e.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide px-2",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-8 pb-12",children:_.map(c=>e.jsxs("div",{className:"group",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(c.icon,{size:20,className:`${c.color} opacity-80`}),e.jsx("h3",{className:"text-xl font-serif font-bold text-stone-800",children:c.title}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold uppercase tracking-widest text-stone-400 bg-stone-50 px-2 py-1 rounded-full border border-stone-100",children:[e.jsxs("span",{children:["Total: ",c.items.length]}),c.id!=="done"&&c.statCount>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-stone-300",children:"|"}),e.jsxs("span",{className:c.color,children:[c.statLabel,": ",c.statCount]})]})]})]})}),e.jsxs("div",{className:"space-y-1 pl-2 md:pl-8 border-l border-stone-100 group-hover:border-stone-200 transition-colors max-h-[300px] overflow-y-auto pr-2 scrollbar-thin scrollbar-thumb-stone-200 scrollbar-track-transparent",children:[c.items.length>0?c.items.slice(0,100).map(C=>e.jsxs("div",{className:"flex items-center gap-3 py-2 px-3 rounded-lg hover:bg-stone-50 transition-colors flex-shrink-0 group/item relative",children:[c.id!=="done"&&c.id!=="projects"&&e.jsx("button",{onClick:P=>{P.stopPropagation(),w(C.id,{status:"done"})},className:"flex-shrink-0 w-4 h-4 rounded-full border border-stone-300 hover:border-emerald-500 hover:bg-emerald-50 transition-all flex items-center justify-center group/check",title:"Mark as Done",children:e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 opacity-0 group-hover/check:opacity-100 transition-opacity"})}),(c.id==="done"||c.id==="projects")&&e.jsx("div",{className:`w-1.5 h-1.5 rounded-full flex-shrink-0 ${c.id==="done"?"bg-stone-300":"bg-indigo-300"}`}),e.jsx("span",{className:`text-sm font-serif truncate ${c.id==="done"?"text-stone-400 line-through decoration-stone-200":"text-stone-700"}`,children:C.text}),e.jsx("span",{className:"text-[10px] text-stone-300 font-sans uppercase tracking-wider",children:c.id==="done"?C.completedAt?new Date(C.completedAt).toLocaleDateString(void 0,{month:"short",day:"numeric"}):"":C.createdAt?new Date(C.createdAt).toLocaleDateString(void 0,{month:"short",day:"numeric"}):""}),e.jsxs("div",{className:"ml-auto flex items-center gap-1 opacity-0 group-hover/item:opacity-100 transition-opacity",children:[c.id!=="done"&&e.jsx("button",{onClick:()=>{j(C.id);const P=new Date;P.setDate(P.getDate()+1),P.setHours(9,0,0,0),w(C.id,{dueDate:P.getTime(),status:"actionable"})},className:"p-1 text-stone-300 hover:text-amber-500 transition-colors",title:"Hold for Tomorrow",children:e.jsx(qe,{size:14})}),e.jsx("button",{onClick:()=>{confirm("Delete this item?")&&m(C.id)},className:"p-1 text-stone-300 hover:text-red-500 transition-colors",title:"Delete",children:e.jsx(he,{size:14})})]})]},C.id)):e.jsxs("div",{className:"py-2 px-3 text-stone-300 text-sm italic",children:["No items ",c.id==="done"?"completed":"in this list","."]}),c.items.length>100&&e.jsxs("div",{className:"py-2 px-3 text-[10px] font-bold text-stone-400 uppercase tracking-widest",children:["+ ",c.items.length-100," more..."]})]})]},c.id))})})]})},ft=({items:n,projects:g,onExport:w})=>{const[m,o]=x.useState("all"),p=n.filter(d=>d.status==="actionable"),s=n.filter(d=>d.status==="done"),j=Array.from(new Set(p.map(d=>d.contextId||"uncategorized")));let N=[];return m==="all"?N=p:m==="completed"?N=s.sort((d,i)=>(i.completedAt||0)-(d.completedAt||0)):N=p.filter(d=>(d.contextId||"uncategorized")===m),e.jsxs("div",{className:"h-full min-h-[600px] flex flex-col font-serif p-6 max-w-[90rem] mx-auto w-full",children:[e.jsx("div",{className:"flex-none text-center mb-6",children:e.jsx("h1",{className:"text-4xl md:text-5xl font-bold font-serif text-stone-900 uppercase tracking-widest select-none",children:"Engage"})}),e.jsx("div",{className:"flex-none mb-6 px-4",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>o("all"),className:`px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider transition-all font-sans border ${m==="all"?"bg-stone-800 text-white border-stone-800":"bg-white text-stone-400 border-stone-200 hover:border-stone-400 hover:text-stone-600"}`,children:"All"}),j.map(d=>e.jsx("button",{onClick:()=>o(d),className:`px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider transition-all font-sans border ${m===d?"bg-stone-800 text-white border-stone-800":"bg-white text-stone-400 border-stone-200 hover:border-stone-400 hover:text-stone-600"}`,children:d},d)),e.jsx("button",{onClick:()=>o("completed"),className:`px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider transition-all font-sans border ${m==="completed"?"bg-stone-800 text-white border-stone-800":"bg-white text-stone-400 border-stone-200 hover:border-stone-400 hover:text-stone-600"}`,children:"Completed"})]})}),e.jsxs("div",{className:"flex-1 w-full min-h-0",children:[e.jsx("div",{className:"max-h-[500px] overflow-y-auto scrollbar-hide px-4 pb-12",children:e.jsx("div",{className:"max-w-2xl mx-auto space-y-3",children:N.length===0?e.jsxs("div",{className:"text-center py-12 text-stone-300",children:[e.jsx("span",{className:"block text-4xl mb-4",children:"☕️"}),e.jsx("p",{className:"italic font-serif text-lg",children:"Nothing here."}),e.jsx("p",{className:"text-sm font-sans",children:"Check other tabs or enjoy your break."})]}):N.map(d=>{const i=g.find(r=>r.id===d.projectId);return e.jsx("div",{className:"group bg-white p-4 rounded-xl border border-stone-200 hover:border-stone-400 shadow-sm hover:shadow-md transition-all cursor-default",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("button",{className:"pt-1 text-stone-300 hover:text-green-600 transition-colors",children:e.jsx(W,{size:24,strokeWidth:1.5})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-xl font-serif italic text-stone-800 mb-2 group-hover:text-black transition-colors leading-tight",children:d.text}),e.jsxs("div",{className:"flex items-center gap-3 text-[10px] font-sans font-bold text-stone-400 uppercase tracking-widest mb-3",children:[e.jsxs("span",{className:"text-stone-500 flex items-center gap-1",children:[e.jsx(K,{size:10}),i?i.name:"Inbox"]}),d.contextId&&e.jsxs("span",{className:"bg-stone-100 px-1.5 py-0.5 rounded text-stone-500",children:["#",d.contextId]}),d.time&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(q,{size:10})," ",d.time]}),d.energy&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ne,{size:10})," ",d.energy]})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t border-stone-100 opacity-60 group-hover:opacity-100 transition-opacity",children:[e.jsxs("button",{onClick:()=>w(d,"task"),className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-stone-50 hover:bg-stone-100 text-stone-400 hover:text-blue-600 transition-all text-xs font-bold uppercase tracking-wider border border-transparent hover:border-stone-200",title:"Send to Task Board",children:[e.jsx(K,{size:14}),e.jsx("span",{children:"Task"})]}),e.jsxs("button",{onClick:()=>w(d,"goal"),className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-stone-50 hover:bg-stone-100 text-stone-400 hover:text-red-500 transition-all text-xs font-bold uppercase tracking-wider border border-transparent hover:border-stone-200",title:"Create Goal",children:[e.jsx(ge,{size:14}),e.jsx("span",{children:"Goal"})]}),e.jsxs("button",{onClick:()=>w(d,"reminder"),className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-stone-50 hover:bg-stone-100 text-stone-400 hover:text-amber-500 transition-all text-xs font-bold uppercase tracking-wider border border-transparent hover:border-stone-200",title:"Set Reminder",children:[e.jsx(Z,{size:14}),e.jsx("span",{children:"Remind"})]}),e.jsxs("button",{onClick:()=>w(d,"discussion"),className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-stone-50 hover:bg-stone-100 text-stone-400 hover:text-purple-500 transition-all text-xs font-bold uppercase tracking-wider border border-transparent hover:border-stone-200",title:"Start Discussion",children:[e.jsx(Ge,{size:14}),e.jsx("span",{children:"Discuss"})]})]})]})]}),d.dueDate&&e.jsx("div",{className:"flex flex-col items-end gap-1",children:e.jsxs("span",{className:"text-xs font-serif italic text-red-500 bg-red-50 px-2 py-1 rounded-md mb-1 whitespace-nowrap",children:["Due ",new Date(d.dueDate).toLocaleDateString(void 0,{month:"short",day:"numeric"})]})})]})},d.id)})})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-12 bg-gradient-to-t from-stone-50/100 to-transparent pointer-events-none"})]})]})},bt=({isOpen:n,onClose:g})=>{if(!n)return null;const w=[{icon:me,title:"1. Capture",description:"Collect what has your attention. Use the Inbox to write down tasks, ideas, and reminders immediately so you don't forget them.",color:"text-blue-600",bg:"bg-blue-50"},{icon:W,title:"2. Clarify",description:"Process what you've captured. Decide if it's actionable. If yes, decide the next action. If no, trash it, store it for reference, or put it on hold.",color:"text-amber-600",bg:"bg-amber-50"},{icon:K,title:"3. Organize",description:"Put everything in the right place. Add actionable items to your lists (Next Actions, Projects, Waiting For, Calendar).",color:"text-indigo-600",bg:"bg-indigo-50"},{icon:_e,title:"4. Reflect",description:"Review frequently. Update your lists, clear your mind, and get perspective. Weekly Review is key to keeping the system trusted.",color:"text-emerald-600",bg:"bg-emerald-50"},{icon:ne,title:"5. Engage",description:"Simply do. Use your system to make confident choices about what to do right now, based on context, time, and energy available.",color:"text-orange-600",bg:"bg-orange-50"}];return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-stone-900/40 backdrop-blur-sm animate-fade-in",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl w-full max-w-4xl overflow-hidden relative flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"flex items-center justify-between p-8 pb-4 border-b border-stone-100",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-serif italic text-stone-900 mb-1",children:"Getting Things Done"}),e.jsx("p",{className:"text-sm text-stone-500 font-sans",children:"The art of stress-free productivity."})]}),e.jsx("button",{onClick:g,className:"p-2 rounded-full hover:bg-stone-100 text-stone-500 transition-colors",children:e.jsx(ue,{size:24})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-8",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[w.map((m,o)=>e.jsxs("div",{className:"p-6 rounded-2xl border border-stone-100 hover:shadow-lg hover:border-stone-200 transition-all duration-300 group bg-stone-50/50",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl ${m.bg} flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300`,children:e.jsx(m.icon,{size:24,className:m.color})}),e.jsx("h3",{className:"text-xl font-bold text-stone-900 mb-2 font-serif",children:m.title}),e.jsx("p",{className:"text-sm text-stone-600 leading-relaxed",children:m.description})]},o)),e.jsxs("div",{className:"p-6 rounded-2xl bg-stone-900 text-white flex flex-col justify-center items-center text-center",children:[e.jsx("h3",{className:"text-xl font-bold mb-2 font-serif italic",children:"Why GTD?"}),e.jsx("p",{className:"text-sm text-stone-300 leading-relaxed",children:'"Your mind is for having ideas, not holding them."'}),e.jsx("p",{className:"text-xs text-stone-500 mt-2 uppercase tracking-widest font-bold",children:"— David Allen"})]})]})}),e.jsx("div",{className:"p-6 bg-stone-50 border-t border-stone-100 text-center",children:e.jsx("button",{onClick:g,className:"bg-stone-900 text-white px-8 py-3 rounded-xl font-bold uppercase tracking-widest text-xs hover:bg-stone-800 transition-colors shadow-lg hover:shadow-xl hover:-translate-y-0.5 transform",children:"Start Organizing"})})]})})},jt=({isOpen:n,onClose:g,type:w,itemText:m,existingOptions:o,onConfirm:p})=>{const[s,j]=x.useState("new"),[N,d]=x.useState(""),[i,r]=x.useState("");if(x.useEffect(()=>{var _;n&&(d(m),j("new"),r(((_=o[0])==null?void 0:_.id)||""))},[n,m,o]),!n||!w)return null;const u=()=>{switch(w){case"task":return e.jsx(K,{size:24,className:"text-blue-500"});case"goal":return e.jsx(ge,{size:24,className:"text-red-500"});case"reminder":return e.jsx(Z,{size:24,className:"text-amber-500"});case"discussion":return e.jsx(Ie,{size:24,className:"text-purple-500"})}},h=()=>{switch(w){case"task":return"Send to Task Board";case"goal":return"Create Goal";case"reminder":return"Set Reminder";case"discussion":return"Start Discussion"}},T=(()=>{switch(w){case"task":return{new:"New Group",existing:"Add to Existing Group",namePlaceholder:"Group Name"};case"goal":return{new:"New Goal",existing:"Add as Sub-goal to",namePlaceholder:"Goal Title"};case"reminder":return{new:"New List",existing:"Add to List",namePlaceholder:"List Name"};case"discussion":return{new:"New Channel",existing:"Post in Channel",namePlaceholder:"Channel Name"}}})(),l=()=>{s==="new"&&!N.trim()||s==="existing"&&!i||p(s,s==="existing"?i:void 0,s==="new"?N:void 0)};return e.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"p-6 border-b border-stone-100 flex items-center justify-between bg-stone-50/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white rounded-xl shadow-sm border border-stone-100",children:u()}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-serif font-bold text-xl text-stone-900",children:h()}),e.jsx("p",{className:"text-xs text-stone-400 font-bold uppercase tracking-wider",children:"Select Destination"})]})]}),e.jsx("button",{onClick:g,className:"p-2 hover:bg-stone-100 rounded-full text-stone-400 transition-colors",children:e.jsx(ue,{size:20})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"p-3 bg-stone-50 border border-stone-200 rounded-xl text-stone-700 italic font-serif text-sm",children:['"',m,'"']}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 p-1 bg-stone-100 rounded-xl",children:[e.jsx("button",{onClick:()=>j("new"),className:`py-2 px-4 rounded-lg text-xs font-bold uppercase tracking-wider transition-all ${s==="new"?"bg-white text-stone-900 shadow-sm":"text-stone-400 hover:text-stone-600"}`,children:T.new}),e.jsx("button",{onClick:()=>j("existing"),className:`py-2 px-4 rounded-lg text-xs font-bold uppercase tracking-wider transition-all ${s==="existing"?"bg-white text-stone-900 shadow-sm":"text-stone-400 hover:text-stone-600"}`,children:T.existing})]}),e.jsx("div",{className:"space-y-4",children:s==="new"?e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase tracking-wider text-stone-400 ml-1",children:"Name"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:N,onChange:_=>d(_.target.value),placeholder:T.namePlaceholder,className:"w-full pl-4 pr-4 py-3 bg-white border border-stone-200 focus:border-stone-900 focus:ring-0 rounded-xl text-stone-900 placeholder-stone-300 transition-all font-medium",autoFocus:!0}),e.jsx(we,{size:16,className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-stone-400"})]}),e.jsx("p",{className:"text-[10px] text-stone-400 px-1",children:"Using item text as default. You can rename the container."})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase tracking-wider text-stone-400 ml-1",children:"Select Existing"}),e.jsxs("select",{value:i,onChange:_=>r(_.target.value),className:"w-full px-4 py-3 bg-white border border-stone-200 focus:border-stone-900 focus:ring-0 rounded-xl text-stone-900 cursor-pointer appearance-none",children:[o.length===0?e.jsx("option",{disabled:!0,children:"No options available"}):null,o.map(_=>e.jsx("option",{value:_.id,children:_.name},_.id))]})]})})]}),e.jsxs("div",{className:"p-4 border-t border-stone-100 bg-stone-50 flex justify-end gap-3",children:[e.jsx("button",{onClick:g,className:"px-6 py-2.5 rounded-xl text-xs font-bold uppercase tracking-wider text-stone-400 hover:text-stone-600 hover:bg-stone-200 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:l,className:"px-6 py-2.5 bg-stone-900 hover:bg-black text-white rounded-xl shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all text-xs font-bold uppercase tracking-wider flex items-center gap-2",children:[e.jsx("span",{children:"Confirm Action"}),e.jsx(oe,{size:14})]})]})]})})},H={getItems:async()=>{const n=ie(),g=ee.getCurrentUser();if(!g)return[];const{data:w,error:m}=await se.from("gtd_items").select("*").eq("company_id",n).eq("user_id",g.id);return m?(console.error("Error fetching GTD items:",m),[]):(w||[]).map(o=>({id:Number(o.id),text:o.text,description:o.description,status:o.status,projectId:o.project_id?Number(o.project_id):void 0,contextId:o.context_id,energy:o.energy,time:o.time,dueDate:o.due_date,delegatedTo:o.delegated_to,createdAt:Number(o.created_at),completedAt:o.completed_at?Number(o.completed_at):void 0,parentId:o.parent_id?Number(o.parent_id):void 0}))},saveItem:async n=>{const g=ie(),w=ee.getCurrentUser();if(!w)return;const m={id:n.id.toString(),text:n.text,description:n.description,status:n.status,project_id:n.projectId?n.projectId.toString():void 0,context_id:n.contextId,energy:n.energy,time:n.time,due_date:n.dueDate,delegated_to:n.delegatedTo,created_at:n.createdAt,completed_at:n.completedAt,parent_id:n.parentId?n.parentId.toString():void 0,company_id:g,user_id:w.id},{error:o}=await se.from("gtd_items").upsert(m);if(o)throw console.error("Error saving GTD item:",o),o},deleteItem:async n=>{const{error:g}=await se.from("gtd_items").delete().eq("id",n.toString());g&&console.error("Error deleting GTD item:",g)},getProjects:async()=>{const n=ie(),g=ee.getCurrentUser();if(!g)return[];const{data:w,error:m}=await se.from("gtd_projects").select("*").eq("company_id",n).eq("user_id",g.id);return m?(console.error("Error fetching GTD projects:",m),[]):(w||[]).map(o=>({id:Number(o.id),name:o.name,status:o.status,color:o.color,items:o.items||[]}))},saveProject:async n=>{const g=ie(),w=ee.getCurrentUser();if(!w)return;const m={id:n.id.toString(),name:n.name,status:n.status,color:n.color,items:n.items,company_id:g,user_id:w.id},{error:o}=await se.from("gtd_projects").upsert(m);if(o)throw console.error("Error saving GTD project:",o),o}},vt=({userName:n="User",onOpenQuickTask:g,onOpenDiscussion:w,onOpenNewGoal:m,onOpenReminder:o})=>{const{showToast:p}=Te(),{t:s}=pe(),[j,N]=x.useState("capture"),[d,i]=x.useState(!1),[r,u]=x.useState([]),[h,S]=x.useState([]);x.useEffect(()=>{(async()=>{const f=await H.getItems(),I=await H.getProjects();u(f),S(I)})()},[]);const[T,l]=x.useState(null),[_,c]=x.useState(new Date),[C,P]=x.useState(null),[v,k]=x.useState("Locating..."),[R,M]=x.useState(!1),[D,L]=x.useState(null),[z,U]=x.useState(null),[G,A]=x.useState([]),F=async(a,f)=>{U(a),L(f);let I=[];f==="task"?I=(await ae.getSpaces()).map(b=>({id:b.id,name:b.name||"Unnamed Space"})):f==="goal"?I=(await X.getGoals()).map(b=>({id:b.id,name:b.title})):f==="reminder"?I=(await de.getLists()).map(b=>({id:b.id,name:b.name})):f==="discussion"&&(I=(await ce.getChannels()).map(b=>({id:b.id,name:b.name}))),A(I),M(!0)},t=async(a,f,I)=>{if(!(!z||!D)){try{if(D==="task"){let y=f;if(a==="new"||!y){const b=await ae.getSpaces();y=b.length>0?b[0].id:"default"}await ae.createTask({title:z.text,status:"Todo",priority:"Normal",dueDate:z.dueDate?new Date(z.dueDate).toISOString():void 0,spaceId:y,assignees:[],tags:[]})}else if(D==="goal"){if(a==="new"&&I)await X.createGoal({title:I,description:z.text,category:"Work",dueDate:new Date(Date.now()+720*60*60*1e3).toISOString().split("T")[0],progress:0,subGoals:[],status:"on-track",priority:"Medium",impact:"Medium"});else if(a==="existing"&&f){const b=(await X.getGoals()).find(E=>E.id===f);if(b){const E={id:Date.now().toString(),title:z.text,completed:!1};await X.updateGoal({...b,subGoals:[...b.subGoals,E]})}}}else if(D==="reminder"){let y=f;a==="new"&&I&&(y=(await de.addList({name:I,type:"project",color:"text-black"})).id),y&&await de.addReminder({title:z.text,listId:y,dueDate:z.dueDate?new Date(z.dueDate).toISOString().split("T")[0]:void 0,priority:"none",tags:[],completed:!1,subtasks:[]})}else if(D==="discussion"){let y=f;if(a==="new"&&I&&(y=(await ce.createChannel({name:I,members:[],type:"public",category:"Channels"})).id),y){const b=ee.getCurrentUser(),E=(b==null?void 0:b.id)||"u1";await ce.sendMessage({content:`Added from Engage: ${z.text}`,sender:E,senderAvatar:"bg-gray-500",isMe:!0,time:new Date().toLocaleTimeString(),type:"text",channelId:y})}}}catch(y){console.error("Export failed",y)}M(!1)}};x.useEffect(()=>{const a=setInterval(()=>c(new Date),6e4);return()=>clearInterval(a)},[]),x.useEffect(()=>{if(!navigator.geolocation){k("Location unavailable");return}navigator.geolocation.getCurrentPosition(async a=>{const{latitude:f,longitude:I}=a.coords;try{const b=await(await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${f}&longitude=${I}&current=temperature_2m,weather_code`)).json();b.current&&P({temp:b.current.temperature_2m,code:b.current.weather_code});const fe=await(await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${f}&longitude=${I}&localityLanguage=en`)).json(),Pe=fe.city||fe.locality||"Unknown Location",Ne=fe.principalSubdivisionCode||"";k(`${Pe}${Ne?`, ${Ne}`:""}`)}catch(y){console.error("Failed to fetch weather/location",y),k("Weather unavailable")}},a=>{console.warn("Location permission denied",a),k("Location denied")})},[]);const $=a=>a===0||a===1?e.jsx(He,{size:10}):a===2||a===3?e.jsx(Ke,{size:10}):a>=51&&a<=67?e.jsx(nt,{size:10}):a>=71&&a<=77?e.jsx(lt,{size:10}):a>=95?e.jsx(at,{size:10}):e.jsx(Ce,{size:10}),O=r.filter(a=>a.status==="inbox").sort((a,f)=>f.createdAt-a.createdAt);r.filter(a=>a.status==="actionable"&&!a.dueDate),r.filter(a=>(a.status==="actionable"||a.status==="waiting")&&a.dueDate).sort((a,f)=>(a.dueDate||0)-(f.dueDate||0)),r.filter(a=>a.status==="waiting"),r.filter(a=>a.status==="someday"),r.filter(a=>a.status==="reference");const B=a=>{const f=a.toLowerCase();let I="inbox",y=a,b=!1;if(f.startsWith("@task ")?(I="actionable",y=a.slice(6)):f.startsWith("@project ")?(b=!0,y=a.slice(9)):f.startsWith("@waiting ")?(I="waiting",y=a.slice(9)):f.startsWith("@someday ")?(I="someday",y=a.slice(9)):f.startsWith("@read ")&&(I="reference",y=a.slice(6)),b){const E={id:Date.now(),name:y,status:"active",items:[]};S([E,...h]),H.saveProject(E).catch(()=>{p("Failed to save project!","error")})}else{const E={id:Date.now(),text:y,status:I,createdAt:Date.now()};u([E,...r]),H.saveItem(E).catch(()=>{p("Failed to save item!","error")})}},Y=(a,f)=>{let I;u(r.map(y=>{if(y.id===a){const E=f.status==="done"&&y.status!=="done";return I={...y,...f,completedAt:E?Date.now():y.completedAt},I}return y})),I&&H.saveItem(I),a===T&&(r.filter(y=>y.status==="inbox"&&y.id!==a),O.findIndex(y=>y.id===a)+1,l(null))},V=(a,f=[])=>{const I={id:Date.now(),name:a,status:"active",items:[]},y=f.map((b,E)=>({id:Date.now()+E+1,text:b,status:"actionable",projectId:I.id,createdAt:Date.now()}));X.createGoal({title:a,category:"Work",dueDate:new Date(Date.now()+10080*60*1e3).toISOString().split("T")[0],progress:0,subGoals:f.map((b,E)=>({id:`${Date.now()}_${E}`,title:b,completed:!1})),status:"on-track",priority:"Medium",impact:"Medium",description:"Generated from GTD Project"}).catch(b=>console.error("Failed to sync project to goals",b)),S([...h,I]),u([...r,...y]),H.saveProject(I),y.forEach(b=>H.saveItem(b))},J=a=>{u(r.filter(f=>f.id!==a)),H.deleteItem(a)},re=a=>{const f={id:Date.now(),text:a.text||"",status:a.status||"inbox",createdAt:Date.now(),projectId:a.projectId,delegatedTo:a.delegatedTo,dueDate:a.dueDate};u([f,...r]),H.saveItem(f)},le=async a=>{try{const f=await ae.getSpaces(),I=f.length>0?f[0].id:"default";await ae.createTask({title:a,status:"Todo",priority:"Normal",spaceId:I,dueDate:new Date().toISOString(),assignees:[],tags:[]}),p("Task created!","success")}catch(f){console.error("Failed to export to Task Board",f),p("Failed to create task","error")}},ze=()=>{switch(j){case"capture":return e.jsx(ut,{items:r,projects:h,onCapture:B,onSelect:b=>{l(b),N("clarify")},onDelete:J});case"clarify":const a=O.findIndex(b=>{var E;return b.id===(T||((E=O[0])==null?void 0:E.id))}),f=T?r.find(b=>b.id===T):O[0],I=()=>{a<O.length-1&&l(O[a+1].id)},y=()=>{a>0&&l(O[a-1].id)};return e.jsx(pt,{item:f,onProcess:Y,onCreateProject:V,onNavigate:b=>N(b),onExportToBoard:le,projects:h,hasMore:O.length>0,onNext:I,onPrev:y,canNext:a<O.length-1,canPrev:a>0});case"organize":return e.jsx(ht,{projects:h,items:r,onUpdateItem:Y,onAddProject:V,onAddItem:re,onDelete:J});case"review":return e.jsx(gt,{items:r,projects:h,onUpdate:Y,onDelete:J});case"engage":return e.jsx(ft,{items:r,projects:h,onExport:F});default:return null}},Ae=[{id:"capture",label:s("gtd.capture"),icon:me,color:"text-blue-600",count:O.length},{id:"clarify",label:s("gtd.clarify"),icon:W,color:"text-amber-600",count:T?1:0},{id:"organize",label:s("gtd.organize"),icon:K,color:"text-indigo-600",count:0},{id:"review",label:s("gtd.reflect"),icon:_e,color:"text-emerald-600",count:0},{id:"engage",label:s("gtd.engage"),icon:ne,color:"text-orange-600",count:0}];return e.jsxs("div",{className:"min-h-[600px] h-fit w-full bg-stone-50 rounded-[2.5rem] p-6 shadow-inner ring-1 ring-stone-900/5 flex flex-col font-serif relative",children:[e.jsx("div",{className:"absolute inset-0 opacity-[0.03] pointer-events-none bg-[url('https://www.transparenttextures.com/patterns/notebook.png')]"}),e.jsx("div",{className:"flex-none pt-10 pb-6 z-10 relative px-8",children:e.jsxs("div",{className:"flex items-end justify-between w-full mb-8",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-4xl md:text-5xl font-serif italic text-stone-900 tracking-tight leading-none mb-2",children:[(()=>{const a=_.getHours();return a<12?s("gtd.greeting.morning"):a<18?s("gtd.greeting.afternoon"):s("gtd.greeting.evening")})(),", ",n.split(" ")[0]]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs font-bold font-sans text-stone-400 uppercase tracking-widest ps-1",children:[e.jsx("span",{children:_.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}),e.jsx("span",{children:"•"}),e.jsx("span",{children:_.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric"})}),e.jsx("span",{children:"•"}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Fe,{size:10})," ",v]}),e.jsx("span",{children:"•"}),e.jsxs("span",{className:"flex items-center gap-1",children:[C?$(C.code):e.jsx(Ce,{size:10}),C?`${Math.round(C.temp)}°C`:"--°C"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 pb-2",children:[e.jsxs("button",{onClick:g,className:"bg-white border border-stone-200 text-stone-900 px-5 py-2.5 rounded-xl shadow-sm hover:bg-stone-50 hover:-translate-y-0.5 transition-all text-xs font-bold tracking-widest uppercase flex items-center gap-2",children:[e.jsx(we,{size:14,strokeWidth:2,className:"text-stone-400"}),e.jsx("span",{children:s("gtd.action.task")})]}),e.jsxs("button",{onClick:w,className:"bg-white border border-stone-200 text-stone-900 px-5 py-2.5 rounded-xl shadow-sm hover:bg-stone-50 hover:-translate-y-0.5 transition-all text-xs font-bold tracking-widest uppercase flex items-center gap-2",children:[e.jsx(ne,{size:14,strokeWidth:2,className:"text-stone-400"}),e.jsx("span",{children:s("gtd.action.discussion")})]}),e.jsxs("button",{onClick:m,className:"bg-white border border-stone-200 text-stone-900 px-5 py-2.5 rounded-xl shadow-sm hover:bg-stone-50 hover:-translate-y-0.5 transition-all text-xs font-bold tracking-widest uppercase flex items-center gap-2",children:[e.jsx(ge,{size:14,strokeWidth:2,className:"text-stone-400"}),e.jsx("span",{children:s("gtd.action.new_goal")})]}),e.jsxs("button",{onClick:o,className:"bg-white border border-stone-200 text-stone-900 px-5 py-2.5 rounded-xl shadow-sm hover:bg-stone-50 hover:-translate-y-0.5 transition-all text-xs font-bold tracking-widest uppercase flex items-center gap-2",children:[e.jsx(Z,{size:14,strokeWidth:2,className:"text-stone-400"}),e.jsx("span",{children:s("gtd.action.reminder")})]})]})]})}),e.jsx("div",{className:"text-center mb-10 mt-16",children:e.jsxs("h1",{className:"text-3xl font-serif italic text-stone-900 tracking-tight flex items-center justify-center gap-3",children:[s("gtd.title"),e.jsx("button",{onClick:()=>i(!0),className:"p-1.5 rounded-full bg-stone-100/50 text-stone-400 hover:text-stone-600 hover:bg-stone-200 transition-colors",title:"How it works",children:e.jsx(We,{size:16,strokeWidth:2.5})})]})}),e.jsx("div",{className:"flex justify-center relative z-20",children:e.jsx("div",{className:"flex items-center space-x-2",children:Ae.map(a=>{const f=j===a.id,I=a.icon;return e.jsxs("button",{onClick:()=>N(a.id),className:`
                                            relative px-8 py-2.5 rounded-xl flex items-center gap-2.5 transition-all duration-300
                                            ${f?"bg-white text-stone-900 shadow-sm ring-1 ring-stone-900/5":"text-stone-400 hover:text-stone-600 hover:bg-stone-200/50"}
                                        `,children:[e.jsx(I,{size:16,strokeWidth:f?2.5:2,className:f?a.color:"text-stone-400"}),e.jsx("span",{className:"text-[11px] font-bold tracking-widest uppercase opacity-100",children:a.label}),a.count>0&&e.jsx("span",{className:`flex h-4 min-w-[1rem] px-1 items-center justify-center rounded-full text-[9px] font-extrabold ${f?"bg-stone-900 text-white":"bg-stone-200 text-stone-500"}`,children:a.count})]},a.id)})})}),e.jsx("div",{className:"flex-1 flex bg-white/30 relative",children:e.jsx("div",{className:"flex-1 w-full relative z-10",children:ze()})}),e.jsx(bt,{isOpen:d,onClose:()=>i(!1)}),e.jsx(jt,{isOpen:R,onClose:()=>M(!1),type:D,itemText:(z==null?void 0:z.text)||"",existingOptions:G,onConfirm:t})]})},wt=()=>{const[n,g]=x.useState("weekly"),m=n==="weekly"?{xAxis:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],data:[12,19,15,22,28,14,10]}:n==="monthly"?{xAxis:["Week 1","Week 2","Week 3","Week 4"],data:[65,82,70,95]}:{xAxis:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],data:[220,240,280,250,310,350,340,380,410,450,430,480]},o={tooltip:{trigger:"axis",backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:"#e7e5e4",textStyle:{color:"#1c1917"},padding:[10,14],formatter:"{b}: <b>{c} Tasks</b>"},grid:{left:"3%",right:"4%",bottom:"3%",top:"15%",containLabel:!0},xAxis:{type:"category",data:m.xAxis,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#a8a29e",fontSize:11,fontFamily:"serif"}},yAxis:{type:"value",splitLine:{lineStyle:{color:"#f5f5f4",type:"dashed"}},axisLabel:{color:"#a8a29e",fontSize:11,fontFamily:"serif"}},series:[{data:m.data,type:"bar",showBackground:!0,backgroundStyle:{color:"#fafaf9",borderRadius:[4,4,0,0]},itemStyle:{color:"#1c1917",borderRadius:[4,4,0,0]},barWidth:n==="yearly"?"40%":"30%"}]},p=({title:s,value:j,trend:N,isPositive:d,icon:i,color:r="stone"})=>{const u={stone:"bg-white",emerald:"bg-emerald-50/50",indigo:"bg-indigo-50/50",amber:"bg-amber-50/50"},h={stone:"text-stone-900",emerald:"text-emerald-600",indigo:"text-indigo-600",amber:"text-amber-600"};return e.jsxs("div",{className:`${u[r]} p-5 rounded-3xl border border-stone-100 shadow-sm flex flex-col justify-between h-full group hover:shadow-md transition-all`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("div",{className:"p-2 rounded-xl bg-white shadow-sm border border-stone-50",children:e.jsx(i,{size:18,className:h[r]})}),e.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded-lg text-[10px] font-bold ${d?"bg-emerald-100/50 text-emerald-700":"bg-rose-100/50 text-rose-700"}`,children:[d?e.jsx(Xe,{size:10}):e.jsx(tt,{size:10}),N]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-serif font-bold text-stone-900",children:j}),e.jsx("div",{className:"text-xs font-bold text-stone-400 tracking-wide uppercase mt-1",children:s})]})]})};return e.jsx("div",{className:"w-full mt-6 animate-fade-in-up delay-100",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-auto lg:h-[320px]",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white rounded-3xl p-6 border border-stone-100 shadow-sm flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-stone-50 rounded-xl",children:e.jsx(Be,{size:20,className:"text-stone-900"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-serif font-bold text-lg text-stone-900 italic",children:"Productivity Trends"}),e.jsx("p",{className:"text-xs text-stone-400 font-medium",children:"Tasks completed over time"})]})]}),e.jsx("div",{className:"flex bg-stone-100 p-1 rounded-xl",children:["weekly","monthly","yearly"].map(s=>e.jsx("button",{onClick:()=>g(s),className:`px-4 py-1.5 text-xs font-bold rounded-lg transition-all capitalize ${n===s?"bg-white text-stone-900 shadow-sm":"text-stone-500 hover:text-stone-700 hover:bg-stone-200/50"}`,children:s},s))})]}),e.jsx("div",{className:"flex-1 min-h-[200px] w-full",children:e.jsx(Ze,{option:o,style:{height:"100%",width:"100%"},opts:{renderer:"svg"}})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 h-full",children:[e.jsx(p,{title:"Completed",value:"128",trend:"+12%",isPositive:!0,icon:W,color:"emerald"}),e.jsx(p,{title:"Focus Hours",value:"32h",trend:"+4%",isPositive:!0,icon:ne,color:"indigo"}),e.jsx(p,{title:"Pending",value:"14",trend:"-2%",isPositive:!0,icon:q,color:"amber"}),e.jsx(p,{title:"Goals Met",value:"3/5",trend:"On Track",isPositive:!0,icon:ge,color:"stone"})]})]})})},yt=({isOpen:n,onClose:g,onGoalCreated:w})=>{const[m,o]=x.useState(""),[p,s]=x.useState("Work"),[j,N]=x.useState(""),[d,i]=x.useState("Medium"),[r,u]=x.useState(""),[h,S]=x.useState(!1);if(!n)return null;const T=async()=>{if(!m.trim())return;const l={title:m,category:p,dueDate:j||new Date().toISOString().split("T")[0],progress:0,subGoals:[],status:"on-track",priority:d,impact:"Medium",description:r};try{const _=await X.createGoal(l);w&&w(_),o(""),s("Work"),N(""),i("Medium"),u(""),g()}catch(_){console.error("Failed to save goal",_),alert("Failed to save goal. Please check the server connection.")}};return e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-8",children:[e.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm",onClick:()=>{g(),S(!1)}}),e.jsxs("div",{className:"relative w-full max-w-[600px] bg-white p-12 shadow-[0_20px_50px_rgba(0,0,0,0.1)] animate-in zoom-in-95 duration-300 rounded-[2px]",onClick:()=>S(!1),children:[e.jsx("h2",{className:"text-[32px] font-serif text-gray-900 leading-tight mb-2",children:"Create New Goal"}),e.jsx("p",{className:"text-[16px] text-gray-500 italic font-serif mb-10",children:"What's the next big milestone?"}),e.jsxs("div",{className:"space-y-8",onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-[0.2em] text-gray-400 block mb-3",children:"Goal Title"}),e.jsx("input",{type:"text",className:"w-full text-2xl font-serif text-gray-900 pb-2 border-b-2 border-gray-900 focus:border-black focus:outline-none placeholder:text-gray-300",placeholder:"Enter goal...",value:m,onChange:l=>o(l.target.value),autoFocus:!0})]}),e.jsxs("div",{className:"flex gap-12",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-[0.2em] text-gray-400 block mb-4",children:"Category"}),e.jsx("div",{className:"flex flex-col gap-3",children:["WORK","PERSONAL","HEALTH"].map(l=>e.jsx("button",{onClick:()=>s(l.charAt(0)+l.slice(1).toLowerCase()),className:`px-4 py-3 text-[11px] font-bold uppercase tracking-widest text-left w-full transition-all border ${p.toUpperCase()===l?"bg-black text-white border-black":"bg-white text-gray-400 border-gray-200 hover:border-gray-900 hover:text-gray-900"}`,children:l},l))})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-[0.2em] text-gray-400 block mb-4",children:"Priority"}),e.jsx("div",{className:"flex flex-col gap-3",children:["HIGH","MEDIUM","LOW"].map(l=>e.jsx("button",{onClick:()=>i(l.charAt(0)+l.slice(1).toLowerCase()),className:`px-4 py-3 text-[11px] font-bold uppercase tracking-widest text-left w-full transition-all border ${d.toUpperCase()===l?"bg-black text-white border-black":"bg-white text-gray-400 border-gray-200 hover:border-gray-900 hover:text-gray-900"}`,children:l},l))})]})]}),e.jsxs("div",{className:"pt-2 relative",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-[0.2em] text-gray-400 block mb-3",children:"Target Date"}),e.jsx("button",{onClick:l=>{l.stopPropagation(),S(!h)},className:"w-full text-left text-lg font-serif text-gray-900 pb-2 border-b border-gray-200 hover:border-black focus:outline-none transition-colors",children:j?new Date(j).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}):e.jsx("span",{className:"text-gray-300",children:"MM/DD/YYYY"})}),h&&e.jsx("div",{className:"absolute top-full left-0 mt-4 z-[60] shadow-2xl",children:e.jsx(ye,{date:j,onSelect:l=>{N(l),S(!1)},onClose:()=>S(!1),compact:!0,className:"shadow-2xl border border-gray-100"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-[0.2em] text-gray-400 block mb-3",children:"Description (Optional)"}),e.jsx("textarea",{className:"w-full text-base font-serif text-gray-600 pb-2 border-b border-gray-200 focus:border-black focus:outline-none resize-none h-24 bg-transparent",placeholder:"Add some context or success criteria...",value:r,onChange:l=>u(l.target.value)})]}),e.jsxs("div",{className:"flex justify-between items-center pt-8 mt-4",children:[e.jsx("button",{onClick:g,className:"text-xs font-bold uppercase tracking-widest text-gray-400 hover:text-black transition-colors",children:"Cancel"}),e.jsx("button",{onClick:T,className:"px-8 py-4 bg-black text-white text-xs font-bold uppercase tracking-[0.2em] hover:bg-gray-800 transition-colors shadow-lg",children:"Save Goal"})]})]})]})]})},Nt=({isOpen:n,onClose:g})=>{const[w,m]=x.useState(""),[o,p]=x.useState(""),[s,j]=x.useState(""),[N,d]=x.useState("none"),[i,r]=x.useState(!1);if(!n)return null;const u=()=>{w.trim()&&(de.addReminder({title:w,notes:o,dueDate:s||"Today",priority:N,listId:"inbox",tags:[],completed:!1,subtasks:[]}),m(""),p(""),j(""),d("none"),g())};return e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-8",children:[e.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm",onClick:()=>{g(),r(!1)}}),e.jsxs("div",{className:"relative w-full max-w-[500px] bg-white p-8 shadow-[0_20px_50px_rgba(0,0,0,0.1)] animate-in zoom-in-95 duration-300 rounded-2xl border border-stone-100",onClick:()=>r(!1),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-3 bg-stone-100 rounded-xl text-stone-900",children:e.jsx(Z,{size:20})}),e.jsx("h2",{className:"text-2xl font-serif text-stone-900",children:"Set Reminder"})]}),e.jsxs("div",{className:"space-y-6",onClick:h=>h.stopPropagation(),children:[e.jsx("div",{children:e.jsx("input",{type:"text",className:"w-full text-xl font-serif text-stone-900 pb-2 border-b border-stone-200 focus:border-stone-900 focus:outline-none placeholder:text-stone-300 transition-colors",placeholder:"Remind me to...",value:w,onChange:h=>m(h.target.value),autoFocus:!0})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-stone-400 block mb-2",children:"When"}),e.jsxs("button",{onClick:h=>{h.stopPropagation(),r(!i)},className:"w-full flex items-center gap-2 p-3 bg-stone-50 hover:bg-stone-100 rounded-lg text-sm text-stone-700 font-medium transition-colors text-left",children:[e.jsx(q,{size:14,className:"text-stone-400"}),s?new Date(s).toLocaleDateString():"Today"]}),i&&e.jsx("div",{className:"absolute top-full left-0 mt-2 z-[60] shadow-xl",children:e.jsx(ye,{date:s,onSelect:h=>{j(h),r(!1)},onClose:()=>r(!1),compact:!0,className:"shadow-xl border border-stone-100"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-stone-400 block mb-2",children:"Priority"}),e.jsx("div",{className:"flex bg-stone-50 rounded-lg p-1",children:["none","high"].map(h=>e.jsx("button",{onClick:()=>d(h),className:`flex-1 py-2 text-[10px] font-bold uppercase tracking-wider rounded-md transition-all ${N===h?"bg-white shadow-sm text-stone-900":"text-stone-400 hover:text-stone-600"}`,children:h==="none"?"Normal":"Urgent"},h))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-stone-400 block mb-2",children:"Notes"}),e.jsx("textarea",{className:"w-full text-sm font-sans text-stone-600 p-3 bg-stone-50 rounded-lg border border-transparent focus:bg-white focus:border-stone-200 focus:outline-none resize-none h-20 transition-all placeholder:text-stone-300",placeholder:"Add details...",value:o,onChange:h=>p(h.target.value)})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{onClick:g,className:"px-6 py-3 text-xs font-bold uppercase tracking-widest text-stone-500 hover:bg-stone-50 rounded-xl transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:u,className:"px-8 py-3 bg-stone-900 text-white text-xs font-bold uppercase tracking-widest hover:bg-black rounded-xl shadow-lg transition-colors flex items-center gap-2",children:[e.jsx(Z,{size:14,className:"text-stone-300"}),"Set Reminder"]})]})]})]})]})},kt="available_rooms",Kt=({cards:n=[],onUpdateCard:g=p=>{},onRemoveCard:w=p=>{},onOpenCustomize:m=()=>{},userName:o="User"})=>{var R;const{showToast:p}=Te(),{setActivePage:s}=Ve(),[j,N]=x.useState(!1),[d,i]=x.useState(!1),[r,u]=x.useState(!1),[h,S]=x.useState(!1),[T,l]=x.useState([]);De.useEffect(()=>{(()=>{try{const D=localStorage.getItem(kt);D&&l(JSON.parse(D))}catch(D){console.error("Failed to load rooms for QuickTask",D)}})()},[]);const _=((R=ve.groups[0])==null?void 0:R.columns)||[],c=M=>{try{const D=ee.getCurrentUser(),L=D?`taskboard-${D.id}`:"taskboard-default",z=localStorage.getItem(L);let U=z?JSON.parse(z):{id:"main",name:"My Tasks",groups:[],columns:[],users:[],version:1};console.log("Debug: Main board before merge",U),(M.groups||[]).map(A=>({...A,id:A.id||crypto.randomUUID(),title:A.title||"Quick Tasks",color:A.color||"#579bfc",columns:Array.isArray(A.columns)&&A.columns.length?A.columns:_,tasks:Array.isArray(A.tasks)?A.tasks:[]})).forEach(A=>{if(A.tasks.length>0){const F=A.title||"Quick Tasks",t=U.groups.findIndex($=>$.title===F);if(t>=0){const $=U.groups[t],O=A.tasks.map(B=>({...B,id:B.id||crypto.randomUUID()}));$.tasks=[...$.tasks,...O],U.groups[t]=$}else{const $={...A,id:crypto.randomUUID(),title:F,tasks:[...A.tasks]};U.groups=[$,...U.groups]}}}),localStorage.setItem(L,JSON.stringify(U)),console.log("Debug: Saved to localStorage",L,U),p("Tasks sent to My Tasks successfully","success"),s("tasks"),window.dispatchEvent(new CustomEvent("local-storage-update",{detail:{key:L}})),window.dispatchEvent(new Event("storage"))}catch(D){console.error("Failed to merge to main tasks",D),p("Failed to send tasks","error")}},C=(M,D)=>{try{const L=`room_board_${D.id}`,z=localStorage.getItem(L);let U=z?JSON.parse(z):{id:D.id,name:D.name,groups:[],columns:[],users:[],version:1};M.groups.forEach(G=>{if(G.tasks.length>0){let A=U.groups.find(F=>F.title===G.title);A||(A={...G,id:crypto.randomUUID(),tasks:[]},U.groups.push(A)),A.tasks=[...A.tasks,...G.tasks]}}),localStorage.setItem(L,JSON.stringify(U)),p(`Tasks sent to ${D.name}`,"success"),window.dispatchEvent(new CustomEvent("local-storage-update",{detail:{key:L}})),window.dispatchEvent(new Event("storage"))}catch(L){console.error("Failed to send to room",L),p("Failed to send to room","error")}},P=(M,D)=>{if(i(!1),D.type==="main")c(M);else if(D.type==="room"&&D.roomId){const L=T.find(z=>z.id===D.roomId);L?C(M,L):p("Room not found","error")}},v=()=>{N(!0)},k=async(M,D)=>{try{const L=await ce.createChannel({name:M,members:D,type:"public",category:"Channels"});p("Discussion created successfully!","success"),localStorage.setItem("autoOpenChannelId",L.id),N(!1),s("discussion")}catch(L){console.error("Failed to create discussion:",L),p("Failed to create discussion","error")}};return e.jsxs("div",{className:"flex-1 bg-brand-surface flex flex-col h-full overflow-hidden relative",children:[e.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide w-full h-full bg-white relative",children:e.jsx("div",{className:"w-full mx-auto p-4 pb-48 flex flex-col h-full min-h-[800px]",children:e.jsxs("div",{className:"flex-1 w-full animate-fade-in-up",children:[e.jsx(vt,{userName:o,onOpenQuickTask:()=>i(!0),onOpenDiscussion:v,onOpenNewGoal:()=>u(!0),onOpenReminder:()=>S(!0)}),e.jsx(wt,{})]})})}),e.jsx(mt,{isOpen:d,onClose:()=>i(!1),onSend:P,rooms:T,darkMode:!1}),e.jsx(xt,{isOpen:j,onClose:()=>N(!1),onCreate:k}),e.jsx(yt,{isOpen:r,onClose:()=>u(!1)}),e.jsx(Nt,{isOpen:h,onClose:()=>S(!1)})]})};export{Kt as default};
