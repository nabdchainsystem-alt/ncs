import{r as u,J as p,j as a,K as m}from"./index-BlVqsW8p.js";class c{constructor(e,t,i,n,s){this.markedForDeletion=!1,this.frame=0,this.id=Math.random().toString(36).substr(2,9),this.type=e,this.x=t,this.y=i,this.width=n,this.height=s,this.vx=0,this.vy=0}update(e,t){this.x+=this.vx*e,this.y+=(this.vy+t)*e,this.frame+=e*10}draw(e){e.fillStyle="white",e.fillRect(this.x,this.y,this.width,this.height)}getBounds(){return{left:this.x+4,right:this.x+this.width-4,top:this.y+4,bottom:this.y+this.height-4}}collidesWith(e){const t=this.getBounds(),i=e.getBounds();return!(t.right<i.left||t.left>i.right||t.bottom<i.top||t.top>i.bottom)}}class w extends c{constructor(e,t){super("player",e,t,32,36),this.fuel=100,this.maxFuel=100,this.speedX=200,this.speedY=0,this.isAccelerating=!1,this.bankAngle=0}update(e,t){this.x+=this.vx*e;const i=this.vx<0?-.3:this.vx>0?.3:0;this.bankAngle+=(i-this.bankAngle)*10*e,this.fuel-=3*e,this.fuel<0&&(this.fuel=0)}draw(e){const t=this.x+this.width/2,i=this.y+this.height/2;e.save(),e.translate(t,i),e.rotate(this.bankAngle),e.fillStyle="#E0E0E0",e.beginPath(),e.moveTo(0,-18),e.lineTo(4,-6),e.lineTo(4,10),e.lineTo(0,16),e.lineTo(-4,10),e.lineTo(-4,-6),e.closePath(),e.fill(),e.fillStyle="#303030",e.beginPath(),e.moveTo(0,-10),e.lineTo(2,-4),e.lineTo(0,0),e.lineTo(-2,-4),e.closePath(),e.fill(),e.fillStyle="#C0C0C0",e.beginPath(),e.moveTo(4,-2),e.lineTo(16,8),e.lineTo(16,12),e.lineTo(4,8),e.closePath(),e.fill(),e.beginPath(),e.moveTo(-4,-2),e.lineTo(-16,8),e.lineTo(-16,12),e.lineTo(-4,8),e.closePath(),e.fill(),e.fillStyle="#A0A0A0",e.beginPath(),e.moveTo(2,10),e.lineTo(8,16),e.lineTo(2,16),e.closePath(),e.fill(),e.beginPath(),e.moveTo(-2,10),e.lineTo(-8,16),e.lineTo(-2,16),e.closePath(),e.fill(),this.isAccelerating&&(e.fillStyle="#FF8000",e.beginPath(),e.moveTo(-2,16),e.lineTo(0,24+Math.random()*4),e.lineTo(2,16),e.closePath(),e.fill()),e.restore()}}class v extends c{constructor(e,t){super("bullet",e,t,4,12),this.vy=-1500}update(e,t){this.y+=this.vy*e}draw(e){e.fillStyle="#FFFF00",e.shadowColor="#FF8000",e.shadowBlur=5,e.fillRect(this.x,this.y,this.width,this.height),e.shadowBlur=0}}class S extends c{constructor(e,t,i){super(e,t,i,32,32),e==="enemy_heli"?this.vx=60:e==="enemy_jet"&&(this.vx=180)}update(e,t){this.y+=t*e,this.type==="enemy_heli"?this.x+=this.vx*e:this.type==="enemy_jet"&&(this.x+=this.vx*e)}draw(e){const t=this.x+this.width/2,i=this.y+this.height/2;e.save(),e.translate(t,i),this.type==="enemy_ship"?(e.fillStyle="#202020",e.beginPath(),e.moveTo(-16,-6),e.lineTo(16,-6),e.lineTo(12,8),e.lineTo(-12,8),e.closePath(),e.fill(),e.fillStyle="#505050",e.fillRect(-10,-6,20,10),e.fillStyle="#808080",e.fillRect(-4,-10,8,6),e.fillStyle="#00FFFF",e.fillRect(-2,-8,4,2)):this.type==="enemy_heli"?(e.fillStyle="#304030",e.beginPath(),e.ellipse(0,0,8,12,0,0,Math.PI*2),e.fill(),e.fillRect(-2,8,4,10),e.fillStyle="#202020",e.fillRect(-6,16,12,2),e.fillStyle="#80C0FF",e.beginPath(),e.arc(0,-4,5,Math.PI,0),e.fill(),e.fillStyle="#101010",e.save(),e.rotate(this.frame*5),e.fillRect(-18,-2,36,4),e.fillRect(-2,-18,4,36),e.restore()):this.type==="enemy_jet"&&(e.rotate(Math.PI),e.fillStyle="#800000",e.beginPath(),e.moveTo(0,-16),e.lineTo(12,12),e.lineTo(0,8),e.lineTo(-12,12),e.closePath(),e.fill(),e.fillStyle="#000000",e.beginPath(),e.moveTo(0,-8),e.lineTo(3,0),e.lineTo(-3,0),e.closePath(),e.fill()),e.restore()}}class T extends c{constructor(e,t){super("fuel",e,t,28,48)}update(e,t){this.y+=t*e}draw(e){const t=e.createLinearGradient(this.x,this.y,this.x+this.width,this.y);t.addColorStop(0,"#B03030"),t.addColorStop(.5,"#FF5050"),t.addColorStop(1,"#902020"),e.fillStyle=t,e.fillRect(this.x,this.y,this.width,this.height),e.fillStyle="#E0E0E0",e.fillRect(this.x+2,this.y+2,this.width-4,6),e.fillStyle="#FFFFFF",e.font="bold 12px sans-serif",e.textAlign="center",e.textBaseline="middle",e.save(),e.translate(this.x+this.width/2,this.y+this.height/2+4),e.rotate(-Math.PI/2),e.fillText("FUEL",0,0),e.restore()}}class b extends c{constructor(e,t,i){super("bridge",e,t,i,40)}update(e,t){this.y+=t*e}draw(e){e.fillStyle="#808080",e.fillRect(this.x,this.y,this.width,this.height),e.fillStyle="#FFFF00",e.setLineDash([10,10]),e.beginPath(),e.moveTo(this.x,this.y+this.height/2),e.lineTo(this.x+this.width,this.y+this.height/2),e.stroke(),e.setLineDash([]),e.fillStyle="#505050",e.fillRect(this.x,this.y,this.width,4),e.fillRect(this.x,this.y+this.height-4,this.width,4),e.fillStyle="#404040";for(let t=20;t<this.width;t+=40)e.fillRect(this.x+t,this.y+4,8,this.height-8)}}class g extends c{constructor(e,t){super("explosion",e,t,0,0),this.timer=0,this.particles=[];for(let i=0;i<20;i++){const n=Math.random()*Math.PI*2,s=Math.random()*100;this.particles.push({x:0,y:0,vx:Math.cos(n)*s,vy:Math.sin(n)*s,life:1,color:Math.random()>.5?"#FF4000":"#FFFF00"})}}update(e,t){this.y+=t*e,this.timer+=e,this.timer>1&&(this.markedForDeletion=!0),this.particles.forEach(i=>{i.x+=i.vx*e,i.y+=i.vy*e,i.life-=e})}draw(e){e.save(),e.translate(this.x,this.y),this.particles.forEach(t=>{t.life>0&&(e.globalAlpha=t.life,e.fillStyle=t.color,e.beginPath(),e.arc(t.x,t.y,3+t.life*2,0,Math.PI*2),e.fill())}),e.restore()}}class F{constructor(e,t){this.riverWidth=400,this.riverSegments=[],this.lastGeneratedY=0,this.segmentHeight=40,this.screenWidth=e,this.screenHeight=t,this.lastGeneratedY=-t,this.currentCenter=e/2,this.currentWidth=400,this.targetCenter=e/2,this.targetWidth=400;for(let i=t;i>-t*2;i-=this.segmentHeight)this.generateSegment(i)}generateSegment(e){if(Math.abs(this.currentCenter-this.targetCenter)<5&&Math.random()<.1){const s=Math.random()>.5?1:-1;this.targetCenter+=s*50,this.targetCenter=Math.max(200,Math.min(this.screenWidth-200,this.targetCenter))}Math.abs(this.currentWidth-this.targetWidth)<5&&Math.random()<.1&&(this.targetWidth=300+Math.random()*200);const t=5;this.currentCenter<this.targetCenter?this.currentCenter+=t:this.currentCenter>this.targetCenter&&(this.currentCenter-=t),this.currentWidth<this.targetWidth?this.currentWidth+=t:this.currentWidth>this.targetWidth&&(this.currentWidth-=t);const i=this.currentCenter-this.currentWidth/2,n=this.currentCenter+this.currentWidth/2;this.riverSegments.push({y:e,leftBank:i,rightBank:n})}update(e,t,i){const n=e*t;this.riverSegments=this.riverSegments.filter(h=>(h.y+=n,h.y<this.screenHeight+100));let s=this.riverSegments.reduce((h,l)=>Math.min(h,l.y),1/0);for(;s>-this.screenHeight;)s-=this.segmentHeight,this.generateSegment(s),Math.random()<.8&&this.spawnEntity(s,i)}spawnEntity(e,t){const i=this.riverSegments.find(d=>Math.abs(d.y-e)<this.segmentHeight);if(!i)return;const n=i.rightBank-i.leftBank,s=40,h=n-s*2;if(h<=0)return;const l=Math.random();let r=null;if(l<.05?r="bridge":l<.35?r="fuel":l<.6?r="enemy_ship":l<.8?r="enemy_heli":r="enemy_jet",r==="bridge")t.push(new b(i.leftBank,e,n));else if(r){const d=i.leftBank+s+Math.random()*h,f=Math.floor(d/10)*10;r==="fuel"?t.push(new T(f,e)):t.push(new S(r,f,e))}}draw(e){const t=e.createLinearGradient(0,0,this.screenWidth,0);t.addColorStop(0,"#509000"),t.addColorStop(.2,"#64B000"),t.addColorStop(.8,"#64B000"),t.addColorStop(1,"#509000"),e.fillStyle=t,e.fillRect(0,0,this.screenWidth,this.screenHeight);const i=e.createLinearGradient(0,0,0,this.screenHeight);if(i.addColorStop(0,"#3232FF"),i.addColorStop(1,"#4040FF"),e.fillStyle=i,e.beginPath(),this.riverSegments.length===0)return;e.moveTo(this.riverSegments[0].leftBank,this.riverSegments[0].y);for(let s=0;s<this.riverSegments.length-1;s++){const h=this.riverSegments[s],l=this.riverSegments[s+1];e.lineTo(h.leftBank,h.y),e.lineTo(l.leftBank,h.y),e.lineTo(l.leftBank,l.y)}const n=this.riverSegments[this.riverSegments.length-1];e.lineTo(n.rightBank,n.y);for(let s=this.riverSegments.length-1;s>0;s--){const h=this.riverSegments[s],l=this.riverSegments[s-1];e.lineTo(h.rightBank,h.y),e.lineTo(h.rightBank,l.y),e.lineTo(l.rightBank,l.y)}e.closePath(),e.fill(),e.strokeStyle="#CCCCCC",e.lineWidth=2,e.stroke()}checkCollision(e){const t=this.riverSegments.find(i=>i.y>=e.y&&i.y<e.y+this.segmentHeight*2);return t?e.x<t.leftBank||e.x+e.width>t.rightBank:!1}}class k{constructor(){this.ctx=null,this.masterGain=null,this.engineOsc=null,this.engineGain=null,this.isMuted=!1;try{const e=window.AudioContext||window.webkitAudioContext;this.ctx=new e,this.masterGain=this.ctx.createGain(),this.masterGain.gain.value=.3,this.masterGain.connect(this.ctx.destination)}catch(e){console.error("Web Audio API not supported",e)}}init(){var e;((e=this.ctx)==null?void 0:e.state)==="suspended"&&this.ctx.resume()}startEngine(){if(!this.ctx||!this.masterGain)return;const e=this.ctx.sampleRate*2,t=this.ctx.createBuffer(1,e,this.ctx.sampleRate),i=t.getChannelData(0);for(let h=0;h<e;h++)i[h]=Math.random()*2-1;const n=this.ctx.createBufferSource();n.buffer=t,n.loop=!0;const s=this.ctx.createBiquadFilter();s.type="lowpass",s.frequency.value=200,this.engineGain=this.ctx.createGain(),this.engineGain.gain.value=.05,n.connect(s),s.connect(this.engineGain),this.engineGain.connect(this.masterGain),n.start(),this.engineOsc=n,this.engineOsc.filter=s}updateEnginePitch(e){if(!this.engineOsc)return;const t=this.engineOsc.filter;if(t){const i=200+e*400;t.frequency.setTargetAtTime(i,this.ctx.currentTime,.1)}}stopEngine(){this.engineOsc&&(this.engineOsc.stop(),this.engineOsc.disconnect(),this.engineOsc=null)}playShoot(){if(!this.ctx||!this.masterGain)return;const e=this.ctx.createOscillator(),t=this.ctx.createGain();e.type="square",e.frequency.setValueAtTime(800,this.ctx.currentTime),e.frequency.exponentialRampToValueAtTime(100,this.ctx.currentTime+.1),t.gain.setValueAtTime(.3,this.ctx.currentTime),t.gain.exponentialRampToValueAtTime(.01,this.ctx.currentTime+.1),e.connect(t),t.connect(this.masterGain),e.start(),e.stop(this.ctx.currentTime+.1)}playExplosion(){if(!this.ctx||!this.masterGain)return;const e=this.ctx.sampleRate*.5,t=this.ctx.createBuffer(1,e,this.ctx.sampleRate),i=t.getChannelData(0);for(let l=0;l<e;l++)i[l]=Math.random()*2-1;const n=this.ctx.createBufferSource();n.buffer=t;const s=this.ctx.createBiquadFilter();s.type="lowpass",s.frequency.value=1e3;const h=this.ctx.createGain();h.gain.setValueAtTime(.5,this.ctx.currentTime),h.gain.exponentialRampToValueAtTime(.01,this.ctx.currentTime+.5),n.connect(s),s.connect(h),h.connect(this.masterGain),n.start()}playRefuel(){if(!this.ctx||!this.masterGain)return;const e=this.ctx.createOscillator(),t=this.ctx.createGain();e.type="sine",e.frequency.setValueAtTime(400,this.ctx.currentTime),e.frequency.linearRampToValueAtTime(600,this.ctx.currentTime+.1),t.gain.setValueAtTime(.1,this.ctx.currentTime),t.gain.linearRampToValueAtTime(0,this.ctx.currentTime+.1),e.connect(t),t.connect(this.masterGain),e.start(),e.stop(this.ctx.currentTime+.1)}}class C{constructor(e,t){this.entities=[],this.score=0,this.lives=3,this.isGameOver=!1,this.isPaused=!1,this.keys={},this.scrollSpeed=100,this.baseScrollSpeed=100,this.lastTime=0,this.animationId=null,this.handleKeyDown=n=>{this.keys[n.code]=!0,n.code==="Space"&&this.shoot()},this.handleKeyUp=n=>{this.keys[n.code]=!1},this.loop=n=>{const s=(n-this.lastTime)/1e3;this.lastTime=n,!this.isPaused&&!this.isGameOver&&(this.update(s),this.draw()),this.animationId=requestAnimationFrame(this.loop)},this.canvas=e,this.ctx=e.getContext("2d"),this.width=e.width,this.height=e.height,this.onGameOver=t,this.player=new w(this.width/2-14,this.height-120),this.levelGenerator=new F(this.width,this.height),this.soundManager=new k,window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp);const i=()=>{this.soundManager.init(),window.removeEventListener("keydown",i),window.removeEventListener("click",i)};window.addEventListener("keydown",i),window.addEventListener("click",i)}shoot(){if(this.isGameOver||this.isPaused)return;this.entities.filter(t=>t.type==="bullet").length<3&&(this.entities.push(new v(this.player.x+this.player.width/2-2,this.player.y)),this.soundManager.playShoot())}start(){this.lastTime=performance.now(),this.soundManager.startEngine(),this.loop(this.lastTime)}stop(){this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null),this.soundManager.stopEngine(),window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("keyup",this.handleKeyUp)}update(e){this.keys.ArrowLeft?this.player.vx=-this.player.speedX:this.keys.ArrowRight?this.player.vx=this.player.speedX:this.player.vx=0,this.keys.ArrowUp?(this.scrollSpeed=this.baseScrollSpeed*2.5,this.player.isAccelerating=!0):this.keys.ArrowDown?(this.scrollSpeed=this.baseScrollSpeed*.5,this.player.isAccelerating=!1):(this.scrollSpeed=this.baseScrollSpeed,this.player.isAccelerating=!1),this.soundManager.updateEnginePitch(this.scrollSpeed/this.baseScrollSpeed),this.player.update(e,this.scrollSpeed),this.player.x<0&&(this.player.x=0),this.player.x+this.player.width>this.width&&(this.player.x=this.width-this.player.width),this.levelGenerator.update(this.scrollSpeed,e,this.entities),this.entities.forEach(t=>t.update(e,this.scrollSpeed)),this.entities=this.entities.filter(t=>t.y<this.height+100&&t.y>-this.height*2&&!t.markedForDeletion),this.checkCollisions(),this.player.fuel<=0&&this.handleDeath()}checkCollisions(){this.levelGenerator.checkCollision(this.player)&&this.handleDeath();for(const t of this.entities)t.type==="bullet"||t.type==="explosion"||this.player.collidesWith(t)&&(t.type==="fuel"?(this.player.fuel=Math.min(this.player.maxFuel,this.player.fuel+.5),this.soundManager.playRefuel()):t.type==="bridge"?this.handleDeath():t.type.startsWith("enemy")&&(this.handleDeath(),t.markedForDeletion=!0,this.entities.push(new g(t.x,t.y))));const e=this.entities.filter(t=>t.type==="bullet");for(const t of e)for(const i of this.entities)i===t||i.type==="bullet"||i.type==="explosion"||t.collidesWith(i)&&(t.markedForDeletion=!0,i.type==="bridge"?(i.markedForDeletion=!0,this.score+=500,this.entities.push(new g(i.x+i.width/2,i.y)),this.soundManager.playExplosion()):i.type==="fuel"?(i.markedForDeletion=!0,this.score+=80,this.entities.push(new g(i.x,i.y)),this.soundManager.playExplosion()):i.type.startsWith("enemy")&&(i.markedForDeletion=!0,this.score+=100,this.entities.push(new g(i.x,i.y)),this.soundManager.playExplosion()))}handleDeath(){this.soundManager.playExplosion(),this.entities.push(new g(this.player.x,this.player.y)),this.lives--,this.lives<=0?(this.isGameOver=!0,this.soundManager.stopEngine(),this.onGameOver(this.score)):(this.player.x=this.width/2-14,this.player.y=this.height-120,this.player.fuel=100,this.player.vx=0,this.entities=this.entities.filter(e=>e.y>this.height/2))}draw(){this.ctx.clearRect(0,0,this.width,this.height),this.levelGenerator.draw(this.ctx),this.entities.forEach(e=>e.draw(this.ctx)),this.player.draw(this.ctx),this.drawHUD()}drawHUD(){const t=this.height-60;this.ctx.fillStyle="#888888",this.ctx.fillRect(0,t,this.width,60);const i=200,n=30,s=this.width/2-i/2,h=t+15;this.ctx.fillStyle="#000000",this.ctx.fillRect(s,h,i,n),this.ctx.fillStyle="#FFFFFF",this.ctx.font="20px monospace",this.ctx.textAlign="center",this.ctx.fillText("E",s+15,h+22),this.ctx.fillText("1/2",s+i/2,h+22),this.ctx.fillText("F",s+i-15,h+22);const l=this.player.fuel/this.player.maxFuel,r=s+15+(i-30)*l;this.ctx.strokeStyle="#FFFF00",this.ctx.lineWidth=3,this.ctx.beginPath(),this.ctx.moveTo(r,h+25),this.ctx.lineTo(r,h+5),this.ctx.stroke(),this.ctx.fillStyle="#FFFF00",this.ctx.font="bold 24px monospace",this.ctx.fillText(this.score.toString(),this.width/2,t-10),this.ctx.fillText(this.lives.toString(),30,t+40)}}const E=()=>{var l;const o=u.useRef(null),e=u.useRef(null),[t,i]=u.useState(!1),[n,s]=u.useState(0),{setActivePage:h}=p();return u.useEffect(()=>{if(!o.current)return;const r=o.current;r.width=800,r.height=600;const d=new C(r,y=>{i(!0),s(y)});e.current=d,d.start();const f=y=>{d.isGameOver&&y.code==="KeyR"&&window.location.reload()};return window.addEventListener("keydown",f),()=>{d.stop(),window.removeEventListener("keydown",f)}},[]),a.jsxs("div",{className:"flex flex-col items-center justify-center h-full bg-zinc-900 relative",children:[a.jsx("div",{className:"absolute top-4 left-4 z-10",children:a.jsxs("button",{onClick:()=>h("home"),className:"flex items-center gap-2 px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-colors backdrop-blur-sm",children:[a.jsx(m,{size:20}),a.jsx("span",{children:"Back to Home"})]})}),a.jsxs("div",{className:"relative border-4 border-zinc-700 rounded-lg overflow-hidden shadow-2xl",children:[a.jsx("canvas",{ref:o,className:"block bg-blue-900",style:{width:"800px",height:"600px"}}),!((l=e.current)!=null&&l.animationId)&&!t&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 text-white pointer-events-none",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-4xl font-bold mb-4",children:"RIVER RAID"}),a.jsx("p",{children:"Arrow Keys to Move & Accelerate"}),a.jsx("p",{children:"Space to Shoot"})]})})]}),a.jsx("div",{className:"mt-4 text-zinc-400 text-sm",children:a.jsx("p",{children:"Controls: Arrows to Move/Speed | Space to Shoot | Fly over FUEL to refuel"})})]})};export{E as default};
