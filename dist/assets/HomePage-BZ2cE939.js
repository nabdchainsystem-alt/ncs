import{c as te,r as d,R as ze,V as _e,j as e,W as Ae,Y as Ne,Z as Me,n as he,h as Le,l as U,_ as me,X as je,$ as Pe,T as ue,Q as q,L as K,a0 as oe,C as fe,B as Z,a1 as $e,P as we,a2 as xe,a3 as Ee,a4 as ne,m as pe,O as Oe,S as Ce,H as Re,a5 as ie,a6 as ee,a7 as se,u as De,a8 as Ge,K as We,a9 as Fe,aa as ae,ab as Ue,I as He,ac as Be}from"./index-DYCMOhyY.js";import{d as ce,C as Ye}from"./discussionService-CLMKEkgO.js";import{I as be,T as Je,A as Qe}from"./TaskBoard-UzbIWNMp.js";import{g as X}from"./goalsService-CuNe5Z76.js";import{r as de}from"./remindersService-D0e1lVE8.js";import{D as ve}from"./DatePicker-BjEDCiA7.js";import{T as Ve}from"./TaskBoardIcons-jR9B2fMY.js";import{C as qe}from"./calendar-plus-DTZi7yjw.js";import{C as Ke}from"./cloud-U9w1zbwI.js";import{E as Ze}from"./index-Bv7JfK0D.js";import{A as Xe}from"./circle-plus-kLkXezsw.js";import"./index-Ca_DMGSD.js";import"./copy-D3xr8-w6.js";import"./sortable.esm-CO2260nM.js";import"./core.esm-Dtb28RSd.js";import"./list-CfCVgUkr.js";import"./list-ordered-DZ4kicST.js";import"./flag-Q3wn5sWP.js";import"./grip-vertical-Cd79Tdtl.js";import"./phone-BtP1w4K8.js";import"./star-lcAsu_-e.js";import"./corner-down-right-D9UHXAv6.js";import"./tag-Dug0Eb5H.js";import"./smile-DcJqnDon.js";import"./type-BH6jMgYP.js";import"./paperclip-BEEJzDs_.js";import"./minus-PGWUH-iD.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],tt=te("arrow-down-right",et);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]],at=te("cloud-lightning",st);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]],nt=te("cloud-rain",ot);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M8 19h.01",key:"puxtts"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M12 21h.01",key:"h35vbk"}],["path",{d:"M16 15h.01",key:"rnfrdf"}],["path",{d:"M16 19h.01",key:"1vcnzz"}]],lt=te("cloud-snow",rt);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=[["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}],["path",{d:"M15.947 12.65a4 4 0 0 0-5.925-4.128",key:"dpwdj0"}],["path",{d:"M13 22H7a5 5 0 1 1 4.9-6H13a3 3 0 0 1 0 6Z",key:"s09mg5"}]],ke=te("cloud-sun",it);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],dt=te("thumbs-down",ct),V="taskboard-quick-draft",xt=({isOpen:n,onClose:f,onSend:y,rooms:x=[],darkMode:o=!1})=>{const[g,s]=d.useState(!1),[w,k]=d.useState({type:"main",name:"My Tasks"}),[i,l]=d.useState(!1),m=d.useRef(null),u=()=>{f()},{ref:p,setIsActive:I}=ze({onCancel:u,initialActive:n});if(d.useEffect(()=>{I(n)},[n,I]),d.useEffect(()=>{if(n){if(s(!0),k({type:"main",name:"My Tasks"}),l(!1),!localStorage.getItem(V)){const c={...be,id:"draft-board",name:"Draft Task",groups:[{...be.groups[0],id:_e(),title:"New Group",tasks:[]}]};localStorage.setItem(V,JSON.stringify(c))}}else{const c=setTimeout(()=>s(!1),300);return()=>clearTimeout(c)}},[n]),!g&&!n)return null;const z=()=>{var c;try{const T=(c=m.current)==null?void 0:c.exportBoardWithDrafts();if(!T){const r=localStorage.getItem(V);if(!r)return;y(JSON.parse(r),{type:w.type,roomId:w.roomId}),localStorage.removeItem(V);return}localStorage.setItem(V,JSON.stringify(T)),y(T,{type:w.type,roomId:w.roomId}),localStorage.removeItem(V)}catch(T){console.error("Failed to read draft board",T)}};return e.jsx(Ae,{children:n&&e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",children:[e.jsx(Ne.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:`absolute inset-0 ${n?"bg-black/60 backdrop-blur-md":""}`,onClick:u}),e.jsx(Ne.div,{ref:p,initial:{scale:.95,opacity:0,y:10},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:10},transition:{duration:.2,ease:"easeOut"},className:"w-full max-w-[95vw] h-auto max-h-[85vh] relative z-10",children:e.jsxs("div",{className:`relative w-full max-h-full flex flex-col rounded-3xl shadow-2xl overflow-hidden backdrop-blur-xl border ${o?"bg-gray-900/95 border-gray-700":"bg-white/95 border-white/40"}`,children:[e.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden relative min-h-[300px]",children:g&&e.jsx("div",{className:"min-w-full h-full",children:e.jsx(Je,{ref:m,storageKey:V,darkMode:o,minimal:!0,showGroupHeader:!0})})}),e.jsxs("div",{className:`px-6 py-4 flex items-center justify-between border-t border-gray-100/10 shrink-0 ${o?"bg-black/20":"bg-white/40"}`,children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>l(!i),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${o?"text-gray-300 hover:bg-white/5":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx("span",{className:"opacity-60",children:"Save As:"}),e.jsxs("span",{className:`font-bold flex items-center gap-2 ${o?"text-white":"text-gray-900"}`,children:[w.type==="room"&&e.jsx(Me,{size:12,className:"text-indigo-400"}),w.type==="main"&&e.jsx(he,{size:12,className:"text-blue-400"}),w.name]}),e.jsx(Le,{size:14,className:`opacity-50 transition-transform ${i?"rotate-180":""}`})]}),i&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>l(!1)}),e.jsxs("div",{className:`absolute bottom-full left-0 mb-2 w-64 rounded-xl shadow-xl border overflow-hidden p-1 z-20 animate-in slide-in-from-bottom-2 fade-in duration-200 ${o?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("button",{onClick:()=>{k({type:"main",name:"My Tasks"}),l(!1)},className:`w-full flex items-center justify-between px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ${o?"hover:bg-white/5 text-gray-200":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-1.5 rounded-md ${o?"bg-blue-500/20 text-blue-400":"bg-blue-50 text-blue-600"}`,children:e.jsx(he,{size:14})}),e.jsx("span",{children:"My Tasks"})]}),w.type==="main"&&e.jsx(U,{size:16,className:"text-blue-500"})]}),e.jsx("div",{className:`my-1 mx-2 border-t ${o?"border-gray-700":"border-gray-100"}`}),e.jsx("div",{className:`px-3 py-1 text-xs font-semibold uppercase tracking-wider mb-1 ${o?"text-gray-500":"text-gray-400"}`,children:"Private Rooms"}),e.jsx("div",{className:"max-h-48 overflow-y-auto custom-scrollbar space-y-0.5",children:x.length===0?e.jsx("div",{className:`px-3 py-2 text-xs italic ${o?"text-gray-500":"text-gray-400"}`,children:"No rooms found"}):x.map(c=>e.jsxs("button",{onClick:()=>{k({type:"room",roomId:c.id,name:c.name}),l(!1)},className:`w-full flex items-center justify-between px-3 py-2 rounded-lg text-sm font-medium transition-colors ${o?"hover:bg-white/5 text-gray-200":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-md flex items-center justify-center text-[10px] font-bold text-white shadow-sm",style:{backgroundColor:c.color||"#3b82f6"},children:c.name.charAt(0).toUpperCase()}),e.jsx("span",{className:"truncate max-w-[140px]",children:c.name})]}),w.roomId===c.id&&e.jsx(U,{size:16,className:"text-indigo-500"})]},c.id))})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:u,className:`px-5 py-2.5 rounded-xl font-semibold text-sm transition-all ${o?"text-gray-400 hover:bg-white/10 hover:text-white":"text-gray-600 hover:bg-black/5 hover:text-gray-900"}`,children:"Cancel"}),e.jsx("button",{onClick:z,className:"px-6 py-2.5 rounded-xl font-semibold text-sm text-white shadow-lg active:scale-95 transition-all bg-[#2a2e35] hover:bg-[#32363e] border border-gray-700",children:e.jsx("span",{children:"Send Task"})})]})]})]})})]})})},mt=({items:n,projects:f,onCapture:y,onSelect:x,onDelete:o})=>{const{t:g}=me(),[s,w]=d.useState(""),[k,i]=d.useState(null),l=j=>{j.preventDefault(),s.trim()&&(y(s),w(""))},m=(j,N)=>{j.stopPropagation(),i(N)},u=(j,N)=>{j.stopPropagation(),o(N),i(null)},p=j=>{j.stopPropagation(),i(null)},I=n.filter(j=>j.status==="inbox").sort((j,N)=>N.createdAt-j.createdAt),z=j=>{const N=new Date;return j.getDate()===N.getDate()&&j.getMonth()===N.getMonth()&&j.getFullYear()===N.getFullYear()},c=j=>{const N=new Date;return N.setDate(N.getDate()-1),j.getDate()===N.getDate()&&j.getMonth()===N.getMonth()&&j.getFullYear()===N.getFullYear()},T=I.filter(j=>z(new Date(j.createdAt))),r=I.filter(j=>c(new Date(j.createdAt))),C=I.filter(j=>!z(new Date(j.createdAt))&&!c(new Date(j.createdAt))),M=({title:j,items:N,subtitle:R,highlight:P=!1})=>e.jsxs("div",{className:`flex flex-col h-full relative ${P?"bg-white/40 shadow-sm ring-1 ring-stone-900/5":"bg-transparent"} rounded-[2rem] p-1 transition-all duration-300`,children:[e.jsxs("div",{className:"flex-none flex items-center justify-between px-5 pt-4 pb-2 border-b border-stone-100/50 mb-1 mx-2",children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:`text-xs font-bold uppercase tracking-widest ${P?"text-stone-900":"text-stone-400"}`,children:j}),R&&e.jsx("span",{className:"text-[10px] text-stone-300 italic font-medium",children:R})]}),e.jsx("span",{className:`text-[10px] font-extrabold h-5 min-w-[1.25rem] flex items-center justify-center px-1.5 rounded-full ${P?"bg-stone-900 text-white":"bg-stone-100 text-stone-400"}`,children:N.length})]}),e.jsxs("div",{className:"flex-1 relative w-full min-h-0 rounded-b-[2rem] overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 overflow-y-auto scrollbar-hide px-3 pb-8 pt-1",children:N.length>0?e.jsx("div",{className:"space-y-1",children:N.map(D=>{const L=k===D.id;return e.jsx("div",{onClick:()=>!L&&x(D.id),className:`group relative py-3 px-3 border border-transparent transition-all cursor-pointer rounded-xl flex flex-col gap-1 overflow-hidden 
                                            ${L?"bg-red-50 border-red-100":"hover:border-stone-100/50 hover:bg-white/60 hover:shadow-sm"}
                                        `,children:L?e.jsxs("div",{className:"flex items-center justify-between w-full h-full animate-fade-in-right",children:[e.jsx("span",{className:"text-xs font-bold text-red-600 uppercase tracking-widest pl-1",children:g("gtd.capture.delete_confirm")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:_=>p(_),className:"p-1 rounded-full bg-stone-200 text-stone-500 hover:bg-stone-300 transition-colors",children:e.jsx(je,{size:14,strokeWidth:3})}),e.jsx("button",{onClick:_=>u(_,D.id),className:"p-1 rounded-full bg-red-500 text-white hover:bg-red-600 transition-colors shadow-sm",children:e.jsx(Pe,{size:14,strokeWidth:3})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("span",{className:`text-base font-serif italic line-clamp-2 leading-snug ${P?"text-stone-700":"text-stone-500"} group-hover:text-stone-900 transition-colors`,children:D.text}),e.jsx("button",{onClick:_=>m(_,D.id),className:"opacity-0 group-hover:opacity-100 transition-all p-1.5 text-stone-300 hover:text-red-500 hover:bg-red-50 rounded-lg -mr-1 -mt-1",title:"Delete",children:e.jsx(ue,{size:14})})]}),e.jsx("span",{className:"text-[9px] font-sans font-bold text-stone-200 group-hover:text-stone-300 uppercase tracking-wider transition-opacity",children:new Date(D.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},D.id)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full opacity-30 select-none pb-8",children:[e.jsx("span",{className:"text-3xl font-serif italic text-stone-300 mb-2",children:"~"}),e.jsx("p",{className:"text-[9px] font-sans tracking-widest uppercase font-bold text-stone-300",children:g("gtd.capture.empty")})]})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-10 bg-gradient-to-t from-stone-50/100 to-transparent pointer-events-none"})]})]});return e.jsxs("div",{className:"h-full min-h-[600px] flex flex-col font-serif p-6 max-w-[90rem] mx-auto w-full",children:[e.jsxs("div",{className:"flex-none mb-8 text-center relative z-10",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold font-serif text-stone-900 uppercase tracking-widest mb-6 select-none",children:g("gtd.capture")}),e.jsxs("form",{onSubmit:l,className:"relative w-full max-w-2xl mx-auto group",children:[e.jsx("input",{type:"text",value:s,onChange:j=>w(j.target.value),placeholder:g("gtd.capture.placeholder"),className:"w-full bg-transparent border-b border-stone-200 focus:border-stone-900 px-6 py-4 text-4xl font-serif italic text-stone-800 placeholder:text-stone-200 focus:placeholder:text-stone-300 focus:outline-none transition-all text-center",autoFocus:!0}),e.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 opacity-0 group-focus-within:opacity-100 transition-opacity duration-500",children:e.jsx("span",{className:"text-[9px] font-bold bg-stone-100 text-stone-400 px-2 py-1 rounded-md uppercase tracking-wider",children:g("gtd.capture.enter")})})]})]}),e.jsxs("div",{className:"flex-1 w-full grid grid-cols-1 md:grid-cols-3 gap-6 min-h-0 border-t border-stone-100/30 pt-4",children:[e.jsx(M,{title:g("gtd.capture.yesterday"),items:r,subtitle:g("gtd.capture.review")}),e.jsx(M,{title:g("gtd.capture.today"),items:T,subtitle:g("gtd.capture.inbox"),highlight:!0}),e.jsx(M,{title:g("gtd.capture.pending"),items:C,subtitle:g("gtd.capture.backlog")})]})]})},ut=({item:n,onProcess:f,onCreateProject:y,onNavigate:x,onExportToBoard:o,projects:g,onNext:s,onPrev:w,canNext:k,canPrev:i})=>{const{t:l}=me(),[m,u]=d.useState("initial"),[p,I]=d.useState(""),[z,c]=d.useState(""),[T,r]=d.useState(!1);d.useEffect(()=>{u("initial"),I(""),c(""),r(!1)},[n==null?void 0:n.id]),d.useEffect(()=>{const N=R=>{R.target instanceof HTMLInputElement||R.target instanceof HTMLTextAreaElement||(R.key==="ArrowRight"&&k?s==null||s():R.key==="ArrowLeft"&&i&&(w==null||w()))};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[k,i,s,w]);const C=N=>{f(n.id,N)},M=(N,R,P)=>e.jsxs("div",{className:"w-full max-w-2xl mx-auto animate-fade-in-up",children:[e.jsx("div",{className:"text-center mb-10",children:e.jsxs("div",{className:"bg-white p-8 rounded-3xl shadow-xl border border-stone-100 relative",children:[e.jsxs("div",{className:"text-3xl font-serif text-stone-800 italic leading-snug mb-4",children:['"',n.text,'"']}),e.jsxs("div",{className:"flex justify-center gap-4 text-xs font-bold uppercase tracking-wider text-stone-300",children:[e.jsxs("span",{children:["Created ",new Date(n.createdAt).toLocaleDateString()]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["ID #",n.id]})]}),i&&e.jsx("button",{onClick:w,className:"absolute left-[-3rem] top-1/2 -translate-y-1/2 p-2 text-stone-300 hover:text-stone-600 transition-colors",title:"Previous Item",children:e.jsx(oe,{size:24,className:"rotate-180"})}),k&&e.jsx("button",{onClick:s,className:"absolute right-[-3rem] top-1/2 -translate-y-1/2 p-2 text-stone-300 hover:text-stone-600 transition-colors",title:"Next Item",children:e.jsx(oe,{size:24})})]})}),e.jsxs("div",{className:"bg-stone-50/50 backdrop-blur-sm rounded-3xl p-8 border border-stone-100 shadow-inner",children:[e.jsx("h4",{className:"text-xl font-serif text-stone-600 mb-8 text-center italic",children:N}),R]}),P&&e.jsxs("button",{onClick:P,className:"mx-auto mt-6 flex items-center gap-2 text-stone-400 hover:text-stone-600 text-xs font-bold uppercase tracking-wider transition-colors",children:[e.jsx(oe,{className:"rotate-180",size:14})," Back"]})]});let j=null;return n?m==="initial"?j=M(l("gtd.clarify.is_actionable"),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("button",{onClick:()=>u("not_actionable"),className:"group bg-white p-8 rounded-2xl border border-stone-200 shadow-sm hover:border-stone-400 hover:shadow-lg transition-all text-center",children:[e.jsx(dt,{size:32,className:"mx-auto mb-4 text-stone-300 group-hover:text-stone-500 transition-colors"}),e.jsx("span",{className:"block text-lg font-bold text-stone-700 mb-2",children:l("gtd.clarify.no")}),e.jsx("span",{className:"text-xs text-stone-400 font-sans",children:l("gtd.clarify.no_desc")})]}),e.jsxs("button",{onClick:()=>u("actionable_type"),className:"group bg-stone-900 p-8 rounded-2xl shadow-xl hover:bg-black hover:-translate-y-1 transition-all text-center",children:[e.jsx(Ve,{size:32,className:"mx-auto mb-4 text-stone-400 group-hover:text-amber-400 transition-colors"}),e.jsx("span",{className:"block text-lg font-bold text-white mb-2",children:l("gtd.clarify.yes")}),e.jsx("span",{className:"text-xs text-stone-400 font-sans",children:l("gtd.clarify.yes_desc")})]})]})):m==="not_actionable"?j=M(l("gtd.clarify.organize_non_actionable"),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("button",{onClick:()=>{C({status:"trash"}),x("organize")},className:"bg-white hover:bg-red-50 p-6 rounded-2xl border border-stone-200 hover:border-red-200 transition-all flex flex-col items-center gap-3 group",children:[e.jsx(ue,{size:24,className:"text-stone-400 group-hover:text-red-500"}),e.jsx("span",{className:"font-bold text-stone-600 group-hover:text-red-700",children:l("gtd.clarify.trash")})]}),e.jsxs("button",{onClick:()=>{C({status:"reference"}),x("organize")},className:"bg-white hover:bg-blue-50 p-6 rounded-2xl border border-stone-200 hover:border-blue-200 transition-all flex flex-col items-center gap-3 group",children:[e.jsx(Qe,{size:24,className:"text-stone-400 group-hover:text-blue-500"}),e.jsx("span",{className:"font-bold text-stone-600 group-hover:text-blue-700",children:l("gtd.list.reference")}),e.jsx("span",{className:"text-[10px] text-stone-400 font-sans mt-1",children:l("gtd.clarify.file_away")})]}),e.jsxs("button",{onClick:()=>{C({status:"someday"}),x("organize")},className:"bg-white hover:bg-amber-50 p-6 rounded-2xl border border-stone-200 hover:border-amber-200 transition-all flex flex-col items-center gap-3 group",children:[e.jsx(q,{size:24,className:"text-stone-400 group-hover:text-amber-500"}),e.jsx("span",{className:"font-bold text-stone-600 group-hover:text-amber-700",children:l("gtd.list.someday")})]})]}),()=>u("initial")):m==="actionable_type"?j=M(l("gtd.clarify.next_step"),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-2",children:e.jsxs("button",{onClick:()=>u("project_details"),className:"w-full bg-indigo-50 hover:bg-indigo-100 p-4 rounded-xl border border-indigo-100 hover:border-indigo-200 transition-all flex items-center justify-between group px-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(K,{size:20,className:"text-indigo-400 group-hover:text-indigo-600"}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"block font-bold text-indigo-900",children:l("gtd.clarify.is_project")}),e.jsx("span",{className:"text-xs text-indigo-400",children:l("gtd.clarify.project_desc")})]})]}),e.jsx(oe,{size:16,className:"text-indigo-300"})]})}),e.jsxs("button",{onClick:()=>{C({status:"done"}),x("review")},className:"bg-white hover:bg-emerald-50 p-4 rounded-xl border border-stone-200 hover:border-emerald-200 transition-all flex flex-col items-center gap-2 group",children:[e.jsx(U,{size:24,className:"text-stone-400 group-hover:text-emerald-500"}),e.jsx("span",{className:"font-bold text-sm text-stone-600 group-hover:text-emerald-700",children:l("gtd.clarify.do_it")}),e.jsx("span",{className:"text-[10px] text-stone-400 font-sans",children:l("gtd.clarify.mark_done")})]}),e.jsxs("button",{onClick:()=>u("delegate_details"),className:"bg-white hover:bg-purple-50 p-4 rounded-xl border border-stone-200 hover:border-purple-200 transition-all flex flex-col items-center gap-2 group",children:[e.jsx(he,{size:24,className:"text-stone-400 group-hover:text-purple-500"}),e.jsx("span",{className:"font-bold text-sm text-stone-600 group-hover:text-purple-700",children:l("gtd.clarify.delegate")})]}),e.jsxs("button",{onClick:()=>{C({status:"actionable"}),x("organize")},className:"bg-white hover:bg-stone-50 p-4 rounded-xl border border-stone-200 hover:border-stone-300 transition-all flex flex-col items-center gap-2 group",children:[e.jsx(U,{size:24,className:"text-stone-400 group-hover:text-stone-600"}),e.jsx("span",{className:"font-bold text-sm text-stone-600 group-hover:text-stone-800",children:l("gtd.list.next_actions")})]}),e.jsxs("button",{onClick:()=>u("defer_details"),className:"bg-white hover:bg-orange-50 p-4 rounded-xl border border-stone-200 hover:border-orange-200 transition-all flex flex-col items-center gap-2 group",children:[e.jsx(fe,{size:24,className:"text-stone-400 group-hover:text-orange-500"}),e.jsx("span",{className:"font-bold text-sm text-stone-600 group-hover:text-orange-700",children:l("gtd.clarify.defer")})]})]}),()=>u("initial")):m==="delegate_details"?j=M(l("gtd.clarify.who_waiting"),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:l("gtd.clarify.enter_name"),value:p,onChange:N=>I(N.target.value),className:"w-full p-4 bg-white rounded-xl border border-stone-200 focus:outline-none focus:ring-2 focus:ring-stone-900/10 focus:border-stone-400 font-serif italic text-lg",autoFocus:!0}),e.jsx("button",{disabled:!p.trim(),onClick:()=>{C({status:"waiting",delegatedTo:p}),x("organize")},className:"w-full py-4 bg-stone-900 text-white rounded-xl font-bold tracking-wide hover:bg-black disabled:opacity-50 transition-all",children:l("gtd.clarify.confirm_waiting")})]}),()=>u("actionable_type")):m==="defer_details"?j=M(l("gtd.clarify.when_need"),e.jsxs("div",{className:"space-y-4 relative",children:[e.jsxs("button",{onClick:()=>r(!0),className:"w-full p-4 bg-white rounded-xl border border-stone-200 focus:outline-none focus:ring-2 focus:ring-stone-900/10 focus:border-stone-400 font-serif italic text-lg text-left text-stone-700 flex justify-between items-center",children:[z?new Date(z).toLocaleDateString(void 0,{weekday:"long",month:"long",day:"numeric"}):l("gtd.clarify.select_value"),e.jsx(fe,{size:20,className:"text-stone-400"})]}),T&&e.jsx("div",{className:"absolute bottom-full mb-2 left-0 z-50 shadow-2xl rounded-2xl overflow-hidden",children:e.jsx(ve,{date:z,onSelect:N=>{c(N),r(!1)},onClose:()=>r(!1)})}),e.jsx("button",{disabled:!z,onClick:()=>{C({status:"actionable",dueDate:new Date(z).getTime()}),x("organize")},className:"w-full py-4 bg-stone-900 text-white rounded-xl font-bold tracking-wide hover:bg-black disabled:opacity-50 transition-all",children:l("gtd.clarify.add_calendar")})]}),()=>u("actionable_type")):m==="project_details"&&(j=M(l("gtd.clarify.define_outcome"),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"e.g. Vacation in Hawaii...",value:p,onChange:N=>I(N.target.value),className:"w-full p-4 bg-white rounded-xl border border-stone-200 focus:outline-none focus:ring-2 focus:ring-stone-900/10 focus:border-stone-400 font-serif italic text-lg",autoFocus:!0}),e.jsx("button",{disabled:!p.trim(),onClick:()=>{y(p,[n.text]),f(n.id,{status:"trash"}),x("organize")},className:"w-full py-4 bg-stone-900 text-white rounded-xl font-bold tracking-wide hover:bg-black disabled:opacity-50 transition-all",children:l("gtd.clarify.create_project")})]}),()=>u("actionable_type"))):j=e.jsxs("div",{className:"h-full w-full flex flex-col items-center justify-center text-stone-300 animate-fade-in-up",children:[e.jsx(U,{size:96,strokeWidth:.5,className:"mb-8 opacity-20 text-stone-900"}),e.jsx("h3",{className:"text-4xl font-serif text-stone-400 italic mb-4",children:l("gtd.clarify.inbox_zero")}),e.jsx("p",{className:"text-stone-400 font-sans tracking-widest uppercase text-xs font-bold",children:l("gtd.clarify.you_are_clear")})]}),e.jsxs("div",{className:"h-full min-h-[600px] flex flex-col font-serif p-6 max-w-[90rem] mx-auto w-full",children:[e.jsx("div",{className:"text-center mb-8",children:e.jsx("h1",{className:"text-4xl md:text-5xl font-bold font-serif text-stone-900 uppercase tracking-widest mb-2 select-none",children:l("gtd.clarify")})}),e.jsx("div",{className:"flex-1 w-full min-h-0 relative",children:j})]})},pt=({projects:n,items:f,onUpdateItem:y,onAddProject:x,onAddItem:o,onDelete:g})=>{const{t:s}=me(),w=f.filter(t=>t.status==="actionable"&&!t.dueDate),k=f.filter(t=>(t.status==="actionable"||t.status==="waiting")&&t.dueDate).sort((t,$)=>(t.dueDate||0)-($.dueDate||0)),i=f.filter(t=>t.status==="waiting"),l=f.filter(t=>t.status==="someday"),m=f.filter(t=>t.status==="reference");f.filter(t=>t.status==="done").sort((t,$)=>$.createdAt-t.createdAt);const[u,p]=d.useState(null),[I,z]=d.useState(""),[c,T]=d.useState(""),[r,C]=d.useState(""),[M,j]=d.useState(null),[N,R]=d.useState(""),[P,D]=d.useState(""),L=()=>{if(!I.trim())return;const t={dueDate:r?new Date(r).getTime():void 0,energy:M||void 0,contextId:N||void 0,description:P||void 0};u==="project"?x(I):u==="action"?o({text:I,status:"actionable",...t}):u==="waiting"?o({text:I,status:"waiting",delegatedTo:c||"Someone",...t}):u==="someday"?o({text:I,status:"someday",...t}):u==="reference"&&o({text:I,status:"reference",...t}),_()},_=()=>{p(null),z(""),T(""),C(""),j(null),R(""),D("")},G=new Date().setHours(0,0,0,0),W=t=>t>=G,A=({title:t,description:$,icon:O,count:B,children:J,onAdd:Y,addLabel:Q,newCount:re,color:le="text-stone-400"})=>e.jsxs("div",{className:"group",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(O,{size:20,className:`${le} opacity-80`}),e.jsx("h3",{className:"text-xl font-serif font-bold text-stone-800",children:t}),Y&&e.jsx("button",{onClick:Y,className:"ml-2 p-1 text-stone-300 hover:text-stone-900 hover:bg-stone-100 rounded-lg transition-colors",title:Q,children:e.jsx(we,{size:16})}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold uppercase tracking-widest text-stone-400 bg-stone-50 px-2 py-1 rounded-full border border-stone-100",children:[e.jsxs("span",{children:[s("gtd.label.total"),": ",B]}),re>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-stone-300",children:"|"}),e.jsxs("span",{className:le,children:[s("gtd.label.new"),": ",re]})]})]})]})}),e.jsx("div",{className:"space-y-1 pl-2 md:pl-8 border-l border-stone-100 group-hover:border-stone-200 transition-colors max-h-[300px] overflow-y-auto pr-2 scrollbar-hide",children:J})]}),F=({item:t,type:$="task"})=>e.jsxs("div",{className:"group py-3 px-2 flex items-start justify-between gap-4 border-b border-stone-100/50 hover:border-stone-100 hover:bg-stone-50/50 rounded-lg transition-all cursor-pointer relative",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`font-serif text-sm leading-snug ${$==="simple"?"text-stone-500":"text-stone-800 font-medium"}`,children:$==="project"?t.name:t.text}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-1.5 opacity-0 group-hover:opacity-100 transition-opacity",children:[$==="waiting"&&t.delegatedTo&&e.jsxs("span",{className:"text-[10px] uppercase font-bold text-amber-500",children:["Waiting: ",t.delegatedTo]}),t.dueDate&&e.jsx("span",{className:"text-[10px] uppercase font-bold text-stone-400",children:new Date(t.dueDate).toLocaleDateString(void 0,{month:"short",day:"numeric"})}),t.progress!==void 0&&e.jsxs("span",{className:"text-[10px] uppercase font-bold text-indigo-500",children:[t.progress,"% Done"]})]})]}),e.jsxs("div",{className:"flex items-start gap-3 min-w-fit",children:[e.jsx("button",{onClick:O=>{O.stopPropagation(),confirm("Are you sure you want to delete this item?")&&g(t.id)},className:"opacity-0 group-hover:opacity-100 p-1 text-stone-300 hover:text-red-500 transition-all",title:"Delete",children:e.jsx(ue,{size:14})}),e.jsxs("div",{className:"mt-1",children:[$==="project"&&e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-stone-900"}),$==="task"&&e.jsx("div",{className:"h-3 w-3 rounded-full border border-stone-300 group-hover:border-emerald-500 transition-colors"}),$==="waiting"&&e.jsx(q,{size:14,className:"text-stone-300 group-hover:text-amber-500"})]})]})]});return e.jsxs("div",{className:"h-full min-h-[600px] flex flex-col font-serif p-6 max-w-[90rem] mx-auto w-full",children:[e.jsx("div",{className:"flex flex-col items-center justify-center mb-8 pb-6 border-b border-stone-100",children:e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold font-serif text-stone-900 uppercase tracking-widest select-none",children:s("gtd.organize")}),e.jsx("p",{className:"text-stone-400 text-xs font-bold uppercase tracking-widest mt-2",children:s("gtd.organize.subtitle")})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide px-2",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-8 pb-12",children:[e.jsx(A,{title:s("gtd.list.projects"),description:s("gtd.list.desc.projects"),icon:K,count:n.filter(t=>t.status==="active").length,newCount:n.filter(t=>t.status==="active"&&W(t.id)).length,color:"text-indigo-500",onAdd:()=>p("project"),addLabel:s("gtd.modal.start_project"),children:n.filter(t=>t.status==="active").map(t=>{const $=t.items.length,O=t.items.filter(J=>{var Y;return((Y=f.find(Q=>Q.id===J))==null?void 0:Y.status)==="done"}).length,B=$>0?Math.round(O/$*100):0;return e.jsx(F,{item:{...t,progress:B},type:"project"},t.id)})}),e.jsx(A,{title:s("gtd.list.next_actions"),description:s("gtd.list.desc.next_actions"),icon:U,count:w.length,newCount:w.filter(t=>W(t.createdAt)).length,color:"text-emerald-500",onAdd:()=>p("action"),addLabel:s("gtd.modal.add_action"),children:w.map(t=>e.jsx(F,{item:t,type:"task"},t.id))}),e.jsx(A,{title:s("gtd.list.waiting_for"),description:s("gtd.list.desc.waiting"),icon:Z,count:i.length,newCount:i.filter(t=>W(t.createdAt)).length,color:"text-amber-500",onAdd:()=>p("waiting"),addLabel:s("gtd.modal.log_waiting"),children:i.map(t=>e.jsx(F,{item:t,type:"waiting"},t.id))}),e.jsxs(A,{title:s("gtd.list.scheduled"),description:s("gtd.list.desc.scheduled"),icon:fe,count:k.length,newCount:k.filter(t=>W(t.createdAt)).length,color:"text-blue-500",children:[k.map(t=>e.jsx("div",{className:"py-3 px-2 border-b border-transparent hover:bg-stone-50 rounded-lg group",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-10 text-center leading-none",children:[e.jsx("span",{className:"block text-[10px] font-bold text-stone-400 uppercase",children:t.dueDate?new Date(t.dueDate).toLocaleDateString(void 0,{month:"short"}):""}),e.jsx("span",{className:"block text-xl font-serif font-bold text-stone-900",children:t.dueDate?new Date(t.dueDate).getDate():""})]}),e.jsx("span",{className:"text-sm font-serif font-medium text-stone-800",children:t.text})]})},t.id)),k.length===0&&e.jsx("span",{className:"text-stone-300 text-xs italic p-2",children:s("gtd.label.nothing_scheduled")})]}),e.jsx(A,{title:s("gtd.list.someday"),description:s("gtd.list.desc.someday"),icon:q,count:l.length,newCount:l.filter(t=>W(t.createdAt)).length,color:"text-stone-400",onAdd:()=>p("someday"),addLabel:s("gtd.modal.add_idea"),children:l.map(t=>e.jsx(F,{item:t,type:"simple"},t.id))}),e.jsx(A,{title:s("gtd.list.reference"),description:s("gtd.list.desc.reference"),icon:$e,count:m.length,newCount:m.filter(t=>W(t.createdAt)).length,color:"text-stone-500",onAdd:()=>p("reference"),addLabel:s("gtd.modal.add_reference"),children:m.map(t=>e.jsx(F,{item:t,type:"simple"},t.id))})]})}),u&&e.jsxs("div",{className:"absolute inset-0 z-50 flex items-center justify-center p-4 bg-stone-900/10 backdrop-blur-sm animate-fade-in",children:[e.jsx("div",{className:"absolute inset-0",onClick:_}),e.jsxs("div",{className:"bg-white rounded-3xl p-8 pb-12 w-full max-w-lg shadow-2xl ring-1 ring-black/5 animate-scale-in relative z-10 overflow-y-auto max-h-[85vh]",children:[e.jsx("h3",{className:"text-2xl font-serif font-bold text-stone-900 mb-6 italic",children:s(u==="project"?"gtd.modal.start_project":u==="action"?"gtd.modal.add_action":u==="someday"?"gtd.list.someday":u==="reference"?"gtd.modal.add_reference":"gtd.modal.log_waiting")}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-stone-400 uppercase tracking-widest mb-2",children:s(u==="project"?"gtd.modal.project_name":"gtd.modal.description")}),e.jsx("input",{autoFocus:!0,type:"text",className:"w-full text-lg font-serif border-b-2 border-stone-100 focus:border-stone-900 outline-none py-2 bg-transparent transition-colors placeholder:text-stone-300 text-stone-800",placeholder:u==="project"?"e.g., Q4 Marketing Strategy":"e.g., Call John about updates",value:I,onChange:t=>z(t.target.value)})]}),u==="waiting"&&e.jsxs("div",{className:"animate-fade-in-up",children:[e.jsx("label",{className:"block text-xs font-bold text-stone-400 uppercase tracking-widest mb-2",children:s("gtd.modal.who_waiting")}),e.jsx("input",{type:"text",className:"w-full text-base font-serif border-b-2 border-stone-100 focus:border-stone-900 outline-none py-2 bg-transparent transition-colors placeholder:text-stone-300 text-stone-800",placeholder:"e.g., Alice, Client, Approval Board",value:c,onChange:t=>T(t.target.value)})]}),e.jsxs("div",{className:"pt-4 border-t border-stone-100 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold text-stone-400 uppercase tracking-widest mb-1",children:s("gtd.modal.due_date")}),e.jsx("input",{type:"date",className:"w-full text-sm font-sans border-b border-stone-100 focus:border-stone-900 outline-none py-1 bg-transparent text-stone-600",value:r,onChange:t=>C(t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold text-stone-400 uppercase tracking-widest mb-1",children:s("gtd.modal.context")}),e.jsx("input",{type:"text",placeholder:"@office, @home",className:"w-full text-sm font-sans border-b border-stone-100 focus:border-stone-900 outline-none py-1 bg-transparent text-stone-600 placeholder:text-stone-300",value:N,onChange:t=>R(t.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold text-stone-400 uppercase tracking-widest mb-2",children:s("gtd.modal.energy")}),e.jsx("div",{className:"flex items-center gap-2",children:["High","Medium","Low"].map(t=>e.jsx("button",{onClick:()=>j(t),className:`px-3 py-1.5 rounded-lg text-xs font-bold uppercase tracking-wider border transition-all ${M===t?"bg-stone-900 text-white border-stone-900":"bg-white text-stone-400 border-stone-200 hover:border-stone-400"}`,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold text-stone-400 uppercase tracking-widest mb-1",children:s("gtd.modal.notes")}),e.jsx("textarea",{className:"w-full text-sm font-serif border border-stone-200 rounded-xl p-3 focus:border-stone-900 outline-none bg-stone-50/50 min-h-[80px] text-stone-700 resize-none",placeholder:"Add any additional details...",value:P,onChange:t=>D(t.target.value)})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-stone-100",children:[e.jsx("button",{onClick:_,className:"px-6 py-3 rounded-xl text-stone-500 font-bold text-xs uppercase tracking-wider hover:bg-stone-50 transition-colors",children:s("gtd.modal.cancel")}),e.jsx("button",{onClick:L,disabled:!I.trim(),className:"px-8 py-3 bg-stone-900 text-white rounded-xl font-bold text-xs uppercase tracking-wider hover:bg-black transition-all shadow-lg hover:shadow-xl disabled:opacity-50 disabled:shadow-none",children:s(u==="project"?"gtd.clarify.create_project":"gtd.modal.add_item")})]})]})]})]})]})},gt=({items:n,projects:f,onUpdate:y,onDelete:x})=>{const[o,g]=d.useState("daily"),[s,w]=d.useState(null),i=(r=>{const C=new Date;if(C.setHours(0,0,0,0),r==="weekly"){const M=C.getDay()||7;M!==1&&C.setHours(-24*(M-1))}else r==="monthly"&&C.setDate(1);return C.getTime()})(o),l=n.filter(r=>r.status==="inbox"),m=n.filter(r=>r.status==="actionable"),u=n.filter(r=>r.status==="waiting"),p=n.filter(r=>r.status==="someday"),I=f.filter(r=>r.status!=="completed"),z=n.filter(r=>r.status==="done").sort((r,C)=>(C.completedAt||0)-(r.completedAt||0)),c=r=>r.filter(C=>(C.createdAt||C.id)>=i).length,T=[{id:"inbox",title:"Inbox",icon:xe,items:l,color:"text-blue-500",statLabel:"New",statCount:c(l)},{id:"actions",title:"Next Actions",icon:U,items:m,color:"text-emerald-500",statLabel:"New",statCount:c(m)},{id:"waiting",title:"Waiting For",icon:Z,items:u,color:"text-amber-500",statLabel:"New",statCount:c(u)},{id:"projects",title:"Active Projects",icon:Ee,items:I.map(r=>({id:r.id,text:r.name,...r})),color:"text-indigo-500",statLabel:"New",statCount:c(I)},{id:"someday",title:"Someday / Maybe",icon:q,items:p,color:"text-stone-400",statLabel:"New",statCount:c(p)},{id:"done",title:"Completed",icon:xe,items:z,color:"text-blue-500",statLabel:"Total",statCount:z.length}];return e.jsxs("div",{className:"h-full min-h-[600px] flex flex-col font-serif p-6 max-w-[90rem] mx-auto w-full",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center mb-8 pb-6 border-b border-stone-100",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold font-serif text-stone-900 uppercase tracking-widest select-none",children:"Reflect"}),e.jsx("p",{className:"text-stone-400 text-xs font-bold uppercase tracking-widest mt-2",children:o==="daily"?"Today's Progress":o==="weekly"?"Weekly Reset":"Monthly Overview"})]}),e.jsx("div",{className:"flex bg-stone-100 p-1 rounded-xl",children:["daily","weekly","monthly"].map(r=>e.jsx("button",{onClick:()=>g(r),className:`px-6 py-2 rounded-lg text-xs font-bold uppercase tracking-wider transition-all ${o===r?"bg-white text-stone-900 shadow-sm":"text-stone-400 hover:text-stone-600"}`,children:r},r))})]}),e.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide px-2",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-8 pb-12",children:T.map(r=>e.jsxs("div",{className:"group",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(r.icon,{size:20,className:`${r.color} opacity-80`}),e.jsx("h3",{className:"text-xl font-serif font-bold text-stone-800",children:r.title}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold uppercase tracking-widest text-stone-400 bg-stone-50 px-2 py-1 rounded-full border border-stone-100",children:[e.jsxs("span",{children:["Total: ",r.items.length]}),r.id!=="done"&&r.statCount>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-stone-300",children:"|"}),e.jsxs("span",{className:r.color,children:[r.statLabel,": ",r.statCount]})]})]})]})}),e.jsxs("div",{className:"space-y-1 pl-2 md:pl-8 border-l border-stone-100 group-hover:border-stone-200 transition-colors max-h-[300px] overflow-y-auto pr-2 scrollbar-thin scrollbar-thumb-stone-200 scrollbar-track-transparent",children:[r.items.length>0?r.items.slice(0,100).map(C=>e.jsxs("div",{className:"flex items-center gap-3 py-2 px-3 rounded-lg hover:bg-stone-50 transition-colors flex-shrink-0 group/item relative",children:[r.id!=="done"&&r.id!=="projects"&&e.jsx("button",{onClick:M=>{M.stopPropagation(),y(C.id,{status:"done"})},className:"flex-shrink-0 w-4 h-4 rounded-full border border-stone-300 hover:border-emerald-500 hover:bg-emerald-50 transition-all flex items-center justify-center group/check",title:"Mark as Done",children:e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 opacity-0 group-hover/check:opacity-100 transition-opacity"})}),(r.id==="done"||r.id==="projects")&&e.jsx("div",{className:`w-1.5 h-1.5 rounded-full flex-shrink-0 ${r.id==="done"?"bg-stone-300":"bg-indigo-300"}`}),e.jsx("span",{className:`text-sm font-serif truncate ${r.id==="done"?"text-stone-400 line-through decoration-stone-200":"text-stone-700"}`,children:C.text}),e.jsx("span",{className:"text-[10px] text-stone-300 font-sans uppercase tracking-wider",children:r.id==="done"?C.completedAt?new Date(C.completedAt).toLocaleDateString(void 0,{month:"short",day:"numeric"}):"":C.createdAt?new Date(C.createdAt).toLocaleDateString(void 0,{month:"short",day:"numeric"}):""}),e.jsxs("div",{className:"ml-auto flex items-center gap-1 opacity-0 group-hover/item:opacity-100 transition-opacity",children:[r.id!=="done"&&e.jsx("button",{onClick:()=>{w(C.id);const M=new Date;M.setDate(M.getDate()+1),M.setHours(9,0,0,0),y(C.id,{dueDate:M.getTime(),status:"actionable"})},className:"p-1 text-stone-300 hover:text-amber-500 transition-colors",title:"Hold for Tomorrow",children:e.jsx(qe,{size:14})}),e.jsx("button",{onClick:()=>{confirm("Delete this item?")&&x(C.id)},className:"p-1 text-stone-300 hover:text-red-500 transition-colors",title:"Delete",children:e.jsx(ue,{size:14})})]})]},C.id)):e.jsxs("div",{className:"py-2 px-3 text-stone-300 text-sm italic",children:["No items ",r.id==="done"?"completed":"in this list","."]}),r.items.length>100&&e.jsxs("div",{className:"py-2 px-3 text-[10px] font-bold text-stone-400 uppercase tracking-widest",children:["+ ",r.items.length-100," more..."]})]})]},r.id))})})]})},ht=({items:n,projects:f,onExport:y})=>{const[x,o]=d.useState("all"),g=n.filter(i=>i.status==="actionable"),s=n.filter(i=>i.status==="done"),w=Array.from(new Set(g.map(i=>i.contextId||"uncategorized")));let k=[];return x==="all"?k=g:x==="completed"?k=s.sort((i,l)=>(l.completedAt||0)-(i.completedAt||0)):k=g.filter(i=>(i.contextId||"uncategorized")===x),e.jsxs("div",{className:"h-full min-h-[600px] flex flex-col font-serif p-6 max-w-[90rem] mx-auto w-full",children:[e.jsx("div",{className:"flex-none text-center mb-6",children:e.jsx("h1",{className:"text-4xl md:text-5xl font-bold font-serif text-stone-900 uppercase tracking-widest select-none",children:"Engage"})}),e.jsx("div",{className:"flex-none mb-6 px-4",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>o("all"),className:`px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider transition-all font-sans border ${x==="all"?"bg-stone-800 text-white border-stone-800":"bg-white text-stone-400 border-stone-200 hover:border-stone-400 hover:text-stone-600"}`,children:"All"}),w.map(i=>e.jsx("button",{onClick:()=>o(i),className:`px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider transition-all font-sans border ${x===i?"bg-stone-800 text-white border-stone-800":"bg-white text-stone-400 border-stone-200 hover:border-stone-400 hover:text-stone-600"}`,children:i},i)),e.jsx("button",{onClick:()=>o("completed"),className:`px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider transition-all font-sans border ${x==="completed"?"bg-stone-800 text-white border-stone-800":"bg-white text-stone-400 border-stone-200 hover:border-stone-400 hover:text-stone-600"}`,children:"Completed"})]})}),e.jsxs("div",{className:"flex-1 w-full min-h-0",children:[e.jsx("div",{className:"max-h-[500px] overflow-y-auto scrollbar-hide px-4 pb-12",children:e.jsx("div",{className:"max-w-2xl mx-auto space-y-3",children:k.length===0?e.jsxs("div",{className:"text-center py-12 text-stone-300",children:[e.jsx("span",{className:"block text-4xl mb-4",children:"☕️"}),e.jsx("p",{className:"italic font-serif text-lg",children:"Nothing here."}),e.jsx("p",{className:"text-sm font-sans",children:"Check other tabs or enjoy your break."})]}):k.map(i=>{const l=f.find(m=>m.id===i.projectId);return e.jsx("div",{className:"group bg-white p-4 rounded-xl border border-stone-200 hover:border-stone-400 shadow-sm hover:shadow-md transition-all cursor-default",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("button",{className:"pt-1 text-stone-300 hover:text-green-600 transition-colors",children:e.jsx(U,{size:24,strokeWidth:1.5})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-xl font-serif italic text-stone-800 mb-2 group-hover:text-black transition-colors leading-tight",children:i.text}),e.jsxs("div",{className:"flex items-center gap-3 text-[10px] font-sans font-bold text-stone-400 uppercase tracking-widest mb-3",children:[e.jsxs("span",{className:"text-stone-500 flex items-center gap-1",children:[e.jsx(K,{size:10}),l?l.name:"Inbox"]}),i.contextId&&e.jsxs("span",{className:"bg-stone-100 px-1.5 py-0.5 rounded text-stone-500",children:["#",i.contextId]}),i.time&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(q,{size:10})," ",i.time]}),i.energy&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ne,{size:10})," ",i.energy]})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t border-stone-100 opacity-60 group-hover:opacity-100 transition-opacity",children:[e.jsxs("button",{onClick:()=>y(i,"task"),className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-stone-50 hover:bg-stone-100 text-stone-400 hover:text-blue-600 transition-all text-xs font-bold uppercase tracking-wider border border-transparent hover:border-stone-200",title:"Send to Task Board",children:[e.jsx(K,{size:14}),e.jsx("span",{children:"Task"})]}),e.jsxs("button",{onClick:()=>y(i,"goal"),className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-stone-50 hover:bg-stone-100 text-stone-400 hover:text-red-500 transition-all text-xs font-bold uppercase tracking-wider border border-transparent hover:border-stone-200",title:"Create Goal",children:[e.jsx(pe,{size:14}),e.jsx("span",{children:"Goal"})]}),e.jsxs("button",{onClick:()=>y(i,"reminder"),className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-stone-50 hover:bg-stone-100 text-stone-400 hover:text-amber-500 transition-all text-xs font-bold uppercase tracking-wider border border-transparent hover:border-stone-200",title:"Set Reminder",children:[e.jsx(Z,{size:14}),e.jsx("span",{children:"Remind"})]}),e.jsxs("button",{onClick:()=>y(i,"discussion"),className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-stone-50 hover:bg-stone-100 text-stone-400 hover:text-purple-500 transition-all text-xs font-bold uppercase tracking-wider border border-transparent hover:border-stone-200",title:"Start Discussion",children:[e.jsx(Oe,{size:14}),e.jsx("span",{children:"Discuss"})]})]})]})]}),i.dueDate&&e.jsx("div",{className:"flex flex-col items-end gap-1",children:e.jsxs("span",{className:"text-xs font-serif italic text-red-500 bg-red-50 px-2 py-1 rounded-md mb-1 whitespace-nowrap",children:["Due ",new Date(i.dueDate).toLocaleDateString(void 0,{month:"short",day:"numeric"})]})})]})},i.id)})})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-12 bg-gradient-to-t from-stone-50/100 to-transparent pointer-events-none"})]})]})},ft=({isOpen:n,onClose:f})=>{if(!n)return null;const y=[{icon:xe,title:"1. Capture",description:"Collect what has your attention. Use the Inbox to write down tasks, ideas, and reminders immediately so you don't forget them.",color:"text-blue-600",bg:"bg-blue-50"},{icon:U,title:"2. Clarify",description:"Process what you've captured. Decide if it's actionable. If yes, decide the next action. If no, trash it, store it for reference, or put it on hold.",color:"text-amber-600",bg:"bg-amber-50"},{icon:K,title:"3. Organize",description:"Put everything in the right place. Add actionable items to your lists (Next Actions, Projects, Waiting For, Calendar).",color:"text-indigo-600",bg:"bg-indigo-50"},{icon:Ce,title:"4. Reflect",description:"Review frequently. Update your lists, clear your mind, and get perspective. Weekly Review is key to keeping the system trusted.",color:"text-emerald-600",bg:"bg-emerald-50"},{icon:ne,title:"5. Engage",description:"Simply do. Use your system to make confident choices about what to do right now, based on context, time, and energy available.",color:"text-orange-600",bg:"bg-orange-50"}];return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-stone-900/40 backdrop-blur-sm animate-fade-in",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl w-full max-w-4xl overflow-hidden relative flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"flex items-center justify-between p-8 pb-4 border-b border-stone-100",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-serif italic text-stone-900 mb-1",children:"Getting Things Done"}),e.jsx("p",{className:"text-sm text-stone-500 font-sans",children:"The art of stress-free productivity."})]}),e.jsx("button",{onClick:f,className:"p-2 rounded-full hover:bg-stone-100 text-stone-500 transition-colors",children:e.jsx(je,{size:24})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-8",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[y.map((x,o)=>e.jsxs("div",{className:"p-6 rounded-2xl border border-stone-100 hover:shadow-lg hover:border-stone-200 transition-all duration-300 group bg-stone-50/50",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl ${x.bg} flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300`,children:e.jsx(x.icon,{size:24,className:x.color})}),e.jsx("h3",{className:"text-xl font-bold text-stone-900 mb-2 font-serif",children:x.title}),e.jsx("p",{className:"text-sm text-stone-600 leading-relaxed",children:x.description})]},o)),e.jsxs("div",{className:"p-6 rounded-2xl bg-stone-900 text-white flex flex-col justify-center items-center text-center",children:[e.jsx("h3",{className:"text-xl font-bold mb-2 font-serif italic",children:"Why GTD?"}),e.jsx("p",{className:"text-sm text-stone-300 leading-relaxed",children:'"Your mind is for having ideas, not holding them."'}),e.jsx("p",{className:"text-xs text-stone-500 mt-2 uppercase tracking-widest font-bold",children:"— David Allen"})]})]})}),e.jsx("div",{className:"p-6 bg-stone-50 border-t border-stone-100 text-center",children:e.jsx("button",{onClick:f,className:"bg-stone-900 text-white px-8 py-3 rounded-xl font-bold uppercase tracking-widest text-xs hover:bg-stone-800 transition-colors shadow-lg hover:shadow-xl hover:-translate-y-0.5 transform",children:"Start Organizing"})})]})})},bt=({isOpen:n,onClose:f,type:y,itemText:x,existingOptions:o,onConfirm:g})=>{const[s,w]=d.useState("new"),[k,i]=d.useState(""),[l,m]=d.useState("");if(d.useEffect(()=>{var T;n&&(i(x),w("new"),m(((T=o[0])==null?void 0:T.id)||""))},[n,x,o]),!n||!y)return null;const u=()=>{switch(y){case"task":return e.jsx(K,{size:24,className:"text-blue-500"});case"goal":return e.jsx(pe,{size:24,className:"text-red-500"});case"reminder":return e.jsx(Z,{size:24,className:"text-amber-500"});case"discussion":return e.jsx(Re,{size:24,className:"text-purple-500"})}},p=()=>{switch(y){case"task":return"Send to Task Board";case"goal":return"Create Goal";case"reminder":return"Set Reminder";case"discussion":return"Start Discussion"}},z=(()=>{switch(y){case"task":return{new:"New Group",existing:"Add to Existing Group",namePlaceholder:"Group Name"};case"goal":return{new:"New Goal",existing:"Add as Sub-goal to",namePlaceholder:"Goal Title"};case"reminder":return{new:"New List",existing:"Add to List",namePlaceholder:"List Name"};case"discussion":return{new:"New Channel",existing:"Post in Channel",namePlaceholder:"Channel Name"}}})(),c=()=>{s==="new"&&!k.trim()||s==="existing"&&!l||g(s,s==="existing"?l:void 0,s==="new"?k:void 0)};return e.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"p-6 border-b border-stone-100 flex items-center justify-between bg-stone-50/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white rounded-xl shadow-sm border border-stone-100",children:u()}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-serif font-bold text-xl text-stone-900",children:p()}),e.jsx("p",{className:"text-xs text-stone-400 font-bold uppercase tracking-wider",children:"Select Destination"})]})]}),e.jsx("button",{onClick:f,className:"p-2 hover:bg-stone-100 rounded-full text-stone-400 transition-colors",children:e.jsx(je,{size:20})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"p-3 bg-stone-50 border border-stone-200 rounded-xl text-stone-700 italic font-serif text-sm",children:['"',x,'"']}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 p-1 bg-stone-100 rounded-xl",children:[e.jsx("button",{onClick:()=>w("new"),className:`py-2 px-4 rounded-lg text-xs font-bold uppercase tracking-wider transition-all ${s==="new"?"bg-white text-stone-900 shadow-sm":"text-stone-400 hover:text-stone-600"}`,children:z.new}),e.jsx("button",{onClick:()=>w("existing"),className:`py-2 px-4 rounded-lg text-xs font-bold uppercase tracking-wider transition-all ${s==="existing"?"bg-white text-stone-900 shadow-sm":"text-stone-400 hover:text-stone-600"}`,children:z.existing})]}),e.jsx("div",{className:"space-y-4",children:s==="new"?e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase tracking-wider text-stone-400 ml-1",children:"Name"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:k,onChange:T=>i(T.target.value),placeholder:z.namePlaceholder,className:"w-full pl-4 pr-4 py-3 bg-white border border-stone-200 focus:border-stone-900 focus:ring-0 rounded-xl text-stone-900 placeholder-stone-300 transition-all font-medium",autoFocus:!0}),e.jsx(we,{size:16,className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-stone-400"})]}),e.jsx("p",{className:"text-[10px] text-stone-400 px-1",children:"Using item text as default. You can rename the container."})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase tracking-wider text-stone-400 ml-1",children:"Select Existing"}),e.jsxs("select",{value:l,onChange:T=>m(T.target.value),className:"w-full px-4 py-3 bg-white border border-stone-200 focus:border-stone-900 focus:ring-0 rounded-xl text-stone-900 cursor-pointer appearance-none",children:[o.length===0?e.jsx("option",{disabled:!0,children:"No options available"}):null,o.map(T=>e.jsx("option",{value:T.id,children:T.name},T.id))]})]})})]}),e.jsxs("div",{className:"p-4 border-t border-stone-100 bg-stone-50 flex justify-end gap-3",children:[e.jsx("button",{onClick:f,className:"px-6 py-2.5 rounded-xl text-xs font-bold uppercase tracking-wider text-stone-400 hover:text-stone-600 hover:bg-stone-200 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:c,className:"px-6 py-2.5 bg-stone-900 hover:bg-black text-white rounded-xl shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all text-xs font-bold uppercase tracking-wider flex items-center gap-2",children:[e.jsx("span",{children:"Confirm Action"}),e.jsx(oe,{size:14})]})]})]})})},H={getItems:async()=>{const n=ie(),f=ee.getCurrentUser();if(!f)return[];const{data:y,error:x}=await se.from("gtd_items").select("*").eq("company_id",n).eq("user_id",f.id);return x?(console.error("Error fetching GTD items:",x),[]):(y||[]).map(o=>({id:Number(o.id),text:o.text,description:o.description,status:o.status,projectId:o.project_id?Number(o.project_id):void 0,contextId:o.context_id,energy:o.energy,time:o.time,dueDate:o.due_date,delegatedTo:o.delegated_to,createdAt:Number(o.created_at),completedAt:o.completed_at?Number(o.completed_at):void 0,parentId:o.parent_id?Number(o.parent_id):void 0}))},saveItem:async n=>{const f=ie(),y=ee.getCurrentUser();if(!y)return;const x={id:n.id.toString(),text:n.text,description:n.description,status:n.status,project_id:n.projectId?n.projectId.toString():void 0,context_id:n.contextId,energy:n.energy,time:n.time,due_date:n.dueDate,delegated_to:n.delegatedTo,created_at:n.createdAt,completed_at:n.completedAt,parent_id:n.parentId?n.parentId.toString():void 0,company_id:f,user_id:y.id},{error:o}=await se.from("gtd_items").upsert(x);if(o)throw console.error("Error saving GTD item:",o),o},deleteItem:async n=>{const{error:f}=await se.from("gtd_items").delete().eq("id",n.toString());f&&console.error("Error deleting GTD item:",f)},getProjects:async()=>{const n=ie(),f=ee.getCurrentUser();if(!f)return[];const{data:y,error:x}=await se.from("gtd_projects").select("*").eq("company_id",n).eq("user_id",f.id);return x?(console.error("Error fetching GTD projects:",x),[]):(y||[]).map(o=>({id:Number(o.id),name:o.name,status:o.status,color:o.color,items:o.items||[]}))},saveProject:async n=>{const f=ie(),y=ee.getCurrentUser();if(!y)return;const x={id:n.id.toString(),name:n.name,status:n.status,color:n.color,items:n.items,company_id:f,user_id:y.id},{error:o}=await se.from("gtd_projects").upsert(x);if(o)throw console.error("Error saving GTD project:",o),o}},jt=({userName:n="User",onOpenQuickTask:f,onOpenDiscussion:y,onOpenNewGoal:x,onOpenReminder:o})=>{const{showToast:g}=De(),{t:s}=me(),[w,k]=d.useState("capture"),[i,l]=d.useState(!1),[m,u]=d.useState([]),[p,I]=d.useState([]);d.useEffect(()=>{(async()=>{const h=await H.getItems(),S=await H.getProjects();u(h),I(S)})()},[]);const[z,c]=d.useState(null),[T,r]=d.useState(new Date),[C,M]=d.useState(null),[j,N]=d.useState("Locating..."),[R,P]=d.useState(!1),[D,L]=d.useState(null),[_,G]=d.useState(null),[W,A]=d.useState([]),F=async(a,h)=>{G(a),L(h);let S=[];h==="task"?S=(await ae.getSpaces()).map(b=>({id:b.id,name:b.name||"Unnamed Space"})):h==="goal"?S=(await X.getGoals()).map(b=>({id:b.id,name:b.title})):h==="reminder"?S=(await de.getLists()).map(b=>({id:b.id,name:b.name})):h==="discussion"&&(S=(await ce.getChannels()).map(b=>({id:b.id,name:b.name}))),A(S),P(!0)},t=async(a,h,S)=>{if(!(!_||!D)){try{if(D==="task"){let v=h;if(a==="new"||!v){const b=await ae.getSpaces();v=b.length>0?b[0].id:"default"}await ae.createTask({title:_.text,status:"Todo",priority:"Normal",dueDate:_.dueDate?new Date(_.dueDate).toISOString():void 0,spaceId:v,assignees:[],tags:[]})}else if(D==="goal"){if(a==="new"&&S)await X.createGoal({title:S,description:_.text,category:"Work",dueDate:new Date(Date.now()+720*60*60*1e3).toISOString().split("T")[0],progress:0,subGoals:[],status:"on-track",priority:"Medium",impact:"Medium"});else if(a==="existing"&&h){const b=(await X.getGoals()).find(E=>E.id===h);if(b){const E={id:Date.now().toString(),title:_.text,completed:!1};await X.updateGoal({...b,subGoals:[...b.subGoals,E]})}}}else if(D==="reminder"){let v=h;a==="new"&&S&&(v=(await de.addList({name:S,type:"project",color:"text-black"})).id),v&&await de.addReminder({title:_.text,listId:v,dueDate:_.dueDate?new Date(_.dueDate).toISOString().split("T")[0]:void 0,priority:"none",tags:[],completed:!1,subtasks:[]})}else if(D==="discussion"){let v=h;if(a==="new"&&S&&(v=(await ce.createChannel(S,[])).id),v){const b=ee.getCurrentUser(),E=(b==null?void 0:b.id)||"u1";await ce.sendMessage(v,`Added from Engage: ${_.text}`,E)}}}catch(v){console.error("Export failed",v)}P(!1)}};d.useEffect(()=>{const a=setInterval(()=>r(new Date),6e4);return()=>clearInterval(a)},[]),d.useEffect(()=>{if(!navigator.geolocation){N("Location unavailable");return}navigator.geolocation.getCurrentPosition(async a=>{const{latitude:h,longitude:S}=a.coords;try{const b=await(await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${h}&longitude=${S}&current=temperature_2m,weather_code`)).json();b.current&&M({temp:b.current.temperature_2m,code:b.current.weather_code});const ge=await(await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${h}&longitude=${S}&localityLanguage=en`)).json(),Te=ge.city||ge.locality||"Unknown Location",ye=ge.principalSubdivisionCode||"";N(`${Te}${ye?`, ${ye}`:""}`)}catch(v){console.error("Failed to fetch weather/location",v),N("Weather unavailable")}},a=>{console.warn("Location permission denied",a),N("Location denied")})},[]);const $=a=>a===0||a===1?e.jsx(Fe,{size:10}):a===2||a===3?e.jsx(Ke,{size:10}):a>=51&&a<=67?e.jsx(nt,{size:10}):a>=71&&a<=77?e.jsx(lt,{size:10}):a>=95?e.jsx(at,{size:10}):e.jsx(ke,{size:10}),O=m.filter(a=>a.status==="inbox").sort((a,h)=>h.createdAt-a.createdAt);m.filter(a=>a.status==="actionable"&&!a.dueDate),m.filter(a=>(a.status==="actionable"||a.status==="waiting")&&a.dueDate).sort((a,h)=>(a.dueDate||0)-(h.dueDate||0)),m.filter(a=>a.status==="waiting"),m.filter(a=>a.status==="someday"),m.filter(a=>a.status==="reference");const B=a=>{const h=a.toLowerCase();let S="inbox",v=a,b=!1;if(h.startsWith("@task ")?(S="actionable",v=a.slice(6)):h.startsWith("@project ")?(b=!0,v=a.slice(9)):h.startsWith("@waiting ")?(S="waiting",v=a.slice(9)):h.startsWith("@someday ")?(S="someday",v=a.slice(9)):h.startsWith("@read ")&&(S="reference",v=a.slice(6)),b){const E={id:Date.now(),name:v,status:"active",items:[]};I([E,...p]),H.saveProject(E).catch(()=>{g("Failed to save project!","error")})}else{const E={id:Date.now(),text:v,status:S,createdAt:Date.now()};u([E,...m]),H.saveItem(E).catch(()=>{g("Failed to save item!","error")})}},J=(a,h)=>{let S;u(m.map(v=>{if(v.id===a){const E=h.status==="done"&&v.status!=="done";return S={...v,...h,completedAt:E?Date.now():v.completedAt},S}return v})),S&&H.saveItem(S),a===z&&(m.filter(v=>v.status==="inbox"&&v.id!==a),O.findIndex(v=>v.id===a)+1,c(null))},Y=(a,h=[])=>{const S={id:Date.now(),name:a,status:"active",items:[]},v=h.map((b,E)=>({id:Date.now()+E+1,text:b,status:"actionable",projectId:S.id,createdAt:Date.now()}));X.createGoal({title:a,category:"Work",dueDate:new Date(Date.now()+10080*60*1e3).toISOString().split("T")[0],progress:0,subGoals:h.map((b,E)=>({id:`${Date.now()}_${E}`,title:b,completed:!1})),status:"on-track",priority:"Medium",impact:"Medium",description:"Generated from GTD Project"}).catch(b=>console.error("Failed to sync project to goals",b)),I([...p,S]),u([...m,...v]),H.saveProject(S),v.forEach(b=>H.saveItem(b))},Q=a=>{u(m.filter(h=>h.id!==a)),H.deleteItem(a)},re=a=>{const h={id:Date.now(),text:a.text||"",status:a.status||"inbox",createdAt:Date.now(),projectId:a.projectId,delegatedTo:a.delegatedTo,dueDate:a.dueDate};u([h,...m]),H.saveItem(h)},le=async a=>{try{const h=await ae.getSpaces(),S=h.length>0?h[0].id:"default";await ae.createTask({title:a,status:"Todo",priority:"Normal",spaceId:S,dueDate:new Date().toISOString(),assignees:[],tags:[]}),g("Task created!","success")}catch(h){console.error("Failed to export to Task Board",h),g("Failed to create task","error")}},Se=()=>{switch(w){case"capture":return e.jsx(mt,{items:m,projects:p,onCapture:B,onSelect:b=>{c(b),k("clarify")},onDelete:Q});case"clarify":const a=O.findIndex(b=>{var E;return b.id===(z||((E=O[0])==null?void 0:E.id))}),h=z?m.find(b=>b.id===z):O[0],S=()=>{a<O.length-1&&c(O[a+1].id)},v=()=>{a>0&&c(O[a-1].id)};return e.jsx(ut,{item:h,onProcess:J,onCreateProject:Y,onNavigate:b=>k(b),onExportToBoard:le,projects:p,hasMore:O.length>0,onNext:S,onPrev:v,canNext:a<O.length-1,canPrev:a>0});case"organize":return e.jsx(pt,{projects:p,items:m,onUpdateItem:J,onAddProject:Y,onAddItem:re,onDelete:Q});case"review":return e.jsx(gt,{items:m,projects:p,onUpdate:J,onDelete:Q});case"engage":return e.jsx(ht,{items:m,projects:p,onExport:F});default:return null}},Ie=[{id:"capture",label:s("gtd.capture"),icon:xe,color:"text-blue-600",count:O.length},{id:"clarify",label:s("gtd.clarify"),icon:U,color:"text-amber-600",count:z?1:0},{id:"organize",label:s("gtd.organize"),icon:K,color:"text-indigo-600",count:0},{id:"review",label:s("gtd.reflect"),icon:Ce,color:"text-emerald-600",count:0},{id:"engage",label:s("gtd.engage"),icon:ne,color:"text-orange-600",count:0}];return e.jsxs("div",{className:"min-h-[600px] h-fit w-full bg-stone-50 rounded-[2.5rem] p-6 shadow-inner ring-1 ring-stone-900/5 flex flex-col font-serif relative",children:[e.jsx("div",{className:"absolute inset-0 opacity-[0.03] pointer-events-none bg-[url('https://www.transparenttextures.com/patterns/notebook.png')]"}),e.jsx("div",{className:"flex-none pt-10 pb-6 z-10 relative px-8",children:e.jsxs("div",{className:"flex items-end justify-between w-full mb-8",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-4xl md:text-5xl font-serif italic text-stone-900 tracking-tight leading-none mb-2",children:[(()=>{const a=T.getHours();return a<12?s("gtd.greeting.morning"):a<18?s("gtd.greeting.afternoon"):s("gtd.greeting.evening")})(),", ",n.split(" ")[0]]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs font-bold font-sans text-stone-400 uppercase tracking-widest ps-1",children:[e.jsx("span",{children:T.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}),e.jsx("span",{children:"•"}),e.jsx("span",{children:T.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric"})}),e.jsx("span",{children:"•"}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ge,{size:10})," ",j]}),e.jsx("span",{children:"•"}),e.jsxs("span",{className:"flex items-center gap-1",children:[C?$(C.code):e.jsx(ke,{size:10}),C?`${Math.round(C.temp)}°C`:"--°C"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 pb-2",children:[e.jsxs("button",{onClick:f,className:"bg-white border border-stone-200 text-stone-900 px-5 py-2.5 rounded-xl shadow-sm hover:bg-stone-50 hover:-translate-y-0.5 transition-all text-xs font-bold tracking-widest uppercase flex items-center gap-2",children:[e.jsx(we,{size:14,strokeWidth:2,className:"text-stone-400"}),e.jsx("span",{children:s("gtd.action.task")})]}),e.jsxs("button",{onClick:y,className:"bg-white border border-stone-200 text-stone-900 px-5 py-2.5 rounded-xl shadow-sm hover:bg-stone-50 hover:-translate-y-0.5 transition-all text-xs font-bold tracking-widest uppercase flex items-center gap-2",children:[e.jsx(ne,{size:14,strokeWidth:2,className:"text-stone-400"}),e.jsx("span",{children:s("gtd.action.discussion")})]}),e.jsxs("button",{onClick:x,className:"bg-white border border-stone-200 text-stone-900 px-5 py-2.5 rounded-xl shadow-sm hover:bg-stone-50 hover:-translate-y-0.5 transition-all text-xs font-bold tracking-widest uppercase flex items-center gap-2",children:[e.jsx(pe,{size:14,strokeWidth:2,className:"text-stone-400"}),e.jsx("span",{children:s("gtd.action.new_goal")})]}),e.jsxs("button",{onClick:o,className:"bg-white border border-stone-200 text-stone-900 px-5 py-2.5 rounded-xl shadow-sm hover:bg-stone-50 hover:-translate-y-0.5 transition-all text-xs font-bold tracking-widest uppercase flex items-center gap-2",children:[e.jsx(Z,{size:14,strokeWidth:2,className:"text-stone-400"}),e.jsx("span",{children:s("gtd.action.reminder")})]})]})]})}),e.jsx("div",{className:"text-center mb-10 mt-16",children:e.jsxs("h1",{className:"text-3xl font-serif italic text-stone-900 tracking-tight flex items-center justify-center gap-3",children:[s("gtd.title"),e.jsx("button",{onClick:()=>l(!0),className:"p-1.5 rounded-full bg-stone-100/50 text-stone-400 hover:text-stone-600 hover:bg-stone-200 transition-colors",title:"How it works",children:e.jsx(We,{size:16,strokeWidth:2.5})})]})}),e.jsx("div",{className:"flex justify-center relative z-20",children:e.jsx("div",{className:"flex items-center space-x-2",children:Ie.map(a=>{const h=w===a.id,S=a.icon;return e.jsxs("button",{onClick:()=>k(a.id),className:`
                                            relative px-8 py-2.5 rounded-xl flex items-center gap-2.5 transition-all duration-300
                                            ${h?"bg-white text-stone-900 shadow-sm ring-1 ring-stone-900/5":"text-stone-400 hover:text-stone-600 hover:bg-stone-200/50"}
                                        `,children:[e.jsx(S,{size:16,strokeWidth:h?2.5:2,className:h?a.color:"text-stone-400"}),e.jsx("span",{className:"text-[11px] font-bold tracking-widest uppercase opacity-100",children:a.label}),a.count>0&&e.jsx("span",{className:`flex h-4 min-w-[1rem] px-1 items-center justify-center rounded-full text-[9px] font-extrabold ${h?"bg-stone-900 text-white":"bg-stone-200 text-stone-500"}`,children:a.count})]},a.id)})})}),e.jsx("div",{className:"flex-1 flex bg-white/30 relative",children:e.jsx("div",{className:"flex-1 w-full relative z-10",children:Se()})}),e.jsx(ft,{isOpen:i,onClose:()=>l(!1)}),e.jsx(bt,{isOpen:R,onClose:()=>P(!1),type:D,itemText:(_==null?void 0:_.text)||"",existingOptions:W,onConfirm:t})]})},wt=()=>{const[n,f]=d.useState("weekly"),x=n==="weekly"?{xAxis:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],data:[12,19,15,22,28,14,10]}:n==="monthly"?{xAxis:["Week 1","Week 2","Week 3","Week 4"],data:[65,82,70,95]}:{xAxis:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],data:[220,240,280,250,310,350,340,380,410,450,430,480]},o={tooltip:{trigger:"axis",backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:"#e7e5e4",textStyle:{color:"#1c1917"},padding:[10,14],formatter:"{b}: <b>{c} Tasks</b>"},grid:{left:"3%",right:"4%",bottom:"3%",top:"15%",containLabel:!0},xAxis:{type:"category",data:x.xAxis,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#a8a29e",fontSize:11,fontFamily:"serif"}},yAxis:{type:"value",splitLine:{lineStyle:{color:"#f5f5f4",type:"dashed"}},axisLabel:{color:"#a8a29e",fontSize:11,fontFamily:"serif"}},series:[{data:x.data,type:"bar",showBackground:!0,backgroundStyle:{color:"#fafaf9",borderRadius:[4,4,0,0]},itemStyle:{color:"#1c1917",borderRadius:[4,4,0,0]},barWidth:n==="yearly"?"40%":"30%"}]},g=({title:s,value:w,trend:k,isPositive:i,icon:l,color:m="stone"})=>{const u={stone:"bg-white",emerald:"bg-emerald-50/50",indigo:"bg-indigo-50/50",amber:"bg-amber-50/50"},p={stone:"text-stone-900",emerald:"text-emerald-600",indigo:"text-indigo-600",amber:"text-amber-600"};return e.jsxs("div",{className:`${u[m]} p-5 rounded-3xl border border-stone-100 shadow-sm flex flex-col justify-between h-full group hover:shadow-md transition-all`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("div",{className:"p-2 rounded-xl bg-white shadow-sm border border-stone-50",children:e.jsx(l,{size:18,className:p[m]})}),e.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded-lg text-[10px] font-bold ${i?"bg-emerald-100/50 text-emerald-700":"bg-rose-100/50 text-rose-700"}`,children:[i?e.jsx(Xe,{size:10}):e.jsx(tt,{size:10}),k]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-serif font-bold text-stone-900",children:w}),e.jsx("div",{className:"text-xs font-bold text-stone-400 tracking-wide uppercase mt-1",children:s})]})]})};return e.jsx("div",{className:"w-full mt-6 animate-fade-in-up delay-100",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-auto lg:h-[320px]",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white rounded-3xl p-6 border border-stone-100 shadow-sm flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-stone-50 rounded-xl",children:e.jsx(Ue,{size:20,className:"text-stone-900"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-serif font-bold text-lg text-stone-900 italic",children:"Productivity Trends"}),e.jsx("p",{className:"text-xs text-stone-400 font-medium",children:"Tasks completed over time"})]})]}),e.jsx("div",{className:"flex bg-stone-100 p-1 rounded-xl",children:["weekly","monthly","yearly"].map(s=>e.jsx("button",{onClick:()=>f(s),className:`px-4 py-1.5 text-xs font-bold rounded-lg transition-all capitalize ${n===s?"bg-white text-stone-900 shadow-sm":"text-stone-500 hover:text-stone-700 hover:bg-stone-200/50"}`,children:s},s))})]}),e.jsx("div",{className:"flex-1 min-h-[200px] w-full",children:e.jsx(Ze,{option:o,style:{height:"100%",width:"100%"},opts:{renderer:"svg"}})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 h-full",children:[e.jsx(g,{title:"Completed",value:"128",trend:"+12%",isPositive:!0,icon:U,color:"emerald"}),e.jsx(g,{title:"Focus Hours",value:"32h",trend:"+4%",isPositive:!0,icon:ne,color:"indigo"}),e.jsx(g,{title:"Pending",value:"14",trend:"-2%",isPositive:!0,icon:q,color:"amber"}),e.jsx(g,{title:"Goals Met",value:"3/5",trend:"On Track",isPositive:!0,icon:pe,color:"stone"})]})]})})},vt=({isOpen:n,onClose:f,onGoalCreated:y})=>{const[x,o]=d.useState(""),[g,s]=d.useState("Work"),[w,k]=d.useState(""),[i,l]=d.useState("Medium"),[m,u]=d.useState(""),[p,I]=d.useState(!1);if(!n)return null;const z=async()=>{if(!x.trim())return;const c={title:x,category:g,dueDate:w||new Date().toISOString().split("T")[0],progress:0,subGoals:[],status:"on-track",priority:i,impact:"Medium",description:m};try{const T=await X.createGoal(c);y&&y(T),o(""),s("Work"),k(""),l("Medium"),u(""),f()}catch(T){console.error("Failed to save goal",T),alert("Failed to save goal. Please check the server connection.")}};return e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-8",children:[e.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm",onClick:()=>{f(),I(!1)}}),e.jsxs("div",{className:"relative w-full max-w-[600px] bg-white p-12 shadow-[0_20px_50px_rgba(0,0,0,0.1)] animate-in zoom-in-95 duration-300 rounded-[2px]",onClick:()=>I(!1),children:[e.jsx("h2",{className:"text-[32px] font-serif text-gray-900 leading-tight mb-2",children:"Create New Goal"}),e.jsx("p",{className:"text-[16px] text-gray-500 italic font-serif mb-10",children:"What's the next big milestone?"}),e.jsxs("div",{className:"space-y-8",onClick:c=>c.stopPropagation(),children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-[0.2em] text-gray-400 block mb-3",children:"Goal Title"}),e.jsx("input",{type:"text",className:"w-full text-2xl font-serif text-gray-900 pb-2 border-b-2 border-gray-900 focus:border-black focus:outline-none placeholder:text-gray-300",placeholder:"Enter goal...",value:x,onChange:c=>o(c.target.value),autoFocus:!0})]}),e.jsxs("div",{className:"flex gap-12",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-[0.2em] text-gray-400 block mb-4",children:"Category"}),e.jsx("div",{className:"flex flex-col gap-3",children:["WORK","PERSONAL","HEALTH"].map(c=>e.jsx("button",{onClick:()=>s(c.charAt(0)+c.slice(1).toLowerCase()),className:`px-4 py-3 text-[11px] font-bold uppercase tracking-widest text-left w-full transition-all border ${g.toUpperCase()===c?"bg-black text-white border-black":"bg-white text-gray-400 border-gray-200 hover:border-gray-900 hover:text-gray-900"}`,children:c},c))})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-[0.2em] text-gray-400 block mb-4",children:"Priority"}),e.jsx("div",{className:"flex flex-col gap-3",children:["HIGH","MEDIUM","LOW"].map(c=>e.jsx("button",{onClick:()=>l(c.charAt(0)+c.slice(1).toLowerCase()),className:`px-4 py-3 text-[11px] font-bold uppercase tracking-widest text-left w-full transition-all border ${i.toUpperCase()===c?"bg-black text-white border-black":"bg-white text-gray-400 border-gray-200 hover:border-gray-900 hover:text-gray-900"}`,children:c},c))})]})]}),e.jsxs("div",{className:"pt-2 relative",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-[0.2em] text-gray-400 block mb-3",children:"Target Date"}),e.jsx("button",{onClick:c=>{c.stopPropagation(),I(!p)},className:"w-full text-left text-lg font-serif text-gray-900 pb-2 border-b border-gray-200 hover:border-black focus:outline-none transition-colors",children:w?new Date(w).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}):e.jsx("span",{className:"text-gray-300",children:"MM/DD/YYYY"})}),p&&e.jsx("div",{className:"absolute top-full left-0 mt-4 z-[60] shadow-2xl",children:e.jsx(ve,{date:w,onSelect:c=>{k(c),I(!1)},onClose:()=>I(!1),compact:!0,className:"shadow-2xl border border-gray-100"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-[0.2em] text-gray-400 block mb-3",children:"Description (Optional)"}),e.jsx("textarea",{className:"w-full text-base font-serif text-gray-600 pb-2 border-b border-gray-200 focus:border-black focus:outline-none resize-none h-24 bg-transparent",placeholder:"Add some context or success criteria...",value:m,onChange:c=>u(c.target.value)})]}),e.jsxs("div",{className:"flex justify-between items-center pt-8 mt-4",children:[e.jsx("button",{onClick:f,className:"text-xs font-bold uppercase tracking-widest text-gray-400 hover:text-black transition-colors",children:"Cancel"}),e.jsx("button",{onClick:z,className:"px-8 py-4 bg-black text-white text-xs font-bold uppercase tracking-[0.2em] hover:bg-gray-800 transition-colors shadow-lg",children:"Save Goal"})]})]})]})]})},yt=({isOpen:n,onClose:f})=>{const[y,x]=d.useState(""),[o,g]=d.useState(""),[s,w]=d.useState(""),[k,i]=d.useState("none"),[l,m]=d.useState(!1);if(!n)return null;const u=()=>{y.trim()&&(de.addReminder({title:y,notes:o,dueDate:s||"Today",priority:k,listId:"inbox",tags:[],completed:!1,subtasks:[]}),x(""),g(""),w(""),i("none"),f())};return e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-8",children:[e.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm",onClick:()=>{f(),m(!1)}}),e.jsxs("div",{className:"relative w-full max-w-[500px] bg-white p-8 shadow-[0_20px_50px_rgba(0,0,0,0.1)] animate-in zoom-in-95 duration-300 rounded-2xl border border-stone-100",onClick:()=>m(!1),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-3 bg-stone-100 rounded-xl text-stone-900",children:e.jsx(Z,{size:20})}),e.jsx("h2",{className:"text-2xl font-serif text-stone-900",children:"Set Reminder"})]}),e.jsxs("div",{className:"space-y-6",onClick:p=>p.stopPropagation(),children:[e.jsx("div",{children:e.jsx("input",{type:"text",className:"w-full text-xl font-serif text-stone-900 pb-2 border-b border-stone-200 focus:border-stone-900 focus:outline-none placeholder:text-stone-300 transition-colors",placeholder:"Remind me to...",value:y,onChange:p=>x(p.target.value),autoFocus:!0})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-stone-400 block mb-2",children:"When"}),e.jsxs("button",{onClick:p=>{p.stopPropagation(),m(!l)},className:"w-full flex items-center gap-2 p-3 bg-stone-50 hover:bg-stone-100 rounded-lg text-sm text-stone-700 font-medium transition-colors text-left",children:[e.jsx(q,{size:14,className:"text-stone-400"}),s?new Date(s).toLocaleDateString():"Today"]}),l&&e.jsx("div",{className:"absolute top-full left-0 mt-2 z-[60] shadow-xl",children:e.jsx(ve,{date:s,onSelect:p=>{w(p),m(!1)},onClose:()=>m(!1),compact:!0,className:"shadow-xl border border-stone-100"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-stone-400 block mb-2",children:"Priority"}),e.jsx("div",{className:"flex bg-stone-50 rounded-lg p-1",children:["none","high"].map(p=>e.jsx("button",{onClick:()=>i(p),className:`flex-1 py-2 text-[10px] font-bold uppercase tracking-wider rounded-md transition-all ${k===p?"bg-white shadow-sm text-stone-900":"text-stone-400 hover:text-stone-600"}`,children:p==="none"?"Normal":"Urgent"},p))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-stone-400 block mb-2",children:"Notes"}),e.jsx("textarea",{className:"w-full text-sm font-sans text-stone-600 p-3 bg-stone-50 rounded-lg border border-transparent focus:bg-white focus:border-stone-200 focus:outline-none resize-none h-20 transition-all placeholder:text-stone-300",placeholder:"Add details...",value:o,onChange:p=>g(p.target.value)})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{onClick:f,className:"px-6 py-3 text-xs font-bold uppercase tracking-widest text-stone-500 hover:bg-stone-50 rounded-xl transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:u,className:"px-8 py-3 bg-stone-900 text-white text-xs font-bold uppercase tracking-widest hover:bg-black rounded-xl shadow-lg transition-colors flex items-center gap-2",children:[e.jsx(Z,{size:14,className:"text-stone-300"}),"Set Reminder"]})]})]})]})]})},Nt="available_rooms",Kt=({cards:n=[],onUpdateCard:f=g=>{},onRemoveCard:y=g=>{},onOpenCustomize:x=()=>{},userName:o="User"})=>{var R;const{showToast:g}=De(),{setActivePage:s}=He(),[w,k]=d.useState(!1),[i,l]=d.useState(!1),[m,u]=d.useState(!1),[p,I]=d.useState(!1),[z,c]=d.useState([]);Be.useEffect(()=>{(()=>{try{const D=localStorage.getItem(Nt);D&&c(JSON.parse(D))}catch(D){console.error("Failed to load rooms for QuickTask",D)}})()},[]);const T=((R=be.groups[0])==null?void 0:R.columns)||[],r=P=>{console.log("Debug: Handle Send",P);try{const D=ee.getCurrentUser(),L=D?`taskboard-${D.id}`:"taskboard-default";console.log("Debug: Sending tasks to",L);const _=localStorage.getItem(L);let G=_?JSON.parse(_):{id:"main",name:"My Tasks",groups:[],columns:[],users:[],version:1};console.log("Debug: Main board before merge",G),(P.groups||[]).map(A=>({...A,id:A.id||crypto.randomUUID(),title:A.title||"Quick Tasks",color:A.color||"#579bfc",columns:Array.isArray(A.columns)&&A.columns.length?A.columns:T,tasks:Array.isArray(A.tasks)?A.tasks:[]})).forEach(A=>{if(A.tasks.length>0){const F=A.title||"Quick Tasks",t=G.groups.findIndex($=>$.title===F);if(t>=0){const $=G.groups[t],O=A.tasks.map(B=>({...B,id:B.id||crypto.randomUUID()}));$.tasks=[...$.tasks,...O],G.groups[t]=$}else{const $={...A,id:crypto.randomUUID(),title:F,tasks:[...A.tasks]};G.groups=[$,...G.groups]}}}),localStorage.setItem(L,JSON.stringify(G)),console.log("Debug: Saved to localStorage",L,G),g("Tasks sent to My Tasks successfully","success"),s("tasks"),window.dispatchEvent(new CustomEvent("local-storage-update",{detail:{key:L}})),window.dispatchEvent(new Event("storage"))}catch(D){console.error("Failed to merge to main tasks",D),g("Failed to send tasks","error")}},C=(P,D)=>{try{const L=`room_board_${D.id}`,_=localStorage.getItem(L);let G=_?JSON.parse(_):{id:D.id,name:D.name,groups:[],columns:[],users:[],version:1};P.groups.forEach(W=>{if(W.tasks.length>0){let A=G.groups.find(F=>F.title===W.title);A||(A={...W,id:crypto.randomUUID(),tasks:[]},G.groups.push(A)),A.tasks=[...A.tasks,...W.tasks]}}),localStorage.setItem(L,JSON.stringify(G)),g(`Tasks sent to ${D.name}`,"success"),window.dispatchEvent(new CustomEvent("local-storage-update",{detail:{key:L}})),window.dispatchEvent(new Event("storage"))}catch(L){console.error("Failed to send to room",L),g("Failed to send to room","error")}},M=(P,D)=>{if(l(!1),D.type==="main")r(P);else if(D.type==="room"&&D.roomId){const L=z.find(_=>_.id===D.roomId);L?C(P,L):g("Room not found","error")}},j=()=>{k(!0)},N=async(P,D)=>{try{const L=await ce.createChannel(P,D);g("Discussion created successfully!","success"),localStorage.setItem("autoOpenChannelId",L.id),k(!1),s("discussion")}catch(L){console.error("Failed to create discussion:",L),g("Failed to create discussion","error")}};return e.jsxs("div",{className:"flex-1 bg-brand-surface flex flex-col h-full overflow-hidden relative",children:[e.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide w-full h-full bg-white relative",children:e.jsx("div",{className:"w-full mx-auto p-4 pb-48 flex flex-col h-full min-h-[800px]",children:e.jsxs("div",{className:"flex-1 w-full animate-fade-in-up",children:[e.jsx(jt,{userName:o,onOpenQuickTask:()=>l(!0),onOpenDiscussion:j,onOpenNewGoal:()=>u(!0),onOpenReminder:()=>I(!0)}),e.jsx(wt,{})]})})}),e.jsx(xt,{isOpen:i,onClose:()=>l(!1),onSend:M,rooms:z,darkMode:!1}),e.jsx(Ye,{isOpen:w,onClose:()=>k(!1),onCreate:N}),e.jsx(vt,{isOpen:m,onClose:()=>u(!1)}),e.jsx(yt,{isOpen:p,onClose:()=>I(!1)})]})};export{Kt as default};
