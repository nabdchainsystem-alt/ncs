import{c as M,r as z,V as ie,R as we,j as e,L as Mt,Z as es,a4 as ts,ay as ss,T as Ke,X as Oe,$ as Ve,m as dt,a6 as xt,u as rs,N as ut,q as be,n as gt,P as He,S as ns,ai as as,ac as mt,h as is,k as ht,an as pt,ag as os,a8 as ls,aK as yt,M as cs,Q as ft,aP as ds,E as xs,I as us,W as gs,Y as it,aw as ms,af as hs}from"./index-DYCMOhyY.js";import{T as Se}from"./index-Ca_DMGSD.js";import{b as ps,c as ys,L as bt,P as fs,S as bs,C as ws}from"./TaskBoardIcons-jR9B2fMY.js";import{D as vs}from"./DatePicker-BjEDCiA7.js";import{C as wt}from"./copy-D3xr8-w6.js";import{r as js}from"./remindersService-D0e1lVE8.js";import{g as Ns}from"./goalsService-CuNe5Z76.js";import{u as $s,S as Cs,v as Ss,a as Ds}from"./sortable.esm-CO2260nM.js";import{C as zs,u as ks,a as ot,T as Is,M as Ps,D as As,g as _s,b as Es,d as Ts}from"./core.esm-Dtb28RSd.js";import{L as Fs}from"./list-CfCVgUkr.js";import{L as Vs}from"./list-ordered-DZ4kicST.js";import{F as vt}from"./flag-Q3wn5sWP.js";import{G as Os}from"./grip-vertical-Cd79Tdtl.js";import{P as Rs}from"./phone-BtP1w4K8.js";import{S as jt}from"./star-lcAsu_-e.js";import{C as lt}from"./corner-down-right-D9UHXAv6.js";import{T as Ls}from"./tag-Dug0Eb5H.js";import{A as Gs}from"./circle-plus-kLkXezsw.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Hs=M("archive",Bs);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M20 8h-5",key:"1vsyxs"}],["path",{d:"M15 10V6.5a2.5 2.5 0 0 1 5 0V10",key:"ag13bf"}],["path",{d:"M15 14h5l-5 6h5",key:"ur5jdg"}]],Ws=M("arrow-down-a-z",Us);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=[["path",{d:"M3 19V5",key:"rwsyhb"}],["path",{d:"m13 6-6 6 6 6",key:"1yhaz7"}],["path",{d:"M7 12h14",key:"uoisry"}]],Js=M("arrow-left-to-line",qs);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=[["path",{d:"M17 12H3",key:"8awo09"}],["path",{d:"m11 18 6-6-6-6",key:"8c2y43"}],["path",{d:"M21 5v14",key:"nzette"}]],Xs=M("arrow-right-to-line",Ys);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M15 4h5l-5 6h5",key:"8asdl1"}],["path",{d:"M15 20v-3.5a2.5 2.5 0 0 1 5 0V20",key:"r6l5cz"}],["path",{d:"M20 18h-5",key:"18j1r2"}]],Qs=M("arrow-up-z-a",Ks);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]],Ms=M("heading-1",Zs);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]],tr=M("heading-2",er);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sr=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]],rr=M("heading-3",sr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nr=[["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17 10v3a1 1 0 0 0 1 1h3",key:"tj5zdr"}],["path",{d:"M21 10v8",key:"1kdml4"}],["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}]],ar=M("heading-4",nr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],Nt=M("maximize-2",ir);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const or=[["path",{d:"M14 14a2 2 0 0 0 2-2V8h-2",key:"1r06pg"}],["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}],["path",{d:"M8 14a2 2 0 0 0 2-2V8H8",key:"1jzu5j"}]],lr=M("message-square-quote",or);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cr=[["path",{d:"M18 8L22 12L18 16",key:"1r0oui"}],["path",{d:"M2 12H22",key:"1m8cig"}]],ct=M("move-right",cr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dr=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]],xr=M("pin",dr);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]],gr=M("quote",ur);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mr=[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],hr=M("toggle-left",mr);var P=(t=>(t.New="New",t.Pending="Pending",t.Working="Working on it",t.Stuck="Stuck",t.AlmostFinish="Almost Finish",t.Done="Done",t))(P||{}),Z=(t=>(t.Normal="Normal",t.Low="Low",t.Medium="Medium",t.High="High",t.Urgent="Urgent",t))(Z||{});const Qe={New:"bg-gradient-to-r from-[#A0A5B9] to-[#8D92A6] text-white shadow-sm",Pending:"bg-gradient-to-r from-[#FFD940] to-[#FFCC00] text-white shadow-sm","Working on it":"bg-gradient-to-r from-[#FFBE66] to-[#FFA533] hover:from-[#FFA533] hover:to-[#FF991F] text-white shadow-sm",Stuck:"bg-gradient-to-r from-[#FF7085] to-[#FF526B] hover:from-[#FF526B] hover:to-[#FF3352] text-white shadow-sm","Almost Finish":"bg-gradient-to-r from-[#C48AF0] to-[#B06CE0] text-white shadow-sm",Done:"bg-gradient-to-r from-[#33D995] to-[#00C875] hover:from-[#00C875] hover:to-[#00B067] text-white shadow-sm"},pr={New:"bg-gradient-to-r from-slate-700 to-slate-600 text-white shadow-sm border border-white/10",Pending:"bg-gradient-to-r from-yellow-700 to-yellow-600 text-white shadow-sm border border-white/10","Working on it":"bg-gradient-to-r from-orange-700 to-orange-600 text-white shadow-sm border border-white/10",Stuck:"bg-gradient-to-r from-red-700 to-red-600 text-white shadow-sm border border-white/10","Almost Finish":"bg-gradient-to-r from-purple-700 to-purple-600 text-white shadow-sm border border-white/10",Done:"bg-gradient-to-r from-emerald-700 to-emerald-600 text-white shadow-sm border border-white/10"},Ie={Normal:"bg-gradient-to-r from-[#D9D9D9] to-[#C4C4C4] text-white shadow-sm",Low:"bg-gradient-to-r from-[#82B4FF] to-[#579BFC] text-white shadow-sm",Medium:"bg-gradient-to-r from-[#FFBE66] to-[#FFA533] text-white shadow-sm",High:"bg-gradient-to-r from-[#7048C4] to-[#552CB0] text-white shadow-sm",Urgent:"bg-gradient-to-r from-[#FF7085] to-[#FF526B] text-white shadow-sm"},yr={Normal:"bg-gradient-to-r from-slate-700 to-slate-600 text-white shadow-sm border border-white/10",Low:"bg-gradient-to-r from-blue-700 to-blue-600 text-white shadow-sm border border-white/10",Medium:"bg-gradient-to-r from-orange-700 to-orange-600 text-white shadow-sm border border-white/10",High:"bg-gradient-to-r from-purple-700 to-purple-600 text-white shadow-sm border border-white/10",Urgent:"bg-gradient-to-r from-red-700 to-red-600 text-white shadow-sm border border-white/10"},Be=["#3B82F6","#10B981","#F59E0B","#EC4899","#8B5CF6","#0EA5E9","#7C3AED"],Ue=[{id:"p1",name:"Max",initials:"MA",color:"bg-gradient-to-br from-blue-400 to-blue-600"},{id:"p2",name:"Hasan",initials:"HA",color:"bg-gradient-to-br from-emerald-400 to-emerald-600"},{id:"p3",name:"Sarah",initials:"SA",color:"bg-gradient-to-br from-purple-400 to-purple-600"},{id:"p4",name:"John",initials:"JO",color:"bg-gradient-to-br from-amber-400 to-amber-600"}],Fe={id:"board-1",name:"Task Board",groups:[{id:"group-1",title:"New Group",color:"#579bfc",columns:[{id:"col_name",title:"Item",type:"name",width:"300px"},{id:"col_person",title:"Owner",type:"person",width:"96px"},{id:"col_status",title:"Status",type:"status",width:"128px"},{id:"col_priority",title:"Priority",type:"priority",width:"128px"},{id:"col_date",title:"Due Date",type:"date",width:"110px"}],tasks:[]}]};Se.OBJECT,Se.ARRAY,Se.OBJECT,Se.STRING,Se.STRING,Se.INTEGER,Se.STRING;const fr=async t=>(console.warn("Gemini API key is missing. AI features are disabled."),null),br=async t=>"AI features are disabled (missing API key).",wr=t=>{const[a,c]=z.useState(()=>{try{if(typeof window<"u"){const y=localStorage.getItem(t);if(y){const m=JSON.parse(y);if(m.columns&&Array.isArray(m.columns)&&m.groups){const b=m.groups.map(f=>({...f,columns:f.columns||[...m.columns]}));return{...m,groups:b}}if(m.groups&&Array.isArray(m.groups)){const b=m.groups.map(f=>f.columns&&Array.isArray(f.columns)?f:{...f,columns:[{id:"col_name",title:"Item",type:"name",width:"300px"},{id:"col_person",title:"Owner",type:"person",width:"96px"},{id:"col_status",title:"Status",type:"status",width:"128px"},{id:"col_priority",title:"Priority",type:"priority",width:"128px"},{id:"col_date",title:"Due Date",type:"date",width:"110px"}]});return{...m,groups:b}}}}}catch(y){console.warn("Failed to load saved board",y)}return JSON.parse(JSON.stringify(Fe))}),[s,i]=z.useState(""),[D,C]=z.useState(!1),[v,$]=z.useState(null);z.useEffect(()=>{const y=()=>{try{if(typeof window<"u"){const f=localStorage.getItem(t);if(f){const d=JSON.parse(f);if(d.columns&&Array.isArray(d.columns)&&d.groups){const I=d.groups.map(E=>({...E,columns:E.columns||[...d.columns]}));c({...d,groups:I});return}if(d.groups&&Array.isArray(d.groups)){const I=d.groups.map(E=>E.columns&&Array.isArray(E.columns)?E:{...E,columns:[{id:"col_name",title:"Item",type:"name",width:"300px"},{id:"col_person",title:"Owner",type:"person",width:"96px"},{id:"col_status",title:"Status",type:"status",width:"128px"},{id:"col_priority",title:"Priority",type:"priority",width:"128px"},{id:"col_date",title:"Due Date",type:"date",width:"110px"}]});c({...d,groups:I});return}c(d)}else c(JSON.parse(JSON.stringify(Fe)))}}catch(f){console.warn("Failed to load saved board on key change",f),c(JSON.parse(JSON.stringify(Fe)))}};y();const m=f=>{f.key===t&&y()},b=f=>{var d;((d=f.detail)==null?void 0:d.key)===t&&y()};return window.addEventListener("storage",m),window.addEventListener("local-storage-update",b),()=>{window.removeEventListener("storage",m),window.removeEventListener("local-storage-update",b)}},[t]),z.useEffect(()=>{try{localStorage.setItem(t,JSON.stringify(a))}catch(y){console.warn("Failed to save board",y)}},[a,t]);const p=(y,m,b)=>{c(f=>({...f,groups:f.groups.map(d=>d.id!==y?d:{...d,tasks:d.tasks.map(I=>I.id===m?{...I,...b}:I)})}))},h=(y,m,b)=>{p(y,m,{selected:b})},V=(y,m)=>{c(b=>({...b,groups:b.groups.map(f=>y!=="all"&&f.id!==y?f:{...f,tasks:f.tasks.map(d=>({...d,selected:m}))})}))},u=(y,m,b,f)=>{c(d=>({...d,groups:d.groups.map(I=>I.id!==y?I:{...I,tasks:I.tasks.map(E=>E.id!==m?E:{...E,textValues:{...E.textValues,[b]:f}})})}))},A=(y,m,b)=>{const f={id:ie(),name:(m==null?void 0:m.trim())||"New Item",status:P.New,priority:Z.Normal,dueDate:new Date().toISOString().split("T")[0],personId:null,textValues:{},selected:!1,...b};c(d=>({...d,groups:d.groups.map(I=>I.id===y?{...I,tasks:[...I.tasks,f]}:I)}))},N=(y,m)=>{c(b=>({...b,groups:b.groups.map(f=>f.id===y?{...f,tasks:f.tasks.filter(d=>d.id!==m)}:f)}))},g=()=>{const y={id:ie(),title:"New Group",color:Be[a.groups.length%Be.length],columns:[{id:"col_name",title:"Item",type:"name",width:"300px"},{id:"col_person",title:"Owner",type:"person",width:"96px"},{id:"col_status",title:"Status",type:"status",width:"128px"},{id:"col_priority",title:"Priority",type:"priority",width:"128px"},{id:"col_date",title:"Due Date",type:"date",width:"110px"}],tasks:[],isPinned:!1};c(m=>({...m,groups:[...m.groups,y]}))},R=y=>{c(m=>({...m,groups:m.groups.filter(b=>b.id!==y)}))},K=(y,m)=>{c(b=>({...b,groups:b.groups.map(f=>f.id===y?{...f,title:m}:f)}))},L=y=>{c(m=>({...m,groups:m.groups.map(b=>b.id===y?{...b,isPinned:!b.isPinned}:b)}))},W=(y,m="text",b="New Column",f,d,I)=>{const H={id:`col_${ie().slice(0,4)}`,title:b==="New Column"&&m==="connection"?"Page Connections":b,type:m,width:"140px",options:f,currency:d};c(ee=>({...ee,groups:ee.groups.map(k=>k.id===y?{...k,columns:[...k.columns,H]}:k)}))},G=(y,m,b)=>{c(f=>({...f,groups:f.groups.map(d=>d.id!==y?d:{...d,columns:d.columns.map(I=>I.id===m?{...I,title:b}:I)})}))},X=(y,m,b)=>{c(f=>({...f,groups:f.groups.map(d=>d.id!==y?d:{...d,columns:d.columns.map(I=>I.id===m?{...I,...b}:I)})}))},q=(y,m,b)=>{c(f=>({...f,groups:f.groups.map(d=>d.id!==y?d:{...d,columns:d.columns.map(I=>I.id===m?{...I,width:`${b}px`}:I)})}))},oe=(y,m)=>{c(b=>({...b,groups:b.groups.map(f=>f.id!==y?f:{...f,columns:f.columns.filter(d=>d.id!==m)})}))},he=(y,m)=>{c(b=>({...b,groups:b.groups.map(f=>{if(f.id!==y)return f;const d=f.columns.findIndex(ee=>ee.id===m);if(d===-1)return f;const I=f.columns[d],E={...I,id:`col_${ie().slice(0,4)}`,title:`${I.title} (Copy)`},H=[...f.columns];return H.splice(d+1,0,E),{...f,columns:H}})}))},o=(y,m,b)=>{c(f=>{const d=f.groups.find(H=>H.id===y);if(!d)return f;const I=[...d.columns],[E]=I.splice(m,1);return I.splice(b,0,E),{...f,groups:f.groups.map(H=>H.id!==y?H:{...H,columns:I})}})};return{board:a,setBoard:c,aiPrompt:s,setAiPrompt:i,isAiLoading:D,aiAnalysis:v,setAiAnalysis:$,updateTask:p,toggleTaskSelection:h,toggleGroupSelection:V,updateTaskTextValue:u,addTask:A,deleteTask:N,addGroup:g,deleteGroup:R,updateGroupTitle:K,toggleGroupPin:L,addColumn:W,updateColumn:X,updateColumnTitle:G,updateColumnWidth:q,deleteColumn:oe,duplicateColumn:he,moveColumn:o,reorderColumn:(y,m,b)=>{o(y,m,b)},moveTask:(y,m,b,f)=>{c(d=>{const I=d.groups.find(k=>k.id===m),E=d.groups.find(k=>k.id===b);if(!I||!E)return d;const H=I.tasks.findIndex(k=>k.id===y);if(H===-1)return d;const ee={...I.tasks[H]};return f&&(ee.status=f),m===b?{...d,groups:d.groups.map(k=>k.id!==m?k:{...k,tasks:k.tasks.map(ue=>ue.id===y?ee:ue)})}:{...d,groups:d.groups.map(k=>k.id===m?{...k,tasks:k.tasks.filter(ue=>ue.id!==y)}:k.id===b?{...k,tasks:[...k.tasks,ee]}:k)}})},handleGeneratePlan:async()=>{if(!s.trim())return;C(!0),$(null);const y=await fr();if(y){const m=new Date,b=y.tasks.map(d=>{const I=new Date(m);return I.setDate(m.getDate()+d.dueDateOffsetDays),{id:ie(),name:d.name,status:P.New,priority:d.priority||Z.Medium,dueDate:I.toISOString().split("T")[0],personId:null,textValues:{}}}),f={id:ie(),title:y.groupName||"AI Generated Plan",color:Be[Math.floor(Math.random()*Be.length)],tasks:b,columns:[{id:"col_name",title:"Item",type:"name",width:"300px"},{id:"col_person",title:"Owner",type:"person",width:"96px"},{id:"col_status",title:"Status",type:"status",width:"128px"},{id:"col_priority",title:"Priority",type:"priority",width:"128px"},{id:"col_date",title:"Due Date",type:"date",width:"110px"}]};c(d=>({...d,groups:[f,...d.groups]})),i("")}C(!1)},handleAnalyzeBoard:async()=>{C(!0),a.groups.map(m=>`Group: ${m.title}. Tasks: ${m.tasks.map(b=>`${b.name} (${b.status})`).join(", ")}`).join(`
`);const y=await br();$(y),C(!1)}}},vr=({x:t,y:a,onClose:c,onAction:s,darkMode:i})=>{let v=t,$=a;typeof window<"u"&&(t+256>window.innerWidth&&(v=t-256),a+400>window.innerHeight&&($=a-400));const p={top:$,left:v},h=u=>{s(u),c()},{ref:V}=we({onCancel:c,initialActive:!0});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-50 bg-transparent",onClick:c,onContextMenu:u=>{u.preventDefault(),c()}}),e.jsx("div",{ref:V,className:`fixed z-50 rounded-lg shadow-xl border w-64 py-2 animate-in fade-in zoom-in-95 duration-100 ${i?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,style:p,onClick:u=>u.stopPropagation(),children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("button",{onClick:()=>h("sort_asc"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(Ws,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Sort ascending"})]}),e.jsxs("button",{onClick:()=>h("sort_desc"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(Qs,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Sort descending"})]}),e.jsxs("button",{onClick:()=>h("group"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(Mt,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Group by this field"})]}),e.jsx("div",{className:`h-px my-1 ${i?"bg-gray-700":"bg-gray-100"}`}),e.jsxs("button",{onClick:()=>h("rename"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(ps,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Edit field"})]}),e.jsxs("button",{onClick:()=>h("permissions"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(es,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Privacy and permissions"})]}),e.jsx("div",{className:`h-px my-1 ${i?"bg-gray-700":"bg-gray-100"}`}),e.jsxs("button",{onClick:()=>h("move_start"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(Js,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Move to start"})]}),e.jsxs("button",{onClick:()=>h("move_end"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(Xs,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Move to end"})]}),e.jsxs("button",{onClick:()=>h("automate"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(ts,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Automate"})]}),e.jsx("div",{className:`h-px my-1 ${i?"bg-gray-700":"bg-gray-100"}`}),e.jsxs("button",{onClick:()=>h("hide"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(ss,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Hide column"})]}),e.jsxs("button",{onClick:()=>h("duplicate"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"}`,children:[e.jsx(wt,{size:16,className:"text-gray-500"}),e.jsx("span",{children:"Duplicate"})]}),e.jsxs("button",{onClick:()=>h("delete"),className:`flex items-center px-4 py-2 text-sm gap-3 ${i?"hover:bg-white/5 text-red-400":"hover:bg-red-50 text-red-600"}`,children:[e.jsx(Ke,{size:16,className:"text-red-500"}),e.jsx("span",{children:"Delete field"})]})]})})]})},jr=({isOpen:t,onClose:a,group:c,darkMode:s})=>{const[i,D]=z.useState(new Set);if(!t)return null;const C=p=>{const h=new Set(i);h.has(p)?h.delete(p):h.add(p),D(h)},v=()=>{const p=c.tasks.filter(h=>i.has(h.id));p.length!==0&&(js.addReminder({title:c.title||"Untitled Group",listId:"inbox",priority:"medium",dueDate:void 0,tags:[],completed:!1,subtasks:p.map(h=>({id:ie(),title:h.textValues.col_name||h.name||"Untitled Task",completed:h.status==="Done"}))}),a(),D(new Set))},$=()=>{i.size===c.tasks.length?D(new Set):D(new Set(c.tasks.map(p=>p.id)))};return e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsxs("div",{className:`backdrop-blur-xl rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden animate-in zoom-in-95 duration-300 border ring-1 ring-black/5 flex flex-col max-h-[85vh] ${s?"bg-[#1a1d24]/95 border-gray-700":"bg-white/95 border-white/20"}`,children:[e.jsxs("div",{className:`px-6 py-5 border-b flex items-center justify-between ${s?"border-gray-700 bg-gradient-to-r from-gray-800/50 to-[#1a1d24]":"border-gray-100 bg-gradient-to-r from-gray-50/50 to-white"}`,children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-xl font-bold tracking-tight ${s?"text-gray-100":"text-gray-900"}`,children:"Send to Reminders"}),e.jsxs("p",{className:`text-sm mt-0.5 ${s?"text-gray-400":"text-gray-500"}`,children:["Select tasks from ",e.jsx("span",{className:`font-semibold ${s?"text-gray-300":"text-gray-700"}`,children:c.title})]})]}),e.jsx("button",{onClick:a,className:`p-2 rounded-full transition-all duration-200 active:scale-95 ${s?"hover:bg-white/10 text-gray-400 hover:text-gray-200":"hover:bg-gray-100 text-gray-400 hover:text-gray-600"}`,children:e.jsx(Oe,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-0",children:c.tasks.length===0?e.jsxs("div",{className:`text-center py-16 flex flex-col items-center gap-3 ${s?"text-gray-500":"text-gray-400"}`,children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${s?"bg-gray-800":"bg-gray-50"}`,children:e.jsx(Ve,{size:24,className:`${s?"text-gray-600":"text-gray-300"}`})}),e.jsx("p",{className:"font-medium",children:"No tasks in this group"})]}):e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:`backdrop-blur-md sticky top-0 z-10 shadow-sm ${s?"bg-gray-800/80":"bg-gray-50/80"}`,children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-6 py-3.5 border-b w-[50px] ${s?"border-gray-700/80":"border-gray-200/80"}`,children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("input",{type:"checkbox",checked:i.size===c.tasks.length&&c.tasks.length>0,onChange:$,className:`rounded-md focus:ring-indigo-500/20 transition-all cursor-pointer ${s?"bg-gray-700 border-gray-600 text-indigo-500":"border-gray-300 text-indigo-600"}`})})}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Task Name"}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b text-center w-[120px] ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Priority"}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b w-[140px] ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Due Date"})]})}),e.jsx("tbody",{className:`divide-y ${s?"divide-gray-800":"divide-gray-100"}`,children:c.tasks.map(p=>{const h=i.has(p.id),V=p.textValues.col_name||p.name||"Untitled Task";return e.jsxs("tr",{onClick:()=>C(p.id),className:`cursor-pointer transition-all duration-200 group ${h?s?"bg-indigo-900/20":"bg-indigo-50/60":s?"hover:bg-white/5":"hover:bg-gray-50/80"}`,children:[e.jsx("td",{className:"px-6 py-3.5 w-[50px]",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("input",{type:"checkbox",checked:h,onChange:()=>C(p.id),onClick:u=>u.stopPropagation(),className:`rounded-md focus:ring-indigo-500/20 transition-all cursor-pointer ${s?"bg-gray-700 border-gray-600 text-indigo-500":"border-gray-300 text-indigo-600"}`})})}),e.jsx("td",{className:"px-4 py-3.5",children:e.jsx("span",{className:`text-sm font-medium truncate block max-w-[320px] transition-colors ${h?s?"text-indigo-300":"text-indigo-900":s?"text-gray-300 group-hover:text-white":"text-gray-700 group-hover:text-gray-900"}`,children:V})}),e.jsx("td",{className:"px-4 py-3.5 text-center w-[120px]",children:e.jsx("div",{className:"flex justify-center transform transition-transform group-hover:scale-105",children:e.jsx("span",{className:`text-[11px] px-2.5 py-1 rounded-full text-white font-semibold shadow-sm tracking-wide ${Ie[p.priority]||"bg-gray-400"}`,children:p.priority})})}),e.jsx("td",{className:"px-4 py-3.5 w-[140px]",children:e.jsx("span",{className:`text-sm font-mono transition-colors ${p.dueDate?s?"text-gray-400":"text-gray-600":s?"text-gray-600":"text-gray-300"}`,children:p.dueDate||"-"})})]},p.id)})})]})}),e.jsxs("div",{className:`px-6 py-4 border-t backdrop-blur-sm flex justify-end gap-3 ${s?"bg-gray-800/50 border-gray-700":"bg-gray-50/50 border-gray-100"}`,children:[e.jsx("button",{onClick:a,className:`px-5 py-2.5 text-sm font-medium rounded-xl transition-all duration-200 active:scale-95 ${s?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-600 hover:text-gray-900 hover:bg-gray-200/50"}`,children:"Cancel"}),e.jsxs("button",{onClick:v,disabled:i.size===0,className:"px-6 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 active:scale-95 rounded-xl shadow-lg shadow-blue-500/25 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none flex items-center gap-2",children:[e.jsx(Ve,{size:16,strokeWidth:2.5}),e.jsx("span",{children:"Send Tasks"}),i.size>0&&e.jsx("span",{className:"bg-white/20 px-1.5 py-0.5 rounded text-xs font-bold ml-1",children:i.size})]})]})]})})},Nr=({isOpen:t,onClose:a,group:c,darkMode:s})=>{const[i,D]=z.useState(new Set);if(!t)return null;const C=p=>{const h=new Set(i);h.has(p)?h.delete(p):h.add(p),D(h)},v=()=>{const p=c.tasks.filter(h=>i.has(h.id));p.length!==0&&(Ns.createGoal({title:c.title||"Untitled Goal",category:"Work",dueDate:new Date().toISOString().split("T")[0],progress:0,status:"on-track",priority:"Medium",impact:"Medium",subGoals:p.map(h=>({id:ie(),title:h.textValues.col_name||h.name||"Untitled Milestone",completed:h.status==="Done"}))}).catch(h=>console.error("Failed to create goal from tasks",h)),a(),D(new Set))},$=()=>{i.size===c.tasks.length?D(new Set):D(new Set(c.tasks.map(p=>p.id)))};return e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsxs("div",{className:`backdrop-blur-xl rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden animate-in zoom-in-95 duration-300 border ring-1 ring-black/5 flex flex-col max-h-[85vh] ${s?"bg-[#1a1d24]/95 border-gray-700":"bg-white/95 border-white/20"}`,children:[e.jsxs("div",{className:`px-6 py-5 border-b flex items-center justify-between ${s?"border-gray-700 bg-gradient-to-r from-gray-800/50 to-[#1a1d24]":"border-gray-100 bg-gradient-to-r from-gray-50/50 to-white"}`,children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-xl font-bold tracking-tight ${s?"text-gray-100":"text-gray-900"}`,children:"Send to Goals"}),e.jsxs("p",{className:`text-sm mt-0.5 ${s?"text-gray-400":"text-gray-500"}`,children:["Select tasks from ",e.jsx("span",{className:`font-semibold ${s?"text-gray-300":"text-gray-700"}`,children:c.title})]})]}),e.jsx("button",{onClick:a,className:`p-2 rounded-full transition-all duration-200 active:scale-95 ${s?"hover:bg-white/10 text-gray-400 hover:text-gray-200":"hover:bg-gray-100 text-gray-400 hover:text-gray-600"}`,children:e.jsx(Oe,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-0",children:c.tasks.length===0?e.jsxs("div",{className:`text-center py-16 flex flex-col items-center gap-3 ${s?"text-gray-500":"text-gray-400"}`,children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${s?"bg-gray-800":"bg-gray-50"}`,children:e.jsx(Ve,{size:24,className:`${s?"text-gray-600":"text-gray-300"}`})}),e.jsx("p",{className:"font-medium",children:"No tasks in this group"})]}):e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:`backdrop-blur-md sticky top-0 z-10 shadow-sm ${s?"bg-gray-800/80":"bg-gray-50/80"}`,children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-6 py-3.5 border-b w-[50px] ${s?"border-gray-700/80":"border-gray-200/80"}`,children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("input",{type:"checkbox",checked:i.size===c.tasks.length&&c.tasks.length>0,onChange:$,className:`rounded-md focus:ring-indigo-500/20 transition-all cursor-pointer ${s?"bg-gray-700 border-gray-600 text-indigo-500":"border-gray-300 text-indigo-600"}`})})}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Task Name"}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b text-center w-[120px] ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Priority"}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b w-[140px] ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Due Date"})]})}),e.jsx("tbody",{className:`divide-y ${s?"divide-gray-800":"divide-gray-100"}`,children:c.tasks.map(p=>{const h=i.has(p.id),V=p.textValues.col_name||p.name||"Untitled Task";return e.jsxs("tr",{onClick:()=>C(p.id),className:`cursor-pointer transition-all duration-200 group ${h?s?"bg-indigo-900/20":"bg-indigo-50/60":s?"hover:bg-white/5":"hover:bg-gray-50/80"}`,children:[e.jsx("td",{className:"px-6 py-3.5 w-[50px]",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("input",{type:"checkbox",checked:h,onChange:()=>C(p.id),onClick:u=>u.stopPropagation(),className:`rounded-md focus:ring-indigo-500/20 transition-all cursor-pointer ${s?"bg-gray-700 border-gray-600 text-indigo-500":"border-gray-300 text-indigo-600"}`})})}),e.jsx("td",{className:"px-4 py-3.5",children:e.jsx("span",{className:`text-sm font-medium truncate block max-w-[320px] transition-colors ${h?s?"text-indigo-300":"text-indigo-900":s?"text-gray-300 group-hover:text-white":"text-gray-700 group-hover:text-gray-900"}`,children:V})}),e.jsx("td",{className:"px-4 py-3.5 text-center w-[120px]",children:e.jsx("div",{className:"flex justify-center transform transition-transform group-hover:scale-105",children:e.jsx("span",{className:`text-[11px] px-2.5 py-1 rounded-full text-white font-semibold shadow-sm tracking-wide ${Ie[p.priority]||"bg-gray-400"}`,children:p.priority})})}),e.jsx("td",{className:"px-4 py-3.5 w-[140px]",children:e.jsx("span",{className:`text-sm font-mono transition-colors ${p.dueDate?s?"text-gray-400":"text-gray-600":s?"text-gray-600":"text-gray-300"}`,children:p.dueDate||"-"})})]},p.id)})})]})}),e.jsxs("div",{className:`px-6 py-4 border-t backdrop-blur-sm flex justify-end gap-3 ${s?"bg-gray-800/50 border-gray-700":"bg-gray-50/50 border-gray-100"}`,children:[e.jsx("button",{onClick:a,className:`px-5 py-2.5 text-sm font-medium rounded-xl transition-all duration-200 active:scale-95 ${s?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-600 hover:text-gray-900 hover:bg-gray-200/50"}`,children:"Cancel"}),e.jsxs("button",{onClick:v,disabled:i.size===0,className:"px-6 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 active:scale-95 rounded-xl shadow-lg shadow-blue-500/25 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none flex items-center gap-2",children:[e.jsx(dt,{size:16,strokeWidth:2.5}),e.jsx("span",{children:"Send to Goals"}),i.size>0&&e.jsx("span",{className:"bg-white/20 px-1.5 py-0.5 rounded text-xs font-bold ml-1",children:i.size})]})]})]})})},$r=({isOpen:t,onClose:a,group:c,darkMode:s})=>{const[i,D]=z.useState(new Set),C=xt.getCurrentUser(),v=C?`taskboard-${C.id}`:"taskboard-default",{showToast:$}=rs(),p=N=>{const g=new Set(i);g.has(N)?g.delete(N):g.add(N),D(g)},h=()=>{const N=c.tasks.filter(g=>i.has(g.id));if(N.length!==0)try{const g=localStorage.getItem(v);let R;g?(R=JSON.parse(g),R.groups||(R={...Fe,...R})):R=Fe;const K={id:ie(),title:c.title||"Imported Group",color:c.color,columns:[...c.columns],tasks:N.map(W=>({...W,id:ie()})),isPinned:!1},L={...R,groups:[K,...R.groups||[]]};localStorage.setItem(v,JSON.stringify(L)),$(`Successfully sent ${N.length} tasks to your Tasks Board`,"success"),a(),D(new Set)}catch(g){console.error("Failed to send tasks:",g),$("Failed to send tasks. Please try again.","error")}},V=()=>{i.size===c.tasks.length?D(new Set):D(new Set(c.tasks.map(N=>N.id)))},{ref:u,setIsActive:A}=we({onConfirm:h,onCancel:a,initialActive:t});return z.useEffect(()=>{A(t)},[t,A]),t?e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsxs("div",{ref:u,className:`backdrop-blur-xl rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden animate-in zoom-in-95 duration-300 border ring-1 ring-black/5 flex flex-col max-h-[85vh] ${s?"bg-[#1a1d24]/95 border-gray-700":"bg-white/95 border-white/20"}`,children:[e.jsxs("div",{className:`px-6 py-5 border-b flex items-center justify-between ${s?"border-gray-700 bg-gradient-to-r from-gray-800/50 to-[#1a1d24]":"border-gray-100 bg-gradient-to-r from-gray-50/50 to-white"}`,children:[e.jsxs("div",{children:[e.jsxs("h2",{className:`text-xl font-bold tracking-tight flex items-center gap-2 ${s?"text-gray-100":"text-gray-900"}`,children:[e.jsx(ut,{className:"text-blue-600",size:24}),"Send to Tasks Board"]}),e.jsxs("p",{className:`text-sm mt-0.5 ${s?"text-gray-400":"text-gray-500"}`,children:["Select tasks from ",e.jsx("span",{className:`font-semibold ${s?"text-gray-300":"text-gray-700"}`,children:c.title})," to copy to your personal Tasks."]})]}),e.jsx("button",{onClick:a,className:`p-2 rounded-full transition-all duration-200 active:scale-95 ${s?"hover:bg-white/10 text-gray-400 hover:text-gray-200":"hover:bg-gray-100 text-gray-400 hover:text-gray-600"}`,children:e.jsx(Oe,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-0",children:c.tasks.length===0?e.jsxs("div",{className:`text-center py-16 flex flex-col items-center gap-3 ${s?"text-gray-500":"text-gray-400"}`,children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${s?"bg-gray-800":"bg-gray-50"}`,children:e.jsx(Ve,{size:24,className:`${s?"text-gray-600":"text-gray-300"}`})}),e.jsx("p",{className:"font-medium",children:"No tasks in this group"})]}):e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:`backdrop-blur-md sticky top-0 z-10 shadow-sm ${s?"bg-gray-800/80":"bg-gray-50/80"}`,children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-6 py-3.5 border-b w-[50px] ${s?"border-gray-700/80":"border-gray-200/80"}`,children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("input",{type:"checkbox",checked:i.size===c.tasks.length&&c.tasks.length>0,onChange:V,className:`rounded-md focus:ring-indigo-500/20 transition-all cursor-pointer ${s?"bg-gray-700 border-gray-600 text-indigo-500":"border-gray-300 text-indigo-600"}`})})}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Task Name"}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b text-center w-[120px] ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Priority"}),e.jsx("th",{className:`px-4 py-3.5 text-xs font-bold uppercase tracking-wider border-b w-[140px] ${s?"text-gray-400 border-gray-700/80":"text-gray-500 border-gray-200/80"}`,children:"Due Date"})]})}),e.jsx("tbody",{className:`divide-y ${s?"divide-gray-800":"divide-gray-100"}`,children:c.tasks.map(N=>{const g=i.has(N.id),R=N.textValues.col_name||N.name||"Untitled Task";return e.jsxs("tr",{onClick:()=>p(N.id),className:`cursor-pointer transition-all duration-200 group ${g?s?"bg-indigo-900/20":"bg-indigo-50/60":s?"hover:bg-white/5":"hover:bg-gray-50/80"}`,children:[e.jsx("td",{className:"px-6 py-3.5 w-[50px]",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("input",{type:"checkbox",checked:g,onChange:()=>p(N.id),onClick:K=>K.stopPropagation(),className:`rounded-md focus:ring-indigo-500/20 transition-all cursor-pointer ${s?"bg-gray-700 border-gray-600 text-indigo-500":"border-gray-300 text-indigo-600"}`})})}),e.jsx("td",{className:"px-4 py-3.5",children:e.jsx("span",{className:`text-sm font-medium truncate block max-w-[320px] transition-colors ${g?s?"text-indigo-300":"text-indigo-900":s?"text-gray-300 group-hover:text-white":"text-gray-700 group-hover:text-gray-900"}`,children:R})}),e.jsx("td",{className:"px-4 py-3.5 text-center w-[120px]",children:e.jsx("div",{className:"flex justify-center transform transition-transform group-hover:scale-105",children:e.jsx("span",{className:`text-[11px] px-2.5 py-1 rounded-full text-white font-semibold shadow-sm tracking-wide ${Ie[N.priority]||"bg-gray-400"}`,children:N.priority})})}),e.jsx("td",{className:"px-4 py-3.5 w-[140px]",children:e.jsx("span",{className:`text-sm font-mono transition-colors ${N.dueDate?s?"text-gray-400":"text-gray-600":s?"text-gray-600":"text-gray-300"}`,children:N.dueDate||"-"})})]},N.id)})})]})}),e.jsxs("div",{className:`px-6 py-4 border-t backdrop-blur-sm flex justify-end gap-3 ${s?"bg-gray-800/50 border-gray-700":"bg-gray-50/50 border-gray-100"}`,children:[e.jsx("button",{onClick:a,className:`px-5 py-2.5 text-sm font-medium rounded-xl transition-all duration-200 active:scale-95 ${s?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-600 hover:text-gray-900 hover:bg-gray-200/50"}`,children:"Cancel"}),e.jsxs("button",{onClick:h,disabled:i.size===0,className:"px-6 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 active:scale-95 rounded-xl shadow-lg shadow-blue-500/25 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none flex items-center gap-2",children:[e.jsx(Ve,{size:16,strokeWidth:2.5}),e.jsx("span",{children:"Send Tasks"}),i.size>0&&e.jsx("span",{className:"bg-white/20 px-1.5 py-0.5 rounded text-xs font-bold ml-1",children:i.size})]})]})]})}):null},$t=({status:t,onChange:a,tabIndex:c,darkMode:s})=>{const[i,D]=z.useState({top:0,left:0,width:0}),{ref:C,isActive:v,setIsActive:$,startAction:p}=we({onCancel:()=>$(!1)}),h=u=>{if(u.stopPropagation(),v){$(!1);return}const A=u.currentTarget.getBoundingClientRect(),N=250,R=window.innerHeight-A.bottom<N;D({top:R?A.top+window.scrollY-N-4:A.bottom+window.scrollY+4,left:A.left+window.scrollX,width:A.width}),p()},V=u=>s?pr[u]||"bg-gray-800 text-gray-400":Qe[u]||"bg-gray-100 text-gray-400";return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"relative w-full h-full",children:e.jsxs("div",{onClick:h,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),h(u))},tabIndex:c,className:`w-full h-full flex items-center justify-center cursor-pointer transition-all duration-200 text-xs font-medium relative group focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-inset rounded-sm ${V(t)}`,children:[e.jsx("div",{className:"absolute right-0 bottom-0 w-3 h-3 bg-black/10 opacity-0 group-hover:opacity-100 clip-triangle transition-opacity"}),e.jsx("span",{className:"truncate px-1",children:t||e.jsx("span",{className:"opacity-0 group-hover:opacity-100 text-[10px] uppercase",children:"Set Status"})})]})}),v&&be.createPortal(e.jsx("div",{ref:C,className:`fixed z-[10000] shadow-2xl rounded-lg border p-1.5 overflow-hidden animate-in fade-in zoom-in-95 duration-100 flex flex-col gap-1 ${s?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,style:{top:i.top+4,left:i.left-(160-i.width)/2,width:"160px"},onMouseDown:u=>u.stopPropagation(),children:Object.values(P).map(u=>e.jsx("div",{onClick:A=>{A.stopPropagation(),a(u),$(!1)},className:`px-3 py-2.5 text-xs cursor-pointer hover:brightness-95 rounded-sm text-center font-medium transition-all shadow-sm ${V(u)}`,children:u||"Empty"},u))}),document.body)]})},Ct=({priority:t,onChange:a,tabIndex:c,darkMode:s})=>{const[i,D]=z.useState({top:0,left:0,width:0}),{ref:C,isActive:v,setIsActive:$,startAction:p}=we({onCancel:()=>$(!1)}),h=u=>{if(u.stopPropagation(),v){$(!1);return}const A=u.currentTarget.getBoundingClientRect(),N=200,R=window.innerHeight-A.bottom<N;D({top:R?A.top+window.scrollY-N-4:A.bottom+window.scrollY+4,left:A.left+window.scrollX,width:A.width}),p()},V=u=>s?yr[u]||"bg-gray-800 text-gray-400":Ie[u]||"bg-gray-100 text-gray-400";return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"relative w-full h-full",children:e.jsxs("div",{onClick:h,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),h(u))},tabIndex:c,className:`w-full h-full flex items-center justify-center cursor-pointer transition-all duration-200 text-xs font-medium relative group focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-inset rounded-sm ${V(t)}`,children:[e.jsx("div",{className:"absolute right-0 bottom-0 w-3 h-3 bg-black/10 opacity-0 group-hover:opacity-100 clip-triangle transition-opacity"}),e.jsx("span",{className:"truncate px-1",children:t||e.jsx("span",{className:"opacity-0 group-hover:opacity-100 text-[10px] uppercase",children:"Set"})})]})}),v&&be.createPortal(e.jsx("div",{ref:C,className:`fixed z-[10000] shadow-2xl rounded-lg border p-1.5 animate-in fade-in zoom-in-95 duration-100 flex flex-col gap-1 ${s?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,style:{top:i.top+4,left:i.left-(140-i.width)/2,width:"140px"},onMouseDown:u=>u.stopPropagation(),children:Object.values(Z).map(u=>e.jsx("div",{onClick:A=>{A.stopPropagation(),a(u),$(!1)},className:`px-2 py-2 text-xs cursor-pointer hover:brightness-90 rounded-sm text-center font-medium transition-all shadow-sm ${V(u)}`,children:u||"Empty"},u))}),document.body)]})},St=({personId:t,onChange:a,tabIndex:c,darkMode:s})=>{const[i,D]=z.useState({top:0,left:0}),C=Ue.find(u=>u.id===t),{ref:v,isActive:$,setIsActive:p,startAction:h}=we({onCancel:()=>p(!1)}),V=u=>{if(u.stopPropagation(),$){p(!1);return}const A=u.currentTarget.getBoundingClientRect(),N=250,R=window.innerHeight-A.bottom<N;D({top:R?A.top+window.scrollY-N-5:A.bottom+window.scrollY+5,left:A.left+window.scrollX-90}),h()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"relative w-full h-full flex justify-center items-center group",children:e.jsxs("div",{onClick:V,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),V(u))},tabIndex:c,className:"cursor-pointer hover:scale-110 transition-transform duration-200 active:scale-95 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-full",children:[C?e.jsx("div",{className:"w-6 h-6 rounded-full text-white text-[9px] flex items-center justify-center font-bold ring-2 shadow-md "+C.color+(s?" ring-[#1a1d24]":" ring-white"),title:C.name,children:C.initials}):e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center border border-dashed transition-all shadow-sm ${s?"bg-gray-800 text-gray-500 border-gray-700 hover:border-gray-500 hover:bg-gray-700":"bg-gray-100 text-gray-400 hover:bg-gray-200 border-gray-300 hover:border-gray-400"}`,children:e.jsx(gt,{size:12,strokeWidth:2.5})}),!C&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 pointer-events-none",children:e.jsx("div",{className:"w-6 h-6 rounded-full bg-black/5 flex items-center justify-center backdrop-blur-[1px]",children:e.jsx(He,{size:12,className:"text-black/60",strokeWidth:3})})})]})}),$&&be.createPortal(e.jsxs("div",{ref:v,className:`fixed z-[10000] shadow-2xl rounded-xl border p-2 animate-in fade-in zoom-in-95 duration-100 flex flex-col gap-1 min-w-[180px] ${s?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,style:{top:i.top,left:i.left},onMouseDown:u=>u.stopPropagation(),children:[e.jsx("div",{className:`text-xs font-semibold mb-1 px-2 uppercase tracking-wider py-1 ${s?"text-gray-500":"text-gray-400"}`,children:"Select Person"}),Ue.map(u=>e.jsxs("div",{onClick:A=>{A.stopPropagation(),a(u.id),p(!1)},className:`flex items-center gap-3 px-3 py-2 rounded-lg cursor-pointer transition-colors ${s?t===u.id?"bg-blue-500/20":"hover:bg-white/5":t===u.id?"bg-blue-50":"hover:bg-blue-50"}`,children:[e.jsx("div",{className:"w-6 h-6 rounded-full text-white text-[10px] flex items-center justify-center font-bold "+u.color,children:u.initials}),e.jsx("span",{className:`text-sm font-medium ${s?"text-gray-200":"text-gray-700"}`,children:u.name}),t===u.id&&e.jsx("span",{className:"ml-auto text-blue-500",children:"✓"})]},u.id)),e.jsx("div",{className:`border-t my-1 ${s?"border-gray-700":"border-gray-100"}`}),e.jsxs("div",{onClick:u=>{u.stopPropagation(),a(null),p(!1)},className:`px-3 py-2 text-sm rounded-lg cursor-pointer flex items-center gap-2 transition-colors ${s?"hover:bg-red-500/20 text-red-400":"hover:bg-red-50 text-red-500"}`,children:[e.jsx("span",{className:"w-4 h-4 flex items-center justify-center text-xs",children:"✕"}),"Clear Selection"]})]}),document.body)]})},Cr=[{id:"text",label:"Normal text",icon:e.jsx(ys,{size:18,className:"text-gray-500"})},{id:"h1",label:"Heading 1",icon:e.jsx(Ms,{size:18,className:"text-gray-500"})},{id:"h2",label:"Heading 2",icon:e.jsx(tr,{size:18,className:"text-gray-500"})},{id:"h3",label:"Heading 3",icon:e.jsx(rr,{size:18,className:"text-gray-500"})},{id:"h4",label:"Heading 4",icon:e.jsx(ar,{size:18,className:"text-gray-500"})},{id:"checklist",label:"Checklist",icon:e.jsx(ns,{size:18,className:"text-gray-500"})},{id:"bulletList",label:"Bulleted list",icon:e.jsx(Fs,{size:18,className:"text-gray-500"})},{id:"orderedList",label:"Numbered list",icon:e.jsx(Vs,{size:18,className:"text-gray-500"})},{id:"toggle",label:"Toggle list",icon:e.jsx(hr,{size:18,className:"text-gray-500"})},{id:"banner",label:"Banners",icon:e.jsx(vt,{size:18,className:"text-gray-500"})},{id:"code",label:"Code block",icon:e.jsx(as,{size:18,className:"text-gray-500"})},{id:"quote",label:"Block quote",icon:e.jsx(gr,{size:18,className:"text-gray-500"})},{id:"pullQuote",label:"Pull quote",icon:e.jsx(lr,{size:18,className:"text-gray-500"})}],Sr=({search:t,onSelect:a,onClose:c,position:s,darkMode:i})=>{const[D,C]=z.useState(0),{ref:v}=we({onCancel:c,initialActive:!0}),$=Cr.filter(p=>p.label.toLowerCase().includes(t.toLowerCase()));return z.useEffect(()=>{C(0)},[t]),z.useEffect(()=>{const p=h=>{h.defaultPrevented||(h.key==="ArrowDown"?(h.preventDefault(),C(V=>(V+1)%$.length)):h.key==="ArrowUp"?(h.preventDefault(),C(V=>(V-1+$.length)%$.length)):h.key==="Enter"&&(h.preventDefault(),$[D]&&a($[D])))};return document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)},[$,D,a]),$.length===0?null:e.jsxs("div",{ref:v,className:`fixed z-[9999] rounded-lg shadow-xl border w-72 max-h-80 overflow-y-auto flex flex-col p-1 animate-in fade-in zoom-in-95 duration-100 ${i?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,style:{top:s.top,left:s.left},children:[e.jsx("div",{className:`px-2 py-1.5 text-xs font-semibold uppercase tracking-wider ${i?"text-gray-500":"text-gray-400"}`,children:"Basic blocks"}),$.map((p,h)=>e.jsxs("div",{className:`flex items-center gap-3 px-2 py-1.5 rounded-md cursor-pointer transition-colors ${h===D?i?"bg-white/10":"bg-gray-100":i?"hover:bg-white/5":"hover:bg-gray-50"}`,onClick:()=>a(p),onMouseEnter:()=>C(h),children:[e.jsx("div",{className:`w-10 h-10 rounded border flex items-center justify-center shadow-sm ${i?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:p.icon}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`text-sm font-medium ${i?"text-gray-200":"text-gray-700"}`,children:p.label}),p.description&&e.jsx("span",{className:"text-xs text-gray-400",children:p.description})]})]},p.id))]})},Dr=({value:t,onChange:a,onClose:c,title:s="Edit Text",darkMode:i})=>{const[D,C]=z.useState(t),[v,$]=z.useState(!1),[p,h]=z.useState({top:0,left:0}),[V,u]=z.useState(""),A=z.useRef(null),{ref:N,setIsActive:g}=we({onCancel:c,initialActive:!0});z.useEffect(()=>{g(!v)},[v,g]),z.useEffect(()=>{A.current&&(A.current.focus(),A.current.setSelectionRange(A.current.value.length,A.current.value.length))},[]);const R=W=>{var G;if(v){if(W.key==="ArrowUp"||W.key==="ArrowDown"||W.key==="Enter"){W.key==="Enter"&&W.preventDefault();return}if(W.key==="Escape"){$(!1);return}}if(W.key==="/"&&!v){const X=(G=A.current)==null?void 0:G.getBoundingClientRect();X&&(h({top:X.top+40,left:X.left+20}),$(!0),u(""))}},K=W=>{const G=W.target.value;if(C(G),a(G),v){const X=G.lastIndexOf("/");X===-1?$(!1):u(G.slice(X+1))}},L=W=>{var X;let G="";switch(W.id){case"h1":G="# ";break;case"h2":G="## ";break;case"h3":G="### ";break;case"checklist":G="- [ ] ";break;case"bulletList":G="- ";break;case"orderedList":G="1. ";break;case"quote":G="> ";break;case"code":G="```\n\n```";break;default:G=""}if(G){const q=D.lastIndexOf("/"),oe=D.substring(0,q)+G+D.substring(q+1+V.length);C(oe),a(oe)}$(!1),(X=A.current)==null||X.focus()};return be.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:[e.jsxs("div",{ref:N,className:`rounded-xl shadow-2xl w-[800px] h-[600px] flex flex-col overflow-hidden animate-in zoom-in-95 duration-200 border ${i?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:`flex items-center justify-between px-4 py-3 border-b ${i?"border-gray-700 bg-[#1a1d24]":"border-gray-100 bg-gray-50/50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Nt,{size:16,className:`${i?"text-gray-500":"text-gray-400"}`}),e.jsx("span",{className:`text-sm font-semibold ${i?"text-gray-200":"text-gray-700"}`,children:s})]}),e.jsx("button",{onClick:c,className:`p-1.5 rounded-md transition-colors ${i?"hover:bg-white/5 text-gray-400 hover:text-gray-200":"hover:bg-gray-200 text-gray-400 hover:text-gray-600"}`,children:e.jsx(Oe,{size:18})})]}),e.jsxs("div",{className:`flex-1 relative ${i?"bg-[#1a1d24]":"bg-white"}`,children:[e.jsx("textarea",{ref:A,value:D,onChange:K,onKeyDown:R,className:`w-full h-full p-6 resize-none focus:outline-none text-base leading-relaxed font-mono ${i?"bg-[#1a1d24] text-gray-200 placeholder-gray-600":"text-gray-800 placeholder-gray-300"}`,placeholder:"Write something... Type '/' for commands"}),e.jsx("div",{className:`absolute bottom-4 right-4 text-xs pointer-events-none ${i?"text-gray-600":"text-gray-400"}`,children:"Markdown supported • Type '/' for commands"})]})]}),v&&e.jsx("div",{className:"fixed inset-0 z-[10000] pointer-events-none",children:e.jsx("div",{className:"pointer-events-auto",children:e.jsx(Sr,{search:V,onSelect:L,onClose:()=>$(!1),position:p,darkMode:i})})})]}),document.body)},zr=({value:t,onChange:a,tabIndex:c,darkMode:s})=>{const[i,D]=z.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`w-full h-full relative group cursor-pointer transition-colors ${s?"hover:bg-white/5":"hover:bg-gray-50"}`,onClick:()=>D(!0),children:[e.jsx("div",{className:`w-full h-full px-2 py-1.5 text-sm whitespace-nowrap overflow-hidden text-ellipsis focus:outline-none focus:ring-2 focus:ring-blue-500 rounded ${s?"text-gray-300":"text-gray-700"}`,tabIndex:c,children:t||e.jsx("span",{className:`${s?"text-gray-600":"text-gray-400"} italic`,children:"Empty"})}),e.jsx("div",{className:`absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity ${s?"text-gray-500":"text-gray-400"}`,children:e.jsx(Nt,{size:12})})]}),i&&e.jsx(Dr,{value:t,onChange:a,onClose:()=>D(!1),darkMode:s})]})},kr=({options:t=[],value:a,onChange:c,onClose:s,tabIndex:i,darkMode:D})=>{const[C,v]=z.useState(""),[$,p]=z.useState(null),h=z.useRef(null),{ref:V,isActive:u,setIsActive:A,startAction:N}=we({onCancel:()=>{A(!1),s==null||s()}}),g=t.find(L=>L.id===a),R=L=>{if(L.stopPropagation(),h.current){const W=h.current.getBoundingClientRect(),G=Math.max(W.width,220),X=W.left+window.scrollX-(G-W.width)/2;p({top:W.bottom+window.scrollY+4,left:X,width:G})}N()},K=t.filter(L=>L.label.toLowerCase().includes(C.toLowerCase()));return e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:h,onClick:R,onKeyDown:L=>{(L.key==="Enter"||L.key===" ")&&(L.preventDefault(),R(L))},tabIndex:i,className:`w-full h-full flex items-center justify-center cursor-pointer transition-colors px-2 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded ${D?"hover:bg-white/5":"hover:bg-gray-50"}`,children:g?e.jsx("div",{className:"px-3 py-1 rounded-sm text-white text-xs font-medium truncate w-full text-center "+g.color,children:g.label}):e.jsx("span",{className:`${D?"text-gray-500":"text-gray-400"}`,children:"-"})}),u&&$&&be.createPortal(e.jsxs("div",{ref:V,className:`dropdown-portal fixed z-[9999] rounded-lg shadow-2xl border animate-in fade-in zoom-in-95 duration-100 ${D?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-100"}`,style:{top:$.top,left:$.left,width:$.width,minWidth:"220px"},onClick:L=>L.stopPropagation(),children:[e.jsx("div",{className:"p-2",children:e.jsx("input",{type:"text",placeholder:"Search or add options...",value:C,onChange:L=>v(L.target.value),className:`w-full px-3 py-2 border-none rounded-md text-sm focus:ring-2 focus:ring-blue-500/20 ${D?"bg-gray-800 text-gray-200 placeholder-gray-500":"bg-gray-50 text-gray-700 placeholder-gray-400"}`,autoFocus:!0})}),e.jsxs("div",{className:"max-h-[240px] overflow-y-auto custom-scrollbar p-2 space-y-1",children:[e.jsx("div",{onClick:()=>{c(""),A(!1)},className:`flex items-center justify-center px-3 py-2 rounded-sm cursor-pointer border border-dashed transition-all ${D?"hover:bg-white/5 border-gray-700 text-gray-500 hover:text-gray-300 hover:border-gray-500":"hover:bg-gray-50 border-gray-200 text-gray-400 hover:text-gray-600 hover:border-gray-300"}`,children:"-"}),K.map(L=>e.jsxs("div",{onClick:()=>{c(L.id),A(!1)},className:"flex items-center justify-center relative gap-2 group cursor-pointer",children:[e.jsx("div",{className:`absolute left-2 opacity-0 group-hover:opacity-100 cursor-grab p-1 rounded ${D?"text-gray-500 hover:bg-white/10":"text-gray-300 hover:bg-gray-100"}`,children:e.jsx(Os,{size:14})}),e.jsx("div",{className:"w-[90%] px-3 py-2 rounded-sm text-white text-sm font-medium shadow-sm transition-transform active:scale-[0.98] text-center "+L.color,children:L.label})]},L.id)),K.length===0&&e.jsx("div",{className:`px-3 py-4 text-center text-xs ${D?"text-gray-500":"text-gray-400"}`,children:"No options found"})]})]}),document.body)]})},Ir=({task:t,group:a,selectionColumnWidth:c,actionColumnWidth:s,expandedTaskIds:i,toggleTaskSelection:D,updateTask:C,updateTaskTextValue:v,toggleSubtask:$,setActiveDatePicker:p,handleContextMenu:h,deleteTask:V,handleAddSubtask:u,subtaskInput:A,setSubtaskInput:N,darkMode:g=!1,setActiveConnectionMenu:R})=>{var he;const{attributes:K,listeners:L,setNodeRef:W,transform:G,transition:X,isDragging:q}=$s({id:t.id,data:{type:"TASK",task:t,group:a}}),oe={transform:zs.Translate.toString(G),transition:X,opacity:q?0:1,zIndex:q?999:"auto",position:"relative",gridTemplateColumns:c+" "+a.columns.map(o=>o.width).join(" ")+" "+s};return e.jsxs(mt.Fragment,{children:[e.jsxs("div",{ref:W,style:oe,className:`grid gap-px group/row text-sm transition-colors relative ${q?"z-50 shadow-xl ring-2 ring-blue-500/20":""} ${g?"bg-[#1a1d24] hover:bg-white/5":"bg-white hover:bg-gray-50/50"}`,children:[e.jsxs("div",{className:`flex items-center justify-center py-1.5 border-r relative transition-colors sticky left-0 z-10 border-r-2 ${g?"bg-[#1a1d24] border-gray-800 border-r-gray-800 group-hover/row:bg-white/5":"bg-white border-gray-100 border-r-gray-200/50 hover:bg-gray-50"}`,children:[e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1.5",style:{backgroundColor:a.color}}),e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-gray-300",checked:!!t.selected,onChange:o=>D(a.id,t.id,o.target.checked),onClick:o=>o.stopPropagation(),onMouseDown:o=>o.stopPropagation()})]}),a.columns.map(o=>{var le;const ne=o.type==="name";return e.jsxs("div",{className:`relative border-r flex items-center ${ne?"justify-start pl-2 sticky left-[50px] z-10 border-r-2":"justify-center"} min-h-[32px] transition-colors ${g?"bg-[#1a1d24] border-gray-800 border-r-gray-800 group-hover/row:bg-white/5 text-gray-300":"bg-white border-gray-100 border-r-gray-200/50 group-hover/row:bg-[#f8f9fa]"}`,children:[ne&&e.jsx("div",{className:"cursor-grab active:cursor-grabbing text-gray-300 mr-2 opacity-0 group-hover/row:opacity-100 hover:text-gray-500 p-1",...L,...K,style:{touchAction:"none"},children:e.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"9",cy:"12",r:"1"}),e.jsx("circle",{cx:"9",cy:"5",r:"1"}),e.jsx("circle",{cx:"9",cy:"19",r:"1"}),e.jsx("circle",{cx:"15",cy:"12",r:"1"}),e.jsx("circle",{cx:"15",cy:"5",r:"1"}),e.jsx("circle",{cx:"15",cy:"19",r:"1"})]})}),o.type==="name"&&e.jsxs("div",{className:"flex items-center w-full gap-2",children:[e.jsx("button",{onClick:w=>{w.stopPropagation(),$(t.id)},className:"p-0.5 hover:bg-gray-200 rounded text-gray-400 transition-colors",children:i.has(t.id)?e.jsx(is,{size:14}):e.jsx(ht,{size:14})}),e.jsx("input",{value:t.name,onChange:w=>C(a.id,t.id,{name:w.target.value}),className:`w-full px-2 py-1.5 bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded font-medium truncate ${g?"text-gray-200":"text-gray-700"}`}),e.jsx("div",{className:"text-xs text-gray-400 mr-2",children:(le=t.subtasks)!=null&&le.length?`${t.subtasks.length} subtasks`:""})]}),o.type==="status"?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx($t,{status:o.id==="col_status"?t.status:t.textValues[o.id]||P.New,onChange:w=>{o.id==="col_status"?C(a.id,t.id,{status:w}):v(a.id,t.id,o.id,w)},tabIndex:0,darkMode:g})}):o.type==="priority"?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Ct,{priority:o.id==="col_priority"?t.priority:t.textValues[o.id]||Z.Normal,onChange:w=>{o.id==="col_priority"?C(a.id,t.id,{priority:w}):v(a.id,t.id,o.id,w)},tabIndex:0,darkMode:g})}):o.type==="person"?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(St,{personId:o.id==="col_person"?t.personId:t.textValues[o.id]||null,onChange:w=>{o.id==="col_person"?C(a.id,t.id,{personId:w}):v(a.id,t.id,o.id,w||"")},tabIndex:0,darkMode:g})}):o.type==="date"?e.jsx("div",{className:"w-full h-full relative flex items-center justify-center",children:e.jsx("div",{className:`text-xs font-medium px-2 py-1 rounded transition-colors focus:ring-2 focus:ring-blue-500 focus:outline-none cursor-pointer ${g?"text-gray-300 hover:text-white hover:bg-white/10":"text-gray-500 hover:text-gray-800 hover:bg-gray-100"}`,onClick:w=>{w.stopPropagation();const O=w.currentTarget.getBoundingClientRect(),y=o.id==="col_date",m=y?t.dueDate||"":t.textValues[o.id]||"";p({taskId:t.id,colId:o.id,date:m,rect:O,onSelect:b=>{y?C(a.id,t.id,{dueDate:b}):v(a.id,t.id,o.id,b)}})},tabIndex:0,onKeyDown:w=>{if(w.key==="Enter"||w.key===" "){w.preventDefault();const O=w.currentTarget.getBoundingClientRect(),y=o.id==="col_date",m=y?t.dueDate||"":t.textValues[o.id]||"";p({taskId:t.id,colId:o.id,date:m,rect:O,onSelect:b=>{y?C(a.id,t.id,{dueDate:b}):v(a.id,t.id,o.id,b)}})}},children:(()=>{const O=o.id==="col_date"?t.dueDate:t.textValues[o.id];return O?new Date(O).toLocaleDateString(void 0,{month:"short",day:"numeric"}):e.jsx("span",{className:"text-gray-300",children:"Set Date"})})()})}):null,o.type==="checkbox"&&e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("input",{type:"checkbox",checked:t.textValues[o.id]==="true",onChange:w=>{v(a.id,t.id,o.id,w.target.checked?"true":"false")},className:`w-4 h-4 rounded text-blue-600 focus:ring-blue-500 cursor-pointer ${g?"border-gray-600 bg-transparent":"border-gray-300"}`})}),o.type==="money"&&e.jsx("div",{className:"w-full h-full px-2 py-1.5 text-sm text-gray-700 flex items-center justify-end font-mono",children:t.textValues[o.id]?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:`mr-1 ${g?"text-gray-500":"text-gray-400"}`,children:o.currency||"$"}),e.jsx("input",{type:"text",value:t.textValues[o.id],onChange:w=>{const O=w.target.value.replace(/[^0-9.]/g,"");v(a.id,t.id,o.id,O)},className:"bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-1 w-full text-right",placeholder:"0.00"})]}):e.jsx("input",{type:"text",onChange:w=>{const O=w.target.value.replace(/[^0-9.]/g,"");v(a.id,t.id,o.id,O)},className:`bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-1 w-full text-right ${g?"placeholder-gray-600 text-gray-300":"placeholder-gray-300 text-gray-700"}`,placeholder:o.currency||"$"})}),o.type==="website"&&e.jsxs("div",{className:"w-full h-full px-2 py-1.5 flex items-center gap-2",children:[e.jsx("div",{className:`p-1 rounded ${g?"bg-indigo-500/20 text-indigo-400":"bg-indigo-50 text-indigo-500"}`,children:e.jsx(pt,{size:12})}),e.jsx("input",{type:"text",value:t.textValues[o.id]||"",onChange:w=>v(a.id,t.id,o.id,w.target.value),className:`w-full bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-1 text-sm hover:underline cursor-text truncate ${g?"text-blue-400":"text-blue-600"}`,placeholder:"www.example.com"})]}),o.type==="email"&&e.jsxs("div",{className:"w-full h-full px-2 py-1.5 flex items-center gap-2",children:[e.jsx("div",{className:`p-1 rounded ${g?"bg-red-500/20 text-red-400":"bg-red-50 text-red-500"}`,children:e.jsx(os,{size:12})}),e.jsx("input",{type:"text",value:t.textValues[o.id]||"",onChange:w=>v(a.id,t.id,o.id,w.target.value),className:`w-full bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-1 text-sm truncate ${g?"text-gray-300":"text-gray-700"}`,placeholder:"email@example.com"})]}),o.type==="phone"&&e.jsxs("div",{className:"w-full h-full px-2 py-1.5 flex items-center gap-2",children:[e.jsx("div",{className:`p-1 rounded ${g?"bg-orange-500/20 text-orange-400":"bg-orange-50 text-orange-500"}`,children:e.jsx(Rs,{size:12})}),e.jsx("input",{type:"text",value:t.textValues[o.id]||"",onChange:w=>v(a.id,t.id,o.id,w.target.value),className:`w-full bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-1 text-sm truncate ${g?"text-gray-300":"text-gray-700"}`,placeholder:"+1 234 567 890"})]}),o.type==="location"&&e.jsxs("div",{className:"w-full h-full px-2 py-1.5 flex items-center gap-2",children:[e.jsx("div",{className:`p-1 rounded ${g?"bg-red-500/20 text-red-400":"bg-red-50 text-red-600"}`,children:e.jsx(ls,{size:12})}),e.jsx("input",{type:"text",value:t.textValues[o.id]||"",onChange:w=>v(a.id,t.id,o.id,w.target.value),className:`w-full bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-1 text-sm truncate ${g?"text-gray-300":"text-gray-700"}`,placeholder:"Add location"})]}),o.type==="rating"&&e.jsx("div",{className:"w-full h-full flex items-center justify-center gap-0.5",children:[1,2,3,4,5].map(w=>e.jsx(jt,{size:14,className:`cursor-pointer transition-colors ${w<=(Number(t.textValues[o.id])||0)?"text-amber-400 fill-amber-400":g?"text-gray-600":"text-gray-300"}`,onClick:()=>v(a.id,t.id,o.id,w.toString())},w))}),o.type==="progress_manual"&&e.jsxs("div",{className:"w-full h-full px-2 py-1.5 flex items-center gap-2",children:[e.jsxs("div",{className:`flex-1 h-2 rounded-full overflow-hidden relative group/progress cursor-pointer ${g?"bg-gray-700":"bg-gray-100"}`,children:[e.jsx("div",{className:"h-full bg-green-500 transition-all duration-300",style:{width:`${Number(t.textValues[o.id])||0}%`}}),e.jsx("input",{type:"range",min:"0",max:"100",value:Number(t.textValues[o.id])||0,onChange:w=>v(a.id,t.id,o.id,w.target.value),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"})]}),e.jsxs("span",{className:`text-xs w-8 text-right ${g?"text-gray-400":"text-gray-500"}`,children:[Number(t.textValues[o.id])||0,"%"]})]}),o.type==="button"&&e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("button",{className:"px-3 py-1 bg-blue-500 text-white text-xs font-medium rounded hover:bg-blue-600 transition-colors active:scale-95",onClick:()=>alert(`Action triggered for ${t.name}`),children:"Click Me"})}),o.type==="connection"&&e.jsx("div",{className:"w-full h-full p-1 flex items-center justify-center",children:e.jsxs("button",{onClick:w=>{w.stopPropagation();const O=w.currentTarget.getBoundingClientRect();let y;try{const m=t.textValues[o.id];m&&(y=JSON.parse(m))}catch{}R({groupId:a.id,taskId:t.id,colId:o.id,rect:O,config:y})},className:`w-full h-full text-xs font-semibold rounded transition-all flex items-center justify-center gap-1.5 px-2 group/btn ${(()=>{let w=!1;try{const O=t.textValues[o.id];O&&JSON.parse(O).targetPath&&(w=!0)}catch{}return w})()?"bg-blue-50 hover:bg-blue-100 text-blue-600 border border-blue-200":"bg-gray-50 hover:bg-gray-100 text-gray-500 border border-gray-200"}`,children:[e.jsx(bt,{size:12,className:"group-hover/btn:scale-110 transition-transform"}),e.jsx("span",{className:"truncate",children:(()=>{try{const w=t.textValues[o.id];if(w){const O=JSON.parse(w);if(O.targetName)return`Go to ${O.targetName}`}}catch{}return"Connect"})()})]})}),o.type==="text"&&e.jsx("input",{type:"text",value:t.textValues[o.id]||"",onChange:w=>v(a.id,t.id,o.id,w.target.value),className:`w-full h-full text-center px-2 bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded ${g?"text-gray-300":"text-gray-600"}`,placeholder:"-",tabIndex:0}),o.type==="long_text"&&e.jsx("div",{className:"w-full h-full p-1",children:e.jsx(zr,{value:t.textValues[o.id]||"",onChange:w=>v(a.id,t.id,o.id,w),tabIndex:0,darkMode:g})}),o.type==="dropdown"&&e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(kr,{options:o.options,value:t.textValues[o.id],onChange:w=>v(a.id,t.id,o.id,w),tabIndex:0,darkMode:g})}),o.type==="number"&&e.jsx("input",{type:"text",value:t.textValues[o.id]||"",onChange:w=>{const O=w.target.value;/^[0-9.,]*$/.test(O)&&v(a.id,t.id,o.id,O)},onBlur:w=>{const O=w.target.value.replace(/,/g,"");if(O&&!isNaN(Number(O))){const y=Number(O).toLocaleString();v(a.id,t.id,o.id,y)}},className:"w-full h-full text-center px-2 bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded text-gray-600 font-mono text-xs",placeholder:"0",tabIndex:0})]},o.id)}),e.jsx("div",{className:`flex items-center justify-center border-l opacity-0 group-hover/row:opacity-100 transition-opacity ${g?"border-gray-800 bg-[#0f1115]":"border-gray-100 bg-white"}`,children:e.jsx("button",{onClick:()=>V(a.id,t.id),className:"text-gray-300 hover:text-red-500 hover:bg-red-50 p-1.5 rounded transition-all",children:e.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})})]}),i.has(t.id)&&e.jsxs("div",{className:"contents",children:[(he=t.subtasks)==null?void 0:he.map(o=>e.jsxs("div",{className:`grid gap-px group/subrow text-sm transition-colors relative ${g?"bg-[#1a1d24]/50 hover:bg-white/5":"bg-gray-50/30 hover:bg-gray-50"}`,style:{gridTemplateColumns:c+" "+a.columns.map(ne=>ne.width).join(" ")+" "+s},children:[e.jsxs("div",{className:`flex items-center justify-center py-1.5 border-r relative sticky left-0 z-10 border-r-2 ${g?"bg-[#1a1d24]/50 border-gray-800 border-r-gray-800":"bg-gray-50/30 border-gray-100 border-r-gray-200/50"}`,children:[e.jsx("div",{className:"w-4 h-4"})," "]}),a.columns.map(ne=>{const le=ne.type==="name";return e.jsxs("div",{className:`relative border-r flex items-center ${le?"justify-start pl-8 sticky left-[50px] z-10 border-r-2":"justify-center"} min-h-[32px] transition-colors ${g?"bg-[#1a1d24]/50 border-gray-800 border-r-gray-800 group-hover/subrow:bg-white/5 text-gray-400":"bg-gray-50/30 border-gray-100 border-r-gray-200/50 group-hover/subrow:bg-gray-100"}`,children:[le&&e.jsx(lt,{size:14,className:"text-gray-400 mr-2"}),le?e.jsx("input",{value:o.name,onChange:w=>{var y;const O=(y=t.subtasks)==null?void 0:y.map(m=>m.id===o.id?{...m,name:w.target.value}:m);C(a.id,t.id,{subtasks:O})},className:`w-full px-2 py-1.5 bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded text-sm truncate ${g?"text-gray-300":"text-gray-600"}`}):e.jsx("div",{className:"text-xs text-gray-400 italic",children:"-"})]},`${o.id}-${ne.id}`)}),e.jsx("div",{className:`border-l ${g?"bg-[#1a1d24]/50 border-gray-800":"bg-white border-gray-100"}`})]},o.id)),e.jsx("div",{className:`grid gap-px relative z-20 shadow-lg my-2 mx-4 rounded-lg border overflow-hidden animate-in slide-in-from-top-2 duration-200 ${g?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,style:{gridColumn:"1 / -1"},children:e.jsxs("div",{className:`flex items-center p-2 gap-3 ${g?"bg-[#1a1d24]":"bg-white"}`,children:[e.jsx("div",{className:`w-5 h-5 rounded-full border-2 border-dashed animate-spin-slow ${g?"border-gray-600":"border-gray-300"}`}),e.jsx("input",{autoFocus:!0,value:A[t.id]||"",onChange:o=>N({...A,[t.id]:o.target.value}),onKeyDown:o=>{o.key==="Enter"&&u(a.id,t.id)},placeholder:"Task Name or type '/' for commands",className:`flex-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 bg-transparent ${g?"text-gray-200 placeholder-gray-500":"text-gray-700 placeholder-gray-400"}`}),e.jsxs("div",{className:`flex items-center gap-1 border-l pl-3 ${g?"border-gray-700":"border-gray-200"}`,children:[e.jsx("button",{className:`p-1.5 rounded transition-colors ${g?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:e.jsx(yt,{size:16})}),e.jsx("button",{className:`p-1.5 rounded transition-colors ${g?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:e.jsx(cs,{size:16})}),e.jsx("div",{className:`w-px h-4 mx-1 ${g?"bg-gray-700":"bg-gray-200"}`}),e.jsx("button",{className:`p-1.5 rounded transition-colors ${g?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:e.jsx(gt,{size:16})}),e.jsx("button",{className:`p-1.5 rounded transition-colors ${g?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:e.jsx(ft,{size:16})}),e.jsx("button",{className:`p-1.5 rounded transition-colors ${g?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:e.jsx(vt,{size:16})}),e.jsx("button",{className:`p-1.5 rounded transition-colors ${g?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:e.jsx(Ls,{size:16})}),e.jsx("button",{className:`p-1.5 rounded transition-colors ${g?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:e.jsx(ds,{size:16})}),e.jsx("div",{className:`w-px h-4 mx-1 ${g?"bg-gray-700":"bg-gray-200"}`}),e.jsx("button",{onClick:()=>$(t.id),className:`px-3 py-1.5 text-sm font-medium rounded border transition-colors ${g?"text-gray-400 hover:bg-white/5 border-gray-700":"text-gray-600 hover:bg-gray-100 border-gray-200"}`,children:"Cancel"}),e.jsxs("button",{onClick:()=>u(a.id,t.id),className:"px-3 py-1.5 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded shadow-sm transition-colors flex items-center gap-1",children:["Save ",e.jsx(lt,{size:12})]})]})]})})]})]})},ke={[P.Done]:"#33D995",[P.Working]:"#FFBE66",[P.Stuck]:"#FF7085",[P.Pending]:"#FFD940",[P.AlmostFinish]:"#C48AF0",[P.New]:"#A0A5B9"},Pr=t=>{if(!t)return P.New;const a=t.toLowerCase();return a.includes("done")||a.includes("complete")?P.Done:a.includes("work")||a.includes("progress")||a.includes("doing")?P.Working:a.includes("stuck")||a.includes("block")?P.Stuck:a.includes("pending")||a.includes("todo")||a.includes("to do")||a.includes("backlog")?P.Pending:a.includes("almost")||a.includes("review")?P.AlmostFinish:P.New},Ze=(t,a)=>{var i,D;const c=(i=t.columns.find(C=>C.type==="status"))==null?void 0:i.id,s=a.status||(c?(D=a.textValues)==null?void 0:D[c]:void 0);return Pr(s)},Ar=(t,a)=>{const c=(a??t.tasks).flatMap(C=>[C,...C.subtasks||[]]);if(c.length===0)return{counts:{done:0,working:0,stuck:0,pending:0,almostFinish:0,new:0},weighted:0,total:0};const s=c.reduce((C,v)=>{const $=Ze(t,v);return C[$===P.Done?"done":$===P.Working?"working":$===P.Stuck?"stuck":$===P.Pending?"pending":$===P.AlmostFinish?"almostFinish":"new"]+=1,C},{done:0,working:0,stuck:0,pending:0,almostFinish:0,new:0}),i=c.length,D=(s.done*1+s.almostFinish*.75+s.working*.5+s.pending*.25+s.new*.1+s.stuck*0)/i*100;return{counts:s,weighted:D,total:i}},_r=mt.memo(({group:t,filteredTasks:a,progress:c,collapsedGroups:s,toggleGroupCollapse:i,updateGroupTitle:D,toggleGroupPin:C,setShowReminderModalGroupId:v,setShowGoalsModalGroupId:$,setShowTaskBoardModalGroupId:p,isMainBoard:h,handleDeleteGroupClick:V,allSelected:u,someSelected:A,toggleGroupSelection:N,selectionColumnWidth:g,actionColumnWidth:R,handleContextMenu:K,handleColumnDragStart:L,handleColumnDragOver:W,handleColumnDrop:G,updateColumnTitle:X,activeColumnMenu:q,setActiveColumnMenu:oe,setResizingCol:he,expandedTaskIds:o,toggleTaskSelection:ne,updateTask:le,handleDeleteTaskClick:w,updateTaskTextValue:O,toggleSubtask:y,setActiveDatePicker:m,setActiveConnectionMenu:b,handleAddSubtask:f,subtaskInput:d,setSubtaskInput:I,draftTasks:E,updateDraftTask:H,handleAddTask:ee,darkMode:k})=>{var ue;return e.jsxs("div",{id:`group-${t.id}`,className:`relative flex flex-col w-full mb-10 shadow-sm border rounded-xl overflow-hidden transition-colors ${k?"border-gray-800 bg-[#1a1d24]":"border-gray-200/60"}`,children:[e.jsxs("div",{className:`flex items-center px-4 py-3 relative w-full border-b transition-colors ${k?"bg-[#1a1d24] border-gray-800":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 pr-4",children:[e.jsx("div",{className:"cursor-pointer hover:bg-gray-100 p-1.5 rounded transition-colors group/menu relative",onClick:()=>i(t.id),children:e.jsx("svg",{className:`w-4 h-4 text-gray-400 group-hover/menu:text-blue-500 transition-transform ${s.has(t.id)?"-rotate-90":"rotate-0"}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})}),e.jsx("input",{value:t.title,onChange:n=>D(t.id,n.target.value),className:`text-xl font-bold bg-transparent border border-transparent rounded px-2 py-0.5 focus:outline-none focus:border-blue-500 w-full max-w-md transition-all ${k?"hover:border-gray-700 focus:bg-[#0f1115]":"hover:border-gray-300 focus:bg-white"}`,style:{color:t.color}}),e.jsxs("div",{className:"ml-4 flex items-center gap-2",children:[e.jsx("div",{className:"flex h-1.5 w-28 overflow-hidden rounded-full bg-gray-100",children:["new","pending","working","almostFinish","done","stuck"].map(n=>{const T=c.total===0?0:c.counts[n]/c.total*100;if(T<=0)return null;const _=n==="new"?ke[P.New]:n==="pending"?ke[P.Pending]:n==="working"?ke[P.Working]:n==="almostFinish"?ke[P.AlmostFinish]:n==="done"?ke[P.Done]:ke[P.Stuck];return e.jsx("div",{className:"h-full",style:{width:`${T}%`,backgroundColor:_}},n)})}),e.jsxs("span",{className:"text-xs text-gray-400 font-medium",children:[Math.round(c.weighted),"%"]})]})]}),e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"flex items-center gap-1 px-2",children:[e.jsx("button",{onClick:()=>C(t.id),className:"p-2 transition-colors rounded-md "+(t.isPinned?"text-blue-500 bg-blue-50":"text-gray-300 hover:text-gray-500 hover:bg-gray-100"),title:t.isPinned?"Unpin Group":"Pin Group",children:e.jsx(xr,{className:"w-4 h-4 "+(t.isPinned?"fill-current":"")})}),e.jsx("button",{onClick:n=>{n.stopPropagation(),v(t.id)},className:"p-2 transition-colors rounded-md text-gray-300 hover:text-gray-500 hover:bg-gray-100",title:"Send to Reminders",children:e.jsx(ft,{className:"w-4 h-4"})}),e.jsx("button",{onClick:n=>{n.stopPropagation(),$(t.id)},className:"p-2 transition-colors rounded-md text-gray-300 hover:text-gray-500 hover:bg-gray-100",title:"Send to Goals",children:e.jsx(dt,{className:"w-4 h-4"})}),!h&&e.jsx("button",{onClick:n=>{n.stopPropagation(),p(t.id)},className:"p-2 transition-colors rounded-md text-gray-300 hover:text-gray-500 hover:bg-gray-100",title:"Send to Tasks Board",children:e.jsx(ut,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>V(t.id),className:"text-gray-400 hover:text-red-500 p-2 transition-colors hover:bg-red-50 rounded-md",title:"Delete Group",children:e.jsx(Ke,{size:14})})]})]}),!s.has(t.id)&&e.jsxs("div",{className:"overflow-x-auto w-full [&::-webkit-scrollbar]:hidden",children:[e.jsx("div",{className:`sticky top-0 z-[1] min-w-full w-fit transition-colors ${k?"bg-[#1a1d24]":"bg-white"}`,style:{boxShadow:"0 2px 5px -2px rgba(0,0,0,0.05)"},children:e.jsxs("div",{className:`grid gap-px border-y text-xs font-semibold uppercase tracking-wide transition-colors ${k?"bg-gray-800 border-gray-800 text-gray-400":"bg-gray-200 border-gray-200 text-gray-500"}`,style:{gridTemplateColumns:g+" "+t.columns.map(n=>n.width).join(" ")+" "+R},children:[e.jsx("div",{className:`flex items-center justify-center sticky left-0 z-20 border-r-2 transition-colors ${k?"bg-[#1a1d24]/95 border-r-gray-800":"bg-gray-50/80 border-r-gray-200/50"}`,children:e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-gray-300",checked:u,ref:n=>{n&&(n.indeterminate=A&&!u)},onChange:n=>N(t.id,n.target.checked)})}),t.columns.map((n,T)=>e.jsx("div",{className:`relative group backdrop-blur-sm transition-colors ${n.type==="name"?`sticky left-[50px] z-20 border-r-2 ${k?"border-r-gray-800":"border-r-gray-200/50"}`:"cursor-grab active:cursor-grabbing"} ${k?"bg-[#1a1d24]/95 hover:bg-white/5":"bg-gray-50/80 hover:bg-gray-100"}`,onContextMenu:_=>K(_,t.id,n.id),draggable:n.type!=="name",onDragStart:_=>L(_,t.id,n.id,T),onDragOver:_=>W(_,T),onDrop:_=>G(_,t.id,T),children:e.jsxs("div",{className:"flex items-center justify-between h-full",children:[e.jsx("input",{value:n.title,onChange:_=>X(t.id,n.id,_.target.value),className:`w-full h-full bg-transparent px-3 py-2 text-center text-[11px] focus:outline-none border-b-2 border-transparent focus:border-blue-500 ${k?"focus:bg-[#0f1115] focus:text-white text-gray-300":"focus:bg-white focus:text-gray-800"}`,style:{textAlign:n.type==="name"||n.type==="long_text"?"left":"center"}}),e.jsx("div",{className:"absolute right-1 top-1/2 transform -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer p-1 hover:bg-gray-200 rounded",onClick:_=>{_.stopPropagation();const J=_.currentTarget.getBoundingClientRect();oe((q==null?void 0:q.groupId)===t.id?null:{groupId:t.id,rect:J})},children:e.jsx(xs,{size:14,className:"text-gray-400"})}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-400/50 z-30",onMouseDown:_=>{_.stopPropagation(),_.preventDefault();const J=parseInt(n.width.replace("px",""))||140;he({groupId:t.id,colId:n.id,startX:_.clientX,startWidth:J})},onClick:_=>_.stopPropagation()})]})},n.id)),e.jsx("div",{className:`flex items-center justify-center relative group ${k?"bg-[#1a1d24]/95":"bg-gray-50/80"}`,children:e.jsx("div",{className:"cursor-pointer w-6 h-6 rounded flex items-center justify-center transition-all duration-200 "+((q==null?void 0:q.groupId)===t.id?"bg-gray-200 text-gray-900":"text-gray-400 hover:text-gray-700 hover:bg-gray-200/50"),onClick:n=>{n.stopPropagation();const T=n.currentTarget.getBoundingClientRect();oe((q==null?void 0:q.groupId)===t.id?null:{groupId:t.id,rect:T})},title:"Add Column",children:e.jsx(He,{className:"w-4 h-4"})})})]})}),e.jsx("div",{className:`divide-y relative z-0 min-w-full w-fit ${k?"divide-gray-800":"divide-gray-100"}`,children:e.jsx(Cs,{items:a.map(n=>n.id),strategy:Ss,children:a.map(n=>e.jsx(Ir,{task:n,group:t,selectionColumnWidth:g,actionColumnWidth:R,expandedTaskIds:o,toggleTaskSelection:ne,updateTask:le,deleteTask:()=>w(t.id,n.id),updateTaskTextValue:O,toggleSubtask:y,setActiveDatePicker:m,handleContextMenu:K,handleAddSubtask:f,subtaskInput:d,setSubtaskInput:I,darkMode:k,setActiveConnectionMenu:b},n.id))})}),e.jsxs("div",{className:`grid gap-px border-t group/add-row transition-colors min-w-full w-fit ${k?"bg-[#1a1d24] border-gray-800 hover:bg-white/5":"bg-white border-gray-200 hover:bg-gray-50"}`,style:{gridTemplateColumns:g+" "+t.columns.map(n=>n.width).join(" ")+" "+R},children:[e.jsxs("div",{className:`flex items-center justify-center border-r sticky left-0 z-10 border-r-2 transition-colors relative ${k?"bg-[#1a1d24] border-gray-800 border-r-gray-800 group-hover/add-row:bg-white/5":"bg-white border-gray-100 border-r-gray-200/50 group-hover/add-row:bg-gray-50"}`,children:[e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1.5",style:{backgroundColor:t.color}}),e.jsx("div",{className:"w-4 h-4 rounded border border-gray-200 flex items-center justify-center text-gray-300",children:e.jsx(He,{size:10})})]}),e.jsx("div",{className:`flex items-center pl-2 py-2 border-r sticky left-[50px] z-10 border-r-2 transition-colors ${k?"bg-[#1a1d24] border-gray-800 border-r-gray-800 group-hover/add-row:bg-white/5":"bg-white border-gray-100 border-r-gray-200/50 group-hover/add-row:bg-gray-50"}`,children:e.jsx("input",{type:"text",placeholder:"+ Add task",value:((ue=E[t.id])==null?void 0:ue.name)||"",onChange:n=>H(t.id,{name:n.target.value}),className:`w-full bg-transparent text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 ${k?"placeholder-gray-600 text-gray-200":"placeholder-gray-400 text-gray-700"}`,onKeyDown:n=>{n.key==="Enter"&&ee(t.id)}})}),t.columns.slice(1).map(n=>{var T,_,J,Q,ce,We,ge,De,ve,je,te,me,Pe,Re,Ae;return e.jsx("div",{className:`border-r min-h-[32px] flex items-center justify-center ${k?"bg-[#1a1d24] border-gray-800":"bg-white border-gray-100"}`,children:n.type==="status"?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx($t,{status:n.id==="col_status"?((T=E[t.id])==null?void 0:T.status)||P.New:((J=(_=E[t.id])==null?void 0:_.textValues)==null?void 0:J[n.id])||P.New,onChange:B=>{var U;n.id==="col_status"?H(t.id,{status:B}):H(t.id,{textValues:{...(U=E[t.id])==null?void 0:U.textValues,[n.id]:B}})},tabIndex:0,darkMode:k})}):n.type==="priority"?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Ct,{priority:n.id==="col_priority"?((Q=E[t.id])==null?void 0:Q.priority)||Z.Normal:((We=(ce=E[t.id])==null?void 0:ce.textValues)==null?void 0:We[n.id])||Z.Normal,onChange:B=>{var U;n.id==="col_priority"?H(t.id,{priority:B}):H(t.id,{textValues:{...(U=E[t.id])==null?void 0:U.textValues,[n.id]:B}})},tabIndex:0,darkMode:k})}):n.type==="person"?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(St,{personId:n.id==="col_person"?((ge=E[t.id])==null?void 0:ge.personId)||null:((ve=(De=E[t.id])==null?void 0:De.textValues)==null?void 0:ve[n.id])||null,onChange:B=>{var U;n.id==="col_person"?H(t.id,{personId:B}):H(t.id,{textValues:{...(U=E[t.id])==null?void 0:U.textValues,[n.id]:B||""}})},tabIndex:0,darkMode:k})}):n.type==="button"?e.jsx("div",{className:"w-full h-full p-1",children:e.jsx("button",{className:"w-full h-full bg-blue-500 hover:bg-blue-600 text-white text-xs font-medium rounded transition-colors flex items-center justify-center",children:"Action"})}):n.type==="connection"?e.jsx("div",{className:"w-full h-full p-1 flex items-center justify-center",children:e.jsxs("button",{onClick:B=>{B.stopPropagation();const U=B.currentTarget.getBoundingClientRect();b({groupId:t.id,taskId:"DRAFT_TASK",colId:n.id,rect:U,config:n.config})},className:`w-full h-full text-xs font-semibold rounded transition-all flex items-center justify-center gap-1.5 px-2 group/btn ${(je=n.config)!=null&&je.targetPath?"bg-blue-50 hover:bg-blue-100 text-blue-600 border border-blue-200":"bg-gray-50 hover:bg-gray-100 text-gray-500 border border-gray-200"}`,children:[e.jsx(bt,{size:12,className:"group-hover/btn:scale-110 transition-transform"}),e.jsx("span",{className:"truncate",children:(te=n.config)!=null&&te.targetName?`Go to ${n.config.targetName}`:"Connect"})]})}):n.type==="date"?e.jsx("div",{className:"w-full h-full relative flex items-center justify-center",children:e.jsx("div",{className:`text-xs cursor-pointer font-medium px-2 py-1 rounded transition-colors focus:ring-2 focus:ring-blue-500 focus:outline-none ${k?"text-gray-400 hover:text-gray-200 hover:bg-white/10":"text-gray-500 hover:text-gray-800 hover:bg-gray-100"}`,onClick:B=>{var xe,pe,Ne;B.stopPropagation();const U=B.currentTarget.getBoundingClientRect(),se=n.id==="col_date",de=se?((xe=E[t.id])==null?void 0:xe.dueDate)||"":((Ne=(pe=E[t.id])==null?void 0:pe.textValues)==null?void 0:Ne[n.id])||"";m({taskId:"draft-"+t.id,colId:n.id,date:de,rect:U,onSelect:ye=>{var $e;se?H(t.id,{dueDate:ye}):H(t.id,{textValues:{...($e=E[t.id])==null?void 0:$e.textValues,[n.id]:ye}})}})},tabIndex:0,onKeyDown:B=>{var U,se,de;if(B.key==="Enter"||B.key===" "){B.preventDefault();const xe=B.currentTarget.getBoundingClientRect(),pe=n.id==="col_date",Ne=pe?((U=E[t.id])==null?void 0:U.dueDate)||"":((de=(se=E[t.id])==null?void 0:se.textValues)==null?void 0:de[n.id])||"";m({taskId:"draft-"+t.id,colId:n.id,date:Ne,rect:xe,onSelect:ye=>{var $e;pe?H(t.id,{dueDate:ye}):H(t.id,{textValues:{...($e=E[t.id])==null?void 0:$e.textValues,[n.id]:ye}})}})}},children:(()=>{var se,de,xe;const U=n.id==="col_date"?(se=E[t.id])==null?void 0:se.dueDate:(xe=(de=E[t.id])==null?void 0:de.textValues)==null?void 0:xe[n.id];return U?new Date(U).toLocaleDateString(void 0,{month:"short",day:"numeric"}):e.jsx("span",{className:"text-gray-300",children:"Set Date"})})()})}):n.type==="text"?e.jsx("input",{type:"text",value:((Pe=(me=E[t.id])==null?void 0:me.textValues)==null?void 0:Pe[n.id])||"",onChange:B=>{var U;return H(t.id,{textValues:{...(U=E[t.id])==null?void 0:U.textValues,[n.id]:B.target.value}})},className:"w-full h-full text-center px-2 bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded text-gray-600",placeholder:"-",tabIndex:0,onKeyDown:B=>B.key==="Enter"&&ee(t.id)}):n.type==="number"?e.jsx("input",{type:"text",value:((Ae=(Re=E[t.id])==null?void 0:Re.textValues)==null?void 0:Ae[n.id])||"",onChange:B=>{var se;const U=B.target.value;/^[0-9.,]*$/.test(U)&&H(t.id,{textValues:{...(se=E[t.id])==null?void 0:se.textValues,[n.id]:U}})},className:"w-full h-full text-center px-2 bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded text-gray-600 font-mono text-xs",placeholder:"0",tabIndex:0,onKeyDown:B=>B.key==="Enter"&&ee(t.id)}):e.jsx("div",{className:"w-full h-full"})},n.id)}),e.jsx("div",{className:`transition-colors ${k?"bg-[#1a1d24] group-hover/add-row:bg-white/5":"bg-white group-hover/add-row:bg-gray-50"}`})]}),e.jsxs("div",{className:`grid gap-px border-t rounded-b-xl min-w-full w-fit ${k?"bg-[#1a1d24] border-gray-800":"bg-white border-gray-200"}`,style:{gridTemplateColumns:g+" "+t.columns.map(n=>n.width).join(" ")+" "+R},children:[e.jsx("div",{className:`flex items-center justify-center border-r sticky left-0 z-10 border-r-2 ${k?"bg-[#1a1d24] border-gray-800 border-r-gray-800":"bg-white border-gray-100 border-r-gray-200/50"}`}),e.jsx("div",{className:`flex items-center justify-center sticky left-[50px] z-10 border-t ${k?"bg-[#1a1d24] border-gray-800":"bg-white border-gray-200"}`,children:e.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider"})}),t.columns.slice(1).map(n=>e.jsxs("div",{className:`border-r min-h-[32px] flex items-center justify-center px-2 ${k?"bg-[#1a1d24] border-gray-800":"bg-white border-gray-100"}`,children:[n.type==="status"&&e.jsx("div",{className:"w-full h-4 flex rounded-sm overflow-hidden",children:Object.values(P).map(T=>{const _=a.filter(Q=>Ze(t,Q)===T).length;if(_===0)return null;const J=_/Math.max(a.length,1)*100;return e.jsx("div",{style:{width:J+"%"},title:T+": "+_,className:Qe[T]+" h-full hover:opacity-80 transition-opacity"},T)})}),n.type==="priority"&&e.jsx("div",{className:"w-full h-4 flex rounded-sm overflow-hidden",children:Object.values(Z).map(T=>{const _=t.tasks.filter(Q=>(n.id==="col_priority"?Q.priority:Q.textValues[n.id])===T).length;if(_===0)return null;const J=_/t.tasks.length*100;return e.jsx("div",{style:{width:J+"%"},title:T+": "+_,className:Ie[T]+" h-full hover:opacity-80 transition-opacity"},T)})}),n.type==="person"&&(()=>{const T=t.tasks.filter(_=>{const J=n.id==="col_owner"?_.personId:_.textValues[n.id];return J&&J.length>0}).length;return T===0?null:e.jsxs("div",{className:"flex flex-col items-center justify-center leading-none",children:[e.jsx("span",{className:"text-sm text-gray-500 font-medium",children:T}),e.jsx("span",{className:"text-[10px] text-gray-400",children:"owners"})]})})(),n.type==="money"&&(()=>{const T=t.tasks.reduce((_,J)=>{var ce;const Q=(ce=J.textValues[n.id])==null?void 0:ce.replace(/,/g,"");return _+(Number(Q)||0)},0);return e.jsxs("div",{className:"flex flex-col items-center justify-center leading-none",children:[e.jsxs("span",{className:"text-xs text-gray-700 font-bold font-mono",children:[n.currency||"$"," ",T.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("span",{className:"text-[10px] text-gray-400",children:"sum"})]})})(),n.type==="checkbox"&&(()=>{const T=t.tasks.filter(_=>_.textValues[n.id]==="true").length;return T===0?null:e.jsxs("div",{className:"flex flex-col items-center justify-center leading-none",children:[e.jsx("span",{className:"text-xs text-gray-700 font-bold font-mono",children:T}),e.jsx("span",{className:"text-[10px] text-gray-400",children:"checked"})]})})(),n.type==="number"&&(()=>{const T=t.tasks.reduce((_,J)=>{var ce;const Q=(ce=J.textValues[n.id])==null?void 0:ce.replace(/,/g,"");return _+(Number(Q)||0)},0);return e.jsxs("div",{className:"flex flex-col items-center justify-center leading-none",children:[e.jsx("span",{className:"text-xs text-gray-700 font-bold font-mono",children:T.toLocaleString()}),e.jsx("span",{className:"text-[10px] text-gray-400",children:"sum"})]})})(),(n.type==="text"||n.type==="long_text"||n.type==="date"||n.type==="dropdown"||n.type==="name")&&(()=>{const T=t.tasks.filter(_=>{if(n.type==="name")return!0;const J=_.textValues[n.id];return J&&J.trim().length>0}).length;return T===0?null:e.jsxs("div",{className:"flex flex-col items-center justify-center leading-none",children:[e.jsx("span",{className:"text-xs text-gray-700 font-bold font-mono",children:T}),e.jsx("span",{className:"text-[10px] text-gray-400",children:"count"})]})})()]},n.id)),e.jsx("div",{className:`${k?"bg-[#1a1d24]":"bg-white"}`})]})]})]})}),tn=z.forwardRef(({storageKey:t="taskboard-state",tasks:a,onTaskUpdate:c,darkMode:s=!1,minimal:i=!1,showGroupHeader:D=!1,expandAllSignal:C,collapseAllSignal:v,searchQuery:$="",statusFilter:p="all",sortKey:h="none",transparent:V=!1,autoHeight:u=!1},A)=>{var rt;const{board:N,setBoard:g,aiAnalysis:R,setAiAnalysis:K,updateTask:L,toggleTaskSelection:W,toggleGroupSelection:G,updateTaskTextValue:X,addTask:q,deleteTask:oe,addGroup:he,deleteGroup:o,updateGroupTitle:ne,toggleGroupPin:le,addColumn:w,updateColumnTitle:O,deleteColumn:y,duplicateColumn:m,reorderColumn:b,updateColumnWidth:f}=wr(t),[d,I]=z.useState(null),{isImmersive:E,activePage:H,setActivePage:ee}=us(),k=(r,x)=>{I({type:"task",id:x,groupId:r})},ue=r=>{I({type:"group",groupId:r})},n=()=>{I({type:"selected"})},T=()=>{if(!d)return;const{type:r,id:x,groupId:l}=d;r==="task"&&x&&l?oe(l,x):r==="group"&&l?o(l):r==="selected"?Xt():r==="column"&&x&&l&&y(l,x),I(null)};z.useEffect(()=>{a&&a.length>0&&g(r=>{const x=[...r.groups];x.length===0&&x.push({id:"g1",title:"Tasks",color:"#3b82f6",tasks:[],columns:[],isPinned:!1});const l=x[0],j=a.map(S=>{let F=P.New;return S.status==="To do"?F=P.New:S.status==="In Progress"?F=P.Working:S.status==="Review"?F=P.AlmostFinish:S.status==="Complete"&&(F=P.Done),{id:S.id,name:S.title,status:F,priority:S.priority,personId:S.assigneeId||null,dueDate:S.dueDate?new Date(S.dueDate).toISOString():"",textValues:{},selected:!1}});return x[0]={...l,tasks:j},{...r,groups:x}})},[a,g]);const _=(r,x,l)=>{if(L(r,x,l),c){const j={};l.name&&(j.title=l.name),l.status&&(l.status===P.New||l.status===P.Pending?j.status="To do":l.status===P.Working||l.status===P.Stuck?j.status="In Progress":l.status===P.AlmostFinish?j.status="Review":l.status===P.Done&&(j.status="Complete")),l.priority&&(j.priority=l.priority),l.personId!==void 0&&(j.assigneeId=l.personId||void 0),l.dueDate&&(j.dueDate=new Date(l.dueDate)),c(x,j)}},[J,Q]=z.useState(!1),[ce,We]=z.useState(null),[ge,De]=z.useState(null),[ve,je]=z.useState(null),[te,me]=z.useState(null),[Pe,Re]=z.useState(new Set),[Ae,B]=z.useState({}),[U,se]=z.useState(null),[de,xe]=z.useState(null),[pe,Ne]=z.useState(null),ye=xt.getCurrentUser(),$e=ye&&t===`taskboard-${ye.id}`,[_e,qe]=z.useState(null),[Ee,Je]=z.useState({}),[Er,Tr]=z.useState(null),[Ye,Dt]=z.useState(null),zt=z.useRef(null),kt=z.useRef(N.groups.length),[fe,Me]=z.useState(null),[It,Xe]=z.useState(new Set);z.useEffect(()=>{const r=l=>{if(!fe)return;const j=l.clientX-fe.startX,S=Math.max(50,fe.startWidth+j);f(fe.groupId,fe.colId,S)},x=()=>{fe&&(Me(null),document.body.style.cursor="")};return fe&&(document.addEventListener("mousemove",r),document.addEventListener("mouseup",x),document.body.style.cursor="col-resize"),()=>{document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",x),document.body.style.cursor=""}},[fe,f]),z.useEffect(()=>{kt.current=N.groups.length},[N.groups.length]);const Pt=r=>{const x=new Set(Pe);x.has(r)?x.delete(r):x.add(r),Re(x)},At=(r,x)=>{var S;const l=(S=Ae[x])==null?void 0:S.trim();if(!l)return;const j={id:`subtask-${ie()}`,name:l,status:P.New,priority:Z.Normal,dueDate:"",personId:null,textValues:{},selected:!1};g(F=>({...F,groups:F.groups.map(Y=>Y.id===r?{...Y,tasks:Y.tasks.map(re=>re.id===x?{...re,subtasks:[...re.subtasks||[],j]}:re)}:Y)})),B(F=>({...F,[x]:""}))},_t=(r,x)=>{Je(l=>({...l,[r]:{...l[r],...x}}))},Et=r=>{const x=Ee[r]||{},l=x.name||"";l.trim()&&(q(r,l,x),Je(j=>{const S={...j};return delete S[r],S}))},Tt=r=>{if(Object.entries(Ee).filter(([,j])=>{var S;return(S=j==null?void 0:j.name)==null?void 0:S.trim()}).length===0)return N;const l={...N,groups:N.groups.map(j=>{var re;const S=Ee[j.id],F=(re=S==null?void 0:S.name)==null?void 0:re.trim();if(!S||!F)return j;const Y={id:ie(),name:F,status:S.status||P.New,priority:S.priority||Z.Normal,dueDate:S.dueDate||new Date().toISOString().split("T")[0],personId:S.personId??null,textValues:S.textValues||{},selected:!1};return{...j,tasks:[...j.tasks,Y]}})};return r!=null&&r.skipPersist||g(l),Je({}),l};z.useImperativeHandle(A,()=>({exportBoardWithDrafts:Tt}),[N,Ee]);const Ft=(r,x,l)=>{r.preventDefault(),qe({x:r.clientX,y:r.clientY,groupId:x,colId:l})},Vt=(r,x,l)=>{if(r==="delete")y(x,l);else if(r==="duplicate")m(x,l);else if(r!=="move_left"){if(r!=="move_right"){if(r==="rename"){const j=prompt("Enter new column name:");j&&O(x,l,j)}}}qe(null)},Ot=ks(ot(Ps,{activationConstraint:{distance:5}}),ot(Is,{activationConstraint:{delay:250,tolerance:5}})),Rt=r=>{const{active:x}=r;Q(!0),Dt(x.id)},Lt=r=>{const{active:x,over:l}=r;if(!l){Q(!1);return}const j=x.id,S=l.id;if(j===S){Q(!1);return}g(F=>{const Y=F.groups.find(ae=>ae.tasks.some(Ce=>Ce.id===j)),re=F.groups.find(ae=>ae.tasks.some(Ce=>Ce.id===S));if(!Y||!re)return F;const nt=Y.tasks.findIndex(ae=>ae.id===j),at=re.tasks.findIndex(ae=>ae.id===S);if(Y.id===re.id){const ae=Ds(Y.tasks,nt,at),Ce=F.groups.map(ze=>ze.id===Y.id?{...ze,tasks:ae}:ze);return{...F,groups:Ce}}else{const ae=[...Y.tasks],[Ce]=ae.splice(nt,1),ze=[...re.tasks];ze.splice(at,0,Ce);const Zt=F.groups.map(Te=>Te.id===Y.id?{...Te,tasks:ae}:Te.id===re.id?{...Te,tasks:ze}:Te);return{...F,groups:Zt}}}),Q(!1)},Gt=(r,x,l,j)=>{if(j===0){r.preventDefault();return}r.dataTransfer.setData("application/json",JSON.stringify({type:"COLUMN",groupId:x,colId:l,index:j})),r.dataTransfer.effectAllowed="move"},Bt=(r,x)=>{r.preventDefault(),x===0?r.dataTransfer.dropEffect="none":r.dataTransfer.dropEffect="move"},Ht=(r,x,l)=>{r.preventDefault();const j=r.dataTransfer.getData("application/json");if(j)try{const{type:S,groupId:F,index:Y}=JSON.parse(j);S==="COLUMN"&&F===x&&Y!==l&&l!==0&&b(x,Y,l)}catch{}},Le=$.trim().toLowerCase(),Ut=Le.length>0||p!=="all",Wt=r=>!Le||r.name.toLowerCase().includes(Le)?!0:Object.values(r.textValues||{}).some(x=>(x||"").toLowerCase().includes(Le)),qt=(r,x)=>{if(p==="all")return!0;const l=Ze(x,r);return p==="done"?l===P.Done:p==="new"?l===P.New||l===P.Pending:l!==P.Done},Jt=r=>{if(h==="none")return r;const x=[...r];if(h==="name")x.sort((l,j)=>l.name.localeCompare(j.name));else if(h==="dueAsc"||h==="dueDesc")x.sort((l,j)=>{const S=l.dueDate?new Date(l.dueDate).getTime():1/0,F=j.dueDate?new Date(j.dueDate).getTime():1/0;return h==="dueAsc"?S-F:F-S});else if(h==="priority"){const l={[Z.Urgent]:1,[Z.High]:2,[Z.Medium]:3,[Z.Normal]:4,[Z.Low]:5};x.sort((j,S)=>(l[j.priority]||99)-(l[S.priority]||99))}return x},et="50px",tt="50px",Ge=N.groups.flatMap(r=>r.tasks.filter(x=>x.selected).map(x=>({groupId:r.id,task:x}))).length,Yt=()=>{G("all",!1)},Xt=()=>{Ge!==0&&g(r=>({...r,groups:r.groups.map(x=>({...x,tasks:x.tasks.filter(l=>!l.selected)}))}))},Kt=()=>{Ge!==0&&g(r=>({...r,groups:r.groups.map(x=>{const l=x.tasks.filter(S=>S.selected);if(l.length===0)return x;const j=l.map(S=>({...S,id:crypto.randomUUID(),name:S.name+" (Copy)",selected:!0}));return{...x,tasks:[...x.tasks,...j]}})}))},Qt=r=>{Xe(x=>{const l=new Set(x);return l.has(r)?l.delete(r):l.add(r),l})};z.useEffect(()=>{C!==void 0&&Xe(new Set)},[C]);const st=z.useRef(v);return z.useEffect(()=>{v!==void 0&&v!==st.current&&(Xe(new Set(N.groups.map(r=>r.id))),st.current=v)},[v,N.groups]),e.jsxs(As,{sensors:Ot,collisionDetection:_s,onDragStart:Rt,onDragEnd:Lt,children:[e.jsxs("div",{className:`flex w-full ${i||u?"h-full":"h-screen"} ${u?"":"overflow-hidden"} font-sans transition-colors ${V?"bg-transparent":s?"bg-[#0f1115] text-gray-200":"bg-white text-gray-800"}`,children:[e.jsxs("main",{className:`flex-1 flex flex-col ${i||u?"h-full":"h-screen"} ${u?"":"overflow-hidden"} relative transition-colors ${V?"bg-transparent":s?"bg-[#0f1115]":"bg-white"}`,children:[!i&&e.jsxs("header",{className:`h-16 flex items-center justify-between px-8 flex-shrink-0 transition-colors ${V?"bg-transparent":s?"bg-[#0f1115] border-b border-white/5":"bg-white"}`,children:[e.jsx("div",{children:e.jsx("h1",{className:`text-2xl font-bold tracking-tight ${s?"text-white":"text-gray-800"}`,children:N.name})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:r=>{const x=N.groups[0];x&&q(x.id)},className:"flex items-center gap-2 px-4 py-2 bg-clickup-purple text-white rounded-lg hover:bg-indigo-700 transition-colors shadow-sm active:scale-95",children:[e.jsx(He,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"Add Task"})]}),e.jsxs("button",{onClick:he,className:"flex items-center gap-2 px-4 py-2 bg-[#1e2126] text-white rounded-md hover:bg-[#2c3036] transition text-sm font-medium shadow-sm",children:[e.jsx(fs,{className:"w-4 h-4"})," New Group"]})]})]}),e.jsxs("div",{ref:zt,className:`flex-1 ${u?"":"overflow-y-auto overflow-x-hidden custom-scroll"} ${i?"p-0 pb-4":u?"":"p-6 pb-96"}`,children:[R&&e.jsxs("div",{className:"mb-8 p-6 bg-white border border-indigo-100 rounded-2xl shadow-xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400"}),e.jsxs("h3",{className:"text-indigo-900 font-bold text-lg mb-3 flex items-center gap-2",children:[e.jsx(bs,{className:"w-5 h-5 text-indigo-500"})," AI Assistant Insights"]}),e.jsx("p",{className:"text-gray-700 whitespace-pre-line text-sm leading-relaxed",children:R}),e.jsx("button",{onClick:()=>K(null),className:"mt-4 text-xs font-semibold text-gray-400 hover:text-gray-600 uppercase tracking-wider",children:"Dismiss"})]}),e.jsx("div",{className:"space-y-8 w-full",children:[...N.groups].sort((r,x)=>(x.isPinned?1:0)-(r.isPinned?1:0)).map(r=>{const x=Jt(r.tasks.filter(F=>Wt(F)&&qt(F,r))),l=Ar(r,x),j=r.tasks.length>0&&r.tasks.every(F=>F.selected),S=r.tasks.some(F=>F.selected);return Ut&&x.length===0?null:e.jsx(_r,{group:r,filteredTasks:x,progress:l,collapsedGroups:It,toggleGroupCollapse:Qt,updateGroupTitle:ne,toggleGroupPin:le,setShowReminderModalGroupId:se,setShowGoalsModalGroupId:xe,setShowTaskBoardModalGroupId:Ne,isMainBoard:$e,handleDeleteGroupClick:ue,allSelected:j,someSelected:S,toggleGroupSelection:G,selectionColumnWidth:et,actionColumnWidth:tt,handleContextMenu:Ft,handleColumnDragStart:Gt,handleColumnDragOver:Bt,handleColumnDrop:Ht,updateColumnTitle:O,activeColumnMenu:ve,setActiveColumnMenu:je,setResizingCol:Me,expandedTaskIds:Pe,toggleTaskSelection:W,updateTask:_,handleDeleteTaskClick:k,updateTaskTextValue:X,toggleSubtask:Pt,setActiveDatePicker:De,setActiveConnectionMenu:me,handleAddSubtask:At,subtaskInput:Ae,setSubtaskInput:B,draftTasks:Ee,updateDraftTask:_t,handleAddTask:Et,darkMode:s},r.id)})})]}),e.jsx(gs,{children:Ge>0&&e.jsx(it.div,{className:"fixed bottom-16 md:bottom-20 left-0 right-0 px-4 z-50 pointer-events-none",initial:{opacity:0,y:16,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:16,scale:.98},transition:{duration:.18,ease:"easeOut"},children:e.jsx(it.div,{className:`mx-auto max-w-5xl shadow-2xl border rounded-2xl px-6 py-3 flex items-center gap-6 pointer-events-auto justify-center ${s?"bg-[#1a1d24] border-gray-800":"bg-white border-gray-200"}`,initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:8},transition:{duration:.18,ease:"easeOut",delay:.02},children:e.jsx("div",{className:"flex items-center gap-5 text-sm text-gray-600 flex-wrap md:flex-nowrap justify-center w-full",children:e.jsxs("div",{className:"flex items-center gap-5 flex-wrap md:flex-nowrap justify-center",children:[e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",onClick:Kt,children:[e.jsx(wt,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Duplicate"})]}),e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",children:[e.jsx(ms,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Export"})]}),e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",children:[e.jsx(Hs,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Archive"})]}),e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",onClick:n,children:[e.jsx(Ke,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Delete"})]}),e.jsxs("button",{className:"flex items-center gap-2 text-gray-400 cursor-not-allowed whitespace-nowrap",disabled:!0,children:[e.jsx(ct,{size:18,className:"text-gray-400"})," ",e.jsx("span",{children:"Convert"})]}),e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",children:[e.jsx(ct,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Move to"})]}),e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",children:[e.jsx(jt,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Sidekick"})]}),e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",children:[e.jsx(yt,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Apps"})]}),e.jsxs("button",{className:"flex items-center gap-2 hover:text-gray-900 whitespace-nowrap text-gray-700",onClick:Yt,children:[e.jsx(Oe,{size:18,className:"text-gray-700"})," ",e.jsx("span",{children:"Clear"})]})]})})})})})]}),_e&&e.jsx(vr,{x:_e.x,y:_e.y,onClose:()=>qe(null),onAction:r=>Vt(r,_e.groupId,_e.colId)}),ge&&be.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-[9998] bg-transparent",onClick:r=>{r.stopPropagation(),De(null)}}),e.jsx("div",{className:"fixed z-[10005]",style:{top:ge.rect.bottom+8,left:ge.rect.left+ge.rect.width/2,transform:"translateX(-50%)"},onClick:r=>r.stopPropagation(),children:e.jsx(vs,{date:ge.date,onSelect:r=>{ge.onSelect(r)},onClose:()=>De(null)})})]}),document.body),ve&&be.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-[9998] bg-transparent",onClick:r=>{r.stopPropagation(),je(null)}}),e.jsx("div",{className:"fixed top-[100px] bottom-0 right-0 z-[10005]",onClick:r=>r.stopPropagation(),children:e.jsx(ws,{onClose:()=>je(null),onSelect:(r,x,l,j,S)=>{ve&&w(ve.groupId,r,x,l,j,S),je(null)},darkMode:s})})]}),document.body),te&&be.createPortal(e.jsx("div",{className:"fixed inset-0 z-[100] flex items-start justify-start",onClick:()=>me(null),children:e.jsx("div",{className:"absolute bg-white rounded-lg shadow-xl border border-gray-200 w-64 p-2 animate-in fade-in zoom-in-95 duration-100",style:{top:Math.min(te.rect.bottom+8,window.innerHeight-300),left:Math.max(8,Math.min(te.rect.left,window.innerWidth-270))},onClick:r=>r.stopPropagation(),children:(rt=te.config)!=null&&rt.targetPath?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase px-2 mb-2",children:"Connected Page"}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-blue-50 text-blue-700 rounded-md",children:[e.jsx(pt,{size:16}),e.jsx("span",{className:"font-medium text-sm",children:te.config.targetName})]}),e.jsxs("button",{onClick:()=>{var r;(r=te.config)!=null&&r.targetPath&&ee(te.config.targetPath),me(null)},className:"w-full flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-md text-sm font-medium transition-colors",children:["Open Page ",e.jsx(Gs,{size:14})]}),e.jsx("div",{className:"h-px bg-gray-100 my-2"}),e.jsx("button",{onClick:()=>{me(r=>r?{...r,config:void 0}:null)},className:"w-full text-left px-2 py-1.5 text-xs text-gray-500 hover:text-gray-900 hover:bg-gray-50 rounded",children:"Change Connection..."})]}):e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2 px-2 border-b pb-2",children:e.jsx("h3",{className:"font-semibold text-gray-800 text-sm",children:"Select Page to Connect"})}),[{name:"Goals",path:"goals"},{name:"Reminders",path:"reminders"},{name:"Overview",path:"overview"},{name:"Tasks",path:"tasks"},{name:"Vault",path:"vault"},{name:"Teams",path:"teams"},{name:"Departments",path:"departments"},{name:"Private Rooms",path:"rooms"},{name:"Discussion",path:"discussion"}].map(r=>e.jsxs("button",{onClick:()=>{if(te.taskId==="DRAFT_TASK"){me(null);return}const x={targetPath:r.path,targetName:r.name};X(te.groupId,te.taskId,te.colId,JSON.stringify(x)),me(null)},className:"w-full text-left px-2 py-1.5 rounded hover:bg-gray-50 flex items-center justify-between group transition-colors",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:r.name}),e.jsx(ht,{size:14,className:"text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity"})]},r.path))]})})}),document.body),U&&e.jsx(jr,{isOpen:!!U,onClose:()=>se(null),group:N.groups.find(r=>r.id===U)}),de&&e.jsx(Nr,{isOpen:!0,onClose:()=>xe(null),group:N.groups.find(r=>r.id===de)}),pe&&e.jsx($r,{isOpen:!0,onClose:()=>Ne(null),group:N.groups.find(r=>r.id===pe)}),e.jsx(hs,{isOpen:!!d,onClose:()=>I(null),onConfirm:T,title:(d==null?void 0:d.type)==="task"?"Delete Task":(d==null?void 0:d.type)==="group"?"Delete Group":(d==null?void 0:d.type)==="column"?"Delete Column":"Delete Selected Tasks",message:(d==null?void 0:d.type)==="task"?"Are you sure you want to delete this task? This action cannot be undone.":(d==null?void 0:d.type)==="group"?"Are you sure you want to delete this group and all its tasks? This action cannot be undone.":(d==null?void 0:d.type)==="column"?"Are you sure you want to delete this column? This action cannot be undone.":`Are you sure you want to delete ${Ge} tasks? This action cannot be undone.`,confirmText:"Delete",variant:"danger"})]}),e.jsx(Es,{dropAnimation:{sideEffects:Ts({styles:{active:{opacity:"1"}}})},children:Ye?(()=>{const r=N.groups.flatMap(l=>l.tasks).find(l=>l.id===Ye),x=N.groups.find(l=>l.tasks.some(j=>j.id===Ye));return!r||!x?null:e.jsxs("div",{className:`grid gap-px text-sm rounded cursor-grabbing shadow-2xl ring-2 ring-blue-500/20 z-50 transform scale-[1.01] ${s?"bg-[#1a1d24] border-gray-700":"bg-white border-gray-200"}`,style:{gridTemplateColumns:et+" "+x.columns.map(l=>l.width).join(" ")+" "+tt,width:"100%"},children:[e.jsxs("div",{className:`flex items-center justify-center py-1.5 border-r relative ${s?"border-gray-800":"border-gray-100"}`,children:[e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1.5",style:{backgroundColor:x.color}}),e.jsx("div",{className:"w-4 h-4 rounded border-gray-300"})]}),x.columns.map(l=>{var S,F;const j=l.type==="name";return e.jsxs("div",{className:`relative border-r flex items-center ${j?"justify-start pl-2":"justify-center"} min-h-[32px] overflow-hidden ${s?"border-gray-800":"border-gray-100"}`,children:[j&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-gray-400 mr-2 p-1",children:e.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"9",cy:"12",r:"1"}),e.jsx("circle",{cx:"9",cy:"5",r:"1"}),e.jsx("circle",{cx:"9",cy:"19",r:"1"}),e.jsx("circle",{cx:"15",cy:"12",r:"1"}),e.jsx("circle",{cx:"15",cy:"5",r:"1"}),e.jsx("circle",{cx:"15",cy:"19",r:"1"})]})}),e.jsx("div",{className:`font-medium truncate ${s?"text-gray-200":"text-gray-700"}`,children:r.name})]}),l.type==="status"&&e.jsx("div",{className:"px-2 py-0.5 rounded text-white text-xs font-bold uppercase truncate",style:{backgroundColor:Qe[r.status]},children:r.status}),l.type==="priority"&&e.jsx("div",{className:"px-2 py-0.5 rounded text-white text-xs font-bold uppercase truncate",style:{backgroundColor:Ie[r.priority]},children:r.priority}),l.type==="person"&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center text-[10px] font-medium text-gray-600",children:((S=Ue.find(Y=>Y.id===r.personId))==null?void 0:S.name.charAt(0))||"?"}),e.jsx("span",{className:"text-xs truncate",children:(F=Ue.find(Y=>Y.id===r.personId))==null?void 0:F.name})]}),l.type==="date"&&e.jsx("div",{className:"text-xs text-gray-500 truncate",children:r.dueDate||"-"}),l.type==="text"&&e.jsx("div",{className:"text-xs text-gray-500 truncate px-2",children:r[l.id]||"-"})]},l.id)}),e.jsx("div",{className:"border-r border-transparent"})]})})():null})]})});export{Hs as A,Fe as I,Nt as M,xr as P,P as S,tn as T,Js as a,Z as b,wr as u};
